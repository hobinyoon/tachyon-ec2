run1 #: 0

restaring tachyon
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Killed 0 processes
Killed 0 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting RamFS: /mnt/ramdisk
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata -Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Starting master @ tachyon-ec2-0
Starting worker @ tachyon-ec2-0

spark-shell count
5406 tachyon.Master
5433 tachyon.Worker

Going to fadvise /mnt/tachyon/hit_data.tsv.1 as mode POSIX_FADV_DONTNEED
offset: 0
length: 525
mode: POSIX_FADV_DONTNEED
WIN
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/ubuntu/work/tachyon/target/tachyon-0.3.0-SNAPSHOT-jar-with-dependencies.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/ubuntu/work/spark/lib_managed/jars/slf4j-log4j12-1.7.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
Welcome to
      ____              __  
     / __/__  ___ _____/ /__
    _\ \/ _ \/ _ `/ __/  '_/
   /___/ .__/\_,_/_/ /_/\_\   version 0.8.0
      /_/                  

Using Scala version 2.9.3 (OpenJDK 64-Bit Server VM, Java 1.7.0_25)
Initializing interpreter...
13/07/27 21:11:26 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:11:26 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:52214
Creating SparkContext...
13/07/27 21:11:36 INFO slf4j.Slf4jEventHandler: Slf4jEventHandler started
13/07/27 21:11:36 INFO spark.SparkEnv: Registering BlockManagerMaster
13/07/27 21:11:36 INFO storage.MemoryStore: MemoryStore started with capacity 1295.4 MB.
13/07/27 21:11:36 INFO storage.DiskStore: Created local directory at /tmp/spark-local-20130727211136-abd0
13/07/27 21:11:36 INFO network.ConnectionManager: Bound socket to port 54496 with id = ConnectionManagerId(tachyon-ec2-0,54496)
13/07/27 21:11:36 INFO storage.BlockManagerMaster: Trying to register BlockManager
13/07/27 21:11:36 INFO storage.BlockManagerMasterActor$BlockManagerInfo: Registering block manager tachyon-ec2-0:54496 with 1295.4 MB RAM
13/07/27 21:11:36 INFO storage.BlockManagerMaster: Registered BlockManager
13/07/27 21:11:36 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:11:36 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:39448
13/07/27 21:11:36 INFO broadcast.HttpBroadcast: Broadcast server started at http://10.151.80.188:39448
13/07/27 21:11:36 INFO spark.SparkEnv: Registering MapOutputTracker
13/07/27 21:11:36 INFO spark.HttpFileServer: HTTP File server directory is /tmp/spark-59248353-54ba-40fa-a355-1bcc35e518bf
13/07/27 21:11:36 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:11:36 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:51283
13/07/27 21:11:36 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:11:36 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage/rdd,null}
13/07/27 21:11:36 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:11:36 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:11:36 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:11:36 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:11:36 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:11:36 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:11:36 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:11:36 INFO server.AbstractConnector: Started SelectChannelConnector@0.0.0.0:33000
13/07/27 21:11:36 INFO ui.SparkUI: Started Spark Web UI at http://tachyon-ec2-0:33000
Spark context available as sc.
Type in expressions to have them evaluated.
Type :help for more information.

scala> val s = sc.textFile("tachyon://tachyon-ec2-0:19998/hit_data.tsv.1")
13/07/27 21:11:37 INFO storage.MemoryStore: ensureFreeSpace(57342) called with curMem=0, maxMem=1358297825
13/07/27 21:11:37 INFO storage.MemoryStore: Block broadcast_0 stored as values to memory (estimated size 56.0 KB, free 1295.3 MB)
s: spark.RDD[String] = MappedRDD[1] at textFile at <console>:12

scala> s.count()
13/07/27 21:11:38 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
13/07/27 21:11:38 WARN snappy.LoadSnappy: Snappy native library not loaded
13/07/27 21:11:38 INFO : initialize(tachyon://tachyon-ec2-0:19998/hit_data.tsv.1, Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml). Connecting to Tachyon: tachyon://tachyon-ec2-0:19998/hit_data.tsv.1
13/07/27 21:11:38 INFO : Trying to connect master @ tachyon-ec2-0/10.151.80.188:19998
13/07/27 21:11:38 INFO : User registered at the master tachyon-ec2-0/10.151.80.188:19998 got UserId 1
13/07/27 21:11:38 INFO : Trying to get local worker host : tachyon-ec2-0
13/07/27 21:11:38 INFO : Connecting local worker @ tachyon-ec2-0/10.151.80.188:29998
13/07/27 21:11:38 INFO : tachyon://tachyon-ec2-0:19998 tachyon://tachyon-ec2-0:19998 file:///mnt/tachyon
13/07/27 21:11:38 INFO : getFileStatus(/hit_data.tsv.1): HDFS Path: file:/mnt/tachyon/hit_data.tsv.1 TPath: tachyon://tachyon-ec2-0:19998/hit_data.tsv.1
13/07/27 21:11:38 INFO : tachyon.client.TachyonFS@7c5a8c38 file:///mnt/tachyon /hit_data.tsv.1 tachyon.PrefixList@1cabf050
13/07/27 21:11:38 INFO : Create tachyon file /hit_data.tsv.1 with file id 2 and checkpoint location file:///mnt/tachyon/hit_data.tsv.1
13/07/27 21:11:38 INFO mapred.FileInputFormat: Total input paths to process : 1
13/07/27 21:11:38 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:11:38 INFO scheduler.DAGScheduler: Got job 0 (count at <console>:15) with 1 output partitions (allowLocal=false)
13/07/27 21:11:38 INFO scheduler.DAGScheduler: Final stage: Stage 0 (count at <console>:15)
13/07/27 21:11:38 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:11:38 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:11:38 INFO scheduler.DAGScheduler: Submitting Stage 0 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:11:38 INFO scheduler.DAGScheduler: Submitting 1 missing tasks from Stage 0 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:11:38 INFO local.LocalTaskSetManager: Size of task 0 is 1494 bytes
13/07/27 21:11:38 INFO local.LocalScheduler: Running 0
13/07/27 21:11:38 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.1, 65536)
13/07/27 21:11:39 INFO : /mnt/ramdisk/tachyonworker/2147483648 is not on local disk.
13/07/27 21:11:39 INFO : Try to find and read from remote workers.
13/07/27 21:11:39 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:11:39 INFO : Folder /mnt/ramdisk/tachyonworker/users/1 was created!
13/07/27 21:11:39 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483648 was created!
13/07/27 21:11:39 INFO local.LocalScheduler: Finished 0
13/07/27 21:11:39 INFO local.LocalScheduler: Remove TaskSet 0.0 from pool 
13/07/27 21:11:39 INFO scheduler.DAGScheduler: Completed ResultTask(0, 0)
13/07/27 21:11:39 INFO scheduler.DAGScheduler: Stage 0 (count at <console>:15) finished in 0.363 s
13/07/27 21:11:39 INFO spark.SparkContext: Job finished: count at <console>:15, took 0.407104181 s
res0: Long = 1

scala> 13/07/27 21:11:39 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:11:39 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:11:39 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:11:39 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:11:39 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:11:39 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:11:39 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:11:39 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage/rdd,null}
Killed 1 processes
Killed 1 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting Tachyon @ tachyon-ec2-0
2013-07-27 21:11:40,891 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data
2013-07-27 21:11:40,895 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_log.data
2013-07-27 21:11:41,381 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/data
2013-07-27 21:11:41,393 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/workers

restaring tachyon
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Killed 0 processes
Killed 0 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting RamFS: /mnt/ramdisk
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata -Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Starting master @ tachyon-ec2-0
Starting worker @ tachyon-ec2-0

spark-shell count
5962 tachyon.Master
5989 tachyon.Worker

Going to fadvise /mnt/tachyon/hit_data.tsv.100 as mode POSIX_FADV_DONTNEED
offset: 0
length: 55735
mode: POSIX_FADV_DONTNEED
WIN
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/ubuntu/work/tachyon/target/tachyon-0.3.0-SNAPSHOT-jar-with-dependencies.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/ubuntu/work/spark/lib_managed/jars/slf4j-log4j12-1.7.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
Welcome to
      ____              __  
     / __/__  ___ _____/ /__
    _\ \/ _ \/ _ `/ __/  '_/
   /___/ .__/\_,_/_/ /_/\_\   version 0.8.0
      /_/                  

Using Scala version 2.9.3 (OpenJDK 64-Bit Server VM, Java 1.7.0_25)
Initializing interpreter...
13/07/27 21:11:47 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:11:47 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:42758
Creating SparkContext...
13/07/27 21:11:56 INFO slf4j.Slf4jEventHandler: Slf4jEventHandler started
13/07/27 21:11:57 INFO spark.SparkEnv: Registering BlockManagerMaster
13/07/27 21:11:57 INFO storage.MemoryStore: MemoryStore started with capacity 1295.4 MB.
13/07/27 21:11:57 INFO storage.DiskStore: Created local directory at /tmp/spark-local-20130727211157-ad98
13/07/27 21:11:57 INFO network.ConnectionManager: Bound socket to port 46592 with id = ConnectionManagerId(tachyon-ec2-0,46592)
13/07/27 21:11:57 INFO storage.BlockManagerMaster: Trying to register BlockManager
13/07/27 21:11:57 INFO storage.BlockManagerMasterActor$BlockManagerInfo: Registering block manager tachyon-ec2-0:46592 with 1295.4 MB RAM
13/07/27 21:11:57 INFO storage.BlockManagerMaster: Registered BlockManager
13/07/27 21:11:57 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:11:57 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:37729
13/07/27 21:11:57 INFO broadcast.HttpBroadcast: Broadcast server started at http://10.151.80.188:37729
13/07/27 21:11:57 INFO spark.SparkEnv: Registering MapOutputTracker
13/07/27 21:11:57 INFO spark.HttpFileServer: HTTP File server directory is /tmp/spark-6cdfbf44-8596-4102-a6d8-b7357072e665
13/07/27 21:11:57 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:11:57 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:40281
13/07/27 21:11:57 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:11:57 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage/rdd,null}
13/07/27 21:11:57 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:11:57 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:11:57 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:11:57 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:11:57 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:11:57 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:11:57 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:11:57 INFO server.AbstractConnector: Started SelectChannelConnector@0.0.0.0:33000
13/07/27 21:11:57 INFO ui.SparkUI: Started Spark Web UI at http://tachyon-ec2-0:33000
Spark context available as sc.
Type in expressions to have them evaluated.
Type :help for more information.

scala> val s = sc.textFile("tachyon://tachyon-ec2-0:19998/hit_data.tsv.100")
13/07/27 21:11:58 INFO storage.MemoryStore: ensureFreeSpace(57350) called with curMem=0, maxMem=1358297825
13/07/27 21:11:58 INFO storage.MemoryStore: Block broadcast_0 stored as values to memory (estimated size 56.0 KB, free 1295.3 MB)
s: spark.RDD[String] = MappedRDD[1] at textFile at <console>:12

scala> s.count()
13/07/27 21:11:58 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
13/07/27 21:11:58 WARN snappy.LoadSnappy: Snappy native library not loaded
13/07/27 21:11:58 INFO : initialize(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100, Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml). Connecting to Tachyon: tachyon://tachyon-ec2-0:19998/hit_data.tsv.100
13/07/27 21:11:58 INFO : Trying to connect master @ tachyon-ec2-0/10.151.80.188:19998
13/07/27 21:11:58 INFO : User registered at the master tachyon-ec2-0/10.151.80.188:19998 got UserId 1
13/07/27 21:11:58 INFO : Trying to get local worker host : tachyon-ec2-0
13/07/27 21:11:58 INFO : Connecting local worker @ tachyon-ec2-0/10.151.80.188:29998
13/07/27 21:11:58 INFO : tachyon://tachyon-ec2-0:19998 tachyon://tachyon-ec2-0:19998 file:///mnt/tachyon
13/07/27 21:11:58 INFO : getFileStatus(/hit_data.tsv.100): HDFS Path: file:/mnt/tachyon/hit_data.tsv.100 TPath: tachyon://tachyon-ec2-0:19998/hit_data.tsv.100
13/07/27 21:11:58 INFO : tachyon.client.TachyonFS@1fc7f0d7 file:///mnt/tachyon /hit_data.tsv.100 tachyon.PrefixList@7f94c38d
13/07/27 21:11:59 INFO : Create tachyon file /hit_data.tsv.100 with file id 2 and checkpoint location file:///mnt/tachyon/hit_data.tsv.100
13/07/27 21:11:59 INFO mapred.FileInputFormat: Total input paths to process : 1
13/07/27 21:11:59 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:11:59 INFO scheduler.DAGScheduler: Got job 0 (count at <console>:15) with 1 output partitions (allowLocal=false)
13/07/27 21:11:59 INFO scheduler.DAGScheduler: Final stage: Stage 0 (count at <console>:15)
13/07/27 21:11:59 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:11:59 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:11:59 INFO scheduler.DAGScheduler: Submitting Stage 0 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:11:59 INFO scheduler.DAGScheduler: Submitting 1 missing tasks from Stage 0 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:11:59 INFO local.LocalTaskSetManager: Size of task 0 is 1496 bytes
13/07/27 21:11:59 INFO local.LocalScheduler: Running 0
13/07/27 21:11:59 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100, 65536)
13/07/27 21:11:59 INFO : /mnt/ramdisk/tachyonworker/2147483648 is not on local disk.
13/07/27 21:11:59 INFO : Try to find and read from remote workers.
13/07/27 21:11:59 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:11:59 INFO : Folder /mnt/ramdisk/tachyonworker/users/1 was created!
13/07/27 21:11:59 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483648 was created!
13/07/27 21:11:59 INFO local.LocalScheduler: Finished 0
13/07/27 21:11:59 INFO local.LocalScheduler: Remove TaskSet 0.0 from pool 
13/07/27 21:11:59 INFO scheduler.DAGScheduler: Completed ResultTask(0, 0)
13/07/27 21:11:59 INFO scheduler.DAGScheduler: Stage 0 (count at <console>:15) finished in 0.376 s
13/07/27 21:11:59 INFO spark.SparkContext: Job finished: count at <console>:15, took 0.420717755 s
res0: Long = 100

scala> 13/07/27 21:11:59 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:11:59 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:11:59 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:11:59 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:11:59 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:11:59 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:11:59 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:11:59 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage/rdd,null}
Killed 1 processes
Killed 1 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting Tachyon @ tachyon-ec2-0
2013-07-27 21:12:01,600 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data
2013-07-27 21:12:01,604 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_log.data
2013-07-27 21:12:02,091 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/data
2013-07-27 21:12:02,103 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/workers

restaring tachyon
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Killed 0 processes
Killed 0 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting RamFS: /mnt/ramdisk
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata -Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Starting master @ tachyon-ec2-0
Starting worker @ tachyon-ec2-0

spark-shell count
6517 tachyon.Master
6544 tachyon.Worker

Going to fadvise /mnt/tachyon/hit_data.tsv.1000 as mode POSIX_FADV_DONTNEED
offset: 0
length: 776400
mode: POSIX_FADV_DONTNEED
WIN
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/ubuntu/work/tachyon/target/tachyon-0.3.0-SNAPSHOT-jar-with-dependencies.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/ubuntu/work/spark/lib_managed/jars/slf4j-log4j12-1.7.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
Welcome to
      ____              __  
     / __/__  ___ _____/ /__
    _\ \/ _ \/ _ `/ __/  '_/
   /___/ .__/\_,_/_/ /_/\_\   version 0.8.0
      /_/                  

Using Scala version 2.9.3 (OpenJDK 64-Bit Server VM, Java 1.7.0_25)
Initializing interpreter...
13/07/27 21:12:08 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:12:08 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:48316
Creating SparkContext...
13/07/27 21:12:17 INFO slf4j.Slf4jEventHandler: Slf4jEventHandler started
13/07/27 21:12:17 INFO spark.SparkEnv: Registering BlockManagerMaster
13/07/27 21:12:17 INFO storage.MemoryStore: MemoryStore started with capacity 1295.4 MB.
13/07/27 21:12:17 INFO storage.DiskStore: Created local directory at /tmp/spark-local-20130727211217-5c68
13/07/27 21:12:17 INFO network.ConnectionManager: Bound socket to port 52843 with id = ConnectionManagerId(tachyon-ec2-0,52843)
13/07/27 21:12:17 INFO storage.BlockManagerMaster: Trying to register BlockManager
13/07/27 21:12:17 INFO storage.BlockManagerMasterActor$BlockManagerInfo: Registering block manager tachyon-ec2-0:52843 with 1295.4 MB RAM
13/07/27 21:12:17 INFO storage.BlockManagerMaster: Registered BlockManager
13/07/27 21:12:17 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:12:17 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:50139
13/07/27 21:12:17 INFO broadcast.HttpBroadcast: Broadcast server started at http://10.151.80.188:50139
13/07/27 21:12:17 INFO spark.SparkEnv: Registering MapOutputTracker
13/07/27 21:12:17 INFO spark.HttpFileServer: HTTP File server directory is /tmp/spark-6f610954-14d2-4578-9a58-22d325ce867f
13/07/27 21:12:17 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:12:17 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:39414
13/07/27 21:12:17 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:12:17 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage/rdd,null}
13/07/27 21:12:17 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:12:17 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:12:17 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:12:17 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:12:17 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:12:17 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:12:17 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:12:17 INFO server.AbstractConnector: Started SelectChannelConnector@0.0.0.0:33000
13/07/27 21:12:17 INFO ui.SparkUI: Started Spark Web UI at http://tachyon-ec2-0:33000
Spark context available as sc.
Type in expressions to have them evaluated.
Type :help for more information.

scala> val s = sc.textFile("tachyon://tachyon-ec2-0:19998/hit_data.tsv.1000")
13/07/27 21:12:19 INFO storage.MemoryStore: ensureFreeSpace(57350) called with curMem=0, maxMem=1358297825
13/07/27 21:12:19 INFO storage.MemoryStore: Block broadcast_0 stored as values to memory (estimated size 56.0 KB, free 1295.3 MB)
s: spark.RDD[String] = MappedRDD[1] at textFile at <console>:12

scala> s.count()
13/07/27 21:12:19 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
13/07/27 21:12:19 WARN snappy.LoadSnappy: Snappy native library not loaded
13/07/27 21:12:19 INFO : initialize(tachyon://tachyon-ec2-0:19998/hit_data.tsv.1000, Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml). Connecting to Tachyon: tachyon://tachyon-ec2-0:19998/hit_data.tsv.1000
13/07/27 21:12:19 INFO : Trying to connect master @ tachyon-ec2-0/10.151.80.188:19998
13/07/27 21:12:19 INFO : User registered at the master tachyon-ec2-0/10.151.80.188:19998 got UserId 1
13/07/27 21:12:19 INFO : Trying to get local worker host : tachyon-ec2-0
13/07/27 21:12:19 INFO : Connecting local worker @ tachyon-ec2-0/10.151.80.188:29998
13/07/27 21:12:19 INFO : tachyon://tachyon-ec2-0:19998 tachyon://tachyon-ec2-0:19998 file:///mnt/tachyon
13/07/27 21:12:19 INFO : getFileStatus(/hit_data.tsv.1000): HDFS Path: file:/mnt/tachyon/hit_data.tsv.1000 TPath: tachyon://tachyon-ec2-0:19998/hit_data.tsv.1000
13/07/27 21:12:19 INFO : tachyon.client.TachyonFS@4cb0b955 file:///mnt/tachyon /hit_data.tsv.1000 tachyon.PrefixList@6657a2c8
13/07/27 21:12:20 INFO : Create tachyon file /hit_data.tsv.1000 with file id 2 and checkpoint location file:///mnt/tachyon/hit_data.tsv.1000
13/07/27 21:12:20 INFO mapred.FileInputFormat: Total input paths to process : 1
13/07/27 21:12:20 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:12:20 INFO scheduler.DAGScheduler: Got job 0 (count at <console>:15) with 1 output partitions (allowLocal=false)
13/07/27 21:12:20 INFO scheduler.DAGScheduler: Final stage: Stage 0 (count at <console>:15)
13/07/27 21:12:20 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:12:20 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:12:20 INFO scheduler.DAGScheduler: Submitting Stage 0 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:12:20 INFO scheduler.DAGScheduler: Submitting 1 missing tasks from Stage 0 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:12:20 INFO local.LocalTaskSetManager: Size of task 0 is 1497 bytes
13/07/27 21:12:20 INFO local.LocalScheduler: Running 0
13/07/27 21:12:20 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.1000, 65536)
13/07/27 21:12:20 INFO : /mnt/ramdisk/tachyonworker/2147483648 is not on local disk.
13/07/27 21:12:20 INFO : Try to find and read from remote workers.
13/07/27 21:12:20 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:12:20 INFO : Folder /mnt/ramdisk/tachyonworker/users/1 was created!
13/07/27 21:12:20 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483648 was created!
13/07/27 21:12:20 INFO local.LocalScheduler: Finished 0
13/07/27 21:12:20 INFO local.LocalScheduler: Remove TaskSet 0.0 from pool 
13/07/27 21:12:20 INFO scheduler.DAGScheduler: Completed ResultTask(0, 0)
13/07/27 21:12:20 INFO scheduler.DAGScheduler: Stage 0 (count at <console>:15) finished in 0.400 s
13/07/27 21:12:20 INFO spark.SparkContext: Job finished: count at <console>:15, took 0.443829464 s
res0: Long = 1000

scala> 13/07/27 21:12:20 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:12:20 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:12:20 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:12:20 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:12:20 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:12:20 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:12:20 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:12:20 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage/rdd,null}
Killed 1 processes
Killed 1 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting Tachyon @ tachyon-ec2-0
2013-07-27 21:12:22,375 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data
2013-07-27 21:12:22,379 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_log.data
2013-07-27 21:12:22,874 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/data
2013-07-27 21:12:22,886 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/workers

restaring tachyon
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Killed 0 processes
Killed 0 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting RamFS: /mnt/ramdisk
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata -Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Starting master @ tachyon-ec2-0
Starting worker @ tachyon-ec2-0

spark-shell count
7073 tachyon.Master
7100 tachyon.Worker

Going to fadvise /mnt/tachyon/hit_data.tsv.10000 as mode POSIX_FADV_DONTNEED
offset: 0
length: 12330369
mode: POSIX_FADV_DONTNEED
WIN
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/ubuntu/work/tachyon/target/tachyon-0.3.0-SNAPSHOT-jar-with-dependencies.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/ubuntu/work/spark/lib_managed/jars/slf4j-log4j12-1.7.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
Welcome to
      ____              __  
     / __/__  ___ _____/ /__
    _\ \/ _ \/ _ `/ __/  '_/
   /___/ .__/\_,_/_/ /_/\_\   version 0.8.0
      /_/                  

Using Scala version 2.9.3 (OpenJDK 64-Bit Server VM, Java 1.7.0_25)
Initializing interpreter...
13/07/27 21:12:29 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:12:29 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:48888
Creating SparkContext...
13/07/27 21:12:38 INFO slf4j.Slf4jEventHandler: Slf4jEventHandler started
13/07/27 21:12:38 INFO spark.SparkEnv: Registering BlockManagerMaster
13/07/27 21:12:38 INFO storage.MemoryStore: MemoryStore started with capacity 1295.4 MB.
13/07/27 21:12:38 INFO storage.DiskStore: Created local directory at /tmp/spark-local-20130727211238-c992
13/07/27 21:12:38 INFO network.ConnectionManager: Bound socket to port 46794 with id = ConnectionManagerId(tachyon-ec2-0,46794)
13/07/27 21:12:38 INFO storage.BlockManagerMaster: Trying to register BlockManager
13/07/27 21:12:38 INFO storage.BlockManagerMasterActor$BlockManagerInfo: Registering block manager tachyon-ec2-0:46794 with 1295.4 MB RAM
13/07/27 21:12:38 INFO storage.BlockManagerMaster: Registered BlockManager
13/07/27 21:12:38 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:12:38 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:60045
13/07/27 21:12:38 INFO broadcast.HttpBroadcast: Broadcast server started at http://10.151.80.188:60045
13/07/27 21:12:38 INFO spark.SparkEnv: Registering MapOutputTracker
13/07/27 21:12:38 INFO spark.HttpFileServer: HTTP File server directory is /tmp/spark-ea43ed9a-fb68-47d6-b321-2e82ec29c49a
13/07/27 21:12:38 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:12:38 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:59073
13/07/27 21:12:38 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:12:38 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage/rdd,null}
13/07/27 21:12:38 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:12:38 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:12:38 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:12:38 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:12:38 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:12:38 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:12:38 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:12:38 INFO server.AbstractConnector: Started SelectChannelConnector@0.0.0.0:33000
13/07/27 21:12:38 INFO ui.SparkUI: Started Spark Web UI at http://tachyon-ec2-0:33000
Spark context available as sc.
Type in expressions to have them evaluated.
Type :help for more information.

scala> val s = sc.textFile("tachyon://tachyon-ec2-0:19998/hit_data.tsv.10000")
13/07/27 21:12:40 INFO storage.MemoryStore: ensureFreeSpace(57350) called with curMem=0, maxMem=1358297825
13/07/27 21:12:40 INFO storage.MemoryStore: Block broadcast_0 stored as values to memory (estimated size 56.0 KB, free 1295.3 MB)
s: spark.RDD[String] = MappedRDD[1] at textFile at <console>:12

scala> s.count()
13/07/27 21:12:40 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
13/07/27 21:12:40 WARN snappy.LoadSnappy: Snappy native library not loaded
13/07/27 21:12:40 INFO : initialize(tachyon://tachyon-ec2-0:19998/hit_data.tsv.10000, Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml). Connecting to Tachyon: tachyon://tachyon-ec2-0:19998/hit_data.tsv.10000
13/07/27 21:12:40 INFO : Trying to connect master @ tachyon-ec2-0/10.151.80.188:19998
13/07/27 21:12:40 INFO : User registered at the master tachyon-ec2-0/10.151.80.188:19998 got UserId 1
13/07/27 21:12:40 INFO : Trying to get local worker host : tachyon-ec2-0
13/07/27 21:12:40 INFO : Connecting local worker @ tachyon-ec2-0/10.151.80.188:29998
13/07/27 21:12:40 INFO : tachyon://tachyon-ec2-0:19998 tachyon://tachyon-ec2-0:19998 file:///mnt/tachyon
13/07/27 21:12:40 INFO : getFileStatus(/hit_data.tsv.10000): HDFS Path: file:/mnt/tachyon/hit_data.tsv.10000 TPath: tachyon://tachyon-ec2-0:19998/hit_data.tsv.10000
13/07/27 21:12:40 INFO : tachyon.client.TachyonFS@46afb337 file:///mnt/tachyon /hit_data.tsv.10000 tachyon.PrefixList@391f0422
13/07/27 21:12:40 INFO : Create tachyon file /hit_data.tsv.10000 with file id 2 and checkpoint location file:///mnt/tachyon/hit_data.tsv.10000
13/07/27 21:12:40 INFO mapred.FileInputFormat: Total input paths to process : 1
13/07/27 21:12:41 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:12:41 INFO scheduler.DAGScheduler: Got job 0 (count at <console>:15) with 1 output partitions (allowLocal=false)
13/07/27 21:12:41 INFO scheduler.DAGScheduler: Final stage: Stage 0 (count at <console>:15)
13/07/27 21:12:41 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:12:41 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:12:41 INFO scheduler.DAGScheduler: Submitting Stage 0 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:12:41 INFO scheduler.DAGScheduler: Submitting 1 missing tasks from Stage 0 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:12:41 INFO local.LocalTaskSetManager: Size of task 0 is 1498 bytes
13/07/27 21:12:41 INFO local.LocalScheduler: Running 0
13/07/27 21:12:41 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.10000, 65536)
13/07/27 21:12:41 INFO : /mnt/ramdisk/tachyonworker/2147483648 is not on local disk.
13/07/27 21:12:41 INFO : Try to find and read from remote workers.
13/07/27 21:12:41 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:12:41 INFO : Folder /mnt/ramdisk/tachyonworker/users/1 was created!
13/07/27 21:12:41 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483648 was created!
13/07/27 21:12:41 INFO local.LocalScheduler: Finished 0
13/07/27 21:12:41 INFO local.LocalScheduler: Remove TaskSet 0.0 from pool 
13/07/27 21:12:41 INFO scheduler.DAGScheduler: Completed ResultTask(0, 0)
13/07/27 21:12:41 INFO scheduler.DAGScheduler: Stage 0 (count at <console>:15) finished in 0.637 s
13/07/27 21:12:41 INFO spark.SparkContext: Job finished: count at <console>:15, took 0.680985823 s
res0: Long = 10000

scala> 13/07/27 21:12:41 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:12:41 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:12:41 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:12:41 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:12:41 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:12:41 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:12:41 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:12:41 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage/rdd,null}
Killed 1 processes
Killed 1 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting Tachyon @ tachyon-ec2-0
2013-07-27 21:12:43,410 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data
2013-07-27 21:12:43,414 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_log.data
2013-07-27 21:12:43,899 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/data
2013-07-27 21:12:43,911 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/workers

restaring tachyon
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Killed 0 processes
Killed 0 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting RamFS: /mnt/ramdisk
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata -Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Starting master @ tachyon-ec2-0
Starting worker @ tachyon-ec2-0

spark-shell count
7633 tachyon.Master
7660 tachyon.Worker

Going to fadvise /mnt/tachyon/hit_data.tsv.100000 as mode POSIX_FADV_DONTNEED
offset: 0
length: 125141299
mode: POSIX_FADV_DONTNEED
WIN
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/ubuntu/work/tachyon/target/tachyon-0.3.0-SNAPSHOT-jar-with-dependencies.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/ubuntu/work/spark/lib_managed/jars/slf4j-log4j12-1.7.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
Welcome to
      ____              __  
     / __/__  ___ _____/ /__
    _\ \/ _ \/ _ `/ __/  '_/
   /___/ .__/\_,_/_/ /_/\_\   version 0.8.0
      /_/                  

Using Scala version 2.9.3 (OpenJDK 64-Bit Server VM, Java 1.7.0_25)
Initializing interpreter...
13/07/27 21:12:50 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:12:50 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:54030
Creating SparkContext...
13/07/27 21:12:59 INFO slf4j.Slf4jEventHandler: Slf4jEventHandler started
13/07/27 21:12:59 INFO spark.SparkEnv: Registering BlockManagerMaster
13/07/27 21:12:59 INFO storage.MemoryStore: MemoryStore started with capacity 1295.4 MB.
13/07/27 21:12:59 INFO storage.DiskStore: Created local directory at /tmp/spark-local-20130727211259-24b9
13/07/27 21:12:59 INFO network.ConnectionManager: Bound socket to port 54529 with id = ConnectionManagerId(tachyon-ec2-0,54529)
13/07/27 21:12:59 INFO storage.BlockManagerMaster: Trying to register BlockManager
13/07/27 21:12:59 INFO storage.BlockManagerMasterActor$BlockManagerInfo: Registering block manager tachyon-ec2-0:54529 with 1295.4 MB RAM
13/07/27 21:12:59 INFO storage.BlockManagerMaster: Registered BlockManager
13/07/27 21:12:59 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:12:59 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:37325
13/07/27 21:12:59 INFO broadcast.HttpBroadcast: Broadcast server started at http://10.151.80.188:37325
13/07/27 21:12:59 INFO spark.SparkEnv: Registering MapOutputTracker
13/07/27 21:12:59 INFO spark.HttpFileServer: HTTP File server directory is /tmp/spark-04167a8b-69ed-4e49-bbe1-ba90b7c94c73
13/07/27 21:12:59 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:12:59 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:48390
13/07/27 21:12:59 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:12:59 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage/rdd,null}
13/07/27 21:12:59 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:12:59 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:12:59 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:12:59 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:12:59 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:12:59 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:12:59 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:12:59 INFO server.AbstractConnector: Started SelectChannelConnector@0.0.0.0:33000
13/07/27 21:12:59 INFO ui.SparkUI: Started Spark Web UI at http://tachyon-ec2-0:33000
Spark context available as sc.
Type in expressions to have them evaluated.
Type :help for more information.

scala> val s = sc.textFile("tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000")
13/07/27 21:13:01 INFO storage.MemoryStore: ensureFreeSpace(57358) called with curMem=0, maxMem=1358297825
13/07/27 21:13:01 INFO storage.MemoryStore: Block broadcast_0 stored as values to memory (estimated size 56.0 KB, free 1295.3 MB)
s: spark.RDD[String] = MappedRDD[1] at textFile at <console>:12

scala> s.count()
13/07/27 21:13:01 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
13/07/27 21:13:01 WARN snappy.LoadSnappy: Snappy native library not loaded
13/07/27 21:13:01 INFO : initialize(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000, Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml). Connecting to Tachyon: tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000
13/07/27 21:13:01 INFO : Trying to connect master @ tachyon-ec2-0/10.151.80.188:19998
13/07/27 21:13:01 INFO : User registered at the master tachyon-ec2-0/10.151.80.188:19998 got UserId 1
13/07/27 21:13:01 INFO : Trying to get local worker host : tachyon-ec2-0
13/07/27 21:13:01 INFO : Connecting local worker @ tachyon-ec2-0/10.151.80.188:29998
13/07/27 21:13:01 INFO : tachyon://tachyon-ec2-0:19998 tachyon://tachyon-ec2-0:19998 file:///mnt/tachyon
13/07/27 21:13:01 INFO : getFileStatus(/hit_data.tsv.100000): HDFS Path: file:/mnt/tachyon/hit_data.tsv.100000 TPath: tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000
13/07/27 21:13:01 INFO : tachyon.client.TachyonFS@2348717a file:///mnt/tachyon /hit_data.tsv.100000 tachyon.PrefixList@691212ae
13/07/27 21:13:01 INFO : Create tachyon file /hit_data.tsv.100000 with file id 2 and checkpoint location file:///mnt/tachyon/hit_data.tsv.100000
13/07/27 21:13:01 INFO mapred.FileInputFormat: Total input paths to process : 1
13/07/27 21:13:02 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:13:02 INFO scheduler.DAGScheduler: Got job 0 (count at <console>:15) with 4 output partitions (allowLocal=false)
13/07/27 21:13:02 INFO scheduler.DAGScheduler: Final stage: Stage 0 (count at <console>:15)
13/07/27 21:13:02 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:13:02 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:13:02 INFO scheduler.DAGScheduler: Submitting Stage 0 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:13:02 INFO scheduler.DAGScheduler: Submitting 4 missing tasks from Stage 0 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:13:02 INFO local.LocalTaskSetManager: Size of task 0 is 1499 bytes
13/07/27 21:13:02 INFO local.LocalScheduler: Running 0
13/07/27 21:13:02 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000, 65536)
13/07/27 21:13:02 INFO : /mnt/ramdisk/tachyonworker/2147483648 is not on local disk.
13/07/27 21:13:02 INFO : Try to find and read from remote workers.
13/07/27 21:13:02 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:13:02 INFO : Folder /mnt/ramdisk/tachyonworker/users/1 was created!
13/07/27 21:13:02 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483648 was created!
13/07/27 21:13:03 INFO : /mnt/ramdisk/tachyonworker/2147483649 is not on local disk.
13/07/27 21:13:03 INFO : Try to find and read from remote workers.
13/07/27 21:13:03 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:13:03 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483649 was created!
13/07/27 21:13:03 INFO local.LocalScheduler: Finished 0
13/07/27 21:13:03 INFO local.LocalTaskSetManager: Size of task 1 is 1499 bytes
13/07/27 21:13:03 INFO local.LocalScheduler: Running 1
13/07/27 21:13:03 INFO scheduler.DAGScheduler: Completed ResultTask(0, 0)
13/07/27 21:13:03 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000, 65536)
13/07/27 21:13:03 INFO : /mnt/ramdisk/tachyonworker/2147483650 is not on local disk.
13/07/27 21:13:03 INFO : Try to find and read from remote workers.
13/07/27 21:13:03 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:13:03 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483650 was created!
13/07/27 21:13:04 INFO local.LocalScheduler: Finished 1
13/07/27 21:13:04 INFO scheduler.DAGScheduler: Completed ResultTask(0, 1)
13/07/27 21:13:04 INFO local.LocalTaskSetManager: Size of task 2 is 1499 bytes
13/07/27 21:13:04 INFO local.LocalScheduler: Running 2
13/07/27 21:13:04 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000, 65536)
13/07/27 21:13:04 INFO : /mnt/ramdisk/tachyonworker/2147483651 is not on local disk.
13/07/27 21:13:04 INFO : Try to find and read from remote workers.
13/07/27 21:13:04 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:13:04 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483651 was created!
13/07/27 21:13:05 INFO local.LocalScheduler: Finished 2
13/07/27 21:13:05 INFO scheduler.DAGScheduler: Completed ResultTask(0, 2)
13/07/27 21:13:05 INFO local.LocalTaskSetManager: Size of task 3 is 1499 bytes
13/07/27 21:13:05 INFO local.LocalScheduler: Running 3
13/07/27 21:13:05 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000, 65536)
13/07/27 21:13:05 INFO local.LocalScheduler: Finished 3
13/07/27 21:13:05 INFO scheduler.DAGScheduler: Completed ResultTask(0, 3)
13/07/27 21:13:05 INFO scheduler.DAGScheduler: Stage 0 (count at <console>:15) finished in 3.113 s
13/07/27 21:13:05 INFO local.LocalScheduler: Remove TaskSet 0.0 from pool 
13/07/27 21:13:05 INFO spark.SparkContext: Job finished: count at <console>:15, took 3.158103425 s
res0: Long = 100002

scala> 13/07/27 21:13:05 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:13:05 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:13:05 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:13:05 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:13:05 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:13:05 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:13:05 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:13:05 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage/rdd,null}
Killed 1 processes
Killed 1 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting Tachyon @ tachyon-ec2-0
2013-07-27 21:13:07,002 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data
2013-07-27 21:13:07,006 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_log.data
2013-07-27 21:13:07,512 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/data
2013-07-27 21:13:07,524 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/workers

restaring tachyon
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Killed 0 processes
Killed 0 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting RamFS: /mnt/ramdisk
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata -Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Starting master @ tachyon-ec2-0
Starting worker @ tachyon-ec2-0

spark-shell count
8267 tachyon.Master
8294 tachyon.Worker

Going to fadvise /mnt/tachyon/hit_data.tsv.500000 as mode POSIX_FADV_DONTNEED
offset: 0
length: 618418417
mode: POSIX_FADV_DONTNEED
WIN
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/ubuntu/work/tachyon/target/tachyon-0.3.0-SNAPSHOT-jar-with-dependencies.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/ubuntu/work/spark/lib_managed/jars/slf4j-log4j12-1.7.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
Welcome to
      ____              __  
     / __/__  ___ _____/ /__
    _\ \/ _ \/ _ `/ __/  '_/
   /___/ .__/\_,_/_/ /_/\_\   version 0.8.0
      /_/                  

Using Scala version 2.9.3 (OpenJDK 64-Bit Server VM, Java 1.7.0_25)
Initializing interpreter...
13/07/27 21:13:13 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:13:13 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:47921
Creating SparkContext...
13/07/27 21:13:23 INFO slf4j.Slf4jEventHandler: Slf4jEventHandler started
13/07/27 21:13:23 INFO spark.SparkEnv: Registering BlockManagerMaster
13/07/27 21:13:23 INFO storage.MemoryStore: MemoryStore started with capacity 1295.4 MB.
13/07/27 21:13:23 INFO storage.DiskStore: Created local directory at /tmp/spark-local-20130727211323-a0bd
13/07/27 21:13:23 INFO network.ConnectionManager: Bound socket to port 59262 with id = ConnectionManagerId(tachyon-ec2-0,59262)
13/07/27 21:13:23 INFO storage.BlockManagerMaster: Trying to register BlockManager
13/07/27 21:13:23 INFO storage.BlockManagerMasterActor$BlockManagerInfo: Registering block manager tachyon-ec2-0:59262 with 1295.4 MB RAM
13/07/27 21:13:23 INFO storage.BlockManagerMaster: Registered BlockManager
13/07/27 21:13:23 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:13:23 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:47819
13/07/27 21:13:23 INFO broadcast.HttpBroadcast: Broadcast server started at http://10.151.80.188:47819
13/07/27 21:13:23 INFO spark.SparkEnv: Registering MapOutputTracker
13/07/27 21:13:23 INFO spark.HttpFileServer: HTTP File server directory is /tmp/spark-f72bc2d4-0be5-4e3e-b3eb-0cdeab493386
13/07/27 21:13:23 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:13:23 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:50244
13/07/27 21:13:23 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:13:23 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage/rdd,null}
13/07/27 21:13:23 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:13:23 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:13:23 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:13:23 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:13:23 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:13:23 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:13:23 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:13:23 INFO server.AbstractConnector: Started SelectChannelConnector@0.0.0.0:33000
13/07/27 21:13:23 INFO ui.SparkUI: Started Spark Web UI at http://tachyon-ec2-0:33000
Spark context available as sc.
Type in expressions to have them evaluated.
Type :help for more information.

scala> val s = sc.textFile("tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000")
13/07/27 21:13:24 INFO storage.MemoryStore: ensureFreeSpace(57358) called with curMem=0, maxMem=1358297825
13/07/27 21:13:24 INFO storage.MemoryStore: Block broadcast_0 stored as values to memory (estimated size 56.0 KB, free 1295.3 MB)
s: spark.RDD[String] = MappedRDD[1] at textFile at <console>:12

scala> s.count()
13/07/27 21:13:25 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
13/07/27 21:13:25 WARN snappy.LoadSnappy: Snappy native library not loaded
13/07/27 21:13:25 INFO : initialize(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml). Connecting to Tachyon: tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000
13/07/27 21:13:25 INFO : Trying to connect master @ tachyon-ec2-0/10.151.80.188:19998
13/07/27 21:13:25 INFO : User registered at the master tachyon-ec2-0/10.151.80.188:19998 got UserId 1
13/07/27 21:13:25 INFO : Trying to get local worker host : tachyon-ec2-0
13/07/27 21:13:25 INFO : Connecting local worker @ tachyon-ec2-0/10.151.80.188:29998
13/07/27 21:13:25 INFO : tachyon://tachyon-ec2-0:19998 tachyon://tachyon-ec2-0:19998 file:///mnt/tachyon
13/07/27 21:13:25 INFO : getFileStatus(/hit_data.tsv.500000): HDFS Path: file:/mnt/tachyon/hit_data.tsv.500000 TPath: tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000
13/07/27 21:13:25 INFO : tachyon.client.TachyonFS@58f4d603 file:///mnt/tachyon /hit_data.tsv.500000 tachyon.PrefixList@320e8c95
13/07/27 21:13:25 INFO : Create tachyon file /hit_data.tsv.500000 with file id 2 and checkpoint location file:///mnt/tachyon/hit_data.tsv.500000
13/07/27 21:13:25 INFO mapred.FileInputFormat: Total input paths to process : 1
13/07/27 21:13:26 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:13:26 INFO scheduler.DAGScheduler: Got job 0 (count at <console>:15) with 19 output partitions (allowLocal=false)
13/07/27 21:13:26 INFO scheduler.DAGScheduler: Final stage: Stage 0 (count at <console>:15)
13/07/27 21:13:26 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:13:26 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:13:26 INFO scheduler.DAGScheduler: Submitting Stage 0 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:13:26 INFO scheduler.DAGScheduler: Submitting 19 missing tasks from Stage 0 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:13:26 INFO local.LocalTaskSetManager: Size of task 0 is 1499 bytes
13/07/27 21:13:26 INFO local.LocalScheduler: Running 0
13/07/27 21:13:26 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:13:26 INFO : /mnt/ramdisk/tachyonworker/2147483648 is not on local disk.
13/07/27 21:13:26 INFO : Try to find and read from remote workers.
13/07/27 21:13:26 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:13:26 INFO : Folder /mnt/ramdisk/tachyonworker/users/1 was created!
13/07/27 21:13:26 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483648 was created!
13/07/27 21:13:27 INFO : /mnt/ramdisk/tachyonworker/2147483649 is not on local disk.
13/07/27 21:13:27 INFO : Try to find and read from remote workers.
13/07/27 21:13:27 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:13:27 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483649 was created!
13/07/27 21:13:27 INFO local.LocalScheduler: Finished 0
13/07/27 21:13:27 INFO local.LocalTaskSetManager: Size of task 1 is 1499 bytes
13/07/27 21:13:27 INFO local.LocalScheduler: Running 1
13/07/27 21:13:27 INFO scheduler.DAGScheduler: Completed ResultTask(0, 0)
13/07/27 21:13:27 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:13:27 INFO : /mnt/ramdisk/tachyonworker/2147483650 is not on local disk.
13/07/27 21:13:27 INFO : Try to find and read from remote workers.
13/07/27 21:13:27 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:13:27 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483650 was created!
13/07/27 21:13:28 INFO local.LocalScheduler: Finished 1
13/07/27 21:13:28 INFO scheduler.DAGScheduler: Completed ResultTask(0, 1)
13/07/27 21:13:28 INFO local.LocalTaskSetManager: Size of task 2 is 1499 bytes
13/07/27 21:13:28 INFO local.LocalScheduler: Running 2
13/07/27 21:13:28 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:13:28 INFO : /mnt/ramdisk/tachyonworker/2147483651 is not on local disk.
13/07/27 21:13:28 INFO : Try to find and read from remote workers.
13/07/27 21:13:28 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:13:28 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483651 was created!
13/07/27 21:13:28 INFO local.LocalScheduler: Finished 2
13/07/27 21:13:28 INFO scheduler.DAGScheduler: Completed ResultTask(0, 2)
13/07/27 21:13:28 INFO local.LocalTaskSetManager: Size of task 3 is 1499 bytes
13/07/27 21:13:28 INFO local.LocalScheduler: Running 3
13/07/27 21:13:28 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:13:29 INFO : /mnt/ramdisk/tachyonworker/2147483652 is not on local disk.
13/07/27 21:13:29 INFO : Try to find and read from remote workers.
13/07/27 21:13:29 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:13:29 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483652 was created!
13/07/27 21:13:29 INFO local.LocalScheduler: Finished 3
13/07/27 21:13:29 INFO scheduler.DAGScheduler: Completed ResultTask(0, 3)
13/07/27 21:13:29 INFO local.LocalTaskSetManager: Size of task 4 is 1499 bytes
13/07/27 21:13:29 INFO local.LocalScheduler: Running 4
13/07/27 21:13:29 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:13:29 INFO : /mnt/ramdisk/tachyonworker/2147483653 is not on local disk.
13/07/27 21:13:29 INFO : Try to find and read from remote workers.
13/07/27 21:13:29 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:13:29 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483653 was created!
13/07/27 21:13:29 INFO local.LocalScheduler: Finished 4
13/07/27 21:13:29 INFO scheduler.DAGScheduler: Completed ResultTask(0, 4)
13/07/27 21:13:29 INFO local.LocalTaskSetManager: Size of task 5 is 1499 bytes
13/07/27 21:13:29 INFO local.LocalScheduler: Running 5
13/07/27 21:13:30 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:13:30 INFO : /mnt/ramdisk/tachyonworker/2147483654 is not on local disk.
13/07/27 21:13:30 INFO : Try to find and read from remote workers.
13/07/27 21:13:30 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:13:30 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483654 was created!
13/07/27 21:13:30 INFO local.LocalScheduler: Finished 5
13/07/27 21:13:30 INFO scheduler.DAGScheduler: Completed ResultTask(0, 5)
13/07/27 21:13:30 INFO local.LocalTaskSetManager: Size of task 6 is 1499 bytes
13/07/27 21:13:30 INFO local.LocalScheduler: Running 6
13/07/27 21:13:30 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:13:30 INFO : /mnt/ramdisk/tachyonworker/2147483655 is not on local disk.
13/07/27 21:13:30 INFO : Try to find and read from remote workers.
13/07/27 21:13:30 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:13:30 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483655 was created!
13/07/27 21:13:31 INFO local.LocalScheduler: Finished 6
13/07/27 21:13:31 INFO scheduler.DAGScheduler: Completed ResultTask(0, 6)
13/07/27 21:13:31 INFO local.LocalTaskSetManager: Size of task 7 is 1499 bytes
13/07/27 21:13:31 INFO local.LocalScheduler: Running 7
13/07/27 21:13:31 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:13:31 INFO : /mnt/ramdisk/tachyonworker/2147483656 is not on local disk.
13/07/27 21:13:31 INFO : Try to find and read from remote workers.
13/07/27 21:13:31 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:13:31 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483656 was created!
13/07/27 21:13:31 INFO local.LocalScheduler: Finished 7
13/07/27 21:13:31 INFO scheduler.DAGScheduler: Completed ResultTask(0, 7)
13/07/27 21:13:31 INFO local.LocalTaskSetManager: Size of task 8 is 1499 bytes
13/07/27 21:13:31 INFO local.LocalScheduler: Running 8
13/07/27 21:13:31 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:13:32 INFO : /mnt/ramdisk/tachyonworker/2147483657 is not on local disk.
13/07/27 21:13:32 INFO : Try to find and read from remote workers.
13/07/27 21:13:32 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:13:32 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483657 was created!
13/07/27 21:13:32 INFO local.LocalScheduler: Finished 8
13/07/27 21:13:32 INFO scheduler.DAGScheduler: Completed ResultTask(0, 8)
13/07/27 21:13:32 INFO local.LocalTaskSetManager: Size of task 9 is 1499 bytes
13/07/27 21:13:32 INFO local.LocalScheduler: Running 9
13/07/27 21:13:32 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:13:32 INFO : /mnt/ramdisk/tachyonworker/2147483658 is not on local disk.
13/07/27 21:13:32 INFO : Try to find and read from remote workers.
13/07/27 21:13:32 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:13:32 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483658 was created!
13/07/27 21:13:33 INFO local.LocalScheduler: Finished 9
13/07/27 21:13:33 INFO scheduler.DAGScheduler: Completed ResultTask(0, 9)
13/07/27 21:13:33 INFO local.LocalTaskSetManager: Size of task 10 is 1499 bytes
13/07/27 21:13:33 INFO local.LocalScheduler: Running 10
13/07/27 21:13:33 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:13:33 INFO : /mnt/ramdisk/tachyonworker/2147483659 is not on local disk.
13/07/27 21:13:33 INFO : Try to find and read from remote workers.
13/07/27 21:13:33 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:13:33 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483659 was created!
13/07/27 21:13:33 INFO local.LocalScheduler: Finished 10
13/07/27 21:13:33 INFO scheduler.DAGScheduler: Completed ResultTask(0, 10)
13/07/27 21:13:33 INFO local.LocalTaskSetManager: Size of task 11 is 1499 bytes
13/07/27 21:13:33 INFO local.LocalScheduler: Running 11
13/07/27 21:13:33 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:13:33 INFO : /mnt/ramdisk/tachyonworker/2147483660 is not on local disk.
13/07/27 21:13:33 INFO : Try to find and read from remote workers.
13/07/27 21:13:33 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:13:33 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483660 was created!
13/07/27 21:13:34 INFO local.LocalScheduler: Finished 11
13/07/27 21:13:34 INFO scheduler.DAGScheduler: Completed ResultTask(0, 11)
13/07/27 21:13:34 INFO local.LocalTaskSetManager: Size of task 12 is 1499 bytes
13/07/27 21:13:34 INFO local.LocalScheduler: Running 12
13/07/27 21:13:34 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:13:34 INFO : /mnt/ramdisk/tachyonworker/2147483661 is not on local disk.
13/07/27 21:13:34 INFO : Try to find and read from remote workers.
13/07/27 21:13:34 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:13:34 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483661 was created!
13/07/27 21:13:34 INFO local.LocalScheduler: Finished 12
13/07/27 21:13:34 INFO scheduler.DAGScheduler: Completed ResultTask(0, 12)
13/07/27 21:13:34 INFO local.LocalTaskSetManager: Size of task 13 is 1499 bytes
13/07/27 21:13:34 INFO local.LocalScheduler: Running 13
13/07/27 21:13:34 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:13:34 INFO : /mnt/ramdisk/tachyonworker/2147483662 is not on local disk.
13/07/27 21:13:34 INFO : Try to find and read from remote workers.
13/07/27 21:13:34 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:13:34 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483662 was created!
13/07/27 21:13:35 INFO local.LocalScheduler: Finished 13
13/07/27 21:13:35 INFO scheduler.DAGScheduler: Completed ResultTask(0, 13)
13/07/27 21:13:35 INFO local.LocalTaskSetManager: Size of task 14 is 1499 bytes
13/07/27 21:13:35 INFO local.LocalScheduler: Running 14
13/07/27 21:13:35 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:13:35 INFO : /mnt/ramdisk/tachyonworker/2147483663 is not on local disk.
13/07/27 21:13:35 INFO : Try to find and read from remote workers.
13/07/27 21:13:35 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:13:35 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483663 was created!
13/07/27 21:13:35 INFO local.LocalScheduler: Finished 14
13/07/27 21:13:35 INFO scheduler.DAGScheduler: Completed ResultTask(0, 14)
13/07/27 21:13:35 INFO local.LocalTaskSetManager: Size of task 15 is 1499 bytes
13/07/27 21:13:35 INFO local.LocalScheduler: Running 15
13/07/27 21:13:35 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:13:36 INFO : /mnt/ramdisk/tachyonworker/2147483664 is not on local disk.
13/07/27 21:13:36 INFO : Try to find and read from remote workers.
13/07/27 21:13:36 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:13:36 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483664 was created!
13/07/27 21:13:36 INFO local.LocalScheduler: Finished 15
13/07/27 21:13:36 INFO scheduler.DAGScheduler: Completed ResultTask(0, 15)
13/07/27 21:13:36 INFO local.LocalTaskSetManager: Size of task 16 is 1499 bytes
13/07/27 21:13:36 INFO local.LocalScheduler: Running 16
13/07/27 21:13:36 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:13:36 INFO : /mnt/ramdisk/tachyonworker/2147483665 is not on local disk.
13/07/27 21:13:36 INFO : Try to find and read from remote workers.
13/07/27 21:13:36 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:13:36 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483665 was created!
13/07/27 21:13:37 INFO local.LocalScheduler: Finished 16
13/07/27 21:13:37 INFO scheduler.DAGScheduler: Completed ResultTask(0, 16)
13/07/27 21:13:37 INFO local.LocalTaskSetManager: Size of task 17 is 1499 bytes
13/07/27 21:13:37 INFO local.LocalScheduler: Running 17
13/07/27 21:13:37 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:13:37 INFO : /mnt/ramdisk/tachyonworker/2147483666 is not on local disk.
13/07/27 21:13:37 INFO : Try to find and read from remote workers.
13/07/27 21:13:37 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:13:37 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483666 was created!
13/07/27 21:13:37 INFO local.LocalScheduler: Finished 17
13/07/27 21:13:37 INFO scheduler.DAGScheduler: Completed ResultTask(0, 17)
13/07/27 21:13:37 INFO local.LocalTaskSetManager: Size of task 18 is 1499 bytes
13/07/27 21:13:37 INFO local.LocalScheduler: Running 18
13/07/27 21:13:37 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:13:37 INFO local.LocalScheduler: Finished 18
13/07/27 21:13:37 INFO scheduler.DAGScheduler: Completed ResultTask(0, 18)
13/07/27 21:13:37 INFO local.LocalScheduler: Remove TaskSet 0.0 from pool 
13/07/27 21:13:37 INFO scheduler.DAGScheduler: Stage 0 (count at <console>:15) finished in 11.248 s
13/07/27 21:13:37 INFO spark.SparkContext: Job finished: count at <console>:15, took 11.299698227 s
res0: Long = 500094

scala> 13/07/27 21:13:37 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:13:37 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:13:37 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:13:37 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:13:37 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:13:37 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:13:37 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:13:37 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage/rdd,null}
Killed 1 processes
Killed 1 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting Tachyon @ tachyon-ec2-0
2013-07-27 21:13:39,306 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data
2013-07-27 21:13:39,310 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_log.data
2013-07-27 21:13:39,799 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/data
2013-07-27 21:13:39,811 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/workers

run1 #: 1

restaring tachyon
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Killed 0 processes
Killed 0 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting RamFS: /mnt/ramdisk
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata -Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Starting master @ tachyon-ec2-0
Starting worker @ tachyon-ec2-0

spark-shell count
9038 tachyon.Master
9065 tachyon.Worker

Going to fadvise /mnt/tachyon/hit_data.tsv.1 as mode POSIX_FADV_DONTNEED
offset: 0
length: 525
mode: POSIX_FADV_DONTNEED
WIN
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/ubuntu/work/tachyon/target/tachyon-0.3.0-SNAPSHOT-jar-with-dependencies.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/ubuntu/work/spark/lib_managed/jars/slf4j-log4j12-1.7.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
Welcome to
      ____              __  
     / __/__  ___ _____/ /__
    _\ \/ _ \/ _ `/ __/  '_/
   /___/ .__/\_,_/_/ /_/\_\   version 0.8.0
      /_/                  

Using Scala version 2.9.3 (OpenJDK 64-Bit Server VM, Java 1.7.0_25)
Initializing interpreter...
13/07/27 21:13:46 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:13:46 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:33064
Creating SparkContext...
13/07/27 21:13:55 INFO slf4j.Slf4jEventHandler: Slf4jEventHandler started
13/07/27 21:13:55 INFO spark.SparkEnv: Registering BlockManagerMaster
13/07/27 21:13:55 INFO storage.MemoryStore: MemoryStore started with capacity 1295.4 MB.
13/07/27 21:13:55 INFO storage.DiskStore: Created local directory at /tmp/spark-local-20130727211355-7ae9
13/07/27 21:13:55 INFO network.ConnectionManager: Bound socket to port 53472 with id = ConnectionManagerId(tachyon-ec2-0,53472)
13/07/27 21:13:55 INFO storage.BlockManagerMaster: Trying to register BlockManager
13/07/27 21:13:55 INFO storage.BlockManagerMasterActor$BlockManagerInfo: Registering block manager tachyon-ec2-0:53472 with 1295.4 MB RAM
13/07/27 21:13:55 INFO storage.BlockManagerMaster: Registered BlockManager
13/07/27 21:13:55 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:13:55 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:49332
13/07/27 21:13:55 INFO broadcast.HttpBroadcast: Broadcast server started at http://10.151.80.188:49332
13/07/27 21:13:55 INFO spark.SparkEnv: Registering MapOutputTracker
13/07/27 21:13:55 INFO spark.HttpFileServer: HTTP File server directory is /tmp/spark-279b01eb-3a1d-4d87-90a5-a258c973ac9b
13/07/27 21:13:55 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:13:55 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:41358
13/07/27 21:13:55 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:13:55 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage/rdd,null}
13/07/27 21:13:55 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:13:55 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:13:55 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:13:55 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:13:55 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:13:55 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:13:55 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:13:55 INFO server.AbstractConnector: Started SelectChannelConnector@0.0.0.0:33000
13/07/27 21:13:55 INFO ui.SparkUI: Started Spark Web UI at http://tachyon-ec2-0:33000
Spark context available as sc.
Type in expressions to have them evaluated.
Type :help for more information.

scala> val s = sc.textFile("tachyon://tachyon-ec2-0:19998/hit_data.tsv.1")
13/07/27 21:13:57 INFO storage.MemoryStore: ensureFreeSpace(57342) called with curMem=0, maxMem=1358297825
13/07/27 21:13:57 INFO storage.MemoryStore: Block broadcast_0 stored as values to memory (estimated size 56.0 KB, free 1295.3 MB)
s: spark.RDD[String] = MappedRDD[1] at textFile at <console>:12

scala> s.count()
13/07/27 21:13:57 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
13/07/27 21:13:57 WARN snappy.LoadSnappy: Snappy native library not loaded
13/07/27 21:13:57 INFO : initialize(tachyon://tachyon-ec2-0:19998/hit_data.tsv.1, Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml). Connecting to Tachyon: tachyon://tachyon-ec2-0:19998/hit_data.tsv.1
13/07/27 21:13:57 INFO : Trying to connect master @ tachyon-ec2-0/10.151.80.188:19998
13/07/27 21:13:57 INFO : User registered at the master tachyon-ec2-0/10.151.80.188:19998 got UserId 1
13/07/27 21:13:57 INFO : Trying to get local worker host : tachyon-ec2-0
13/07/27 21:13:57 INFO : Connecting local worker @ tachyon-ec2-0/10.151.80.188:29998
13/07/27 21:13:57 INFO : tachyon://tachyon-ec2-0:19998 tachyon://tachyon-ec2-0:19998 file:///mnt/tachyon
13/07/27 21:13:57 INFO : getFileStatus(/hit_data.tsv.1): HDFS Path: file:/mnt/tachyon/hit_data.tsv.1 TPath: tachyon://tachyon-ec2-0:19998/hit_data.tsv.1
13/07/27 21:13:57 INFO : tachyon.client.TachyonFS@eca82e6 file:///mnt/tachyon /hit_data.tsv.1 tachyon.PrefixList@1157d1a0
13/07/27 21:13:57 INFO : Create tachyon file /hit_data.tsv.1 with file id 2 and checkpoint location file:///mnt/tachyon/hit_data.tsv.1
13/07/27 21:13:57 INFO mapred.FileInputFormat: Total input paths to process : 1
13/07/27 21:13:57 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:13:58 INFO scheduler.DAGScheduler: Got job 0 (count at <console>:15) with 1 output partitions (allowLocal=false)
13/07/27 21:13:58 INFO scheduler.DAGScheduler: Final stage: Stage 0 (count at <console>:15)
13/07/27 21:13:58 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:13:58 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:13:58 INFO scheduler.DAGScheduler: Submitting Stage 0 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:13:58 INFO scheduler.DAGScheduler: Submitting 1 missing tasks from Stage 0 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:13:58 INFO local.LocalTaskSetManager: Size of task 0 is 1494 bytes
13/07/27 21:13:58 INFO local.LocalScheduler: Running 0
13/07/27 21:13:58 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.1, 65536)
13/07/27 21:13:58 INFO : /mnt/ramdisk/tachyonworker/2147483648 is not on local disk.
13/07/27 21:13:58 INFO : Try to find and read from remote workers.
13/07/27 21:13:58 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:13:58 INFO : Folder /mnt/ramdisk/tachyonworker/users/1 was created!
13/07/27 21:13:58 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483648 was created!
13/07/27 21:13:58 INFO local.LocalScheduler: Finished 0
13/07/27 21:13:58 INFO local.LocalScheduler: Remove TaskSet 0.0 from pool 
13/07/27 21:13:58 INFO scheduler.DAGScheduler: Completed ResultTask(0, 0)
13/07/27 21:13:58 INFO scheduler.DAGScheduler: Stage 0 (count at <console>:15) finished in 0.369 s
13/07/27 21:13:58 INFO spark.SparkContext: Job finished: count at <console>:15, took 0.412919793 s
res0: Long = 1

scala> 13/07/27 21:13:58 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:13:58 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:13:58 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:13:58 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:13:58 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:13:58 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:13:58 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:13:58 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage/rdd,null}
Killed 1 processes
Killed 1 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting Tachyon @ tachyon-ec2-0
2013-07-27 21:14:00,108 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data
2013-07-27 21:14:00,112 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_log.data
2013-07-27 21:14:00,598 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/data
2013-07-27 21:14:00,610 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/workers

restaring tachyon
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Killed 0 processes
Killed 0 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting RamFS: /mnt/ramdisk
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata -Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Starting master @ tachyon-ec2-0
Starting worker @ tachyon-ec2-0

spark-shell count
9595 tachyon.Master
9622 tachyon.Worker

Going to fadvise /mnt/tachyon/hit_data.tsv.100 as mode POSIX_FADV_DONTNEED
offset: 0
length: 55735
mode: POSIX_FADV_DONTNEED
WIN
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/ubuntu/work/tachyon/target/tachyon-0.3.0-SNAPSHOT-jar-with-dependencies.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/ubuntu/work/spark/lib_managed/jars/slf4j-log4j12-1.7.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
Welcome to
      ____              __  
     / __/__  ___ _____/ /__
    _\ \/ _ \/ _ `/ __/  '_/
   /___/ .__/\_,_/_/ /_/\_\   version 0.8.0
      /_/                  

Using Scala version 2.9.3 (OpenJDK 64-Bit Server VM, Java 1.7.0_25)
Initializing interpreter...
13/07/27 21:14:06 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:14:06 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:38807
Creating SparkContext...
13/07/27 21:14:16 INFO slf4j.Slf4jEventHandler: Slf4jEventHandler started
13/07/27 21:14:16 INFO spark.SparkEnv: Registering BlockManagerMaster
13/07/27 21:14:16 INFO storage.MemoryStore: MemoryStore started with capacity 1295.4 MB.
13/07/27 21:14:16 INFO storage.DiskStore: Created local directory at /tmp/spark-local-20130727211416-15ec
13/07/27 21:14:16 INFO network.ConnectionManager: Bound socket to port 38917 with id = ConnectionManagerId(tachyon-ec2-0,38917)
13/07/27 21:14:16 INFO storage.BlockManagerMaster: Trying to register BlockManager
13/07/27 21:14:16 INFO storage.BlockManagerMasterActor$BlockManagerInfo: Registering block manager tachyon-ec2-0:38917 with 1295.4 MB RAM
13/07/27 21:14:16 INFO storage.BlockManagerMaster: Registered BlockManager
13/07/27 21:14:16 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:14:16 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:48365
13/07/27 21:14:16 INFO broadcast.HttpBroadcast: Broadcast server started at http://10.151.80.188:48365
13/07/27 21:14:16 INFO spark.SparkEnv: Registering MapOutputTracker
13/07/27 21:14:16 INFO spark.HttpFileServer: HTTP File server directory is /tmp/spark-4d294305-0537-4022-863a-a1df2c31a71e
13/07/27 21:14:16 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:14:16 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:52096
13/07/27 21:14:16 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:14:16 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage/rdd,null}
13/07/27 21:14:16 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:14:16 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:14:16 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:14:16 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:14:16 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:14:16 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:14:16 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:14:16 INFO server.AbstractConnector: Started SelectChannelConnector@0.0.0.0:33000
13/07/27 21:14:16 INFO ui.SparkUI: Started Spark Web UI at http://tachyon-ec2-0:33000
Spark context available as sc.
Type in expressions to have them evaluated.
Type :help for more information.

scala> val s = sc.textFile("tachyon://tachyon-ec2-0:19998/hit_data.tsv.100")
13/07/27 21:14:17 INFO storage.MemoryStore: ensureFreeSpace(57350) called with curMem=0, maxMem=1358297825
13/07/27 21:14:17 INFO storage.MemoryStore: Block broadcast_0 stored as values to memory (estimated size 56.0 KB, free 1295.3 MB)
s: spark.RDD[String] = MappedRDD[1] at textFile at <console>:12

scala> s.count()
13/07/27 21:14:18 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
13/07/27 21:14:18 WARN snappy.LoadSnappy: Snappy native library not loaded
13/07/27 21:14:18 INFO : initialize(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100, Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml). Connecting to Tachyon: tachyon://tachyon-ec2-0:19998/hit_data.tsv.100
13/07/27 21:14:18 INFO : Trying to connect master @ tachyon-ec2-0/10.151.80.188:19998
13/07/27 21:14:18 INFO : User registered at the master tachyon-ec2-0/10.151.80.188:19998 got UserId 1
13/07/27 21:14:18 INFO : Trying to get local worker host : tachyon-ec2-0
13/07/27 21:14:18 INFO : Connecting local worker @ tachyon-ec2-0/10.151.80.188:29998
13/07/27 21:14:18 INFO : tachyon://tachyon-ec2-0:19998 tachyon://tachyon-ec2-0:19998 file:///mnt/tachyon
13/07/27 21:14:18 INFO : getFileStatus(/hit_data.tsv.100): HDFS Path: file:/mnt/tachyon/hit_data.tsv.100 TPath: tachyon://tachyon-ec2-0:19998/hit_data.tsv.100
13/07/27 21:14:18 INFO : tachyon.client.TachyonFS@58f4d603 file:///mnt/tachyon /hit_data.tsv.100 tachyon.PrefixList@320e8c95
13/07/27 21:14:18 INFO : Create tachyon file /hit_data.tsv.100 with file id 2 and checkpoint location file:///mnt/tachyon/hit_data.tsv.100
13/07/27 21:14:18 INFO mapred.FileInputFormat: Total input paths to process : 1
13/07/27 21:14:18 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:14:18 INFO scheduler.DAGScheduler: Got job 0 (count at <console>:15) with 1 output partitions (allowLocal=false)
13/07/27 21:14:18 INFO scheduler.DAGScheduler: Final stage: Stage 0 (count at <console>:15)
13/07/27 21:14:18 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:14:18 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:14:18 INFO scheduler.DAGScheduler: Submitting Stage 0 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:14:18 INFO scheduler.DAGScheduler: Submitting 1 missing tasks from Stage 0 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:14:19 INFO local.LocalTaskSetManager: Size of task 0 is 1496 bytes
13/07/27 21:14:19 INFO local.LocalScheduler: Running 0
13/07/27 21:14:19 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100, 65536)
13/07/27 21:14:19 INFO : /mnt/ramdisk/tachyonworker/2147483648 is not on local disk.
13/07/27 21:14:19 INFO : Try to find and read from remote workers.
13/07/27 21:14:19 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:14:19 INFO : Folder /mnt/ramdisk/tachyonworker/users/1 was created!
13/07/27 21:14:19 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483648 was created!
13/07/27 21:14:19 INFO local.LocalScheduler: Finished 0
13/07/27 21:14:19 INFO local.LocalScheduler: Remove TaskSet 0.0 from pool 
13/07/27 21:14:19 INFO scheduler.DAGScheduler: Completed ResultTask(0, 0)
13/07/27 21:14:19 INFO scheduler.DAGScheduler: Stage 0 (count at <console>:15) finished in 0.365 s
13/07/27 21:14:19 INFO spark.SparkContext: Job finished: count at <console>:15, took 0.410018948 s
res0: Long = 100

scala> 13/07/27 21:14:19 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:14:19 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:14:19 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:14:19 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:14:19 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:14:19 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:14:19 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:14:19 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage/rdd,null}
Killed 1 processes
Killed 1 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting Tachyon @ tachyon-ec2-0
2013-07-27 21:14:21,045 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data
2013-07-27 21:14:21,049 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_log.data
2013-07-27 21:14:21,536 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/data
2013-07-27 21:14:21,547 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/workers

restaring tachyon
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Killed 0 processes
Killed 0 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting RamFS: /mnt/ramdisk
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata -Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Starting master @ tachyon-ec2-0
Starting worker @ tachyon-ec2-0

spark-shell count
10151 tachyon.Master
10178 tachyon.Worker

Going to fadvise /mnt/tachyon/hit_data.tsv.1000 as mode POSIX_FADV_DONTNEED
offset: 0
length: 776400
mode: POSIX_FADV_DONTNEED
WIN
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/ubuntu/work/tachyon/target/tachyon-0.3.0-SNAPSHOT-jar-with-dependencies.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/ubuntu/work/spark/lib_managed/jars/slf4j-log4j12-1.7.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
Welcome to
      ____              __  
     / __/__  ___ _____/ /__
    _\ \/ _ \/ _ `/ __/  '_/
   /___/ .__/\_,_/_/ /_/\_\   version 0.8.0
      /_/                  

Using Scala version 2.9.3 (OpenJDK 64-Bit Server VM, Java 1.7.0_25)
Initializing interpreter...
13/07/27 21:14:27 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:14:27 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:56888
Creating SparkContext...
13/07/27 21:14:37 INFO slf4j.Slf4jEventHandler: Slf4jEventHandler started
13/07/27 21:14:37 INFO spark.SparkEnv: Registering BlockManagerMaster
13/07/27 21:14:37 INFO storage.MemoryStore: MemoryStore started with capacity 1295.4 MB.
13/07/27 21:14:37 INFO storage.DiskStore: Created local directory at /tmp/spark-local-20130727211437-80de
13/07/27 21:14:37 INFO network.ConnectionManager: Bound socket to port 35792 with id = ConnectionManagerId(tachyon-ec2-0,35792)
13/07/27 21:14:37 INFO storage.BlockManagerMaster: Trying to register BlockManager
13/07/27 21:14:37 INFO storage.BlockManagerMasterActor$BlockManagerInfo: Registering block manager tachyon-ec2-0:35792 with 1295.4 MB RAM
13/07/27 21:14:37 INFO storage.BlockManagerMaster: Registered BlockManager
13/07/27 21:14:37 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:14:37 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:48920
13/07/27 21:14:37 INFO broadcast.HttpBroadcast: Broadcast server started at http://10.151.80.188:48920
13/07/27 21:14:37 INFO spark.SparkEnv: Registering MapOutputTracker
13/07/27 21:14:37 INFO spark.HttpFileServer: HTTP File server directory is /tmp/spark-c09f0c78-d10d-4d37-b9ed-8d2eefc5cffa
13/07/27 21:14:37 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:14:37 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:39887
13/07/27 21:14:37 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:14:37 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage/rdd,null}
13/07/27 21:14:37 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:14:37 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:14:37 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:14:37 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:14:37 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:14:37 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:14:37 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:14:37 INFO server.AbstractConnector: Started SelectChannelConnector@0.0.0.0:33000
13/07/27 21:14:37 INFO ui.SparkUI: Started Spark Web UI at http://tachyon-ec2-0:33000
Spark context available as sc.
Type in expressions to have them evaluated.
Type :help for more information.

scala> val s = sc.textFile("tachyon://tachyon-ec2-0:19998/hit_data.tsv.1000")
13/07/27 21:14:38 INFO storage.MemoryStore: ensureFreeSpace(57350) called with curMem=0, maxMem=1358297825
13/07/27 21:14:38 INFO storage.MemoryStore: Block broadcast_0 stored as values to memory (estimated size 56.0 KB, free 1295.3 MB)
s: spark.RDD[String] = MappedRDD[1] at textFile at <console>:12

scala> s.count()
13/07/27 21:14:39 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
13/07/27 21:14:39 WARN snappy.LoadSnappy: Snappy native library not loaded
13/07/27 21:14:39 INFO : initialize(tachyon://tachyon-ec2-0:19998/hit_data.tsv.1000, Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml). Connecting to Tachyon: tachyon://tachyon-ec2-0:19998/hit_data.tsv.1000
13/07/27 21:14:39 INFO : Trying to connect master @ tachyon-ec2-0/10.151.80.188:19998
13/07/27 21:14:39 INFO : User registered at the master tachyon-ec2-0/10.151.80.188:19998 got UserId 1
13/07/27 21:14:39 INFO : Trying to get local worker host : tachyon-ec2-0
13/07/27 21:14:39 INFO : Connecting local worker @ tachyon-ec2-0/10.151.80.188:29998
13/07/27 21:14:39 INFO : tachyon://tachyon-ec2-0:19998 tachyon://tachyon-ec2-0:19998 file:///mnt/tachyon
13/07/27 21:14:39 INFO : getFileStatus(/hit_data.tsv.1000): HDFS Path: file:/mnt/tachyon/hit_data.tsv.1000 TPath: tachyon://tachyon-ec2-0:19998/hit_data.tsv.1000
13/07/27 21:14:39 INFO : tachyon.client.TachyonFS@7b60ce1a file:///mnt/tachyon /hit_data.tsv.1000 tachyon.PrefixList@107b4c3e
13/07/27 21:14:39 INFO : Create tachyon file /hit_data.tsv.1000 with file id 2 and checkpoint location file:///mnt/tachyon/hit_data.tsv.1000
13/07/27 21:14:39 INFO mapred.FileInputFormat: Total input paths to process : 1
13/07/27 21:14:39 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:14:39 INFO scheduler.DAGScheduler: Got job 0 (count at <console>:15) with 1 output partitions (allowLocal=false)
13/07/27 21:14:39 INFO scheduler.DAGScheduler: Final stage: Stage 0 (count at <console>:15)
13/07/27 21:14:39 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:14:39 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:14:39 INFO scheduler.DAGScheduler: Submitting Stage 0 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:14:39 INFO scheduler.DAGScheduler: Submitting 1 missing tasks from Stage 0 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:14:39 INFO local.LocalTaskSetManager: Size of task 0 is 1497 bytes
13/07/27 21:14:39 INFO local.LocalScheduler: Running 0
13/07/27 21:14:39 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.1000, 65536)
13/07/27 21:14:39 INFO : /mnt/ramdisk/tachyonworker/2147483648 is not on local disk.
13/07/27 21:14:39 INFO : Try to find and read from remote workers.
13/07/27 21:14:39 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:14:40 INFO : Folder /mnt/ramdisk/tachyonworker/users/1 was created!
13/07/27 21:14:40 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483648 was created!
13/07/27 21:14:40 INFO local.LocalScheduler: Finished 0
13/07/27 21:14:40 INFO local.LocalScheduler: Remove TaskSet 0.0 from pool 
13/07/27 21:14:40 INFO scheduler.DAGScheduler: Completed ResultTask(0, 0)
13/07/27 21:14:40 INFO scheduler.DAGScheduler: Stage 0 (count at <console>:15) finished in 0.421 s
13/07/27 21:14:40 INFO spark.SparkContext: Job finished: count at <console>:15, took 0.465795735 s
res0: Long = 1000

scala> 13/07/27 21:14:40 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:14:40 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:14:40 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:14:40 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:14:40 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:14:40 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:14:40 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:14:40 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage/rdd,null}
Killed 1 processes
Killed 1 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting Tachyon @ tachyon-ec2-0
2013-07-27 21:14:41,874 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data
2013-07-27 21:14:41,878 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_log.data
2013-07-27 21:14:42,364 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/data
2013-07-27 21:14:42,376 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/workers

restaring tachyon
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Killed 0 processes
Killed 0 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting RamFS: /mnt/ramdisk
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata -Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Starting master @ tachyon-ec2-0
Starting worker @ tachyon-ec2-0

spark-shell count
10708 tachyon.Master
10735 tachyon.Worker

Going to fadvise /mnt/tachyon/hit_data.tsv.10000 as mode POSIX_FADV_DONTNEED
offset: 0
length: 12330369
mode: POSIX_FADV_DONTNEED
WIN
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/ubuntu/work/tachyon/target/tachyon-0.3.0-SNAPSHOT-jar-with-dependencies.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/ubuntu/work/spark/lib_managed/jars/slf4j-log4j12-1.7.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
Welcome to
      ____              __  
     / __/__  ___ _____/ /__
    _\ \/ _ \/ _ `/ __/  '_/
   /___/ .__/\_,_/_/ /_/\_\   version 0.8.0
      /_/                  

Using Scala version 2.9.3 (OpenJDK 64-Bit Server VM, Java 1.7.0_25)
Initializing interpreter...
13/07/27 21:14:48 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:14:48 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:33629
Creating SparkContext...
13/07/27 21:14:57 INFO slf4j.Slf4jEventHandler: Slf4jEventHandler started
13/07/27 21:14:57 INFO spark.SparkEnv: Registering BlockManagerMaster
13/07/27 21:14:57 INFO storage.MemoryStore: MemoryStore started with capacity 1295.4 MB.
13/07/27 21:14:57 INFO storage.DiskStore: Created local directory at /tmp/spark-local-20130727211457-57d8
13/07/27 21:14:57 INFO network.ConnectionManager: Bound socket to port 52375 with id = ConnectionManagerId(tachyon-ec2-0,52375)
13/07/27 21:14:57 INFO storage.BlockManagerMaster: Trying to register BlockManager
13/07/27 21:14:57 INFO storage.BlockManagerMasterActor$BlockManagerInfo: Registering block manager tachyon-ec2-0:52375 with 1295.4 MB RAM
13/07/27 21:14:57 INFO storage.BlockManagerMaster: Registered BlockManager
13/07/27 21:14:58 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:14:58 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:43507
13/07/27 21:14:58 INFO broadcast.HttpBroadcast: Broadcast server started at http://10.151.80.188:43507
13/07/27 21:14:58 INFO spark.SparkEnv: Registering MapOutputTracker
13/07/27 21:14:58 INFO spark.HttpFileServer: HTTP File server directory is /tmp/spark-3109fab1-7a0a-485e-ad03-8ef1ae26ec8f
13/07/27 21:14:58 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:14:58 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:59382
13/07/27 21:14:58 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:14:58 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage/rdd,null}
13/07/27 21:14:58 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:14:58 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:14:58 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:14:58 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:14:58 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:14:58 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:14:58 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:14:58 INFO server.AbstractConnector: Started SelectChannelConnector@0.0.0.0:33000
13/07/27 21:14:58 INFO ui.SparkUI: Started Spark Web UI at http://tachyon-ec2-0:33000
Spark context available as sc.
Type in expressions to have them evaluated.
Type :help for more information.

scala> val s = sc.textFile("tachyon://tachyon-ec2-0:19998/hit_data.tsv.10000")
13/07/27 21:14:59 INFO storage.MemoryStore: ensureFreeSpace(57350) called with curMem=0, maxMem=1358297825
13/07/27 21:14:59 INFO storage.MemoryStore: Block broadcast_0 stored as values to memory (estimated size 56.0 KB, free 1295.3 MB)
s: spark.RDD[String] = MappedRDD[1] at textFile at <console>:12

scala> s.count()
13/07/27 21:14:59 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
13/07/27 21:14:59 WARN snappy.LoadSnappy: Snappy native library not loaded
13/07/27 21:14:59 INFO : initialize(tachyon://tachyon-ec2-0:19998/hit_data.tsv.10000, Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml). Connecting to Tachyon: tachyon://tachyon-ec2-0:19998/hit_data.tsv.10000
13/07/27 21:14:59 INFO : Trying to connect master @ tachyon-ec2-0/10.151.80.188:19998
13/07/27 21:14:59 INFO : User registered at the master tachyon-ec2-0/10.151.80.188:19998 got UserId 1
13/07/27 21:14:59 INFO : Trying to get local worker host : tachyon-ec2-0
13/07/27 21:14:59 INFO : Connecting local worker @ tachyon-ec2-0/10.151.80.188:29998
13/07/27 21:14:59 INFO : tachyon://tachyon-ec2-0:19998 tachyon://tachyon-ec2-0:19998 file:///mnt/tachyon
13/07/27 21:14:59 INFO : getFileStatus(/hit_data.tsv.10000): HDFS Path: file:/mnt/tachyon/hit_data.tsv.10000 TPath: tachyon://tachyon-ec2-0:19998/hit_data.tsv.10000
13/07/27 21:14:59 INFO : tachyon.client.TachyonFS@391f0422 file:///mnt/tachyon /hit_data.tsv.10000 tachyon.PrefixList@2348717a
13/07/27 21:15:00 INFO : Create tachyon file /hit_data.tsv.10000 with file id 2 and checkpoint location file:///mnt/tachyon/hit_data.tsv.10000
13/07/27 21:15:00 INFO mapred.FileInputFormat: Total input paths to process : 1
13/07/27 21:15:00 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:15:00 INFO scheduler.DAGScheduler: Got job 0 (count at <console>:15) with 1 output partitions (allowLocal=false)
13/07/27 21:15:00 INFO scheduler.DAGScheduler: Final stage: Stage 0 (count at <console>:15)
13/07/27 21:15:00 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:15:00 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:15:00 INFO scheduler.DAGScheduler: Submitting Stage 0 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:15:00 INFO scheduler.DAGScheduler: Submitting 1 missing tasks from Stage 0 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:15:00 INFO local.LocalTaskSetManager: Size of task 0 is 1498 bytes
13/07/27 21:15:00 INFO local.LocalScheduler: Running 0
13/07/27 21:15:00 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.10000, 65536)
13/07/27 21:15:00 INFO : /mnt/ramdisk/tachyonworker/2147483648 is not on local disk.
13/07/27 21:15:00 INFO : Try to find and read from remote workers.
13/07/27 21:15:00 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:15:00 INFO : Folder /mnt/ramdisk/tachyonworker/users/1 was created!
13/07/27 21:15:00 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483648 was created!
13/07/27 21:15:01 INFO local.LocalScheduler: Finished 0
13/07/27 21:15:01 INFO local.LocalScheduler: Remove TaskSet 0.0 from pool 
13/07/27 21:15:01 INFO scheduler.DAGScheduler: Completed ResultTask(0, 0)
13/07/27 21:15:01 INFO scheduler.DAGScheduler: Stage 0 (count at <console>:15) finished in 0.642 s
13/07/27 21:15:01 INFO spark.SparkContext: Job finished: count at <console>:15, took 0.685651396 s
res0: Long = 10000

scala> 13/07/27 21:15:01 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:15:01 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:15:01 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:15:01 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:15:01 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:15:01 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:15:01 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:15:01 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage/rdd,null}
Killed 1 processes
Killed 1 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting Tachyon @ tachyon-ec2-0
2013-07-27 21:15:02,811 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data
2013-07-27 21:15:02,815 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_log.data
2013-07-27 21:15:03,331 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/data
2013-07-27 21:15:03,343 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/workers

restaring tachyon
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Killed 0 processes
Killed 0 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting RamFS: /mnt/ramdisk
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata -Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Starting master @ tachyon-ec2-0
Starting worker @ tachyon-ec2-0

spark-shell count
11266 tachyon.Master
11293 tachyon.Worker

Going to fadvise /mnt/tachyon/hit_data.tsv.100000 as mode POSIX_FADV_DONTNEED
offset: 0
length: 125141299
mode: POSIX_FADV_DONTNEED
WIN
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/ubuntu/work/tachyon/target/tachyon-0.3.0-SNAPSHOT-jar-with-dependencies.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/ubuntu/work/spark/lib_managed/jars/slf4j-log4j12-1.7.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
Welcome to
      ____              __  
     / __/__  ___ _____/ /__
    _\ \/ _ \/ _ `/ __/  '_/
   /___/ .__/\_,_/_/ /_/\_\   version 0.8.0
      /_/                  

Using Scala version 2.9.3 (OpenJDK 64-Bit Server VM, Java 1.7.0_25)
Initializing interpreter...
13/07/27 21:15:09 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:15:09 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:49564
Creating SparkContext...
13/07/27 21:15:18 INFO slf4j.Slf4jEventHandler: Slf4jEventHandler started
13/07/27 21:15:19 INFO spark.SparkEnv: Registering BlockManagerMaster
13/07/27 21:15:19 INFO storage.MemoryStore: MemoryStore started with capacity 1295.4 MB.
13/07/27 21:15:19 INFO storage.DiskStore: Created local directory at /tmp/spark-local-20130727211519-9658
13/07/27 21:15:19 INFO network.ConnectionManager: Bound socket to port 45597 with id = ConnectionManagerId(tachyon-ec2-0,45597)
13/07/27 21:15:19 INFO storage.BlockManagerMaster: Trying to register BlockManager
13/07/27 21:15:19 INFO storage.BlockManagerMasterActor$BlockManagerInfo: Registering block manager tachyon-ec2-0:45597 with 1295.4 MB RAM
13/07/27 21:15:19 INFO storage.BlockManagerMaster: Registered BlockManager
13/07/27 21:15:19 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:15:19 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:36608
13/07/27 21:15:19 INFO broadcast.HttpBroadcast: Broadcast server started at http://10.151.80.188:36608
13/07/27 21:15:19 INFO spark.SparkEnv: Registering MapOutputTracker
13/07/27 21:15:19 INFO spark.HttpFileServer: HTTP File server directory is /tmp/spark-e319c7d6-8b41-4a76-b357-4a740d9498f2
13/07/27 21:15:19 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:15:19 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:34058
13/07/27 21:15:19 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:15:19 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage/rdd,null}
13/07/27 21:15:19 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:15:19 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:15:19 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:15:19 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:15:19 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:15:19 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:15:19 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:15:19 INFO server.AbstractConnector: Started SelectChannelConnector@0.0.0.0:33000
13/07/27 21:15:19 INFO ui.SparkUI: Started Spark Web UI at http://tachyon-ec2-0:33000
Spark context available as sc.
Type in expressions to have them evaluated.
Type :help for more information.

scala> val s = sc.textFile("tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000")
13/07/27 21:15:20 INFO storage.MemoryStore: ensureFreeSpace(57358) called with curMem=0, maxMem=1358297825
13/07/27 21:15:20 INFO storage.MemoryStore: Block broadcast_0 stored as values to memory (estimated size 56.0 KB, free 1295.3 MB)
s: spark.RDD[String] = MappedRDD[1] at textFile at <console>:12

scala> s.count()
13/07/27 21:15:20 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
13/07/27 21:15:20 WARN snappy.LoadSnappy: Snappy native library not loaded
13/07/27 21:15:20 INFO : initialize(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000, Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml). Connecting to Tachyon: tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000
13/07/27 21:15:20 INFO : Trying to connect master @ tachyon-ec2-0/10.151.80.188:19998
13/07/27 21:15:20 INFO : User registered at the master tachyon-ec2-0/10.151.80.188:19998 got UserId 1
13/07/27 21:15:20 INFO : Trying to get local worker host : tachyon-ec2-0
13/07/27 21:15:20 INFO : Connecting local worker @ tachyon-ec2-0/10.151.80.188:29998
13/07/27 21:15:21 INFO : tachyon://tachyon-ec2-0:19998 tachyon://tachyon-ec2-0:19998 file:///mnt/tachyon
13/07/27 21:15:21 INFO : getFileStatus(/hit_data.tsv.100000): HDFS Path: file:/mnt/tachyon/hit_data.tsv.100000 TPath: tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000
13/07/27 21:15:21 INFO : tachyon.client.TachyonFS@3e3c4870 file:///mnt/tachyon /hit_data.tsv.100000 tachyon.PrefixList@67b7d0fb
13/07/27 21:15:21 INFO : Create tachyon file /hit_data.tsv.100000 with file id 2 and checkpoint location file:///mnt/tachyon/hit_data.tsv.100000
13/07/27 21:15:21 INFO mapred.FileInputFormat: Total input paths to process : 1
13/07/27 21:15:21 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:15:21 INFO scheduler.DAGScheduler: Got job 0 (count at <console>:15) with 4 output partitions (allowLocal=false)
13/07/27 21:15:21 INFO scheduler.DAGScheduler: Final stage: Stage 0 (count at <console>:15)
13/07/27 21:15:21 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:15:21 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:15:21 INFO scheduler.DAGScheduler: Submitting Stage 0 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:15:21 INFO scheduler.DAGScheduler: Submitting 4 missing tasks from Stage 0 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:15:21 INFO local.LocalTaskSetManager: Size of task 0 is 1499 bytes
13/07/27 21:15:21 INFO local.LocalScheduler: Running 0
13/07/27 21:15:21 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000, 65536)
13/07/27 21:15:21 INFO : /mnt/ramdisk/tachyonworker/2147483648 is not on local disk.
13/07/27 21:15:21 INFO : Try to find and read from remote workers.
13/07/27 21:15:21 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:15:21 INFO : Folder /mnt/ramdisk/tachyonworker/users/1 was created!
13/07/27 21:15:21 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483648 was created!
13/07/27 21:15:22 INFO : /mnt/ramdisk/tachyonworker/2147483649 is not on local disk.
13/07/27 21:15:22 INFO : Try to find and read from remote workers.
13/07/27 21:15:22 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:15:22 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483649 was created!
13/07/27 21:15:23 INFO local.LocalScheduler: Finished 0
13/07/27 21:15:23 INFO local.LocalTaskSetManager: Size of task 1 is 1499 bytes
13/07/27 21:15:23 INFO local.LocalScheduler: Running 1
13/07/27 21:15:23 INFO scheduler.DAGScheduler: Completed ResultTask(0, 0)
13/07/27 21:15:23 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000, 65536)
13/07/27 21:15:23 INFO : /mnt/ramdisk/tachyonworker/2147483650 is not on local disk.
13/07/27 21:15:23 INFO : Try to find and read from remote workers.
13/07/27 21:15:23 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:15:23 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483650 was created!
13/07/27 21:15:23 INFO local.LocalScheduler: Finished 1
13/07/27 21:15:23 INFO scheduler.DAGScheduler: Completed ResultTask(0, 1)
13/07/27 21:15:23 INFO local.LocalTaskSetManager: Size of task 2 is 1499 bytes
13/07/27 21:15:23 INFO local.LocalScheduler: Running 2
13/07/27 21:15:23 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000, 65536)
13/07/27 21:15:24 INFO : /mnt/ramdisk/tachyonworker/2147483651 is not on local disk.
13/07/27 21:15:24 INFO : Try to find and read from remote workers.
13/07/27 21:15:24 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:15:24 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483651 was created!
13/07/27 21:15:24 INFO local.LocalScheduler: Finished 2
13/07/27 21:15:24 INFO scheduler.DAGScheduler: Completed ResultTask(0, 2)
13/07/27 21:15:24 INFO local.LocalTaskSetManager: Size of task 3 is 1499 bytes
13/07/27 21:15:24 INFO local.LocalScheduler: Running 3
13/07/27 21:15:24 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000, 65536)
13/07/27 21:15:24 INFO local.LocalScheduler: Finished 3
13/07/27 21:15:24 INFO scheduler.DAGScheduler: Completed ResultTask(0, 3)
13/07/27 21:15:24 INFO local.LocalScheduler: Remove TaskSet 0.0 from pool 
13/07/27 21:15:24 INFO scheduler.DAGScheduler: Stage 0 (count at <console>:15) finished in 2.850 s
13/07/27 21:15:24 INFO spark.SparkContext: Job finished: count at <console>:15, took 2.895649876 s
res0: Long = 100002

scala> 13/07/27 21:15:24 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:15:24 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:15:24 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:15:24 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:15:24 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:15:24 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:15:24 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:15:24 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage/rdd,null}
Killed 1 processes
Killed 1 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting Tachyon @ tachyon-ec2-0
2013-07-27 21:15:26,268 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data
2013-07-27 21:15:26,272 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_log.data
2013-07-27 21:15:26,759 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/data
2013-07-27 21:15:26,771 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/workers

restaring tachyon
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Killed 0 processes
Killed 0 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting RamFS: /mnt/ramdisk
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata -Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Starting master @ tachyon-ec2-0
Starting worker @ tachyon-ec2-0

spark-shell count
11900 tachyon.Master
11927 tachyon.Worker

Going to fadvise /mnt/tachyon/hit_data.tsv.500000 as mode POSIX_FADV_DONTNEED
offset: 0
length: 618418417
mode: POSIX_FADV_DONTNEED
WIN
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/ubuntu/work/tachyon/target/tachyon-0.3.0-SNAPSHOT-jar-with-dependencies.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/ubuntu/work/spark/lib_managed/jars/slf4j-log4j12-1.7.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
Welcome to
      ____              __  
     / __/__  ___ _____/ /__
    _\ \/ _ \/ _ `/ __/  '_/
   /___/ .__/\_,_/_/ /_/\_\   version 0.8.0
      /_/                  

Using Scala version 2.9.3 (OpenJDK 64-Bit Server VM, Java 1.7.0_25)
Initializing interpreter...
13/07/27 21:15:33 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:15:33 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:57464
Creating SparkContext...
13/07/27 21:15:42 INFO slf4j.Slf4jEventHandler: Slf4jEventHandler started
13/07/27 21:15:42 INFO spark.SparkEnv: Registering BlockManagerMaster
13/07/27 21:15:42 INFO storage.MemoryStore: MemoryStore started with capacity 1295.4 MB.
13/07/27 21:15:42 INFO storage.DiskStore: Created local directory at /tmp/spark-local-20130727211542-4517
13/07/27 21:15:42 INFO network.ConnectionManager: Bound socket to port 34909 with id = ConnectionManagerId(tachyon-ec2-0,34909)
13/07/27 21:15:42 INFO storage.BlockManagerMaster: Trying to register BlockManager
13/07/27 21:15:42 INFO storage.BlockManagerMasterActor$BlockManagerInfo: Registering block manager tachyon-ec2-0:34909 with 1295.4 MB RAM
13/07/27 21:15:42 INFO storage.BlockManagerMaster: Registered BlockManager
13/07/27 21:15:42 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:15:42 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:36552
13/07/27 21:15:42 INFO broadcast.HttpBroadcast: Broadcast server started at http://10.151.80.188:36552
13/07/27 21:15:42 INFO spark.SparkEnv: Registering MapOutputTracker
13/07/27 21:15:42 INFO spark.HttpFileServer: HTTP File server directory is /tmp/spark-39d466b4-cf24-4739-8d21-33ee4a523879
13/07/27 21:15:42 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:15:42 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:48230
13/07/27 21:15:42 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:15:42 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage/rdd,null}
13/07/27 21:15:42 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:15:42 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:15:42 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:15:42 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:15:42 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:15:42 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:15:42 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:15:42 INFO server.AbstractConnector: Started SelectChannelConnector@0.0.0.0:33000
13/07/27 21:15:42 INFO ui.SparkUI: Started Spark Web UI at http://tachyon-ec2-0:33000
Spark context available as sc.
Type in expressions to have them evaluated.
Type :help for more information.

scala> val s = sc.textFile("tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000")
13/07/27 21:15:44 INFO storage.MemoryStore: ensureFreeSpace(57358) called with curMem=0, maxMem=1358297825
13/07/27 21:15:44 INFO storage.MemoryStore: Block broadcast_0 stored as values to memory (estimated size 56.0 KB, free 1295.3 MB)
s: spark.RDD[String] = MappedRDD[1] at textFile at <console>:12

scala> s.count()
13/07/27 21:15:44 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
13/07/27 21:15:44 WARN snappy.LoadSnappy: Snappy native library not loaded
13/07/27 21:15:44 INFO : initialize(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml). Connecting to Tachyon: tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000
13/07/27 21:15:44 INFO : Trying to connect master @ tachyon-ec2-0/10.151.80.188:19998
13/07/27 21:15:44 INFO : User registered at the master tachyon-ec2-0/10.151.80.188:19998 got UserId 1
13/07/27 21:15:44 INFO : Trying to get local worker host : tachyon-ec2-0
13/07/27 21:15:44 INFO : Connecting local worker @ tachyon-ec2-0/10.151.80.188:29998
13/07/27 21:15:44 INFO : tachyon://tachyon-ec2-0:19998 tachyon://tachyon-ec2-0:19998 file:///mnt/tachyon
13/07/27 21:15:44 INFO : getFileStatus(/hit_data.tsv.500000): HDFS Path: file:/mnt/tachyon/hit_data.tsv.500000 TPath: tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000
13/07/27 21:15:44 INFO : tachyon.client.TachyonFS@7c5a8c38 file:///mnt/tachyon /hit_data.tsv.500000 tachyon.PrefixList@1cabf050
13/07/27 21:15:44 INFO : Create tachyon file /hit_data.tsv.500000 with file id 2 and checkpoint location file:///mnt/tachyon/hit_data.tsv.500000
13/07/27 21:15:44 INFO mapred.FileInputFormat: Total input paths to process : 1
13/07/27 21:15:45 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:15:45 INFO scheduler.DAGScheduler: Got job 0 (count at <console>:15) with 19 output partitions (allowLocal=false)
13/07/27 21:15:45 INFO scheduler.DAGScheduler: Final stage: Stage 0 (count at <console>:15)
13/07/27 21:15:45 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:15:45 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:15:45 INFO scheduler.DAGScheduler: Submitting Stage 0 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:15:45 INFO scheduler.DAGScheduler: Submitting 19 missing tasks from Stage 0 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:15:45 INFO local.LocalTaskSetManager: Size of task 0 is 1499 bytes
13/07/27 21:15:45 INFO local.LocalScheduler: Running 0
13/07/27 21:15:45 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:15:45 INFO : /mnt/ramdisk/tachyonworker/2147483648 is not on local disk.
13/07/27 21:15:45 INFO : Try to find and read from remote workers.
13/07/27 21:15:45 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:15:45 INFO : Folder /mnt/ramdisk/tachyonworker/users/1 was created!
13/07/27 21:15:45 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483648 was created!
13/07/27 21:15:46 INFO : /mnt/ramdisk/tachyonworker/2147483649 is not on local disk.
13/07/27 21:15:46 INFO : Try to find and read from remote workers.
13/07/27 21:15:46 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:15:46 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483649 was created!
13/07/27 21:15:46 INFO local.LocalScheduler: Finished 0
13/07/27 21:15:46 INFO local.LocalTaskSetManager: Size of task 1 is 1499 bytes
13/07/27 21:15:46 INFO local.LocalScheduler: Running 1
13/07/27 21:15:46 INFO scheduler.DAGScheduler: Completed ResultTask(0, 0)
13/07/27 21:15:46 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:15:47 INFO : /mnt/ramdisk/tachyonworker/2147483650 is not on local disk.
13/07/27 21:15:47 INFO : Try to find and read from remote workers.
13/07/27 21:15:47 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:15:47 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483650 was created!
13/07/27 21:15:47 INFO local.LocalScheduler: Finished 1
13/07/27 21:15:47 INFO scheduler.DAGScheduler: Completed ResultTask(0, 1)
13/07/27 21:15:47 INFO local.LocalTaskSetManager: Size of task 2 is 1499 bytes
13/07/27 21:15:47 INFO local.LocalScheduler: Running 2
13/07/27 21:15:47 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:15:47 INFO : /mnt/ramdisk/tachyonworker/2147483651 is not on local disk.
13/07/27 21:15:47 INFO : Try to find and read from remote workers.
13/07/27 21:15:47 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:15:47 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483651 was created!
13/07/27 21:15:48 INFO local.LocalScheduler: Finished 2
13/07/27 21:15:48 INFO scheduler.DAGScheduler: Completed ResultTask(0, 2)
13/07/27 21:15:48 INFO local.LocalTaskSetManager: Size of task 3 is 1499 bytes
13/07/27 21:15:48 INFO local.LocalScheduler: Running 3
13/07/27 21:15:48 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:15:48 INFO : /mnt/ramdisk/tachyonworker/2147483652 is not on local disk.
13/07/27 21:15:48 INFO : Try to find and read from remote workers.
13/07/27 21:15:48 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:15:48 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483652 was created!
13/07/27 21:15:48 INFO local.LocalScheduler: Finished 3
13/07/27 21:15:48 INFO scheduler.DAGScheduler: Completed ResultTask(0, 3)
13/07/27 21:15:48 INFO local.LocalTaskSetManager: Size of task 4 is 1499 bytes
13/07/27 21:15:48 INFO local.LocalScheduler: Running 4
13/07/27 21:15:48 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:15:48 INFO : /mnt/ramdisk/tachyonworker/2147483653 is not on local disk.
13/07/27 21:15:48 INFO : Try to find and read from remote workers.
13/07/27 21:15:48 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:15:48 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483653 was created!
13/07/27 21:15:49 INFO local.LocalScheduler: Finished 4
13/07/27 21:15:49 INFO scheduler.DAGScheduler: Completed ResultTask(0, 4)
13/07/27 21:15:49 INFO local.LocalTaskSetManager: Size of task 5 is 1499 bytes
13/07/27 21:15:49 INFO local.LocalScheduler: Running 5
13/07/27 21:15:49 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:15:49 INFO : /mnt/ramdisk/tachyonworker/2147483654 is not on local disk.
13/07/27 21:15:49 INFO : Try to find and read from remote workers.
13/07/27 21:15:49 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:15:49 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483654 was created!
13/07/27 21:15:49 INFO local.LocalScheduler: Finished 5
13/07/27 21:15:49 INFO scheduler.DAGScheduler: Completed ResultTask(0, 5)
13/07/27 21:15:49 INFO local.LocalTaskSetManager: Size of task 6 is 1499 bytes
13/07/27 21:15:49 INFO local.LocalScheduler: Running 6
13/07/27 21:15:49 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:15:50 INFO : /mnt/ramdisk/tachyonworker/2147483655 is not on local disk.
13/07/27 21:15:50 INFO : Try to find and read from remote workers.
13/07/27 21:15:50 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:15:50 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483655 was created!
13/07/27 21:15:50 INFO local.LocalScheduler: Finished 6
13/07/27 21:15:50 INFO scheduler.DAGScheduler: Completed ResultTask(0, 6)
13/07/27 21:15:50 INFO local.LocalTaskSetManager: Size of task 7 is 1499 bytes
13/07/27 21:15:50 INFO local.LocalScheduler: Running 7
13/07/27 21:15:50 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:15:50 INFO : /mnt/ramdisk/tachyonworker/2147483656 is not on local disk.
13/07/27 21:15:50 INFO : Try to find and read from remote workers.
13/07/27 21:15:50 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:15:50 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483656 was created!
13/07/27 21:15:50 INFO local.LocalScheduler: Finished 7
13/07/27 21:15:50 INFO scheduler.DAGScheduler: Completed ResultTask(0, 7)
13/07/27 21:15:50 INFO local.LocalTaskSetManager: Size of task 8 is 1499 bytes
13/07/27 21:15:50 INFO local.LocalScheduler: Running 8
13/07/27 21:15:50 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:15:51 INFO : /mnt/ramdisk/tachyonworker/2147483657 is not on local disk.
13/07/27 21:15:51 INFO : Try to find and read from remote workers.
13/07/27 21:15:51 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:15:51 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483657 was created!
13/07/27 21:15:51 INFO local.LocalScheduler: Finished 8
13/07/27 21:15:51 INFO scheduler.DAGScheduler: Completed ResultTask(0, 8)
13/07/27 21:15:51 INFO local.LocalTaskSetManager: Size of task 9 is 1499 bytes
13/07/27 21:15:51 INFO local.LocalScheduler: Running 9
13/07/27 21:15:51 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:15:51 INFO : /mnt/ramdisk/tachyonworker/2147483658 is not on local disk.
13/07/27 21:15:51 INFO : Try to find and read from remote workers.
13/07/27 21:15:51 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:15:51 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483658 was created!
13/07/27 21:15:52 INFO local.LocalScheduler: Finished 9
13/07/27 21:15:52 INFO scheduler.DAGScheduler: Completed ResultTask(0, 9)
13/07/27 21:15:52 INFO local.LocalTaskSetManager: Size of task 10 is 1499 bytes
13/07/27 21:15:52 INFO local.LocalScheduler: Running 10
13/07/27 21:15:52 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:15:52 INFO : /mnt/ramdisk/tachyonworker/2147483659 is not on local disk.
13/07/27 21:15:52 INFO : Try to find and read from remote workers.
13/07/27 21:15:52 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:15:52 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483659 was created!
13/07/27 21:15:52 INFO local.LocalScheduler: Finished 10
13/07/27 21:15:52 INFO scheduler.DAGScheduler: Completed ResultTask(0, 10)
13/07/27 21:15:52 INFO local.LocalTaskSetManager: Size of task 11 is 1499 bytes
13/07/27 21:15:52 INFO local.LocalScheduler: Running 11
13/07/27 21:15:52 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:15:52 INFO : /mnt/ramdisk/tachyonworker/2147483660 is not on local disk.
13/07/27 21:15:52 INFO : Try to find and read from remote workers.
13/07/27 21:15:52 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:15:52 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483660 was created!
13/07/27 21:15:53 INFO local.LocalScheduler: Finished 11
13/07/27 21:15:53 INFO scheduler.DAGScheduler: Completed ResultTask(0, 11)
13/07/27 21:15:53 INFO local.LocalTaskSetManager: Size of task 12 is 1499 bytes
13/07/27 21:15:53 INFO local.LocalScheduler: Running 12
13/07/27 21:15:53 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:15:53 INFO : /mnt/ramdisk/tachyonworker/2147483661 is not on local disk.
13/07/27 21:15:53 INFO : Try to find and read from remote workers.
13/07/27 21:15:53 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:15:53 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483661 was created!
13/07/27 21:15:53 INFO local.LocalScheduler: Finished 12
13/07/27 21:15:53 INFO scheduler.DAGScheduler: Completed ResultTask(0, 12)
13/07/27 21:15:53 INFO local.LocalTaskSetManager: Size of task 13 is 1499 bytes
13/07/27 21:15:53 INFO local.LocalScheduler: Running 13
13/07/27 21:15:53 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:15:54 INFO : /mnt/ramdisk/tachyonworker/2147483662 is not on local disk.
13/07/27 21:15:54 INFO : Try to find and read from remote workers.
13/07/27 21:15:54 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:15:54 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483662 was created!
13/07/27 21:15:54 INFO local.LocalScheduler: Finished 13
13/07/27 21:15:54 INFO scheduler.DAGScheduler: Completed ResultTask(0, 13)
13/07/27 21:15:54 INFO local.LocalTaskSetManager: Size of task 14 is 1499 bytes
13/07/27 21:15:54 INFO local.LocalScheduler: Running 14
13/07/27 21:15:54 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:15:54 INFO : /mnt/ramdisk/tachyonworker/2147483663 is not on local disk.
13/07/27 21:15:54 INFO : Try to find and read from remote workers.
13/07/27 21:15:54 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:15:54 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483663 was created!
13/07/27 21:15:54 INFO local.LocalScheduler: Finished 14
13/07/27 21:15:54 INFO scheduler.DAGScheduler: Completed ResultTask(0, 14)
13/07/27 21:15:54 INFO local.LocalTaskSetManager: Size of task 15 is 1499 bytes
13/07/27 21:15:54 INFO local.LocalScheduler: Running 15
13/07/27 21:15:54 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:15:55 INFO : /mnt/ramdisk/tachyonworker/2147483664 is not on local disk.
13/07/27 21:15:55 INFO : Try to find and read from remote workers.
13/07/27 21:15:55 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:15:55 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483664 was created!
13/07/27 21:15:55 INFO local.LocalScheduler: Finished 15
13/07/27 21:15:55 INFO scheduler.DAGScheduler: Completed ResultTask(0, 15)
13/07/27 21:15:55 INFO local.LocalTaskSetManager: Size of task 16 is 1499 bytes
13/07/27 21:15:55 INFO local.LocalScheduler: Running 16
13/07/27 21:15:55 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:15:55 INFO : /mnt/ramdisk/tachyonworker/2147483665 is not on local disk.
13/07/27 21:15:55 INFO : Try to find and read from remote workers.
13/07/27 21:15:55 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:15:55 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483665 was created!
13/07/27 21:15:56 INFO local.LocalScheduler: Finished 16
13/07/27 21:15:56 INFO scheduler.DAGScheduler: Completed ResultTask(0, 16)
13/07/27 21:15:56 INFO local.LocalTaskSetManager: Size of task 17 is 1499 bytes
13/07/27 21:15:56 INFO local.LocalScheduler: Running 17
13/07/27 21:15:56 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:15:56 INFO : /mnt/ramdisk/tachyonworker/2147483666 is not on local disk.
13/07/27 21:15:56 INFO : Try to find and read from remote workers.
13/07/27 21:15:56 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:15:56 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483666 was created!
13/07/27 21:15:56 INFO local.LocalScheduler: Finished 17
13/07/27 21:15:56 INFO scheduler.DAGScheduler: Completed ResultTask(0, 17)
13/07/27 21:15:56 INFO local.LocalTaskSetManager: Size of task 18 is 1499 bytes
13/07/27 21:15:56 INFO local.LocalScheduler: Running 18
13/07/27 21:15:56 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:15:56 INFO local.LocalScheduler: Finished 18
13/07/27 21:15:56 INFO scheduler.DAGScheduler: Completed ResultTask(0, 18)
13/07/27 21:15:56 INFO local.LocalScheduler: Remove TaskSet 0.0 from pool 
13/07/27 21:15:56 INFO scheduler.DAGScheduler: Stage 0 (count at <console>:15) finished in 11.140 s
13/07/27 21:15:56 INFO spark.SparkContext: Job finished: count at <console>:15, took 11.192586017 s
res0: Long = 500094

scala> 13/07/27 21:15:56 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:15:56 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:15:56 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:15:56 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:15:56 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:15:56 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:15:56 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:15:56 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage/rdd,null}
Killed 1 processes
Killed 1 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting Tachyon @ tachyon-ec2-0
2013-07-27 21:15:58,406 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data
2013-07-27 21:15:58,410 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_log.data
2013-07-27 21:15:58,900 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/data
2013-07-27 21:15:58,912 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/workers

run1 #: 2

restaring tachyon
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Killed 0 processes
Killed 0 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting RamFS: /mnt/ramdisk
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata -Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Starting master @ tachyon-ec2-0
Starting worker @ tachyon-ec2-0

spark-shell count
12672 tachyon.Master
12699 tachyon.Worker

Going to fadvise /mnt/tachyon/hit_data.tsv.1 as mode POSIX_FADV_DONTNEED
offset: 0
length: 525
mode: POSIX_FADV_DONTNEED
WIN
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/ubuntu/work/tachyon/target/tachyon-0.3.0-SNAPSHOT-jar-with-dependencies.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/ubuntu/work/spark/lib_managed/jars/slf4j-log4j12-1.7.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
Welcome to
      ____              __  
     / __/__  ___ _____/ /__
    _\ \/ _ \/ _ `/ __/  '_/
   /___/ .__/\_,_/_/ /_/\_\   version 0.8.0
      /_/                  

Using Scala version 2.9.3 (OpenJDK 64-Bit Server VM, Java 1.7.0_25)
Initializing interpreter...
13/07/27 21:16:05 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:16:05 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:34021
Creating SparkContext...
13/07/27 21:16:14 INFO slf4j.Slf4jEventHandler: Slf4jEventHandler started
13/07/27 21:16:14 INFO spark.SparkEnv: Registering BlockManagerMaster
13/07/27 21:16:14 INFO storage.MemoryStore: MemoryStore started with capacity 1295.4 MB.
13/07/27 21:16:14 INFO storage.DiskStore: Created local directory at /tmp/spark-local-20130727211614-d652
13/07/27 21:16:14 INFO network.ConnectionManager: Bound socket to port 35332 with id = ConnectionManagerId(tachyon-ec2-0,35332)
13/07/27 21:16:14 INFO storage.BlockManagerMaster: Trying to register BlockManager
13/07/27 21:16:14 INFO storage.BlockManagerMasterActor$BlockManagerInfo: Registering block manager tachyon-ec2-0:35332 with 1295.4 MB RAM
13/07/27 21:16:14 INFO storage.BlockManagerMaster: Registered BlockManager
13/07/27 21:16:14 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:16:14 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:37363
13/07/27 21:16:14 INFO broadcast.HttpBroadcast: Broadcast server started at http://10.151.80.188:37363
13/07/27 21:16:14 INFO spark.SparkEnv: Registering MapOutputTracker
13/07/27 21:16:14 INFO spark.HttpFileServer: HTTP File server directory is /tmp/spark-8970b358-e745-4555-ba21-2de5a55d41d8
13/07/27 21:16:14 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:16:14 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:46038
13/07/27 21:16:14 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:16:14 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage/rdd,null}
13/07/27 21:16:14 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:16:14 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:16:14 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:16:14 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:16:14 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:16:14 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:16:14 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:16:14 INFO server.AbstractConnector: Started SelectChannelConnector@0.0.0.0:33000
13/07/27 21:16:14 INFO ui.SparkUI: Started Spark Web UI at http://tachyon-ec2-0:33000
Spark context available as sc.
Type in expressions to have them evaluated.
Type :help for more information.

scala> val s = sc.textFile("tachyon://tachyon-ec2-0:19998/hit_data.tsv.1")
13/07/27 21:16:16 INFO storage.MemoryStore: ensureFreeSpace(57342) called with curMem=0, maxMem=1358297825
13/07/27 21:16:16 INFO storage.MemoryStore: Block broadcast_0 stored as values to memory (estimated size 56.0 KB, free 1295.3 MB)
s: spark.RDD[String] = MappedRDD[1] at textFile at <console>:12

scala> s.count()
13/07/27 21:16:16 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
13/07/27 21:16:16 WARN snappy.LoadSnappy: Snappy native library not loaded
13/07/27 21:16:16 INFO : initialize(tachyon://tachyon-ec2-0:19998/hit_data.tsv.1, Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml). Connecting to Tachyon: tachyon://tachyon-ec2-0:19998/hit_data.tsv.1
13/07/27 21:16:16 INFO : Trying to connect master @ tachyon-ec2-0/10.151.80.188:19998
13/07/27 21:16:16 INFO : User registered at the master tachyon-ec2-0/10.151.80.188:19998 got UserId 1
13/07/27 21:16:16 INFO : Trying to get local worker host : tachyon-ec2-0
13/07/27 21:16:16 INFO : Connecting local worker @ tachyon-ec2-0/10.151.80.188:29998
13/07/27 21:16:16 INFO : tachyon://tachyon-ec2-0:19998 tachyon://tachyon-ec2-0:19998 file:///mnt/tachyon
13/07/27 21:16:16 INFO : getFileStatus(/hit_data.tsv.1): HDFS Path: file:/mnt/tachyon/hit_data.tsv.1 TPath: tachyon://tachyon-ec2-0:19998/hit_data.tsv.1
13/07/27 21:16:16 INFO : tachyon.client.TachyonFS@56c78e3a file:///mnt/tachyon /hit_data.tsv.1 tachyon.PrefixList@474aae58
13/07/27 21:16:17 INFO : Create tachyon file /hit_data.tsv.1 with file id 2 and checkpoint location file:///mnt/tachyon/hit_data.tsv.1
13/07/27 21:16:17 INFO mapred.FileInputFormat: Total input paths to process : 1
13/07/27 21:16:17 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:16:17 INFO scheduler.DAGScheduler: Got job 0 (count at <console>:15) with 1 output partitions (allowLocal=false)
13/07/27 21:16:17 INFO scheduler.DAGScheduler: Final stage: Stage 0 (count at <console>:15)
13/07/27 21:16:17 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:16:17 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:16:17 INFO scheduler.DAGScheduler: Submitting Stage 0 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:16:17 INFO scheduler.DAGScheduler: Submitting 1 missing tasks from Stage 0 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:16:17 INFO local.LocalTaskSetManager: Size of task 0 is 1494 bytes
13/07/27 21:16:17 INFO local.LocalScheduler: Running 0
13/07/27 21:16:17 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.1, 65536)
13/07/27 21:16:17 INFO : /mnt/ramdisk/tachyonworker/2147483648 is not on local disk.
13/07/27 21:16:17 INFO : Try to find and read from remote workers.
13/07/27 21:16:17 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:16:17 INFO : Folder /mnt/ramdisk/tachyonworker/users/1 was created!
13/07/27 21:16:17 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483648 was created!
13/07/27 21:16:17 INFO local.LocalScheduler: Finished 0
13/07/27 21:16:17 INFO local.LocalScheduler: Remove TaskSet 0.0 from pool 
13/07/27 21:16:17 INFO scheduler.DAGScheduler: Completed ResultTask(0, 0)
13/07/27 21:16:17 INFO scheduler.DAGScheduler: Stage 0 (count at <console>:15) finished in 0.363 s
13/07/27 21:16:17 INFO spark.SparkContext: Job finished: count at <console>:15, took 0.406856689 s
res0: Long = 1

scala> 13/07/27 21:16:17 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:16:17 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:16:17 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:16:17 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:16:17 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:16:17 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:16:17 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:16:17 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage/rdd,null}
Killed 1 processes
Killed 1 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting Tachyon @ tachyon-ec2-0
2013-07-27 21:16:19,221 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data
2013-07-27 21:16:19,224 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_log.data
2013-07-27 21:16:19,711 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/data
2013-07-27 21:16:19,723 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/workers

restaring tachyon
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Killed 0 processes
Killed 0 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting RamFS: /mnt/ramdisk
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata -Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Starting master @ tachyon-ec2-0
Starting worker @ tachyon-ec2-0

spark-shell count
13228 tachyon.Master
13255 tachyon.Worker

Going to fadvise /mnt/tachyon/hit_data.tsv.100 as mode POSIX_FADV_DONTNEED
offset: 0
length: 55735
mode: POSIX_FADV_DONTNEED
WIN
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/ubuntu/work/tachyon/target/tachyon-0.3.0-SNAPSHOT-jar-with-dependencies.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/ubuntu/work/spark/lib_managed/jars/slf4j-log4j12-1.7.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
Welcome to
      ____              __  
     / __/__  ___ _____/ /__
    _\ \/ _ \/ _ `/ __/  '_/
   /___/ .__/\_,_/_/ /_/\_\   version 0.8.0
      /_/                  

Using Scala version 2.9.3 (OpenJDK 64-Bit Server VM, Java 1.7.0_25)
Initializing interpreter...
13/07/27 21:16:25 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:16:26 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:53491
Creating SparkContext...
13/07/27 21:16:35 INFO slf4j.Slf4jEventHandler: Slf4jEventHandler started
13/07/27 21:16:35 INFO spark.SparkEnv: Registering BlockManagerMaster
13/07/27 21:16:35 INFO storage.MemoryStore: MemoryStore started with capacity 1295.4 MB.
13/07/27 21:16:35 INFO storage.DiskStore: Created local directory at /tmp/spark-local-20130727211635-c14f
13/07/27 21:16:35 INFO network.ConnectionManager: Bound socket to port 37167 with id = ConnectionManagerId(tachyon-ec2-0,37167)
13/07/27 21:16:35 INFO storage.BlockManagerMaster: Trying to register BlockManager
13/07/27 21:16:35 INFO storage.BlockManagerMasterActor$BlockManagerInfo: Registering block manager tachyon-ec2-0:37167 with 1295.4 MB RAM
13/07/27 21:16:35 INFO storage.BlockManagerMaster: Registered BlockManager
13/07/27 21:16:35 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:16:35 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:42258
13/07/27 21:16:35 INFO broadcast.HttpBroadcast: Broadcast server started at http://10.151.80.188:42258
13/07/27 21:16:35 INFO spark.SparkEnv: Registering MapOutputTracker
13/07/27 21:16:35 INFO spark.HttpFileServer: HTTP File server directory is /tmp/spark-ffbedde8-e479-418c-aac4-4c9e18cfd254
13/07/27 21:16:35 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:16:35 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:35294
13/07/27 21:16:35 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:16:35 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage/rdd,null}
13/07/27 21:16:35 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:16:35 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:16:35 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:16:35 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:16:35 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:16:35 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:16:35 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:16:35 INFO server.AbstractConnector: Started SelectChannelConnector@0.0.0.0:33000
13/07/27 21:16:35 INFO ui.SparkUI: Started Spark Web UI at http://tachyon-ec2-0:33000
Spark context available as sc.
Type in expressions to have them evaluated.
Type :help for more information.

scala> val s = sc.textFile("tachyon://tachyon-ec2-0:19998/hit_data.tsv.100")
13/07/27 21:16:37 INFO storage.MemoryStore: ensureFreeSpace(57350) called with curMem=0, maxMem=1358297825
13/07/27 21:16:37 INFO storage.MemoryStore: Block broadcast_0 stored as values to memory (estimated size 56.0 KB, free 1295.3 MB)
s: spark.RDD[String] = MappedRDD[1] at textFile at <console>:12

scala> s.count()
13/07/27 21:16:37 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
13/07/27 21:16:37 WARN snappy.LoadSnappy: Snappy native library not loaded
13/07/27 21:16:37 INFO : initialize(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100, Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml). Connecting to Tachyon: tachyon://tachyon-ec2-0:19998/hit_data.tsv.100
13/07/27 21:16:37 INFO : Trying to connect master @ tachyon-ec2-0/10.151.80.188:19998
13/07/27 21:16:37 INFO : User registered at the master tachyon-ec2-0/10.151.80.188:19998 got UserId 1
13/07/27 21:16:37 INFO : Trying to get local worker host : tachyon-ec2-0
13/07/27 21:16:37 INFO : Connecting local worker @ tachyon-ec2-0/10.151.80.188:29998
13/07/27 21:16:37 INFO : tachyon://tachyon-ec2-0:19998 tachyon://tachyon-ec2-0:19998 file:///mnt/tachyon
13/07/27 21:16:37 INFO : getFileStatus(/hit_data.tsv.100): HDFS Path: file:/mnt/tachyon/hit_data.tsv.100 TPath: tachyon://tachyon-ec2-0:19998/hit_data.tsv.100
13/07/27 21:16:37 INFO : tachyon.client.TachyonFS@1b66a60f file:///mnt/tachyon /hit_data.tsv.100 tachyon.PrefixList@702030d6
13/07/27 21:16:37 INFO : Create tachyon file /hit_data.tsv.100 with file id 2 and checkpoint location file:///mnt/tachyon/hit_data.tsv.100
13/07/27 21:16:37 INFO mapred.FileInputFormat: Total input paths to process : 1
13/07/27 21:16:38 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:16:38 INFO scheduler.DAGScheduler: Got job 0 (count at <console>:15) with 1 output partitions (allowLocal=false)
13/07/27 21:16:38 INFO scheduler.DAGScheduler: Final stage: Stage 0 (count at <console>:15)
13/07/27 21:16:38 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:16:38 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:16:38 INFO scheduler.DAGScheduler: Submitting Stage 0 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:16:38 INFO scheduler.DAGScheduler: Submitting 1 missing tasks from Stage 0 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:16:38 INFO local.LocalTaskSetManager: Size of task 0 is 1496 bytes
13/07/27 21:16:38 INFO local.LocalScheduler: Running 0
13/07/27 21:16:38 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100, 65536)
13/07/27 21:16:38 INFO : /mnt/ramdisk/tachyonworker/2147483648 is not on local disk.
13/07/27 21:16:38 INFO : Try to find and read from remote workers.
13/07/27 21:16:38 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:16:38 INFO : Folder /mnt/ramdisk/tachyonworker/users/1 was created!
13/07/27 21:16:38 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483648 was created!
13/07/27 21:16:38 INFO local.LocalScheduler: Finished 0
13/07/27 21:16:38 INFO local.LocalScheduler: Remove TaskSet 0.0 from pool 
13/07/27 21:16:38 INFO scheduler.DAGScheduler: Completed ResultTask(0, 0)
13/07/27 21:16:38 INFO scheduler.DAGScheduler: Stage 0 (count at <console>:15) finished in 0.369 s
13/07/27 21:16:38 INFO spark.SparkContext: Job finished: count at <console>:15, took 0.413205153 s
res0: Long = 100

scala> 13/07/27 21:16:38 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:16:38 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:16:38 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:16:38 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:16:38 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:16:38 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:16:38 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:16:38 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage/rdd,null}
Killed 1 processes
Killed 1 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting Tachyon @ tachyon-ec2-0
2013-07-27 21:16:40,137 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data
2013-07-27 21:16:40,141 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_log.data
2013-07-27 21:16:40,629 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/data
2013-07-27 21:16:40,640 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/workers

restaring tachyon
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Killed 0 processes
Killed 0 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting RamFS: /mnt/ramdisk
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata -Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Starting master @ tachyon-ec2-0
Starting worker @ tachyon-ec2-0

spark-shell count
13786 tachyon.Master
13813 tachyon.Worker

Going to fadvise /mnt/tachyon/hit_data.tsv.1000 as mode POSIX_FADV_DONTNEED
offset: 0
length: 776400
mode: POSIX_FADV_DONTNEED
WIN
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/ubuntu/work/tachyon/target/tachyon-0.3.0-SNAPSHOT-jar-with-dependencies.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/ubuntu/work/spark/lib_managed/jars/slf4j-log4j12-1.7.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
Welcome to
      ____              __  
     / __/__  ___ _____/ /__
    _\ \/ _ \/ _ `/ __/  '_/
   /___/ .__/\_,_/_/ /_/\_\   version 0.8.0
      /_/                  

Using Scala version 2.9.3 (OpenJDK 64-Bit Server VM, Java 1.7.0_25)
Initializing interpreter...
13/07/27 21:16:46 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:16:46 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:39661
Creating SparkContext...
13/07/27 21:16:56 INFO slf4j.Slf4jEventHandler: Slf4jEventHandler started
13/07/27 21:16:56 INFO spark.SparkEnv: Registering BlockManagerMaster
13/07/27 21:16:56 INFO storage.MemoryStore: MemoryStore started with capacity 1295.4 MB.
13/07/27 21:16:56 INFO storage.DiskStore: Created local directory at /tmp/spark-local-20130727211656-b1f0
13/07/27 21:16:56 INFO network.ConnectionManager: Bound socket to port 46734 with id = ConnectionManagerId(tachyon-ec2-0,46734)
13/07/27 21:16:56 INFO storage.BlockManagerMaster: Trying to register BlockManager
13/07/27 21:16:56 INFO storage.BlockManagerMasterActor$BlockManagerInfo: Registering block manager tachyon-ec2-0:46734 with 1295.4 MB RAM
13/07/27 21:16:56 INFO storage.BlockManagerMaster: Registered BlockManager
13/07/27 21:16:56 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:16:56 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:59845
13/07/27 21:16:56 INFO broadcast.HttpBroadcast: Broadcast server started at http://10.151.80.188:59845
13/07/27 21:16:56 INFO spark.SparkEnv: Registering MapOutputTracker
13/07/27 21:16:56 INFO spark.HttpFileServer: HTTP File server directory is /tmp/spark-384cee0c-be7f-42ff-85c5-539d52aa54ac
13/07/27 21:16:56 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:16:56 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:58904
13/07/27 21:16:56 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:16:56 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage/rdd,null}
13/07/27 21:16:56 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:16:56 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:16:56 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:16:56 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:16:56 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:16:56 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:16:56 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:16:56 INFO server.AbstractConnector: Started SelectChannelConnector@0.0.0.0:33000
13/07/27 21:16:56 INFO ui.SparkUI: Started Spark Web UI at http://tachyon-ec2-0:33000
Spark context available as sc.
Type in expressions to have them evaluated.
Type :help for more information.

scala> val s = sc.textFile("tachyon://tachyon-ec2-0:19998/hit_data.tsv.1000")
13/07/27 21:16:57 INFO storage.MemoryStore: ensureFreeSpace(57350) called with curMem=0, maxMem=1358297825
13/07/27 21:16:57 INFO storage.MemoryStore: Block broadcast_0 stored as values to memory (estimated size 56.0 KB, free 1295.3 MB)
s: spark.RDD[String] = MappedRDD[1] at textFile at <console>:12

scala> s.count()
13/07/27 21:16:58 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
13/07/27 21:16:58 WARN snappy.LoadSnappy: Snappy native library not loaded
13/07/27 21:16:58 INFO : initialize(tachyon://tachyon-ec2-0:19998/hit_data.tsv.1000, Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml). Connecting to Tachyon: tachyon://tachyon-ec2-0:19998/hit_data.tsv.1000
13/07/27 21:16:58 INFO : Trying to connect master @ tachyon-ec2-0/10.151.80.188:19998
13/07/27 21:16:58 INFO : User registered at the master tachyon-ec2-0/10.151.80.188:19998 got UserId 1
13/07/27 21:16:58 INFO : Trying to get local worker host : tachyon-ec2-0
13/07/27 21:16:58 INFO : Connecting local worker @ tachyon-ec2-0/10.151.80.188:29998
13/07/27 21:16:58 INFO : tachyon://tachyon-ec2-0:19998 tachyon://tachyon-ec2-0:19998 file:///mnt/tachyon
13/07/27 21:16:58 INFO : getFileStatus(/hit_data.tsv.1000): HDFS Path: file:/mnt/tachyon/hit_data.tsv.1000 TPath: tachyon://tachyon-ec2-0:19998/hit_data.tsv.1000
13/07/27 21:16:58 INFO : tachyon.client.TachyonFS@4cb0b955 file:///mnt/tachyon /hit_data.tsv.1000 tachyon.PrefixList@6657a2c8
13/07/27 21:16:58 INFO : Create tachyon file /hit_data.tsv.1000 with file id 2 and checkpoint location file:///mnt/tachyon/hit_data.tsv.1000
13/07/27 21:16:58 INFO mapred.FileInputFormat: Total input paths to process : 1
13/07/27 21:16:58 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:16:58 INFO scheduler.DAGScheduler: Got job 0 (count at <console>:15) with 1 output partitions (allowLocal=false)
13/07/27 21:16:58 INFO scheduler.DAGScheduler: Final stage: Stage 0 (count at <console>:15)
13/07/27 21:16:58 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:16:58 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:16:58 INFO scheduler.DAGScheduler: Submitting Stage 0 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:16:58 INFO scheduler.DAGScheduler: Submitting 1 missing tasks from Stage 0 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:16:58 INFO local.LocalTaskSetManager: Size of task 0 is 1497 bytes
13/07/27 21:16:58 INFO local.LocalScheduler: Running 0
13/07/27 21:16:59 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.1000, 65536)
13/07/27 21:16:59 INFO : /mnt/ramdisk/tachyonworker/2147483648 is not on local disk.
13/07/27 21:16:59 INFO : Try to find and read from remote workers.
13/07/27 21:16:59 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:16:59 INFO : Folder /mnt/ramdisk/tachyonworker/users/1 was created!
13/07/27 21:16:59 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483648 was created!
13/07/27 21:16:59 INFO local.LocalScheduler: Finished 0
13/07/27 21:16:59 INFO local.LocalScheduler: Remove TaskSet 0.0 from pool 
13/07/27 21:16:59 INFO scheduler.DAGScheduler: Completed ResultTask(0, 0)
13/07/27 21:16:59 INFO scheduler.DAGScheduler: Stage 0 (count at <console>:15) finished in 0.423 s
13/07/27 21:16:59 INFO spark.SparkContext: Job finished: count at <console>:15, took 0.467130645 s
res0: Long = 1000

scala> 13/07/27 21:16:59 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:16:59 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:16:59 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:16:59 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:16:59 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:16:59 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:16:59 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:16:59 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage/rdd,null}
Killed 1 processes
Killed 1 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting Tachyon @ tachyon-ec2-0
2013-07-27 21:17:00,997 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data
2013-07-27 21:17:01,001 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_log.data
2013-07-27 21:17:01,492 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/data
2013-07-27 21:17:01,503 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/workers

restaring tachyon
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Killed 0 processes
Killed 0 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting RamFS: /mnt/ramdisk
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata -Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Starting master @ tachyon-ec2-0
Starting worker @ tachyon-ec2-0

spark-shell count
14347 tachyon.Master
14374 tachyon.Worker

Going to fadvise /mnt/tachyon/hit_data.tsv.10000 as mode POSIX_FADV_DONTNEED
offset: 0
length: 12330369
mode: POSIX_FADV_DONTNEED
WIN
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/ubuntu/work/tachyon/target/tachyon-0.3.0-SNAPSHOT-jar-with-dependencies.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/ubuntu/work/spark/lib_managed/jars/slf4j-log4j12-1.7.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
Welcome to
      ____              __  
     / __/__  ___ _____/ /__
    _\ \/ _ \/ _ `/ __/  '_/
   /___/ .__/\_,_/_/ /_/\_\   version 0.8.0
      /_/                  

Using Scala version 2.9.3 (OpenJDK 64-Bit Server VM, Java 1.7.0_25)
Initializing interpreter...
13/07/27 21:17:07 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:17:07 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:55033
Creating SparkContext...
13/07/27 21:17:16 INFO slf4j.Slf4jEventHandler: Slf4jEventHandler started
13/07/27 21:17:17 INFO spark.SparkEnv: Registering BlockManagerMaster
13/07/27 21:17:17 INFO storage.MemoryStore: MemoryStore started with capacity 1295.4 MB.
13/07/27 21:17:17 INFO storage.DiskStore: Created local directory at /tmp/spark-local-20130727211717-4cfc
13/07/27 21:17:17 INFO network.ConnectionManager: Bound socket to port 49070 with id = ConnectionManagerId(tachyon-ec2-0,49070)
13/07/27 21:17:17 INFO storage.BlockManagerMaster: Trying to register BlockManager
13/07/27 21:17:17 INFO storage.BlockManagerMasterActor$BlockManagerInfo: Registering block manager tachyon-ec2-0:49070 with 1295.4 MB RAM
13/07/27 21:17:17 INFO storage.BlockManagerMaster: Registered BlockManager
13/07/27 21:17:17 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:17:17 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:51405
13/07/27 21:17:17 INFO broadcast.HttpBroadcast: Broadcast server started at http://10.151.80.188:51405
13/07/27 21:17:17 INFO spark.SparkEnv: Registering MapOutputTracker
13/07/27 21:17:17 INFO spark.HttpFileServer: HTTP File server directory is /tmp/spark-78ef2bd7-b904-444d-b7db-57894db7582a
13/07/27 21:17:17 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:17:17 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:43444
13/07/27 21:17:17 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:17:17 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage/rdd,null}
13/07/27 21:17:17 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:17:17 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:17:17 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:17:17 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:17:17 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:17:17 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:17:17 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:17:17 INFO server.AbstractConnector: Started SelectChannelConnector@0.0.0.0:33000
13/07/27 21:17:17 INFO ui.SparkUI: Started Spark Web UI at http://tachyon-ec2-0:33000
Spark context available as sc.
Type in expressions to have them evaluated.
Type :help for more information.

scala> val s = sc.textFile("tachyon://tachyon-ec2-0:19998/hit_data.tsv.10000")
13/07/27 21:17:18 INFO storage.MemoryStore: ensureFreeSpace(57350) called with curMem=0, maxMem=1358297825
13/07/27 21:17:18 INFO storage.MemoryStore: Block broadcast_0 stored as values to memory (estimated size 56.0 KB, free 1295.3 MB)
s: spark.RDD[String] = MappedRDD[1] at textFile at <console>:12

scala> s.count()
13/07/27 21:17:19 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
13/07/27 21:17:19 WARN snappy.LoadSnappy: Snappy native library not loaded
13/07/27 21:17:19 INFO : initialize(tachyon://tachyon-ec2-0:19998/hit_data.tsv.10000, Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml). Connecting to Tachyon: tachyon://tachyon-ec2-0:19998/hit_data.tsv.10000
13/07/27 21:17:19 INFO : Trying to connect master @ tachyon-ec2-0/10.151.80.188:19998
13/07/27 21:17:19 INFO : User registered at the master tachyon-ec2-0/10.151.80.188:19998 got UserId 1
13/07/27 21:17:19 INFO : Trying to get local worker host : tachyon-ec2-0
13/07/27 21:17:19 INFO : Connecting local worker @ tachyon-ec2-0/10.151.80.188:29998
13/07/27 21:17:19 INFO : tachyon://tachyon-ec2-0:19998 tachyon://tachyon-ec2-0:19998 file:///mnt/tachyon
13/07/27 21:17:19 INFO : getFileStatus(/hit_data.tsv.10000): HDFS Path: file:/mnt/tachyon/hit_data.tsv.10000 TPath: tachyon://tachyon-ec2-0:19998/hit_data.tsv.10000
13/07/27 21:17:19 INFO : tachyon.client.TachyonFS@2348717a file:///mnt/tachyon /hit_data.tsv.10000 tachyon.PrefixList@691212ae
13/07/27 21:17:19 INFO : Create tachyon file /hit_data.tsv.10000 with file id 2 and checkpoint location file:///mnt/tachyon/hit_data.tsv.10000
13/07/27 21:17:19 INFO mapred.FileInputFormat: Total input paths to process : 1
13/07/27 21:17:19 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:17:19 INFO scheduler.DAGScheduler: Got job 0 (count at <console>:15) with 1 output partitions (allowLocal=false)
13/07/27 21:17:19 INFO scheduler.DAGScheduler: Final stage: Stage 0 (count at <console>:15)
13/07/27 21:17:19 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:17:19 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:17:19 INFO scheduler.DAGScheduler: Submitting Stage 0 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:17:19 INFO scheduler.DAGScheduler: Submitting 1 missing tasks from Stage 0 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:17:19 INFO local.LocalTaskSetManager: Size of task 0 is 1498 bytes
13/07/27 21:17:19 INFO local.LocalScheduler: Running 0
13/07/27 21:17:19 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.10000, 65536)
13/07/27 21:17:19 INFO : /mnt/ramdisk/tachyonworker/2147483648 is not on local disk.
13/07/27 21:17:19 INFO : Try to find and read from remote workers.
13/07/27 21:17:19 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:17:19 INFO : Folder /mnt/ramdisk/tachyonworker/users/1 was created!
13/07/27 21:17:19 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483648 was created!
13/07/27 21:17:20 INFO local.LocalScheduler: Finished 0
13/07/27 21:17:20 INFO local.LocalScheduler: Remove TaskSet 0.0 from pool 
13/07/27 21:17:20 INFO scheduler.DAGScheduler: Completed ResultTask(0, 0)
13/07/27 21:17:20 INFO scheduler.DAGScheduler: Stage 0 (count at <console>:15) finished in 0.644 s
13/07/27 21:17:20 INFO spark.SparkContext: Job finished: count at <console>:15, took 0.68682632 s
res0: Long = 10000

scala> 13/07/27 21:17:20 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:17:20 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:17:20 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:17:20 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:17:20 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:17:20 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:17:20 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:17:20 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage/rdd,null}
Killed 1 processes
Killed 1 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting Tachyon @ tachyon-ec2-0
2013-07-27 21:17:22,047 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data
2013-07-27 21:17:22,050 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_log.data
2013-07-27 21:17:22,539 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/data
2013-07-27 21:17:22,551 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/workers

restaring tachyon
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Killed 0 processes
Killed 0 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting RamFS: /mnt/ramdisk
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata -Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Starting master @ tachyon-ec2-0
Starting worker @ tachyon-ec2-0

spark-shell count
14906 tachyon.Master
14933 tachyon.Worker

Going to fadvise /mnt/tachyon/hit_data.tsv.100000 as mode POSIX_FADV_DONTNEED
offset: 0
length: 125141299
mode: POSIX_FADV_DONTNEED
WIN
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/ubuntu/work/tachyon/target/tachyon-0.3.0-SNAPSHOT-jar-with-dependencies.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/ubuntu/work/spark/lib_managed/jars/slf4j-log4j12-1.7.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
Welcome to
      ____              __  
     / __/__  ___ _____/ /__
    _\ \/ _ \/ _ `/ __/  '_/
   /___/ .__/\_,_/_/ /_/\_\   version 0.8.0
      /_/                  

Using Scala version 2.9.3 (OpenJDK 64-Bit Server VM, Java 1.7.0_25)
Initializing interpreter...
13/07/27 21:17:28 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:17:28 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:42996
Creating SparkContext...
13/07/27 21:17:37 INFO slf4j.Slf4jEventHandler: Slf4jEventHandler started
13/07/27 21:17:38 INFO spark.SparkEnv: Registering BlockManagerMaster
13/07/27 21:17:38 INFO storage.MemoryStore: MemoryStore started with capacity 1295.4 MB.
13/07/27 21:17:38 INFO storage.DiskStore: Created local directory at /tmp/spark-local-20130727211738-0578
13/07/27 21:17:38 INFO network.ConnectionManager: Bound socket to port 48618 with id = ConnectionManagerId(tachyon-ec2-0,48618)
13/07/27 21:17:38 INFO storage.BlockManagerMaster: Trying to register BlockManager
13/07/27 21:17:38 INFO storage.BlockManagerMasterActor$BlockManagerInfo: Registering block manager tachyon-ec2-0:48618 with 1295.4 MB RAM
13/07/27 21:17:38 INFO storage.BlockManagerMaster: Registered BlockManager
13/07/27 21:17:38 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:17:38 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:34390
13/07/27 21:17:38 INFO broadcast.HttpBroadcast: Broadcast server started at http://10.151.80.188:34390
13/07/27 21:17:38 INFO spark.SparkEnv: Registering MapOutputTracker
13/07/27 21:17:38 INFO spark.HttpFileServer: HTTP File server directory is /tmp/spark-d980d00f-ca26-45a2-a184-749a31ef7d07
13/07/27 21:17:38 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:17:38 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:59591
13/07/27 21:17:38 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:17:38 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage/rdd,null}
13/07/27 21:17:38 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:17:38 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:17:38 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:17:38 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:17:38 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:17:38 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:17:38 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:17:38 INFO server.AbstractConnector: Started SelectChannelConnector@0.0.0.0:33000
13/07/27 21:17:38 INFO ui.SparkUI: Started Spark Web UI at http://tachyon-ec2-0:33000
Spark context available as sc.
Type in expressions to have them evaluated.
Type :help for more information.

scala> val s = sc.textFile("tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000")
13/07/27 21:17:39 INFO storage.MemoryStore: ensureFreeSpace(57358) called with curMem=0, maxMem=1358297825
13/07/27 21:17:39 INFO storage.MemoryStore: Block broadcast_0 stored as values to memory (estimated size 56.0 KB, free 1295.3 MB)
s: spark.RDD[String] = MappedRDD[1] at textFile at <console>:12

scala> s.count()
13/07/27 21:17:40 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
13/07/27 21:17:40 WARN snappy.LoadSnappy: Snappy native library not loaded
13/07/27 21:17:40 INFO : initialize(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000, Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml). Connecting to Tachyon: tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000
13/07/27 21:17:40 INFO : Trying to connect master @ tachyon-ec2-0/10.151.80.188:19998
13/07/27 21:17:40 INFO : User registered at the master tachyon-ec2-0/10.151.80.188:19998 got UserId 1
13/07/27 21:17:40 INFO : Trying to get local worker host : tachyon-ec2-0
13/07/27 21:17:40 INFO : Connecting local worker @ tachyon-ec2-0/10.151.80.188:29998
13/07/27 21:17:40 INFO : tachyon://tachyon-ec2-0:19998 tachyon://tachyon-ec2-0:19998 file:///mnt/tachyon
13/07/27 21:17:40 INFO : getFileStatus(/hit_data.tsv.100000): HDFS Path: file:/mnt/tachyon/hit_data.tsv.100000 TPath: tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000
13/07/27 21:17:40 INFO : tachyon.client.TachyonFS@4b92c9 file:///mnt/tachyon /hit_data.tsv.100000 tachyon.PrefixList@6191ca45
13/07/27 21:17:40 INFO : Create tachyon file /hit_data.tsv.100000 with file id 2 and checkpoint location file:///mnt/tachyon/hit_data.tsv.100000
13/07/27 21:17:40 INFO mapred.FileInputFormat: Total input paths to process : 1
13/07/27 21:17:40 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:17:40 INFO scheduler.DAGScheduler: Got job 0 (count at <console>:15) with 4 output partitions (allowLocal=false)
13/07/27 21:17:40 INFO scheduler.DAGScheduler: Final stage: Stage 0 (count at <console>:15)
13/07/27 21:17:40 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:17:40 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:17:40 INFO scheduler.DAGScheduler: Submitting Stage 0 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:17:40 INFO scheduler.DAGScheduler: Submitting 4 missing tasks from Stage 0 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:17:40 INFO local.LocalTaskSetManager: Size of task 0 is 1499 bytes
13/07/27 21:17:40 INFO local.LocalScheduler: Running 0
13/07/27 21:17:41 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000, 65536)
13/07/27 21:17:41 INFO : /mnt/ramdisk/tachyonworker/2147483648 is not on local disk.
13/07/27 21:17:41 INFO : Try to find and read from remote workers.
13/07/27 21:17:41 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:17:41 INFO : Folder /mnt/ramdisk/tachyonworker/users/1 was created!
13/07/27 21:17:41 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483648 was created!
13/07/27 21:17:41 INFO : /mnt/ramdisk/tachyonworker/2147483649 is not on local disk.
13/07/27 21:17:41 INFO : Try to find and read from remote workers.
13/07/27 21:17:41 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:17:41 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483649 was created!
13/07/27 21:17:42 INFO local.LocalScheduler: Finished 0
13/07/27 21:17:42 INFO local.LocalTaskSetManager: Size of task 1 is 1499 bytes
13/07/27 21:17:42 INFO local.LocalScheduler: Running 1
13/07/27 21:17:42 INFO scheduler.DAGScheduler: Completed ResultTask(0, 0)
13/07/27 21:17:42 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000, 65536)
13/07/27 21:17:42 INFO : /mnt/ramdisk/tachyonworker/2147483650 is not on local disk.
13/07/27 21:17:42 INFO : Try to find and read from remote workers.
13/07/27 21:17:42 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:17:42 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483650 was created!
13/07/27 21:17:42 INFO local.LocalScheduler: Finished 1
13/07/27 21:17:42 INFO scheduler.DAGScheduler: Completed ResultTask(0, 1)
13/07/27 21:17:42 INFO local.LocalTaskSetManager: Size of task 2 is 1499 bytes
13/07/27 21:17:42 INFO local.LocalScheduler: Running 2
13/07/27 21:17:43 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000, 65536)
13/07/27 21:17:43 INFO : /mnt/ramdisk/tachyonworker/2147483651 is not on local disk.
13/07/27 21:17:43 INFO : Try to find and read from remote workers.
13/07/27 21:17:43 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:17:43 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483651 was created!
13/07/27 21:17:43 INFO local.LocalScheduler: Finished 2
13/07/27 21:17:43 INFO scheduler.DAGScheduler: Completed ResultTask(0, 2)
13/07/27 21:17:43 INFO local.LocalTaskSetManager: Size of task 3 is 1499 bytes
13/07/27 21:17:43 INFO local.LocalScheduler: Running 3
13/07/27 21:17:43 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000, 65536)
13/07/27 21:17:43 INFO local.LocalScheduler: Finished 3
13/07/27 21:17:43 INFO scheduler.DAGScheduler: Completed ResultTask(0, 3)
13/07/27 21:17:43 INFO local.LocalScheduler: Remove TaskSet 0.0 from pool 
13/07/27 21:17:43 INFO scheduler.DAGScheduler: Stage 0 (count at <console>:15) finished in 2.813 s
13/07/27 21:17:43 INFO spark.SparkContext: Job finished: count at <console>:15, took 2.859036915 s
res0: Long = 100002

scala> 13/07/27 21:17:43 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:17:43 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:17:43 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:17:43 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:17:43 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:17:43 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:17:43 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:17:43 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage/rdd,null}
Killed 1 processes
Killed 1 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting Tachyon @ tachyon-ec2-0
2013-07-27 21:17:45,448 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data
2013-07-27 21:17:45,452 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_log.data
2013-07-27 21:17:45,939 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/data
2013-07-27 21:17:45,951 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/workers

restaring tachyon
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Killed 0 processes
Killed 0 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting RamFS: /mnt/ramdisk
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata -Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Starting master @ tachyon-ec2-0
Starting worker @ tachyon-ec2-0

spark-shell count
15542 tachyon.Master
15569 tachyon.Worker

Going to fadvise /mnt/tachyon/hit_data.tsv.500000 as mode POSIX_FADV_DONTNEED
offset: 0
length: 618418417
mode: POSIX_FADV_DONTNEED
WIN
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/ubuntu/work/tachyon/target/tachyon-0.3.0-SNAPSHOT-jar-with-dependencies.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/ubuntu/work/spark/lib_managed/jars/slf4j-log4j12-1.7.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
Welcome to
      ____              __  
     / __/__  ___ _____/ /__
    _\ \/ _ \/ _ `/ __/  '_/
   /___/ .__/\_,_/_/ /_/\_\   version 0.8.0
      /_/                  

Using Scala version 2.9.3 (OpenJDK 64-Bit Server VM, Java 1.7.0_25)
Initializing interpreter...
13/07/27 21:17:52 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:17:52 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:51700
Creating SparkContext...
13/07/27 21:18:01 INFO slf4j.Slf4jEventHandler: Slf4jEventHandler started
13/07/27 21:18:01 INFO spark.SparkEnv: Registering BlockManagerMaster
13/07/27 21:18:01 INFO storage.MemoryStore: MemoryStore started with capacity 1295.4 MB.
13/07/27 21:18:01 INFO storage.DiskStore: Created local directory at /tmp/spark-local-20130727211801-42f9
13/07/27 21:18:01 INFO network.ConnectionManager: Bound socket to port 46246 with id = ConnectionManagerId(tachyon-ec2-0,46246)
13/07/27 21:18:01 INFO storage.BlockManagerMaster: Trying to register BlockManager
13/07/27 21:18:01 INFO storage.BlockManagerMasterActor$BlockManagerInfo: Registering block manager tachyon-ec2-0:46246 with 1295.4 MB RAM
13/07/27 21:18:01 INFO storage.BlockManagerMaster: Registered BlockManager
13/07/27 21:18:01 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:18:01 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:58332
13/07/27 21:18:01 INFO broadcast.HttpBroadcast: Broadcast server started at http://10.151.80.188:58332
13/07/27 21:18:01 INFO spark.SparkEnv: Registering MapOutputTracker
13/07/27 21:18:01 INFO spark.HttpFileServer: HTTP File server directory is /tmp/spark-2a47ed55-b042-4a09-b6f2-c2dd0aa5cee1
13/07/27 21:18:01 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:18:01 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:36546
13/07/27 21:18:01 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:18:01 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage/rdd,null}
13/07/27 21:18:01 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:18:01 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:18:01 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:18:01 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:18:01 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:18:01 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:18:01 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:18:01 INFO server.AbstractConnector: Started SelectChannelConnector@0.0.0.0:33000
13/07/27 21:18:01 INFO ui.SparkUI: Started Spark Web UI at http://tachyon-ec2-0:33000
Spark context available as sc.
Type in expressions to have them evaluated.
Type :help for more information.

scala> val s = sc.textFile("tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000")
13/07/27 21:18:03 INFO storage.MemoryStore: ensureFreeSpace(57358) called with curMem=0, maxMem=1358297825
13/07/27 21:18:03 INFO storage.MemoryStore: Block broadcast_0 stored as values to memory (estimated size 56.0 KB, free 1295.3 MB)
s: spark.RDD[String] = MappedRDD[1] at textFile at <console>:12

scala> s.count()
13/07/27 21:18:03 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
13/07/27 21:18:03 WARN snappy.LoadSnappy: Snappy native library not loaded
13/07/27 21:18:03 INFO : initialize(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml). Connecting to Tachyon: tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000
13/07/27 21:18:03 INFO : Trying to connect master @ tachyon-ec2-0/10.151.80.188:19998
13/07/27 21:18:03 INFO : User registered at the master tachyon-ec2-0/10.151.80.188:19998 got UserId 1
13/07/27 21:18:03 INFO : Trying to get local worker host : tachyon-ec2-0
13/07/27 21:18:03 INFO : Connecting local worker @ tachyon-ec2-0/10.151.80.188:29998
13/07/27 21:18:03 INFO : tachyon://tachyon-ec2-0:19998 tachyon://tachyon-ec2-0:19998 file:///mnt/tachyon
13/07/27 21:18:03 INFO : getFileStatus(/hit_data.tsv.500000): HDFS Path: file:/mnt/tachyon/hit_data.tsv.500000 TPath: tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000
13/07/27 21:18:03 INFO : tachyon.client.TachyonFS@4bf3f11c file:///mnt/tachyon /hit_data.tsv.500000 tachyon.PrefixList@7c5a8c38
13/07/27 21:18:04 INFO : Create tachyon file /hit_data.tsv.500000 with file id 2 and checkpoint location file:///mnt/tachyon/hit_data.tsv.500000
13/07/27 21:18:04 INFO mapred.FileInputFormat: Total input paths to process : 1
13/07/27 21:18:04 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:18:04 INFO scheduler.DAGScheduler: Got job 0 (count at <console>:15) with 19 output partitions (allowLocal=false)
13/07/27 21:18:04 INFO scheduler.DAGScheduler: Final stage: Stage 0 (count at <console>:15)
13/07/27 21:18:04 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:18:04 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:18:04 INFO scheduler.DAGScheduler: Submitting Stage 0 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:18:04 INFO scheduler.DAGScheduler: Submitting 19 missing tasks from Stage 0 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:18:04 INFO local.LocalTaskSetManager: Size of task 0 is 1499 bytes
13/07/27 21:18:04 INFO local.LocalScheduler: Running 0
13/07/27 21:18:04 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:18:04 INFO : /mnt/ramdisk/tachyonworker/2147483648 is not on local disk.
13/07/27 21:18:04 INFO : Try to find and read from remote workers.
13/07/27 21:18:04 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:18:04 INFO : Folder /mnt/ramdisk/tachyonworker/users/1 was created!
13/07/27 21:18:04 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483648 was created!
13/07/27 21:18:05 INFO : /mnt/ramdisk/tachyonworker/2147483649 is not on local disk.
13/07/27 21:18:05 INFO : Try to find and read from remote workers.
13/07/27 21:18:05 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:18:05 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483649 was created!
13/07/27 21:18:05 INFO local.LocalScheduler: Finished 0
13/07/27 21:18:05 INFO local.LocalTaskSetManager: Size of task 1 is 1499 bytes
13/07/27 21:18:05 INFO local.LocalScheduler: Running 1
13/07/27 21:18:05 INFO scheduler.DAGScheduler: Completed ResultTask(0, 0)
13/07/27 21:18:05 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:18:06 INFO : /mnt/ramdisk/tachyonworker/2147483650 is not on local disk.
13/07/27 21:18:06 INFO : Try to find and read from remote workers.
13/07/27 21:18:06 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:18:06 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483650 was created!
13/07/27 21:18:06 INFO local.LocalScheduler: Finished 1
13/07/27 21:18:06 INFO scheduler.DAGScheduler: Completed ResultTask(0, 1)
13/07/27 21:18:06 INFO local.LocalTaskSetManager: Size of task 2 is 1499 bytes
13/07/27 21:18:06 INFO local.LocalScheduler: Running 2
13/07/27 21:18:06 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:18:06 INFO : /mnt/ramdisk/tachyonworker/2147483651 is not on local disk.
13/07/27 21:18:06 INFO : Try to find and read from remote workers.
13/07/27 21:18:06 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:18:06 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483651 was created!
13/07/27 21:18:07 INFO local.LocalScheduler: Finished 2
13/07/27 21:18:07 INFO scheduler.DAGScheduler: Completed ResultTask(0, 2)
13/07/27 21:18:07 INFO local.LocalTaskSetManager: Size of task 3 is 1499 bytes
13/07/27 21:18:07 INFO local.LocalScheduler: Running 3
13/07/27 21:18:07 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:18:07 INFO : /mnt/ramdisk/tachyonworker/2147483652 is not on local disk.
13/07/27 21:18:07 INFO : Try to find and read from remote workers.
13/07/27 21:18:07 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:18:07 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483652 was created!
13/07/27 21:18:07 INFO local.LocalScheduler: Finished 3
13/07/27 21:18:07 INFO scheduler.DAGScheduler: Completed ResultTask(0, 3)
13/07/27 21:18:07 INFO local.LocalTaskSetManager: Size of task 4 is 1499 bytes
13/07/27 21:18:07 INFO local.LocalScheduler: Running 4
13/07/27 21:18:07 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:18:07 INFO : /mnt/ramdisk/tachyonworker/2147483653 is not on local disk.
13/07/27 21:18:07 INFO : Try to find and read from remote workers.
13/07/27 21:18:07 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:18:07 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483653 was created!
13/07/27 21:18:08 INFO local.LocalScheduler: Finished 4
13/07/27 21:18:08 INFO scheduler.DAGScheduler: Completed ResultTask(0, 4)
13/07/27 21:18:08 INFO local.LocalTaskSetManager: Size of task 5 is 1499 bytes
13/07/27 21:18:08 INFO local.LocalScheduler: Running 5
13/07/27 21:18:08 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:18:08 INFO : /mnt/ramdisk/tachyonworker/2147483654 is not on local disk.
13/07/27 21:18:08 INFO : Try to find and read from remote workers.
13/07/27 21:18:08 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:18:08 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483654 was created!
13/07/27 21:18:08 INFO local.LocalScheduler: Finished 5
13/07/27 21:18:08 INFO scheduler.DAGScheduler: Completed ResultTask(0, 5)
13/07/27 21:18:08 INFO local.LocalTaskSetManager: Size of task 6 is 1499 bytes
13/07/27 21:18:08 INFO local.LocalScheduler: Running 6
13/07/27 21:18:08 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:18:09 INFO : /mnt/ramdisk/tachyonworker/2147483655 is not on local disk.
13/07/27 21:18:09 INFO : Try to find and read from remote workers.
13/07/27 21:18:09 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:18:09 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483655 was created!
13/07/27 21:18:09 INFO local.LocalScheduler: Finished 6
13/07/27 21:18:09 INFO scheduler.DAGScheduler: Completed ResultTask(0, 6)
13/07/27 21:18:09 INFO local.LocalTaskSetManager: Size of task 7 is 1499 bytes
13/07/27 21:18:09 INFO local.LocalScheduler: Running 7
13/07/27 21:18:09 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:18:09 INFO : /mnt/ramdisk/tachyonworker/2147483656 is not on local disk.
13/07/27 21:18:09 INFO : Try to find and read from remote workers.
13/07/27 21:18:09 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:18:09 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483656 was created!
13/07/27 21:18:10 INFO local.LocalScheduler: Finished 7
13/07/27 21:18:10 INFO scheduler.DAGScheduler: Completed ResultTask(0, 7)
13/07/27 21:18:10 INFO local.LocalTaskSetManager: Size of task 8 is 1499 bytes
13/07/27 21:18:10 INFO local.LocalScheduler: Running 8
13/07/27 21:18:10 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:18:10 INFO : /mnt/ramdisk/tachyonworker/2147483657 is not on local disk.
13/07/27 21:18:10 INFO : Try to find and read from remote workers.
13/07/27 21:18:10 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:18:10 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483657 was created!
13/07/27 21:18:10 INFO local.LocalScheduler: Finished 8
13/07/27 21:18:10 INFO scheduler.DAGScheduler: Completed ResultTask(0, 8)
13/07/27 21:18:10 INFO local.LocalTaskSetManager: Size of task 9 is 1499 bytes
13/07/27 21:18:10 INFO local.LocalScheduler: Running 9
13/07/27 21:18:10 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:18:10 INFO : /mnt/ramdisk/tachyonworker/2147483658 is not on local disk.
13/07/27 21:18:10 INFO : Try to find and read from remote workers.
13/07/27 21:18:10 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:18:11 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483658 was created!
13/07/27 21:18:11 INFO local.LocalScheduler: Finished 9
13/07/27 21:18:11 INFO scheduler.DAGScheduler: Completed ResultTask(0, 9)
13/07/27 21:18:11 INFO local.LocalTaskSetManager: Size of task 10 is 1499 bytes
13/07/27 21:18:11 INFO local.LocalScheduler: Running 10
13/07/27 21:18:11 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:18:11 INFO : /mnt/ramdisk/tachyonworker/2147483659 is not on local disk.
13/07/27 21:18:11 INFO : Try to find and read from remote workers.
13/07/27 21:18:11 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:18:11 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483659 was created!
13/07/27 21:18:11 INFO local.LocalScheduler: Finished 10
13/07/27 21:18:11 INFO scheduler.DAGScheduler: Completed ResultTask(0, 10)
13/07/27 21:18:11 INFO local.LocalTaskSetManager: Size of task 11 is 1499 bytes
13/07/27 21:18:11 INFO local.LocalScheduler: Running 11
13/07/27 21:18:11 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:18:12 INFO : /mnt/ramdisk/tachyonworker/2147483660 is not on local disk.
13/07/27 21:18:12 INFO : Try to find and read from remote workers.
13/07/27 21:18:12 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:18:12 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483660 was created!
13/07/27 21:18:12 INFO local.LocalScheduler: Finished 11
13/07/27 21:18:12 INFO scheduler.DAGScheduler: Completed ResultTask(0, 11)
13/07/27 21:18:12 INFO local.LocalTaskSetManager: Size of task 12 is 1499 bytes
13/07/27 21:18:12 INFO local.LocalScheduler: Running 12
13/07/27 21:18:12 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:18:12 INFO : /mnt/ramdisk/tachyonworker/2147483661 is not on local disk.
13/07/27 21:18:12 INFO : Try to find and read from remote workers.
13/07/27 21:18:12 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:18:12 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483661 was created!
13/07/27 21:18:13 INFO local.LocalScheduler: Finished 12
13/07/27 21:18:13 INFO scheduler.DAGScheduler: Completed ResultTask(0, 12)
13/07/27 21:18:13 INFO local.LocalTaskSetManager: Size of task 13 is 1499 bytes
13/07/27 21:18:13 INFO local.LocalScheduler: Running 13
13/07/27 21:18:13 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:18:13 INFO : /mnt/ramdisk/tachyonworker/2147483662 is not on local disk.
13/07/27 21:18:13 INFO : Try to find and read from remote workers.
13/07/27 21:18:13 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:18:13 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483662 was created!
13/07/27 21:18:13 INFO local.LocalScheduler: Finished 13
13/07/27 21:18:13 INFO scheduler.DAGScheduler: Completed ResultTask(0, 13)
13/07/27 21:18:13 INFO local.LocalTaskSetManager: Size of task 14 is 1499 bytes
13/07/27 21:18:13 INFO local.LocalScheduler: Running 14
13/07/27 21:18:13 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:18:13 INFO : /mnt/ramdisk/tachyonworker/2147483663 is not on local disk.
13/07/27 21:18:13 INFO : Try to find and read from remote workers.
13/07/27 21:18:13 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:18:13 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483663 was created!
13/07/27 21:18:14 INFO local.LocalScheduler: Finished 14
13/07/27 21:18:14 INFO scheduler.DAGScheduler: Completed ResultTask(0, 14)
13/07/27 21:18:14 INFO local.LocalTaskSetManager: Size of task 15 is 1499 bytes
13/07/27 21:18:14 INFO local.LocalScheduler: Running 15
13/07/27 21:18:14 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:18:14 INFO : /mnt/ramdisk/tachyonworker/2147483664 is not on local disk.
13/07/27 21:18:14 INFO : Try to find and read from remote workers.
13/07/27 21:18:14 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:18:14 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483664 was created!
13/07/27 21:18:14 INFO local.LocalScheduler: Finished 15
13/07/27 21:18:14 INFO scheduler.DAGScheduler: Completed ResultTask(0, 15)
13/07/27 21:18:14 INFO local.LocalTaskSetManager: Size of task 16 is 1499 bytes
13/07/27 21:18:14 INFO local.LocalScheduler: Running 16
13/07/27 21:18:14 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:18:14 INFO : /mnt/ramdisk/tachyonworker/2147483665 is not on local disk.
13/07/27 21:18:14 INFO : Try to find and read from remote workers.
13/07/27 21:18:14 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:18:14 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483665 was created!
13/07/27 21:18:15 INFO local.LocalScheduler: Finished 16
13/07/27 21:18:15 INFO scheduler.DAGScheduler: Completed ResultTask(0, 16)
13/07/27 21:18:15 INFO local.LocalTaskSetManager: Size of task 17 is 1499 bytes
13/07/27 21:18:15 INFO local.LocalScheduler: Running 17
13/07/27 21:18:15 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:18:15 INFO : /mnt/ramdisk/tachyonworker/2147483666 is not on local disk.
13/07/27 21:18:15 INFO : Try to find and read from remote workers.
13/07/27 21:18:15 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:18:15 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483666 was created!
13/07/27 21:18:15 INFO local.LocalScheduler: Finished 17
13/07/27 21:18:15 INFO scheduler.DAGScheduler: Completed ResultTask(0, 17)
13/07/27 21:18:15 INFO local.LocalTaskSetManager: Size of task 18 is 1499 bytes
13/07/27 21:18:15 INFO local.LocalScheduler: Running 18
13/07/27 21:18:15 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:18:15 INFO local.LocalScheduler: Finished 18
13/07/27 21:18:15 INFO scheduler.DAGScheduler: Completed ResultTask(0, 18)
13/07/27 21:18:15 INFO local.LocalScheduler: Remove TaskSet 0.0 from pool 
13/07/27 21:18:15 INFO scheduler.DAGScheduler: Stage 0 (count at <console>:15) finished in 11.148 s
13/07/27 21:18:15 INFO spark.SparkContext: Job finished: count at <console>:15, took 11.202565934 s
res0: Long = 500094

scala> 13/07/27 21:18:15 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:18:15 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:18:15 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:18:15 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:18:15 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:18:15 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:18:15 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:18:15 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage/rdd,null}
Killed 1 processes
Killed 1 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting Tachyon @ tachyon-ec2-0
2013-07-27 21:18:17,555 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data
2013-07-27 21:18:17,559 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_log.data
2013-07-27 21:18:18,054 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/data
2013-07-27 21:18:18,066 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/workers

run1 #: 3

restaring tachyon
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Killed 0 processes
Killed 0 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting RamFS: /mnt/ramdisk
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata -Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Starting master @ tachyon-ec2-0
Starting worker @ tachyon-ec2-0

spark-shell count
16316 tachyon.Master
16343 tachyon.Worker

Going to fadvise /mnt/tachyon/hit_data.tsv.1 as mode POSIX_FADV_DONTNEED
offset: 0
length: 525
mode: POSIX_FADV_DONTNEED
WIN
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/ubuntu/work/tachyon/target/tachyon-0.3.0-SNAPSHOT-jar-with-dependencies.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/ubuntu/work/spark/lib_managed/jars/slf4j-log4j12-1.7.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
Welcome to
      ____              __  
     / __/__  ___ _____/ /__
    _\ \/ _ \/ _ `/ __/  '_/
   /___/ .__/\_,_/_/ /_/\_\   version 0.8.0
      /_/                  

Using Scala version 2.9.3 (OpenJDK 64-Bit Server VM, Java 1.7.0_25)
Initializing interpreter...
13/07/27 21:18:24 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:18:24 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:39881
Creating SparkContext...
13/07/27 21:18:33 INFO slf4j.Slf4jEventHandler: Slf4jEventHandler started
13/07/27 21:18:33 INFO spark.SparkEnv: Registering BlockManagerMaster
13/07/27 21:18:33 INFO storage.MemoryStore: MemoryStore started with capacity 1295.4 MB.
13/07/27 21:18:33 INFO storage.DiskStore: Created local directory at /tmp/spark-local-20130727211833-0a20
13/07/27 21:18:33 INFO network.ConnectionManager: Bound socket to port 34446 with id = ConnectionManagerId(tachyon-ec2-0,34446)
13/07/27 21:18:33 INFO storage.BlockManagerMaster: Trying to register BlockManager
13/07/27 21:18:33 INFO storage.BlockManagerMasterActor$BlockManagerInfo: Registering block manager tachyon-ec2-0:34446 with 1295.4 MB RAM
13/07/27 21:18:33 INFO storage.BlockManagerMaster: Registered BlockManager
13/07/27 21:18:33 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:18:33 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:43927
13/07/27 21:18:33 INFO broadcast.HttpBroadcast: Broadcast server started at http://10.151.80.188:43927
13/07/27 21:18:33 INFO spark.SparkEnv: Registering MapOutputTracker
13/07/27 21:18:33 INFO spark.HttpFileServer: HTTP File server directory is /tmp/spark-478577c5-c34a-4275-a8c5-0ad5971b3019
13/07/27 21:18:33 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:18:33 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:54636
13/07/27 21:18:34 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:18:34 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage/rdd,null}
13/07/27 21:18:34 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:18:34 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:18:34 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:18:34 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:18:34 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:18:34 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:18:34 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:18:34 INFO server.AbstractConnector: Started SelectChannelConnector@0.0.0.0:33000
13/07/27 21:18:34 INFO ui.SparkUI: Started Spark Web UI at http://tachyon-ec2-0:33000
Spark context available as sc.
Type in expressions to have them evaluated.
Type :help for more information.

scala> val s = sc.textFile("tachyon://tachyon-ec2-0:19998/hit_data.tsv.1")
13/07/27 21:18:35 INFO storage.MemoryStore: ensureFreeSpace(57342) called with curMem=0, maxMem=1358297825
13/07/27 21:18:35 INFO storage.MemoryStore: Block broadcast_0 stored as values to memory (estimated size 56.0 KB, free 1295.3 MB)
s: spark.RDD[String] = MappedRDD[1] at textFile at <console>:12

scala> s.count()
13/07/27 21:18:35 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
13/07/27 21:18:35 WARN snappy.LoadSnappy: Snappy native library not loaded
13/07/27 21:18:35 INFO : initialize(tachyon://tachyon-ec2-0:19998/hit_data.tsv.1, Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml). Connecting to Tachyon: tachyon://tachyon-ec2-0:19998/hit_data.tsv.1
13/07/27 21:18:35 INFO : Trying to connect master @ tachyon-ec2-0/10.151.80.188:19998
13/07/27 21:18:35 INFO : User registered at the master tachyon-ec2-0/10.151.80.188:19998 got UserId 1
13/07/27 21:18:35 INFO : Trying to get local worker host : tachyon-ec2-0
13/07/27 21:18:35 INFO : Connecting local worker @ tachyon-ec2-0/10.151.80.188:29998
13/07/27 21:18:35 INFO : tachyon://tachyon-ec2-0:19998 tachyon://tachyon-ec2-0:19998 file:///mnt/tachyon
13/07/27 21:18:35 INFO : getFileStatus(/hit_data.tsv.1): HDFS Path: file:/mnt/tachyon/hit_data.tsv.1 TPath: tachyon://tachyon-ec2-0:19998/hit_data.tsv.1
13/07/27 21:18:35 INFO : tachyon.client.TachyonFS@592fa3df file:///mnt/tachyon /hit_data.tsv.1 tachyon.PrefixList@46afb337
13/07/27 21:18:36 INFO : Create tachyon file /hit_data.tsv.1 with file id 2 and checkpoint location file:///mnt/tachyon/hit_data.tsv.1
13/07/27 21:18:36 INFO mapred.FileInputFormat: Total input paths to process : 1
13/07/27 21:18:36 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:18:36 INFO scheduler.DAGScheduler: Got job 0 (count at <console>:15) with 1 output partitions (allowLocal=false)
13/07/27 21:18:36 INFO scheduler.DAGScheduler: Final stage: Stage 0 (count at <console>:15)
13/07/27 21:18:36 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:18:36 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:18:36 INFO scheduler.DAGScheduler: Submitting Stage 0 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:18:36 INFO scheduler.DAGScheduler: Submitting 1 missing tasks from Stage 0 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:18:36 INFO local.LocalTaskSetManager: Size of task 0 is 1494 bytes
13/07/27 21:18:36 INFO local.LocalScheduler: Running 0
13/07/27 21:18:36 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.1, 65536)
13/07/27 21:18:36 INFO : /mnt/ramdisk/tachyonworker/2147483648 is not on local disk.
13/07/27 21:18:36 INFO : Try to find and read from remote workers.
13/07/27 21:18:36 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:18:36 INFO : Folder /mnt/ramdisk/tachyonworker/users/1 was created!
13/07/27 21:18:36 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483648 was created!
13/07/27 21:18:36 INFO local.LocalScheduler: Finished 0
13/07/27 21:18:36 INFO local.LocalScheduler: Remove TaskSet 0.0 from pool 
13/07/27 21:18:36 INFO scheduler.DAGScheduler: Completed ResultTask(0, 0)
13/07/27 21:18:36 INFO scheduler.DAGScheduler: Stage 0 (count at <console>:15) finished in 0.366 s
13/07/27 21:18:36 INFO spark.SparkContext: Job finished: count at <console>:15, took 0.410019075 s
res0: Long = 1

scala> 13/07/27 21:18:36 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:18:36 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:18:36 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:18:36 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:18:36 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:18:36 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:18:36 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:18:36 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage/rdd,null}
Killed 1 processes
Killed 1 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting Tachyon @ tachyon-ec2-0
2013-07-27 21:18:38,484 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data
2013-07-27 21:18:38,488 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_log.data
2013-07-27 21:18:38,980 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/data
2013-07-27 21:18:38,992 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/workers

restaring tachyon
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Killed 0 processes
Killed 0 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting RamFS: /mnt/ramdisk
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata -Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Starting master @ tachyon-ec2-0
Starting worker @ tachyon-ec2-0

spark-shell count
16872 tachyon.Master
16899 tachyon.Worker

Going to fadvise /mnt/tachyon/hit_data.tsv.100 as mode POSIX_FADV_DONTNEED
offset: 0
length: 55735
mode: POSIX_FADV_DONTNEED
WIN
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/ubuntu/work/tachyon/target/tachyon-0.3.0-SNAPSHOT-jar-with-dependencies.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/ubuntu/work/spark/lib_managed/jars/slf4j-log4j12-1.7.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
Welcome to
      ____              __  
     / __/__  ___ _____/ /__
    _\ \/ _ \/ _ `/ __/  '_/
   /___/ .__/\_,_/_/ /_/\_\   version 0.8.0
      /_/                  

Using Scala version 2.9.3 (OpenJDK 64-Bit Server VM, Java 1.7.0_25)
Initializing interpreter...
13/07/27 21:18:45 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:18:45 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:41075
Creating SparkContext...
13/07/27 21:18:54 INFO slf4j.Slf4jEventHandler: Slf4jEventHandler started
13/07/27 21:18:54 INFO spark.SparkEnv: Registering BlockManagerMaster
13/07/27 21:18:54 INFO storage.MemoryStore: MemoryStore started with capacity 1295.4 MB.
13/07/27 21:18:54 INFO storage.DiskStore: Created local directory at /tmp/spark-local-20130727211854-99ca
13/07/27 21:18:54 INFO network.ConnectionManager: Bound socket to port 57479 with id = ConnectionManagerId(tachyon-ec2-0,57479)
13/07/27 21:18:55 INFO storage.BlockManagerMaster: Trying to register BlockManager
13/07/27 21:18:55 INFO storage.BlockManagerMasterActor$BlockManagerInfo: Registering block manager tachyon-ec2-0:57479 with 1295.4 MB RAM
13/07/27 21:18:55 INFO storage.BlockManagerMaster: Registered BlockManager
13/07/27 21:18:55 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:18:55 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:41741
13/07/27 21:18:55 INFO broadcast.HttpBroadcast: Broadcast server started at http://10.151.80.188:41741
13/07/27 21:18:55 INFO spark.SparkEnv: Registering MapOutputTracker
13/07/27 21:18:55 INFO spark.HttpFileServer: HTTP File server directory is /tmp/spark-318e4ac6-8263-42c9-8dad-65ebbc676956
13/07/27 21:18:55 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:18:55 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:59259
13/07/27 21:18:55 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:18:55 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage/rdd,null}
13/07/27 21:18:55 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:18:55 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:18:55 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:18:55 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:18:55 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:18:55 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:18:55 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:18:55 INFO server.AbstractConnector: Started SelectChannelConnector@0.0.0.0:33000
13/07/27 21:18:55 INFO ui.SparkUI: Started Spark Web UI at http://tachyon-ec2-0:33000
Spark context available as sc.
Type in expressions to have them evaluated.
Type :help for more information.

scala> val s = sc.textFile("tachyon://tachyon-ec2-0:19998/hit_data.tsv.100")
13/07/27 21:18:56 INFO storage.MemoryStore: ensureFreeSpace(57350) called with curMem=0, maxMem=1358297825
13/07/27 21:18:56 INFO storage.MemoryStore: Block broadcast_0 stored as values to memory (estimated size 56.0 KB, free 1295.3 MB)
s: spark.RDD[String] = MappedRDD[1] at textFile at <console>:12

scala> s.count()
13/07/27 21:18:56 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
13/07/27 21:18:56 WARN snappy.LoadSnappy: Snappy native library not loaded
13/07/27 21:18:56 INFO : initialize(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100, Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml). Connecting to Tachyon: tachyon://tachyon-ec2-0:19998/hit_data.tsv.100
13/07/27 21:18:56 INFO : Trying to connect master @ tachyon-ec2-0/10.151.80.188:19998
13/07/27 21:18:56 INFO : User registered at the master tachyon-ec2-0/10.151.80.188:19998 got UserId 1
13/07/27 21:18:56 INFO : Trying to get local worker host : tachyon-ec2-0
13/07/27 21:18:56 INFO : Connecting local worker @ tachyon-ec2-0/10.151.80.188:29998
13/07/27 21:18:56 INFO : tachyon://tachyon-ec2-0:19998 tachyon://tachyon-ec2-0:19998 file:///mnt/tachyon
13/07/27 21:18:56 INFO : getFileStatus(/hit_data.tsv.100): HDFS Path: file:/mnt/tachyon/hit_data.tsv.100 TPath: tachyon://tachyon-ec2-0:19998/hit_data.tsv.100
13/07/27 21:18:56 INFO : tachyon.client.TachyonFS@51666b1c file:///mnt/tachyon /hit_data.tsv.100 tachyon.PrefixList@1b022504
13/07/27 21:18:57 INFO : Create tachyon file /hit_data.tsv.100 with file id 2 and checkpoint location file:///mnt/tachyon/hit_data.tsv.100
13/07/27 21:18:57 INFO mapred.FileInputFormat: Total input paths to process : 1
13/07/27 21:18:57 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:18:57 INFO scheduler.DAGScheduler: Got job 0 (count at <console>:15) with 1 output partitions (allowLocal=false)
13/07/27 21:18:57 INFO scheduler.DAGScheduler: Final stage: Stage 0 (count at <console>:15)
13/07/27 21:18:57 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:18:57 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:18:57 INFO scheduler.DAGScheduler: Submitting Stage 0 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:18:57 INFO scheduler.DAGScheduler: Submitting 1 missing tasks from Stage 0 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:18:57 INFO local.LocalTaskSetManager: Size of task 0 is 1496 bytes
13/07/27 21:18:57 INFO local.LocalScheduler: Running 0
13/07/27 21:18:57 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100, 65536)
13/07/27 21:18:57 INFO : /mnt/ramdisk/tachyonworker/2147483648 is not on local disk.
13/07/27 21:18:57 INFO : Try to find and read from remote workers.
13/07/27 21:18:57 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:18:57 INFO : Folder /mnt/ramdisk/tachyonworker/users/1 was created!
13/07/27 21:18:57 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483648 was created!
13/07/27 21:18:57 INFO local.LocalScheduler: Finished 0
13/07/27 21:18:57 INFO scheduler.DAGScheduler: Completed ResultTask(0, 0)
13/07/27 21:18:57 INFO scheduler.DAGScheduler: Stage 0 (count at <console>:15) finished in 0.404 s
13/07/27 21:18:57 INFO local.LocalScheduler: Remove TaskSet 0.0 from pool 
13/07/27 21:18:57 INFO spark.SparkContext: Job finished: count at <console>:15, took 0.449651767 s
res0: Long = 100

scala> 13/07/27 21:18:58 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:18:58 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:18:58 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:18:58 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:18:58 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:18:58 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:18:58 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:18:58 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage/rdd,null}
Killed 1 processes
Killed 1 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting Tachyon @ tachyon-ec2-0
2013-07-27 21:18:59,672 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data
2013-07-27 21:18:59,676 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_log.data
2013-07-27 21:19:00,174 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/data
2013-07-27 21:19:00,185 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/workers

restaring tachyon
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Killed 0 processes
Killed 0 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting RamFS: /mnt/ramdisk
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata -Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Starting master @ tachyon-ec2-0
Starting worker @ tachyon-ec2-0

spark-shell count
17430 tachyon.Master
17457 tachyon.Worker

Going to fadvise /mnt/tachyon/hit_data.tsv.1000 as mode POSIX_FADV_DONTNEED
offset: 0
length: 776400
mode: POSIX_FADV_DONTNEED
WIN
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/ubuntu/work/tachyon/target/tachyon-0.3.0-SNAPSHOT-jar-with-dependencies.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/ubuntu/work/spark/lib_managed/jars/slf4j-log4j12-1.7.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
Welcome to
      ____              __  
     / __/__  ___ _____/ /__
    _\ \/ _ \/ _ `/ __/  '_/
   /___/ .__/\_,_/_/ /_/\_\   version 0.8.0
      /_/                  

Using Scala version 2.9.3 (OpenJDK 64-Bit Server VM, Java 1.7.0_25)
Initializing interpreter...
13/07/27 21:19:06 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:19:06 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:50064
Creating SparkContext...
13/07/27 21:19:15 INFO slf4j.Slf4jEventHandler: Slf4jEventHandler started
13/07/27 21:19:15 INFO spark.SparkEnv: Registering BlockManagerMaster
13/07/27 21:19:15 INFO storage.MemoryStore: MemoryStore started with capacity 1295.4 MB.
13/07/27 21:19:15 INFO storage.DiskStore: Created local directory at /tmp/spark-local-20130727211915-5dfd
13/07/27 21:19:16 INFO network.ConnectionManager: Bound socket to port 57554 with id = ConnectionManagerId(tachyon-ec2-0,57554)
13/07/27 21:19:16 INFO storage.BlockManagerMaster: Trying to register BlockManager
13/07/27 21:19:16 INFO storage.BlockManagerMasterActor$BlockManagerInfo: Registering block manager tachyon-ec2-0:57554 with 1295.4 MB RAM
13/07/27 21:19:16 INFO storage.BlockManagerMaster: Registered BlockManager
13/07/27 21:19:16 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:19:16 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:38963
13/07/27 21:19:16 INFO broadcast.HttpBroadcast: Broadcast server started at http://10.151.80.188:38963
13/07/27 21:19:16 INFO spark.SparkEnv: Registering MapOutputTracker
13/07/27 21:19:16 INFO spark.HttpFileServer: HTTP File server directory is /tmp/spark-ac4840ac-5cdf-4e34-a40f-f33ceb6f4ef3
13/07/27 21:19:16 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:19:16 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:35649
13/07/27 21:19:16 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:19:16 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage/rdd,null}
13/07/27 21:19:16 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:19:16 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:19:16 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:19:16 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:19:16 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:19:16 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:19:16 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:19:16 INFO server.AbstractConnector: Started SelectChannelConnector@0.0.0.0:33000
13/07/27 21:19:16 INFO ui.SparkUI: Started Spark Web UI at http://tachyon-ec2-0:33000
Spark context available as sc.
Type in expressions to have them evaluated.
Type :help for more information.

scala> val s = sc.textFile("tachyon://tachyon-ec2-0:19998/hit_data.tsv.1000")
13/07/27 21:19:17 INFO storage.MemoryStore: ensureFreeSpace(57350) called with curMem=0, maxMem=1358297825
13/07/27 21:19:17 INFO storage.MemoryStore: Block broadcast_0 stored as values to memory (estimated size 56.0 KB, free 1295.3 MB)
s: spark.RDD[String] = MappedRDD[1] at textFile at <console>:12

scala> s.count()
13/07/27 21:19:17 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
13/07/27 21:19:17 WARN snappy.LoadSnappy: Snappy native library not loaded
13/07/27 21:19:17 INFO : initialize(tachyon://tachyon-ec2-0:19998/hit_data.tsv.1000, Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml). Connecting to Tachyon: tachyon://tachyon-ec2-0:19998/hit_data.tsv.1000
13/07/27 21:19:17 INFO : Trying to connect master @ tachyon-ec2-0/10.151.80.188:19998
13/07/27 21:19:17 INFO : User registered at the master tachyon-ec2-0/10.151.80.188:19998 got UserId 1
13/07/27 21:19:17 INFO : Trying to get local worker host : tachyon-ec2-0
13/07/27 21:19:17 INFO : Connecting local worker @ tachyon-ec2-0/10.151.80.188:29998
13/07/27 21:19:17 INFO : tachyon://tachyon-ec2-0:19998 tachyon://tachyon-ec2-0:19998 file:///mnt/tachyon
13/07/27 21:19:17 INFO : getFileStatus(/hit_data.tsv.1000): HDFS Path: file:/mnt/tachyon/hit_data.tsv.1000 TPath: tachyon://tachyon-ec2-0:19998/hit_data.tsv.1000
13/07/27 21:19:17 INFO : tachyon.client.TachyonFS@7c5a8c38 file:///mnt/tachyon /hit_data.tsv.1000 tachyon.PrefixList@1cabf050
13/07/27 21:19:18 INFO : Create tachyon file /hit_data.tsv.1000 with file id 2 and checkpoint location file:///mnt/tachyon/hit_data.tsv.1000
13/07/27 21:19:18 INFO mapred.FileInputFormat: Total input paths to process : 1
13/07/27 21:19:18 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:19:18 INFO scheduler.DAGScheduler: Got job 0 (count at <console>:15) with 1 output partitions (allowLocal=false)
13/07/27 21:19:18 INFO scheduler.DAGScheduler: Final stage: Stage 0 (count at <console>:15)
13/07/27 21:19:18 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:19:18 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:19:18 INFO scheduler.DAGScheduler: Submitting Stage 0 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:19:18 INFO scheduler.DAGScheduler: Submitting 1 missing tasks from Stage 0 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:19:18 INFO local.LocalTaskSetManager: Size of task 0 is 1497 bytes
13/07/27 21:19:18 INFO local.LocalScheduler: Running 0
13/07/27 21:19:18 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.1000, 65536)
13/07/27 21:19:18 INFO : /mnt/ramdisk/tachyonworker/2147483648 is not on local disk.
13/07/27 21:19:18 INFO : Try to find and read from remote workers.
13/07/27 21:19:18 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:19:18 INFO : Folder /mnt/ramdisk/tachyonworker/users/1 was created!
13/07/27 21:19:18 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483648 was created!
13/07/27 21:19:18 INFO local.LocalScheduler: Finished 0
13/07/27 21:19:18 INFO local.LocalScheduler: Remove TaskSet 0.0 from pool 
13/07/27 21:19:18 INFO scheduler.DAGScheduler: Completed ResultTask(0, 0)
13/07/27 21:19:18 INFO scheduler.DAGScheduler: Stage 0 (count at <console>:15) finished in 0.416 s
13/07/27 21:19:18 INFO spark.SparkContext: Job finished: count at <console>:15, took 0.460932923 s
res0: Long = 1000

scala> 13/07/27 21:19:19 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:19:19 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:19:19 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:19:19 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:19:19 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:19:19 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:19:19 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:19:19 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage/rdd,null}
Killed 1 processes
Killed 1 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting Tachyon @ tachyon-ec2-0
2013-07-27 21:19:20,743 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data
2013-07-27 21:19:20,747 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_log.data
2013-07-27 21:19:21,248 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/data
2013-07-27 21:19:21,259 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/workers

restaring tachyon
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Killed 0 processes
Killed 0 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting RamFS: /mnt/ramdisk
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata -Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Starting master @ tachyon-ec2-0
Starting worker @ tachyon-ec2-0

spark-shell count
17988 tachyon.Master
18015 tachyon.Worker

Going to fadvise /mnt/tachyon/hit_data.tsv.10000 as mode POSIX_FADV_DONTNEED
offset: 0
length: 12330369
mode: POSIX_FADV_DONTNEED
WIN
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/ubuntu/work/tachyon/target/tachyon-0.3.0-SNAPSHOT-jar-with-dependencies.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/ubuntu/work/spark/lib_managed/jars/slf4j-log4j12-1.7.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
Welcome to
      ____              __  
     / __/__  ___ _____/ /__
    _\ \/ _ \/ _ `/ __/  '_/
   /___/ .__/\_,_/_/ /_/\_\   version 0.8.0
      /_/                  

Using Scala version 2.9.3 (OpenJDK 64-Bit Server VM, Java 1.7.0_25)
Initializing interpreter...
13/07/27 21:19:27 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:19:27 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:35024
Creating SparkContext...
13/07/27 21:19:36 INFO slf4j.Slf4jEventHandler: Slf4jEventHandler started
13/07/27 21:19:36 INFO spark.SparkEnv: Registering BlockManagerMaster
13/07/27 21:19:37 INFO storage.MemoryStore: MemoryStore started with capacity 1295.4 MB.
13/07/27 21:19:37 INFO storage.DiskStore: Created local directory at /tmp/spark-local-20130727211937-46d5
13/07/27 21:19:37 INFO network.ConnectionManager: Bound socket to port 34185 with id = ConnectionManagerId(tachyon-ec2-0,34185)
13/07/27 21:19:37 INFO storage.BlockManagerMaster: Trying to register BlockManager
13/07/27 21:19:37 INFO storage.BlockManagerMasterActor$BlockManagerInfo: Registering block manager tachyon-ec2-0:34185 with 1295.4 MB RAM
13/07/27 21:19:37 INFO storage.BlockManagerMaster: Registered BlockManager
13/07/27 21:19:37 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:19:37 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:36542
13/07/27 21:19:37 INFO broadcast.HttpBroadcast: Broadcast server started at http://10.151.80.188:36542
13/07/27 21:19:37 INFO spark.SparkEnv: Registering MapOutputTracker
13/07/27 21:19:37 INFO spark.HttpFileServer: HTTP File server directory is /tmp/spark-3ff541e0-3638-4c2f-829d-7cbd3457615b
13/07/27 21:19:37 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:19:37 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:59031
13/07/27 21:19:37 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:19:37 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage/rdd,null}
13/07/27 21:19:37 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:19:37 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:19:37 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:19:37 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:19:37 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:19:37 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:19:37 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:19:37 INFO server.AbstractConnector: Started SelectChannelConnector@0.0.0.0:33000
13/07/27 21:19:37 INFO ui.SparkUI: Started Spark Web UI at http://tachyon-ec2-0:33000
Spark context available as sc.
Type in expressions to have them evaluated.
Type :help for more information.

scala> val s = sc.textFile("tachyon://tachyon-ec2-0:19998/hit_data.tsv.10000")
13/07/27 21:19:38 INFO storage.MemoryStore: ensureFreeSpace(57350) called with curMem=0, maxMem=1358297825
13/07/27 21:19:38 INFO storage.MemoryStore: Block broadcast_0 stored as values to memory (estimated size 56.0 KB, free 1295.3 MB)
s: spark.RDD[String] = MappedRDD[1] at textFile at <console>:12

scala> s.count()
13/07/27 21:19:38 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
13/07/27 21:19:38 WARN snappy.LoadSnappy: Snappy native library not loaded
13/07/27 21:19:38 INFO : initialize(tachyon://tachyon-ec2-0:19998/hit_data.tsv.10000, Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml). Connecting to Tachyon: tachyon://tachyon-ec2-0:19998/hit_data.tsv.10000
13/07/27 21:19:38 INFO : Trying to connect master @ tachyon-ec2-0/10.151.80.188:19998
13/07/27 21:19:38 INFO : User registered at the master tachyon-ec2-0/10.151.80.188:19998 got UserId 1
13/07/27 21:19:38 INFO : Trying to get local worker host : tachyon-ec2-0
13/07/27 21:19:38 INFO : Connecting local worker @ tachyon-ec2-0/10.151.80.188:29998
13/07/27 21:19:38 INFO : tachyon://tachyon-ec2-0:19998 tachyon://tachyon-ec2-0:19998 file:///mnt/tachyon
13/07/27 21:19:38 INFO : getFileStatus(/hit_data.tsv.10000): HDFS Path: file:/mnt/tachyon/hit_data.tsv.10000 TPath: tachyon://tachyon-ec2-0:19998/hit_data.tsv.10000
13/07/27 21:19:38 INFO : tachyon.client.TachyonFS@5390cdba file:///mnt/tachyon /hit_data.tsv.10000 tachyon.PrefixList@47b29932
13/07/27 21:19:39 INFO : Create tachyon file /hit_data.tsv.10000 with file id 2 and checkpoint location file:///mnt/tachyon/hit_data.tsv.10000
13/07/27 21:19:39 INFO mapred.FileInputFormat: Total input paths to process : 1
13/07/27 21:19:39 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:19:39 INFO scheduler.DAGScheduler: Got job 0 (count at <console>:15) with 1 output partitions (allowLocal=false)
13/07/27 21:19:39 INFO scheduler.DAGScheduler: Final stage: Stage 0 (count at <console>:15)
13/07/27 21:19:39 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:19:39 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:19:39 INFO scheduler.DAGScheduler: Submitting Stage 0 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:19:39 INFO scheduler.DAGScheduler: Submitting 1 missing tasks from Stage 0 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:19:39 INFO local.LocalTaskSetManager: Size of task 0 is 1498 bytes
13/07/27 21:19:39 INFO local.LocalScheduler: Running 0
13/07/27 21:19:39 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.10000, 65536)
13/07/27 21:19:39 INFO : /mnt/ramdisk/tachyonworker/2147483648 is not on local disk.
13/07/27 21:19:39 INFO : Try to find and read from remote workers.
13/07/27 21:19:39 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:19:39 INFO : Folder /mnt/ramdisk/tachyonworker/users/1 was created!
13/07/27 21:19:39 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483648 was created!
13/07/27 21:19:40 INFO local.LocalScheduler: Finished 0
13/07/27 21:19:40 INFO local.LocalScheduler: Remove TaskSet 0.0 from pool 
13/07/27 21:19:40 INFO scheduler.DAGScheduler: Completed ResultTask(0, 0)
13/07/27 21:19:40 INFO scheduler.DAGScheduler: Stage 0 (count at <console>:15) finished in 0.660 s
13/07/27 21:19:40 INFO spark.SparkContext: Job finished: count at <console>:15, took 0.703528402 s
res0: Long = 10000

scala> 13/07/27 21:19:40 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:19:40 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:19:40 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:19:40 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:19:40 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:19:40 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:19:40 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:19:40 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage/rdd,null}
Killed 1 processes
Killed 1 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting Tachyon @ tachyon-ec2-0
2013-07-27 21:19:41,870 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data
2013-07-27 21:19:41,874 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_log.data
2013-07-27 21:19:42,362 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/data
2013-07-27 21:19:42,374 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/workers

restaring tachyon
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Killed 0 processes
Killed 0 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting RamFS: /mnt/ramdisk
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata -Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Starting master @ tachyon-ec2-0
Starting worker @ tachyon-ec2-0

spark-shell count
18545 tachyon.Master
18572 tachyon.Worker

Going to fadvise /mnt/tachyon/hit_data.tsv.100000 as mode POSIX_FADV_DONTNEED
offset: 0
length: 125141299
mode: POSIX_FADV_DONTNEED
WIN
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/ubuntu/work/tachyon/target/tachyon-0.3.0-SNAPSHOT-jar-with-dependencies.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/ubuntu/work/spark/lib_managed/jars/slf4j-log4j12-1.7.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
Welcome to
      ____              __  
     / __/__  ___ _____/ /__
    _\ \/ _ \/ _ `/ __/  '_/
   /___/ .__/\_,_/_/ /_/\_\   version 0.8.0
      /_/                  

Using Scala version 2.9.3 (OpenJDK 64-Bit Server VM, Java 1.7.0_25)
Initializing interpreter...
13/07/27 21:19:48 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:19:48 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:42263
Creating SparkContext...
13/07/27 21:19:57 INFO slf4j.Slf4jEventHandler: Slf4jEventHandler started
13/07/27 21:19:58 INFO spark.SparkEnv: Registering BlockManagerMaster
13/07/27 21:19:58 INFO storage.MemoryStore: MemoryStore started with capacity 1295.4 MB.
13/07/27 21:19:58 INFO storage.DiskStore: Created local directory at /tmp/spark-local-20130727211958-69f0
13/07/27 21:19:58 INFO network.ConnectionManager: Bound socket to port 59404 with id = ConnectionManagerId(tachyon-ec2-0,59404)
13/07/27 21:19:58 INFO storage.BlockManagerMaster: Trying to register BlockManager
13/07/27 21:19:58 INFO storage.BlockManagerMasterActor$BlockManagerInfo: Registering block manager tachyon-ec2-0:59404 with 1295.4 MB RAM
13/07/27 21:19:58 INFO storage.BlockManagerMaster: Registered BlockManager
13/07/27 21:19:58 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:19:58 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:36862
13/07/27 21:19:58 INFO broadcast.HttpBroadcast: Broadcast server started at http://10.151.80.188:36862
13/07/27 21:19:58 INFO spark.SparkEnv: Registering MapOutputTracker
13/07/27 21:19:58 INFO spark.HttpFileServer: HTTP File server directory is /tmp/spark-9febf93c-8b55-41bf-88c0-50c734c25101
13/07/27 21:19:58 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:19:58 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:57453
13/07/27 21:19:58 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:19:58 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage/rdd,null}
13/07/27 21:19:58 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:19:58 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:19:58 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:19:58 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:19:58 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:19:58 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:19:58 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:19:58 INFO server.AbstractConnector: Started SelectChannelConnector@0.0.0.0:33000
13/07/27 21:19:58 INFO ui.SparkUI: Started Spark Web UI at http://tachyon-ec2-0:33000
Spark context available as sc.
Type in expressions to have them evaluated.
Type :help for more information.

scala> val s = sc.textFile("tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000")
13/07/27 21:19:59 INFO storage.MemoryStore: ensureFreeSpace(57358) called with curMem=0, maxMem=1358297825
13/07/27 21:19:59 INFO storage.MemoryStore: Block broadcast_0 stored as values to memory (estimated size 56.0 KB, free 1295.3 MB)
s: spark.RDD[String] = MappedRDD[1] at textFile at <console>:12

scala> s.count()
13/07/27 21:19:59 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
13/07/27 21:19:59 WARN snappy.LoadSnappy: Snappy native library not loaded
13/07/27 21:19:59 INFO : initialize(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000, Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml). Connecting to Tachyon: tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000
13/07/27 21:19:59 INFO : Trying to connect master @ tachyon-ec2-0/10.151.80.188:19998
13/07/27 21:19:59 INFO : User registered at the master tachyon-ec2-0/10.151.80.188:19998 got UserId 1
13/07/27 21:19:59 INFO : Trying to get local worker host : tachyon-ec2-0
13/07/27 21:19:59 INFO : Connecting local worker @ tachyon-ec2-0/10.151.80.188:29998
13/07/27 21:20:00 INFO : tachyon://tachyon-ec2-0:19998 tachyon://tachyon-ec2-0:19998 file:///mnt/tachyon
13/07/27 21:20:00 INFO : getFileStatus(/hit_data.tsv.100000): HDFS Path: file:/mnt/tachyon/hit_data.tsv.100000 TPath: tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000
13/07/27 21:20:00 INFO : tachyon.client.TachyonFS@702030d6 file:///mnt/tachyon /hit_data.tsv.100000 tachyon.PrefixList@51666b1c
13/07/27 21:20:00 INFO : Create tachyon file /hit_data.tsv.100000 with file id 2 and checkpoint location file:///mnt/tachyon/hit_data.tsv.100000
13/07/27 21:20:00 INFO mapred.FileInputFormat: Total input paths to process : 1
13/07/27 21:20:00 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:20:00 INFO scheduler.DAGScheduler: Got job 0 (count at <console>:15) with 4 output partitions (allowLocal=false)
13/07/27 21:20:00 INFO scheduler.DAGScheduler: Final stage: Stage 0 (count at <console>:15)
13/07/27 21:20:00 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:20:00 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:20:00 INFO scheduler.DAGScheduler: Submitting Stage 0 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:20:00 INFO scheduler.DAGScheduler: Submitting 4 missing tasks from Stage 0 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:20:00 INFO local.LocalTaskSetManager: Size of task 0 is 1499 bytes
13/07/27 21:20:00 INFO local.LocalScheduler: Running 0
13/07/27 21:20:00 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000, 65536)
13/07/27 21:20:00 INFO : /mnt/ramdisk/tachyonworker/2147483648 is not on local disk.
13/07/27 21:20:00 INFO : Try to find and read from remote workers.
13/07/27 21:20:00 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:20:00 INFO : Folder /mnt/ramdisk/tachyonworker/users/1 was created!
13/07/27 21:20:00 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483648 was created!
13/07/27 21:20:01 INFO : /mnt/ramdisk/tachyonworker/2147483649 is not on local disk.
13/07/27 21:20:01 INFO : Try to find and read from remote workers.
13/07/27 21:20:01 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:20:01 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483649 was created!
13/07/27 21:20:02 INFO local.LocalScheduler: Finished 0
13/07/27 21:20:02 INFO local.LocalTaskSetManager: Size of task 1 is 1499 bytes
13/07/27 21:20:02 INFO local.LocalScheduler: Running 1
13/07/27 21:20:02 INFO scheduler.DAGScheduler: Completed ResultTask(0, 0)
13/07/27 21:20:02 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000, 65536)
13/07/27 21:20:02 INFO : /mnt/ramdisk/tachyonworker/2147483650 is not on local disk.
13/07/27 21:20:02 INFO : Try to find and read from remote workers.
13/07/27 21:20:02 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:20:02 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483650 was created!
13/07/27 21:20:02 INFO local.LocalScheduler: Finished 1
13/07/27 21:20:02 INFO scheduler.DAGScheduler: Completed ResultTask(0, 1)
13/07/27 21:20:02 INFO local.LocalTaskSetManager: Size of task 2 is 1499 bytes
13/07/27 21:20:02 INFO local.LocalScheduler: Running 2
13/07/27 21:20:02 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000, 65536)
13/07/27 21:20:03 INFO : /mnt/ramdisk/tachyonworker/2147483651 is not on local disk.
13/07/27 21:20:03 INFO : Try to find and read from remote workers.
13/07/27 21:20:03 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:20:03 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483651 was created!
13/07/27 21:20:03 INFO local.LocalScheduler: Finished 2
13/07/27 21:20:03 INFO scheduler.DAGScheduler: Completed ResultTask(0, 2)
13/07/27 21:20:03 INFO local.LocalTaskSetManager: Size of task 3 is 1499 bytes
13/07/27 21:20:03 INFO local.LocalScheduler: Running 3
13/07/27 21:20:03 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000, 65536)
13/07/27 21:20:03 INFO local.LocalScheduler: Finished 3
13/07/27 21:20:03 INFO scheduler.DAGScheduler: Completed ResultTask(0, 3)
13/07/27 21:20:03 INFO local.LocalScheduler: Remove TaskSet 0.0 from pool 
13/07/27 21:20:03 INFO scheduler.DAGScheduler: Stage 0 (count at <console>:15) finished in 2.912 s
13/07/27 21:20:03 INFO spark.SparkContext: Job finished: count at <console>:15, took 2.956893665 s
res0: Long = 100002

scala> 13/07/27 21:20:03 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:20:03 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:20:03 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:20:03 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:20:03 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:20:03 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:20:03 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:20:03 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage/rdd,null}
Killed 1 processes
Killed 1 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting Tachyon @ tachyon-ec2-0
2013-07-27 21:20:05,316 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data
2013-07-27 21:20:05,320 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_log.data
2013-07-27 21:20:05,814 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/data
2013-07-27 21:20:05,826 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/workers

restaring tachyon
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Killed 0 processes
Killed 0 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting RamFS: /mnt/ramdisk
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata -Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Starting master @ tachyon-ec2-0
Starting worker @ tachyon-ec2-0

spark-shell count
19183 tachyon.Master
19210 tachyon.Worker

Going to fadvise /mnt/tachyon/hit_data.tsv.500000 as mode POSIX_FADV_DONTNEED
offset: 0
length: 618418417
mode: POSIX_FADV_DONTNEED
WIN
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/ubuntu/work/tachyon/target/tachyon-0.3.0-SNAPSHOT-jar-with-dependencies.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/ubuntu/work/spark/lib_managed/jars/slf4j-log4j12-1.7.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
Welcome to
      ____              __  
     / __/__  ___ _____/ /__
    _\ \/ _ \/ _ `/ __/  '_/
   /___/ .__/\_,_/_/ /_/\_\   version 0.8.0
      /_/                  

Using Scala version 2.9.3 (OpenJDK 64-Bit Server VM, Java 1.7.0_25)
Initializing interpreter...
13/07/27 21:20:12 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:20:12 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:58581
Creating SparkContext...
13/07/27 21:20:21 INFO slf4j.Slf4jEventHandler: Slf4jEventHandler started
13/07/27 21:20:21 INFO spark.SparkEnv: Registering BlockManagerMaster
13/07/27 21:20:21 INFO storage.MemoryStore: MemoryStore started with capacity 1295.4 MB.
13/07/27 21:20:21 INFO storage.DiskStore: Created local directory at /tmp/spark-local-20130727212021-7d0b
13/07/27 21:20:21 INFO network.ConnectionManager: Bound socket to port 57940 with id = ConnectionManagerId(tachyon-ec2-0,57940)
13/07/27 21:20:21 INFO storage.BlockManagerMaster: Trying to register BlockManager
13/07/27 21:20:21 INFO storage.BlockManagerMasterActor$BlockManagerInfo: Registering block manager tachyon-ec2-0:57940 with 1295.4 MB RAM
13/07/27 21:20:21 INFO storage.BlockManagerMaster: Registered BlockManager
13/07/27 21:20:21 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:20:21 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:52602
13/07/27 21:20:21 INFO broadcast.HttpBroadcast: Broadcast server started at http://10.151.80.188:52602
13/07/27 21:20:21 INFO spark.SparkEnv: Registering MapOutputTracker
13/07/27 21:20:21 INFO spark.HttpFileServer: HTTP File server directory is /tmp/spark-5c6f648d-56ab-4515-ba29-2ceb9a96234a
13/07/27 21:20:21 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:20:21 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:54138
13/07/27 21:20:21 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:20:21 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage/rdd,null}
13/07/27 21:20:21 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:20:21 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:20:21 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:20:21 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:20:21 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:20:21 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:20:21 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:20:21 INFO server.AbstractConnector: Started SelectChannelConnector@0.0.0.0:33000
13/07/27 21:20:21 INFO ui.SparkUI: Started Spark Web UI at http://tachyon-ec2-0:33000
Spark context available as sc.
Type in expressions to have them evaluated.
Type :help for more information.

scala> val s = sc.textFile("tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000")
13/07/27 21:20:23 INFO storage.MemoryStore: ensureFreeSpace(57358) called with curMem=0, maxMem=1358297825
13/07/27 21:20:23 INFO storage.MemoryStore: Block broadcast_0 stored as values to memory (estimated size 56.0 KB, free 1295.3 MB)
s: spark.RDD[String] = MappedRDD[1] at textFile at <console>:12

scala> s.count()
13/07/27 21:20:23 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
13/07/27 21:20:23 WARN snappy.LoadSnappy: Snappy native library not loaded
13/07/27 21:20:23 INFO : initialize(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml). Connecting to Tachyon: tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000
13/07/27 21:20:23 INFO : Trying to connect master @ tachyon-ec2-0/10.151.80.188:19998
13/07/27 21:20:23 INFO : User registered at the master tachyon-ec2-0/10.151.80.188:19998 got UserId 1
13/07/27 21:20:23 INFO : Trying to get local worker host : tachyon-ec2-0
13/07/27 21:20:23 INFO : Connecting local worker @ tachyon-ec2-0/10.151.80.188:29998
13/07/27 21:20:23 INFO : tachyon://tachyon-ec2-0:19998 tachyon://tachyon-ec2-0:19998 file:///mnt/tachyon
13/07/27 21:20:23 INFO : getFileStatus(/hit_data.tsv.500000): HDFS Path: file:/mnt/tachyon/hit_data.tsv.500000 TPath: tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000
13/07/27 21:20:23 INFO : tachyon.client.TachyonFS@6657a2c8 file:///mnt/tachyon /hit_data.tsv.500000 tachyon.PrefixList@3802cf6
13/07/27 21:20:23 INFO : Create tachyon file /hit_data.tsv.500000 with file id 2 and checkpoint location file:///mnt/tachyon/hit_data.tsv.500000
13/07/27 21:20:23 INFO mapred.FileInputFormat: Total input paths to process : 1
13/07/27 21:20:24 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:20:24 INFO scheduler.DAGScheduler: Got job 0 (count at <console>:15) with 19 output partitions (allowLocal=false)
13/07/27 21:20:24 INFO scheduler.DAGScheduler: Final stage: Stage 0 (count at <console>:15)
13/07/27 21:20:24 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:20:24 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:20:24 INFO scheduler.DAGScheduler: Submitting Stage 0 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:20:24 INFO scheduler.DAGScheduler: Submitting 19 missing tasks from Stage 0 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:20:24 INFO local.LocalTaskSetManager: Size of task 0 is 1499 bytes
13/07/27 21:20:24 INFO local.LocalScheduler: Running 0
13/07/27 21:20:24 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:20:24 INFO : /mnt/ramdisk/tachyonworker/2147483648 is not on local disk.
13/07/27 21:20:24 INFO : Try to find and read from remote workers.
13/07/27 21:20:24 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:20:24 INFO : Folder /mnt/ramdisk/tachyonworker/users/1 was created!
13/07/27 21:20:24 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483648 was created!
13/07/27 21:20:25 INFO : /mnt/ramdisk/tachyonworker/2147483649 is not on local disk.
13/07/27 21:20:25 INFO : Try to find and read from remote workers.
13/07/27 21:20:25 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:20:25 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483649 was created!
13/07/27 21:20:25 INFO local.LocalScheduler: Finished 0
13/07/27 21:20:25 INFO local.LocalTaskSetManager: Size of task 1 is 1499 bytes
13/07/27 21:20:25 INFO local.LocalScheduler: Running 1
13/07/27 21:20:25 INFO scheduler.DAGScheduler: Completed ResultTask(0, 0)
13/07/27 21:20:25 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:20:25 INFO : /mnt/ramdisk/tachyonworker/2147483650 is not on local disk.
13/07/27 21:20:25 INFO : Try to find and read from remote workers.
13/07/27 21:20:25 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:20:25 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483650 was created!
13/07/27 21:20:26 INFO local.LocalScheduler: Finished 1
13/07/27 21:20:26 INFO scheduler.DAGScheduler: Completed ResultTask(0, 1)
13/07/27 21:20:26 INFO local.LocalTaskSetManager: Size of task 2 is 1499 bytes
13/07/27 21:20:26 INFO local.LocalScheduler: Running 2
13/07/27 21:20:26 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:20:26 INFO : /mnt/ramdisk/tachyonworker/2147483651 is not on local disk.
13/07/27 21:20:26 INFO : Try to find and read from remote workers.
13/07/27 21:20:26 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:20:26 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483651 was created!
13/07/27 21:20:27 INFO local.LocalScheduler: Finished 2
13/07/27 21:20:27 INFO scheduler.DAGScheduler: Completed ResultTask(0, 2)
13/07/27 21:20:27 INFO local.LocalTaskSetManager: Size of task 3 is 1499 bytes
13/07/27 21:20:27 INFO local.LocalScheduler: Running 3
13/07/27 21:20:27 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:20:27 INFO : /mnt/ramdisk/tachyonworker/2147483652 is not on local disk.
13/07/27 21:20:27 INFO : Try to find and read from remote workers.
13/07/27 21:20:27 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:20:27 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483652 was created!
13/07/27 21:20:27 INFO local.LocalScheduler: Finished 3
13/07/27 21:20:27 INFO scheduler.DAGScheduler: Completed ResultTask(0, 3)
13/07/27 21:20:27 INFO local.LocalTaskSetManager: Size of task 4 is 1499 bytes
13/07/27 21:20:27 INFO local.LocalScheduler: Running 4
13/07/27 21:20:27 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:20:27 INFO : /mnt/ramdisk/tachyonworker/2147483653 is not on local disk.
13/07/27 21:20:27 INFO : Try to find and read from remote workers.
13/07/27 21:20:27 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:20:27 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483653 was created!
13/07/27 21:20:28 INFO local.LocalScheduler: Finished 4
13/07/27 21:20:28 INFO scheduler.DAGScheduler: Completed ResultTask(0, 4)
13/07/27 21:20:28 INFO local.LocalTaskSetManager: Size of task 5 is 1499 bytes
13/07/27 21:20:28 INFO local.LocalScheduler: Running 5
13/07/27 21:20:28 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:20:28 INFO : /mnt/ramdisk/tachyonworker/2147483654 is not on local disk.
13/07/27 21:20:28 INFO : Try to find and read from remote workers.
13/07/27 21:20:28 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:20:28 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483654 was created!
13/07/27 21:20:28 INFO local.LocalScheduler: Finished 5
13/07/27 21:20:28 INFO scheduler.DAGScheduler: Completed ResultTask(0, 5)
13/07/27 21:20:28 INFO local.LocalTaskSetManager: Size of task 6 is 1499 bytes
13/07/27 21:20:28 INFO local.LocalScheduler: Running 6
13/07/27 21:20:28 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:20:29 INFO : /mnt/ramdisk/tachyonworker/2147483655 is not on local disk.
13/07/27 21:20:29 INFO : Try to find and read from remote workers.
13/07/27 21:20:29 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:20:29 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483655 was created!
13/07/27 21:20:29 INFO local.LocalScheduler: Finished 6
13/07/27 21:20:29 INFO scheduler.DAGScheduler: Completed ResultTask(0, 6)
13/07/27 21:20:29 INFO local.LocalTaskSetManager: Size of task 7 is 1499 bytes
13/07/27 21:20:29 INFO local.LocalScheduler: Running 7
13/07/27 21:20:29 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:20:29 INFO : /mnt/ramdisk/tachyonworker/2147483656 is not on local disk.
13/07/27 21:20:29 INFO : Try to find and read from remote workers.
13/07/27 21:20:29 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:20:29 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483656 was created!
13/07/27 21:20:29 INFO local.LocalScheduler: Finished 7
13/07/27 21:20:29 INFO scheduler.DAGScheduler: Completed ResultTask(0, 7)
13/07/27 21:20:29 INFO local.LocalTaskSetManager: Size of task 8 is 1499 bytes
13/07/27 21:20:29 INFO local.LocalScheduler: Running 8
13/07/27 21:20:30 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:20:30 INFO : /mnt/ramdisk/tachyonworker/2147483657 is not on local disk.
13/07/27 21:20:30 INFO : Try to find and read from remote workers.
13/07/27 21:20:30 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:20:30 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483657 was created!
13/07/27 21:20:30 INFO local.LocalScheduler: Finished 8
13/07/27 21:20:30 INFO scheduler.DAGScheduler: Completed ResultTask(0, 8)
13/07/27 21:20:30 INFO local.LocalTaskSetManager: Size of task 9 is 1499 bytes
13/07/27 21:20:30 INFO local.LocalScheduler: Running 9
13/07/27 21:20:30 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:20:30 INFO : /mnt/ramdisk/tachyonworker/2147483658 is not on local disk.
13/07/27 21:20:30 INFO : Try to find and read from remote workers.
13/07/27 21:20:30 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:20:30 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483658 was created!
13/07/27 21:20:31 INFO local.LocalScheduler: Finished 9
13/07/27 21:20:31 INFO scheduler.DAGScheduler: Completed ResultTask(0, 9)
13/07/27 21:20:31 INFO local.LocalTaskSetManager: Size of task 10 is 1499 bytes
13/07/27 21:20:31 INFO local.LocalScheduler: Running 10
13/07/27 21:20:31 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:20:31 INFO : /mnt/ramdisk/tachyonworker/2147483659 is not on local disk.
13/07/27 21:20:31 INFO : Try to find and read from remote workers.
13/07/27 21:20:31 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:20:31 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483659 was created!
13/07/27 21:20:31 INFO local.LocalScheduler: Finished 10
13/07/27 21:20:31 INFO scheduler.DAGScheduler: Completed ResultTask(0, 10)
13/07/27 21:20:31 INFO local.LocalTaskSetManager: Size of task 11 is 1499 bytes
13/07/27 21:20:31 INFO local.LocalScheduler: Running 11
13/07/27 21:20:31 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:20:32 INFO : /mnt/ramdisk/tachyonworker/2147483660 is not on local disk.
13/07/27 21:20:32 INFO : Try to find and read from remote workers.
13/07/27 21:20:32 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:20:32 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483660 was created!
13/07/27 21:20:32 INFO local.LocalScheduler: Finished 11
13/07/27 21:20:32 INFO scheduler.DAGScheduler: Completed ResultTask(0, 11)
13/07/27 21:20:32 INFO local.LocalTaskSetManager: Size of task 12 is 1499 bytes
13/07/27 21:20:32 INFO local.LocalScheduler: Running 12
13/07/27 21:20:32 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:20:32 INFO : /mnt/ramdisk/tachyonworker/2147483661 is not on local disk.
13/07/27 21:20:32 INFO : Try to find and read from remote workers.
13/07/27 21:20:32 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:20:32 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483661 was created!
13/07/27 21:20:33 INFO local.LocalScheduler: Finished 12
13/07/27 21:20:33 INFO scheduler.DAGScheduler: Completed ResultTask(0, 12)
13/07/27 21:20:33 INFO local.LocalTaskSetManager: Size of task 13 is 1499 bytes
13/07/27 21:20:33 INFO local.LocalScheduler: Running 13
13/07/27 21:20:33 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:20:33 INFO : /mnt/ramdisk/tachyonworker/2147483662 is not on local disk.
13/07/27 21:20:33 INFO : Try to find and read from remote workers.
13/07/27 21:20:33 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:20:33 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483662 was created!
13/07/27 21:20:33 INFO local.LocalScheduler: Finished 13
13/07/27 21:20:33 INFO scheduler.DAGScheduler: Completed ResultTask(0, 13)
13/07/27 21:20:33 INFO local.LocalTaskSetManager: Size of task 14 is 1499 bytes
13/07/27 21:20:33 INFO local.LocalScheduler: Running 14
13/07/27 21:20:33 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:20:33 INFO : /mnt/ramdisk/tachyonworker/2147483663 is not on local disk.
13/07/27 21:20:33 INFO : Try to find and read from remote workers.
13/07/27 21:20:33 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:20:33 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483663 was created!
13/07/27 21:20:34 INFO local.LocalScheduler: Finished 14
13/07/27 21:20:34 INFO scheduler.DAGScheduler: Completed ResultTask(0, 14)
13/07/27 21:20:34 INFO local.LocalTaskSetManager: Size of task 15 is 1499 bytes
13/07/27 21:20:34 INFO local.LocalScheduler: Running 15
13/07/27 21:20:34 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:20:34 INFO : /mnt/ramdisk/tachyonworker/2147483664 is not on local disk.
13/07/27 21:20:34 INFO : Try to find and read from remote workers.
13/07/27 21:20:34 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:20:34 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483664 was created!
13/07/27 21:20:34 INFO local.LocalScheduler: Finished 15
13/07/27 21:20:34 INFO scheduler.DAGScheduler: Completed ResultTask(0, 15)
13/07/27 21:20:34 INFO local.LocalTaskSetManager: Size of task 16 is 1499 bytes
13/07/27 21:20:34 INFO local.LocalScheduler: Running 16
13/07/27 21:20:34 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:20:35 INFO : /mnt/ramdisk/tachyonworker/2147483665 is not on local disk.
13/07/27 21:20:35 INFO : Try to find and read from remote workers.
13/07/27 21:20:35 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:20:35 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483665 was created!
13/07/27 21:20:35 INFO local.LocalScheduler: Finished 16
13/07/27 21:20:35 INFO scheduler.DAGScheduler: Completed ResultTask(0, 16)
13/07/27 21:20:35 INFO local.LocalTaskSetManager: Size of task 17 is 1499 bytes
13/07/27 21:20:35 INFO local.LocalScheduler: Running 17
13/07/27 21:20:35 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:20:35 INFO : /mnt/ramdisk/tachyonworker/2147483666 is not on local disk.
13/07/27 21:20:35 INFO : Try to find and read from remote workers.
13/07/27 21:20:35 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:20:35 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483666 was created!
13/07/27 21:20:35 INFO local.LocalScheduler: Finished 17
13/07/27 21:20:35 INFO scheduler.DAGScheduler: Completed ResultTask(0, 17)
13/07/27 21:20:35 INFO local.LocalTaskSetManager: Size of task 18 is 1499 bytes
13/07/27 21:20:35 INFO local.LocalScheduler: Running 18
13/07/27 21:20:35 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:20:35 INFO local.LocalScheduler: Finished 18
13/07/27 21:20:35 INFO scheduler.DAGScheduler: Completed ResultTask(0, 18)
13/07/27 21:20:35 INFO local.LocalScheduler: Remove TaskSet 0.0 from pool 
13/07/27 21:20:35 INFO scheduler.DAGScheduler: Stage 0 (count at <console>:15) finished in 11.394 s
13/07/27 21:20:35 INFO spark.SparkContext: Job finished: count at <console>:15, took 11.445046978 s
res0: Long = 500094

scala> 13/07/27 21:20:35 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:20:35 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:20:35 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:20:35 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:20:35 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:20:35 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:20:35 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:20:35 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage/rdd,null}
Killed 1 processes
Killed 1 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting Tachyon @ tachyon-ec2-0
2013-07-27 21:20:37,638 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data
2013-07-27 21:20:37,642 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_log.data
2013-07-27 21:20:38,131 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/data
2013-07-27 21:20:38,143 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/workers

run1 #: 4

restaring tachyon
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Killed 0 processes
Killed 0 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting RamFS: /mnt/ramdisk
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata -Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Starting master @ tachyon-ec2-0
Starting worker @ tachyon-ec2-0

spark-shell count
19971 tachyon.Master
19998 tachyon.Worker

Going to fadvise /mnt/tachyon/hit_data.tsv.1 as mode POSIX_FADV_DONTNEED
offset: 0
length: 525
mode: POSIX_FADV_DONTNEED
WIN
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/ubuntu/work/tachyon/target/tachyon-0.3.0-SNAPSHOT-jar-with-dependencies.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/ubuntu/work/spark/lib_managed/jars/slf4j-log4j12-1.7.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
Welcome to
      ____              __  
     / __/__  ___ _____/ /__
    _\ \/ _ \/ _ `/ __/  '_/
   /___/ .__/\_,_/_/ /_/\_\   version 0.8.0
      /_/                  

Using Scala version 2.9.3 (OpenJDK 64-Bit Server VM, Java 1.7.0_25)
Initializing interpreter...
13/07/27 21:20:44 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:20:44 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:36103
Creating SparkContext...
13/07/27 21:20:53 INFO slf4j.Slf4jEventHandler: Slf4jEventHandler started
13/07/27 21:20:53 INFO spark.SparkEnv: Registering BlockManagerMaster
13/07/27 21:20:53 INFO storage.MemoryStore: MemoryStore started with capacity 1295.4 MB.
13/07/27 21:20:53 INFO storage.DiskStore: Created local directory at /tmp/spark-local-20130727212053-8bc4
13/07/27 21:20:53 INFO network.ConnectionManager: Bound socket to port 57613 with id = ConnectionManagerId(tachyon-ec2-0,57613)
13/07/27 21:20:53 INFO storage.BlockManagerMaster: Trying to register BlockManager
13/07/27 21:20:53 INFO storage.BlockManagerMasterActor$BlockManagerInfo: Registering block manager tachyon-ec2-0:57613 with 1295.4 MB RAM
13/07/27 21:20:53 INFO storage.BlockManagerMaster: Registered BlockManager
13/07/27 21:20:54 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:20:54 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:59342
13/07/27 21:20:54 INFO broadcast.HttpBroadcast: Broadcast server started at http://10.151.80.188:59342
13/07/27 21:20:54 INFO spark.SparkEnv: Registering MapOutputTracker
13/07/27 21:20:54 INFO spark.HttpFileServer: HTTP File server directory is /tmp/spark-9eadb13e-f5a1-4886-aece-8fabac07081a
13/07/27 21:20:54 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:20:54 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:50168
13/07/27 21:20:54 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:20:54 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage/rdd,null}
13/07/27 21:20:54 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:20:54 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:20:54 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:20:54 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:20:54 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:20:54 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:20:54 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:20:54 INFO server.AbstractConnector: Started SelectChannelConnector@0.0.0.0:33000
13/07/27 21:20:54 INFO ui.SparkUI: Started Spark Web UI at http://tachyon-ec2-0:33000
Spark context available as sc.
Type in expressions to have them evaluated.
Type :help for more information.

scala> val s = sc.textFile("tachyon://tachyon-ec2-0:19998/hit_data.tsv.1")
13/07/27 21:20:55 INFO storage.MemoryStore: ensureFreeSpace(58415) called with curMem=0, maxMem=1358297825
13/07/27 21:20:55 INFO storage.MemoryStore: Block broadcast_0 stored as values to memory (estimated size 57.0 KB, free 1295.3 MB)
s: spark.RDD[String] = MappedRDD[1] at textFile at <console>:12

scala> s.count()
13/07/27 21:20:55 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
13/07/27 21:20:55 WARN snappy.LoadSnappy: Snappy native library not loaded
13/07/27 21:20:55 INFO : initialize(tachyon://tachyon-ec2-0:19998/hit_data.tsv.1, Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml). Connecting to Tachyon: tachyon://tachyon-ec2-0:19998/hit_data.tsv.1
13/07/27 21:20:55 INFO : Trying to connect master @ tachyon-ec2-0/10.151.80.188:19998
13/07/27 21:20:55 INFO : User registered at the master tachyon-ec2-0/10.151.80.188:19998 got UserId 1
13/07/27 21:20:55 INFO : Trying to get local worker host : tachyon-ec2-0
13/07/27 21:20:55 INFO : Connecting local worker @ tachyon-ec2-0/10.151.80.188:29998
13/07/27 21:20:55 INFO : tachyon://tachyon-ec2-0:19998 tachyon://tachyon-ec2-0:19998 file:///mnt/tachyon
13/07/27 21:20:55 INFO : getFileStatus(/hit_data.tsv.1): HDFS Path: file:/mnt/tachyon/hit_data.tsv.1 TPath: tachyon://tachyon-ec2-0:19998/hit_data.tsv.1
13/07/27 21:20:55 INFO : tachyon.client.TachyonFS@49d047d6 file:///mnt/tachyon /hit_data.tsv.1 tachyon.PrefixList@91c5876
13/07/27 21:20:56 INFO : Create tachyon file /hit_data.tsv.1 with file id 2 and checkpoint location file:///mnt/tachyon/hit_data.tsv.1
13/07/27 21:20:56 INFO mapred.FileInputFormat: Total input paths to process : 1
13/07/27 21:20:56 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:20:56 INFO scheduler.DAGScheduler: Got job 0 (count at <console>:15) with 1 output partitions (allowLocal=false)
13/07/27 21:20:56 INFO scheduler.DAGScheduler: Final stage: Stage 0 (count at <console>:15)
13/07/27 21:20:56 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:20:56 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:20:56 INFO scheduler.DAGScheduler: Submitting Stage 0 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:20:56 INFO scheduler.DAGScheduler: Submitting 1 missing tasks from Stage 0 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:20:56 INFO local.LocalTaskSetManager: Size of task 0 is 1494 bytes
13/07/27 21:20:56 INFO local.LocalScheduler: Running 0
13/07/27 21:20:56 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.1, 65536)
13/07/27 21:20:56 INFO : /mnt/ramdisk/tachyonworker/2147483648 is not on local disk.
13/07/27 21:20:56 INFO : Try to find and read from remote workers.
13/07/27 21:20:56 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:20:56 INFO : Folder /mnt/ramdisk/tachyonworker/users/1 was created!
13/07/27 21:20:56 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483648 was created!
13/07/27 21:20:56 INFO local.LocalScheduler: Finished 0
13/07/27 21:20:56 INFO local.LocalScheduler: Remove TaskSet 0.0 from pool 
13/07/27 21:20:56 INFO scheduler.DAGScheduler: Completed ResultTask(0, 0)
13/07/27 21:20:56 INFO scheduler.DAGScheduler: Stage 0 (count at <console>:15) finished in 0.358 s
13/07/27 21:20:56 INFO spark.SparkContext: Job finished: count at <console>:15, took 0.401909401 s
res0: Long = 1

scala> 13/07/27 21:20:56 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:20:56 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:20:56 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:20:56 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:20:56 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:20:56 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:20:56 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:20:56 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage/rdd,null}
Killed 1 processes
Killed 1 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting Tachyon @ tachyon-ec2-0
2013-07-27 21:20:58,478 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data
2013-07-27 21:20:58,482 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_log.data
2013-07-27 21:20:58,974 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/data
2013-07-27 21:20:58,986 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/workers

restaring tachyon
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Killed 0 processes
Killed 0 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting RamFS: /mnt/ramdisk
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata -Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Starting master @ tachyon-ec2-0
Starting worker @ tachyon-ec2-0

spark-shell count
20539 tachyon.Master
20566 tachyon.Worker

Going to fadvise /mnt/tachyon/hit_data.tsv.100 as mode POSIX_FADV_DONTNEED
offset: 0
length: 55735
mode: POSIX_FADV_DONTNEED
WIN
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/ubuntu/work/tachyon/target/tachyon-0.3.0-SNAPSHOT-jar-with-dependencies.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/ubuntu/work/spark/lib_managed/jars/slf4j-log4j12-1.7.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
Welcome to
      ____              __  
     / __/__  ___ _____/ /__
    _\ \/ _ \/ _ `/ __/  '_/
   /___/ .__/\_,_/_/ /_/\_\   version 0.8.0
      /_/                  

Using Scala version 2.9.3 (OpenJDK 64-Bit Server VM, Java 1.7.0_25)
Initializing interpreter...
13/07/27 21:21:05 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:21:05 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:33011
Creating SparkContext...
13/07/27 21:21:14 INFO slf4j.Slf4jEventHandler: Slf4jEventHandler started
13/07/27 21:21:14 INFO spark.SparkEnv: Registering BlockManagerMaster
13/07/27 21:21:14 INFO storage.MemoryStore: MemoryStore started with capacity 1295.4 MB.
13/07/27 21:21:14 INFO storage.DiskStore: Created local directory at /tmp/spark-local-20130727212114-0055
13/07/27 21:21:14 INFO network.ConnectionManager: Bound socket to port 41625 with id = ConnectionManagerId(tachyon-ec2-0,41625)
13/07/27 21:21:14 INFO storage.BlockManagerMaster: Trying to register BlockManager
13/07/27 21:21:14 INFO storage.BlockManagerMasterActor$BlockManagerInfo: Registering block manager tachyon-ec2-0:41625 with 1295.4 MB RAM
13/07/27 21:21:14 INFO storage.BlockManagerMaster: Registered BlockManager
13/07/27 21:21:14 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:21:14 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:60449
13/07/27 21:21:14 INFO broadcast.HttpBroadcast: Broadcast server started at http://10.151.80.188:60449
13/07/27 21:21:14 INFO spark.SparkEnv: Registering MapOutputTracker
13/07/27 21:21:14 INFO spark.HttpFileServer: HTTP File server directory is /tmp/spark-2e6aba84-bfae-4d3c-b1e4-ce859ebb2103
13/07/27 21:21:14 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:21:14 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:47141
13/07/27 21:21:14 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:21:14 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage/rdd,null}
13/07/27 21:21:14 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:21:14 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:21:14 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:21:14 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:21:14 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:21:14 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:21:14 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:21:14 INFO server.AbstractConnector: Started SelectChannelConnector@0.0.0.0:33000
13/07/27 21:21:14 INFO ui.SparkUI: Started Spark Web UI at http://tachyon-ec2-0:33000
Spark context available as sc.
Type in expressions to have them evaluated.
Type :help for more information.

scala> val s = sc.textFile("tachyon://tachyon-ec2-0:19998/hit_data.tsv.100")
13/07/27 21:21:16 INFO storage.MemoryStore: ensureFreeSpace(58423) called with curMem=0, maxMem=1358297825
13/07/27 21:21:16 INFO storage.MemoryStore: Block broadcast_0 stored as values to memory (estimated size 57.1 KB, free 1295.3 MB)
s: spark.RDD[String] = MappedRDD[1] at textFile at <console>:12

scala> s.count()
13/07/27 21:21:16 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
13/07/27 21:21:16 WARN snappy.LoadSnappy: Snappy native library not loaded
13/07/27 21:21:16 INFO : initialize(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100, Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml). Connecting to Tachyon: tachyon://tachyon-ec2-0:19998/hit_data.tsv.100
13/07/27 21:21:16 INFO : Trying to connect master @ tachyon-ec2-0/10.151.80.188:19998
13/07/27 21:21:16 INFO : User registered at the master tachyon-ec2-0/10.151.80.188:19998 got UserId 1
13/07/27 21:21:16 INFO : Trying to get local worker host : tachyon-ec2-0
13/07/27 21:21:16 INFO : Connecting local worker @ tachyon-ec2-0/10.151.80.188:29998
13/07/27 21:21:16 INFO : tachyon://tachyon-ec2-0:19998 tachyon://tachyon-ec2-0:19998 file:///mnt/tachyon
13/07/27 21:21:16 INFO : getFileStatus(/hit_data.tsv.100): HDFS Path: file:/mnt/tachyon/hit_data.tsv.100 TPath: tachyon://tachyon-ec2-0:19998/hit_data.tsv.100
13/07/27 21:21:16 INFO : tachyon.client.TachyonFS@3e3c4870 file:///mnt/tachyon /hit_data.tsv.100 tachyon.PrefixList@67b7d0fb
13/07/27 21:21:17 INFO : Create tachyon file /hit_data.tsv.100 with file id 2 and checkpoint location file:///mnt/tachyon/hit_data.tsv.100
13/07/27 21:21:17 INFO mapred.FileInputFormat: Total input paths to process : 1
13/07/27 21:21:17 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:21:17 INFO scheduler.DAGScheduler: Got job 0 (count at <console>:15) with 1 output partitions (allowLocal=false)
13/07/27 21:21:17 INFO scheduler.DAGScheduler: Final stage: Stage 0 (count at <console>:15)
13/07/27 21:21:17 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:21:17 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:21:17 INFO scheduler.DAGScheduler: Submitting Stage 0 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:21:17 INFO scheduler.DAGScheduler: Submitting 1 missing tasks from Stage 0 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:21:17 INFO local.LocalTaskSetManager: Size of task 0 is 1496 bytes
13/07/27 21:21:17 INFO local.LocalScheduler: Running 0
13/07/27 21:21:17 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100, 65536)
13/07/27 21:21:17 INFO : /mnt/ramdisk/tachyonworker/2147483648 is not on local disk.
13/07/27 21:21:17 INFO : Try to find and read from remote workers.
13/07/27 21:21:17 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:21:17 INFO : Folder /mnt/ramdisk/tachyonworker/users/1 was created!
13/07/27 21:21:17 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483648 was created!
13/07/27 21:21:17 INFO local.LocalScheduler: Finished 0
13/07/27 21:21:17 INFO local.LocalScheduler: Remove TaskSet 0.0 from pool 
13/07/27 21:21:17 INFO scheduler.DAGScheduler: Completed ResultTask(0, 0)
13/07/27 21:21:17 INFO scheduler.DAGScheduler: Stage 0 (count at <console>:15) finished in 0.371 s
13/07/27 21:21:17 INFO spark.SparkContext: Job finished: count at <console>:15, took 0.414335331 s
res0: Long = 100

scala> 13/07/27 21:21:17 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:21:17 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:21:17 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:21:17 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:21:17 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:21:17 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:21:17 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:21:17 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage/rdd,null}
Killed 1 processes
Killed 1 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting Tachyon @ tachyon-ec2-0
2013-07-27 21:21:19,223 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data
2013-07-27 21:21:19,226 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_log.data
2013-07-27 21:21:19,715 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/data
2013-07-27 21:21:19,727 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/workers

restaring tachyon
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Killed 0 processes
Killed 0 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting RamFS: /mnt/ramdisk
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata -Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Starting master @ tachyon-ec2-0
Starting worker @ tachyon-ec2-0

spark-shell count
21094 tachyon.Master
21121 tachyon.Worker

Going to fadvise /mnt/tachyon/hit_data.tsv.1000 as mode POSIX_FADV_DONTNEED
offset: 0
length: 776400
mode: POSIX_FADV_DONTNEED
WIN
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/ubuntu/work/tachyon/target/tachyon-0.3.0-SNAPSHOT-jar-with-dependencies.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/ubuntu/work/spark/lib_managed/jars/slf4j-log4j12-1.7.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
Welcome to
      ____              __  
     / __/__  ___ _____/ /__
    _\ \/ _ \/ _ `/ __/  '_/
   /___/ .__/\_,_/_/ /_/\_\   version 0.8.0
      /_/                  

Using Scala version 2.9.3 (OpenJDK 64-Bit Server VM, Java 1.7.0_25)
Initializing interpreter...
13/07/27 21:21:25 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:21:26 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:46247
Creating SparkContext...
13/07/27 21:21:35 INFO slf4j.Slf4jEventHandler: Slf4jEventHandler started
13/07/27 21:21:35 INFO spark.SparkEnv: Registering BlockManagerMaster
13/07/27 21:21:35 INFO storage.MemoryStore: MemoryStore started with capacity 1295.4 MB.
13/07/27 21:21:35 INFO storage.DiskStore: Created local directory at /tmp/spark-local-20130727212135-ccfc
13/07/27 21:21:35 INFO network.ConnectionManager: Bound socket to port 44714 with id = ConnectionManagerId(tachyon-ec2-0,44714)
13/07/27 21:21:35 INFO storage.BlockManagerMaster: Trying to register BlockManager
13/07/27 21:21:35 INFO storage.BlockManagerMasterActor$BlockManagerInfo: Registering block manager tachyon-ec2-0:44714 with 1295.4 MB RAM
13/07/27 21:21:35 INFO storage.BlockManagerMaster: Registered BlockManager
13/07/27 21:21:35 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:21:35 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:43884
13/07/27 21:21:35 INFO broadcast.HttpBroadcast: Broadcast server started at http://10.151.80.188:43884
13/07/27 21:21:35 INFO spark.SparkEnv: Registering MapOutputTracker
13/07/27 21:21:35 INFO spark.HttpFileServer: HTTP File server directory is /tmp/spark-2ec96928-a29d-4248-a902-6383df0cd155
13/07/27 21:21:35 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:21:35 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:46708
13/07/27 21:21:35 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:21:35 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage/rdd,null}
13/07/27 21:21:35 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:21:35 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:21:35 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:21:35 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:21:35 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:21:35 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:21:35 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:21:35 INFO server.AbstractConnector: Started SelectChannelConnector@0.0.0.0:33000
13/07/27 21:21:35 INFO ui.SparkUI: Started Spark Web UI at http://tachyon-ec2-0:33000
Spark context available as sc.
Type in expressions to have them evaluated.
Type :help for more information.

scala> val s = sc.textFile("tachyon://tachyon-ec2-0:19998/hit_data.tsv.1000")
13/07/27 21:21:36 INFO storage.MemoryStore: ensureFreeSpace(58423) called with curMem=0, maxMem=1358297825
13/07/27 21:21:36 INFO storage.MemoryStore: Block broadcast_0 stored as values to memory (estimated size 57.1 KB, free 1295.3 MB)
s: spark.RDD[String] = MappedRDD[1] at textFile at <console>:12

scala> s.count()
13/07/27 21:21:37 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
13/07/27 21:21:37 WARN snappy.LoadSnappy: Snappy native library not loaded
13/07/27 21:21:37 INFO : initialize(tachyon://tachyon-ec2-0:19998/hit_data.tsv.1000, Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml). Connecting to Tachyon: tachyon://tachyon-ec2-0:19998/hit_data.tsv.1000
13/07/27 21:21:37 INFO : Trying to connect master @ tachyon-ec2-0/10.151.80.188:19998
13/07/27 21:21:37 INFO : User registered at the master tachyon-ec2-0/10.151.80.188:19998 got UserId 1
13/07/27 21:21:37 INFO : Trying to get local worker host : tachyon-ec2-0
13/07/27 21:21:37 INFO : Connecting local worker @ tachyon-ec2-0/10.151.80.188:29998
13/07/27 21:21:37 INFO : tachyon://tachyon-ec2-0:19998 tachyon://tachyon-ec2-0:19998 file:///mnt/tachyon
13/07/27 21:21:37 INFO : getFileStatus(/hit_data.tsv.1000): HDFS Path: file:/mnt/tachyon/hit_data.tsv.1000 TPath: tachyon://tachyon-ec2-0:19998/hit_data.tsv.1000
13/07/27 21:21:37 INFO : tachyon.client.TachyonFS@1cabf050 file:///mnt/tachyon /hit_data.tsv.1000 tachyon.PrefixList@5c2e22e4
13/07/27 21:21:37 INFO : Create tachyon file /hit_data.tsv.1000 with file id 2 and checkpoint location file:///mnt/tachyon/hit_data.tsv.1000
13/07/27 21:21:37 INFO mapred.FileInputFormat: Total input paths to process : 1
13/07/27 21:21:37 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:21:37 INFO scheduler.DAGScheduler: Got job 0 (count at <console>:15) with 1 output partitions (allowLocal=false)
13/07/27 21:21:37 INFO scheduler.DAGScheduler: Final stage: Stage 0 (count at <console>:15)
13/07/27 21:21:37 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:21:37 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:21:37 INFO scheduler.DAGScheduler: Submitting Stage 0 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:21:37 INFO scheduler.DAGScheduler: Submitting 1 missing tasks from Stage 0 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:21:38 INFO local.LocalTaskSetManager: Size of task 0 is 1497 bytes
13/07/27 21:21:38 INFO local.LocalScheduler: Running 0
13/07/27 21:21:38 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.1000, 65536)
13/07/27 21:21:38 INFO : /mnt/ramdisk/tachyonworker/2147483648 is not on local disk.
13/07/27 21:21:38 INFO : Try to find and read from remote workers.
13/07/27 21:21:38 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:21:38 INFO : Folder /mnt/ramdisk/tachyonworker/users/1 was created!
13/07/27 21:21:38 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483648 was created!
13/07/27 21:21:38 INFO local.LocalScheduler: Finished 0
13/07/27 21:21:38 INFO local.LocalScheduler: Remove TaskSet 0.0 from pool 
13/07/27 21:21:38 INFO scheduler.DAGScheduler: Completed ResultTask(0, 0)
13/07/27 21:21:38 INFO scheduler.DAGScheduler: Stage 0 (count at <console>:15) finished in 0.395 s
13/07/27 21:21:38 INFO spark.SparkContext: Job finished: count at <console>:15, took 0.439197967 s
res0: Long = 1000

scala> 13/07/27 21:21:38 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:21:38 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:21:38 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:21:38 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:21:38 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:21:38 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:21:38 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:21:38 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage/rdd,null}
Killed 1 processes
Killed 1 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting Tachyon @ tachyon-ec2-0
2013-07-27 21:21:40,032 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data
2013-07-27 21:21:40,036 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_log.data
2013-07-27 21:21:40,525 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/data
2013-07-27 21:21:40,537 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/workers

restaring tachyon
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Killed 0 processes
Killed 0 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting RamFS: /mnt/ramdisk
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata -Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Starting master @ tachyon-ec2-0
Starting worker @ tachyon-ec2-0

spark-shell count
21650 tachyon.Master
21677 tachyon.Worker

Going to fadvise /mnt/tachyon/hit_data.tsv.10000 as mode POSIX_FADV_DONTNEED
offset: 0
length: 12330369
mode: POSIX_FADV_DONTNEED
WIN
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/ubuntu/work/tachyon/target/tachyon-0.3.0-SNAPSHOT-jar-with-dependencies.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/ubuntu/work/spark/lib_managed/jars/slf4j-log4j12-1.7.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
Welcome to
      ____              __  
     / __/__  ___ _____/ /__
    _\ \/ _ \/ _ `/ __/  '_/
   /___/ .__/\_,_/_/ /_/\_\   version 0.8.0
      /_/                  

Using Scala version 2.9.3 (OpenJDK 64-Bit Server VM, Java 1.7.0_25)
Initializing interpreter...
13/07/27 21:21:46 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:21:46 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:55717
Creating SparkContext...
13/07/27 21:21:56 INFO slf4j.Slf4jEventHandler: Slf4jEventHandler started
13/07/27 21:21:56 INFO spark.SparkEnv: Registering BlockManagerMaster
13/07/27 21:21:56 INFO storage.MemoryStore: MemoryStore started with capacity 1295.4 MB.
13/07/27 21:21:56 INFO storage.DiskStore: Created local directory at /tmp/spark-local-20130727212156-e635
13/07/27 21:21:56 INFO network.ConnectionManager: Bound socket to port 53916 with id = ConnectionManagerId(tachyon-ec2-0,53916)
13/07/27 21:21:56 INFO storage.BlockManagerMaster: Trying to register BlockManager
13/07/27 21:21:56 INFO storage.BlockManagerMasterActor$BlockManagerInfo: Registering block manager tachyon-ec2-0:53916 with 1295.4 MB RAM
13/07/27 21:21:56 INFO storage.BlockManagerMaster: Registered BlockManager
13/07/27 21:21:56 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:21:56 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:35133
13/07/27 21:21:56 INFO broadcast.HttpBroadcast: Broadcast server started at http://10.151.80.188:35133
13/07/27 21:21:56 INFO spark.SparkEnv: Registering MapOutputTracker
13/07/27 21:21:56 INFO spark.HttpFileServer: HTTP File server directory is /tmp/spark-b6a2fe2b-b8fd-4fc3-a3ef-d498ca10aae4
13/07/27 21:21:56 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:21:56 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:51323
13/07/27 21:21:56 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:21:56 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage/rdd,null}
13/07/27 21:21:56 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:21:56 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:21:56 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:21:56 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:21:56 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:21:56 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:21:56 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:21:56 INFO server.AbstractConnector: Started SelectChannelConnector@0.0.0.0:33000
13/07/27 21:21:56 INFO ui.SparkUI: Started Spark Web UI at http://tachyon-ec2-0:33000
Spark context available as sc.
Type in expressions to have them evaluated.
Type :help for more information.

scala> val s = sc.textFile("tachyon://tachyon-ec2-0:19998/hit_data.tsv.10000")
13/07/27 21:21:57 INFO storage.MemoryStore: ensureFreeSpace(58423) called with curMem=0, maxMem=1358297825
13/07/27 21:21:57 INFO storage.MemoryStore: Block broadcast_0 stored as values to memory (estimated size 57.1 KB, free 1295.3 MB)
s: spark.RDD[String] = MappedRDD[1] at textFile at <console>:12

scala> s.count()
13/07/27 21:21:58 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
13/07/27 21:21:58 WARN snappy.LoadSnappy: Snappy native library not loaded
13/07/27 21:21:58 INFO : initialize(tachyon://tachyon-ec2-0:19998/hit_data.tsv.10000, Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml). Connecting to Tachyon: tachyon://tachyon-ec2-0:19998/hit_data.tsv.10000
13/07/27 21:21:58 INFO : Trying to connect master @ tachyon-ec2-0/10.151.80.188:19998
13/07/27 21:21:58 INFO : User registered at the master tachyon-ec2-0/10.151.80.188:19998 got UserId 1
13/07/27 21:21:58 INFO : Trying to get local worker host : tachyon-ec2-0
13/07/27 21:21:58 INFO : Connecting local worker @ tachyon-ec2-0/10.151.80.188:29998
13/07/27 21:21:58 INFO : tachyon://tachyon-ec2-0:19998 tachyon://tachyon-ec2-0:19998 file:///mnt/tachyon
13/07/27 21:21:58 INFO : getFileStatus(/hit_data.tsv.10000): HDFS Path: file:/mnt/tachyon/hit_data.tsv.10000 TPath: tachyon://tachyon-ec2-0:19998/hit_data.tsv.10000
13/07/27 21:21:58 INFO : tachyon.client.TachyonFS@320e8c95 file:///mnt/tachyon /hit_data.tsv.10000 tachyon.PrefixList@592fa3df
13/07/27 21:21:58 INFO : Create tachyon file /hit_data.tsv.10000 with file id 2 and checkpoint location file:///mnt/tachyon/hit_data.tsv.10000
13/07/27 21:21:58 INFO mapred.FileInputFormat: Total input paths to process : 1
13/07/27 21:21:58 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:21:58 INFO scheduler.DAGScheduler: Got job 0 (count at <console>:15) with 1 output partitions (allowLocal=false)
13/07/27 21:21:58 INFO scheduler.DAGScheduler: Final stage: Stage 0 (count at <console>:15)
13/07/27 21:21:58 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:21:58 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:21:58 INFO scheduler.DAGScheduler: Submitting Stage 0 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:21:58 INFO scheduler.DAGScheduler: Submitting 1 missing tasks from Stage 0 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:21:58 INFO local.LocalTaskSetManager: Size of task 0 is 1498 bytes
13/07/27 21:21:58 INFO local.LocalScheduler: Running 0
13/07/27 21:21:59 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.10000, 65536)
13/07/27 21:21:59 INFO : /mnt/ramdisk/tachyonworker/2147483648 is not on local disk.
13/07/27 21:21:59 INFO : Try to find and read from remote workers.
13/07/27 21:21:59 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:21:59 INFO : Folder /mnt/ramdisk/tachyonworker/users/1 was created!
13/07/27 21:21:59 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483648 was created!
13/07/27 21:21:59 INFO local.LocalScheduler: Finished 0
13/07/27 21:21:59 INFO local.LocalScheduler: Remove TaskSet 0.0 from pool 
13/07/27 21:21:59 INFO scheduler.DAGScheduler: Completed ResultTask(0, 0)
13/07/27 21:21:59 INFO scheduler.DAGScheduler: Stage 0 (count at <console>:15) finished in 0.628 s
13/07/27 21:21:59 INFO spark.SparkContext: Job finished: count at <console>:15, took 0.671231789 s
res0: Long = 10000

scala> 13/07/27 21:21:59 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:21:59 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:21:59 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:21:59 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:21:59 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:21:59 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:21:59 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:21:59 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage/rdd,null}
Killed 1 processes
Killed 1 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting Tachyon @ tachyon-ec2-0
2013-07-27 21:22:01,209 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data
2013-07-27 21:22:01,213 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_log.data
2013-07-27 21:22:01,707 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/data
2013-07-27 21:22:01,719 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/workers

restaring tachyon
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Killed 0 processes
Killed 0 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting RamFS: /mnt/ramdisk
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata -Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Starting master @ tachyon-ec2-0
Starting worker @ tachyon-ec2-0

spark-shell count
22210 tachyon.Master
22237 tachyon.Worker

Going to fadvise /mnt/tachyon/hit_data.tsv.100000 as mode POSIX_FADV_DONTNEED
offset: 0
length: 125141299
mode: POSIX_FADV_DONTNEED
WIN
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/ubuntu/work/tachyon/target/tachyon-0.3.0-SNAPSHOT-jar-with-dependencies.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/ubuntu/work/spark/lib_managed/jars/slf4j-log4j12-1.7.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
Welcome to
      ____              __  
     / __/__  ___ _____/ /__
    _\ \/ _ \/ _ `/ __/  '_/
   /___/ .__/\_,_/_/ /_/\_\   version 0.8.0
      /_/                  

Using Scala version 2.9.3 (OpenJDK 64-Bit Server VM, Java 1.7.0_25)
Initializing interpreter...
13/07/27 21:22:08 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:22:08 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:56213
Creating SparkContext...
13/07/27 21:22:17 INFO slf4j.Slf4jEventHandler: Slf4jEventHandler started
13/07/27 21:22:17 INFO spark.SparkEnv: Registering BlockManagerMaster
13/07/27 21:22:17 INFO storage.MemoryStore: MemoryStore started with capacity 1295.4 MB.
13/07/27 21:22:17 INFO storage.DiskStore: Created local directory at /tmp/spark-local-20130727212217-ab76
13/07/27 21:22:17 INFO network.ConnectionManager: Bound socket to port 37292 with id = ConnectionManagerId(tachyon-ec2-0,37292)
13/07/27 21:22:17 INFO storage.BlockManagerMaster: Trying to register BlockManager
13/07/27 21:22:17 INFO storage.BlockManagerMasterActor$BlockManagerInfo: Registering block manager tachyon-ec2-0:37292 with 1295.4 MB RAM
13/07/27 21:22:17 INFO storage.BlockManagerMaster: Registered BlockManager
13/07/27 21:22:17 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:22:17 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:58946
13/07/27 21:22:17 INFO broadcast.HttpBroadcast: Broadcast server started at http://10.151.80.188:58946
13/07/27 21:22:17 INFO spark.SparkEnv: Registering MapOutputTracker
13/07/27 21:22:17 INFO spark.HttpFileServer: HTTP File server directory is /tmp/spark-da583648-2f21-46b6-ae59-e1666a0cd291
13/07/27 21:22:17 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:22:17 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:54147
13/07/27 21:22:17 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:22:17 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage/rdd,null}
13/07/27 21:22:17 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:22:17 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:22:17 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:22:17 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:22:17 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:22:17 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:22:17 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:22:17 INFO server.AbstractConnector: Started SelectChannelConnector@0.0.0.0:33000
13/07/27 21:22:17 INFO ui.SparkUI: Started Spark Web UI at http://tachyon-ec2-0:33000
Spark context available as sc.
Type in expressions to have them evaluated.
Type :help for more information.

scala> val s = sc.textFile("tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000")
13/07/27 21:22:18 INFO storage.MemoryStore: ensureFreeSpace(58431) called with curMem=0, maxMem=1358297825
13/07/27 21:22:18 INFO storage.MemoryStore: Block broadcast_0 stored as values to memory (estimated size 57.1 KB, free 1295.3 MB)
s: spark.RDD[String] = MappedRDD[1] at textFile at <console>:12

scala> s.count()
13/07/27 21:22:19 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
13/07/27 21:22:19 WARN snappy.LoadSnappy: Snappy native library not loaded
13/07/27 21:22:19 INFO : initialize(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000, Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml). Connecting to Tachyon: tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000
13/07/27 21:22:19 INFO : Trying to connect master @ tachyon-ec2-0/10.151.80.188:19998
13/07/27 21:22:19 INFO : User registered at the master tachyon-ec2-0/10.151.80.188:19998 got UserId 1
13/07/27 21:22:19 INFO : Trying to get local worker host : tachyon-ec2-0
13/07/27 21:22:19 INFO : Connecting local worker @ tachyon-ec2-0/10.151.80.188:29998
13/07/27 21:22:19 INFO : tachyon://tachyon-ec2-0:19998 tachyon://tachyon-ec2-0:19998 file:///mnt/tachyon
13/07/27 21:22:19 INFO : getFileStatus(/hit_data.tsv.100000): HDFS Path: file:/mnt/tachyon/hit_data.tsv.100000 TPath: tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000
13/07/27 21:22:19 INFO : tachyon.client.TachyonFS@1ea5113a file:///mnt/tachyon /hit_data.tsv.100000 tachyon.PrefixList@670e068d
13/07/27 21:22:19 INFO : Create tachyon file /hit_data.tsv.100000 with file id 2 and checkpoint location file:///mnt/tachyon/hit_data.tsv.100000
13/07/27 21:22:19 INFO mapred.FileInputFormat: Total input paths to process : 1
13/07/27 21:22:20 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:22:20 INFO scheduler.DAGScheduler: Got job 0 (count at <console>:15) with 4 output partitions (allowLocal=false)
13/07/27 21:22:20 INFO scheduler.DAGScheduler: Final stage: Stage 0 (count at <console>:15)
13/07/27 21:22:20 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:22:20 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:22:20 INFO scheduler.DAGScheduler: Submitting Stage 0 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:22:20 INFO scheduler.DAGScheduler: Submitting 4 missing tasks from Stage 0 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:22:20 INFO local.LocalTaskSetManager: Size of task 0 is 1499 bytes
13/07/27 21:22:20 INFO local.LocalScheduler: Running 0
13/07/27 21:22:20 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000, 65536)
13/07/27 21:22:20 INFO : /mnt/ramdisk/tachyonworker/2147483648 is not on local disk.
13/07/27 21:22:20 INFO : Try to find and read from remote workers.
13/07/27 21:22:20 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:22:20 INFO : Folder /mnt/ramdisk/tachyonworker/users/1 was created!
13/07/27 21:22:20 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483648 was created!
13/07/27 21:22:20 INFO : /mnt/ramdisk/tachyonworker/2147483649 is not on local disk.
13/07/27 21:22:20 INFO : Try to find and read from remote workers.
13/07/27 21:22:20 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:22:20 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483649 was created!
13/07/27 21:22:21 INFO local.LocalScheduler: Finished 0
13/07/27 21:22:21 INFO local.LocalTaskSetManager: Size of task 1 is 1499 bytes
13/07/27 21:22:21 INFO local.LocalScheduler: Running 1
13/07/27 21:22:21 INFO scheduler.DAGScheduler: Completed ResultTask(0, 0)
13/07/27 21:22:21 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000, 65536)
13/07/27 21:22:21 INFO : /mnt/ramdisk/tachyonworker/2147483650 is not on local disk.
13/07/27 21:22:21 INFO : Try to find and read from remote workers.
13/07/27 21:22:21 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:22:21 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483650 was created!
13/07/27 21:22:21 INFO local.LocalScheduler: Finished 1
13/07/27 21:22:21 INFO scheduler.DAGScheduler: Completed ResultTask(0, 1)
13/07/27 21:22:21 INFO local.LocalTaskSetManager: Size of task 2 is 1499 bytes
13/07/27 21:22:21 INFO local.LocalScheduler: Running 2
13/07/27 21:22:21 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000, 65536)
13/07/27 21:22:22 INFO : /mnt/ramdisk/tachyonworker/2147483651 is not on local disk.
13/07/27 21:22:22 INFO : Try to find and read from remote workers.
13/07/27 21:22:22 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:22:22 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483651 was created!
13/07/27 21:22:22 INFO local.LocalScheduler: Finished 2
13/07/27 21:22:22 INFO scheduler.DAGScheduler: Completed ResultTask(0, 2)
13/07/27 21:22:22 INFO local.LocalTaskSetManager: Size of task 3 is 1499 bytes
13/07/27 21:22:22 INFO local.LocalScheduler: Running 3
13/07/27 21:22:22 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000, 65536)
13/07/27 21:22:22 INFO local.LocalScheduler: Finished 3
13/07/27 21:22:22 INFO scheduler.DAGScheduler: Completed ResultTask(0, 3)
13/07/27 21:22:22 INFO local.LocalScheduler: Remove TaskSet 0.0 from pool 
13/07/27 21:22:22 INFO scheduler.DAGScheduler: Stage 0 (count at <console>:15) finished in 2.760 s
13/07/27 21:22:22 INFO spark.SparkContext: Job finished: count at <console>:15, took 2.811118387 s
res0: Long = 100002

scala> 13/07/27 21:22:22 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:22:22 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:22:22 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:22:22 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:22:22 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:22:22 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:22:22 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:22:22 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage/rdd,null}
Killed 1 processes
Killed 1 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting Tachyon @ tachyon-ec2-0
2013-07-27 21:22:24,551 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data
2013-07-27 21:22:24,555 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_log.data
2013-07-27 21:22:25,044 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/data
2013-07-27 21:22:25,056 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/workers

restaring tachyon
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Killed 0 processes
Killed 0 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting RamFS: /mnt/ramdisk
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata -Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Starting master @ tachyon-ec2-0
Starting worker @ tachyon-ec2-0

spark-shell count
22845 tachyon.Master
22872 tachyon.Worker

Going to fadvise /mnt/tachyon/hit_data.tsv.500000 as mode POSIX_FADV_DONTNEED
offset: 0
length: 618418417
mode: POSIX_FADV_DONTNEED
WIN
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/ubuntu/work/tachyon/target/tachyon-0.3.0-SNAPSHOT-jar-with-dependencies.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/ubuntu/work/spark/lib_managed/jars/slf4j-log4j12-1.7.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
Welcome to
      ____              __  
     / __/__  ___ _____/ /__
    _\ \/ _ \/ _ `/ __/  '_/
   /___/ .__/\_,_/_/ /_/\_\   version 0.8.0
      /_/                  

Using Scala version 2.9.3 (OpenJDK 64-Bit Server VM, Java 1.7.0_25)
Initializing interpreter...
13/07/27 21:22:31 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:22:31 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:43496
Creating SparkContext...
13/07/27 21:22:40 INFO slf4j.Slf4jEventHandler: Slf4jEventHandler started
13/07/27 21:22:40 INFO spark.SparkEnv: Registering BlockManagerMaster
13/07/27 21:22:40 INFO storage.MemoryStore: MemoryStore started with capacity 1295.4 MB.
13/07/27 21:22:40 INFO storage.DiskStore: Created local directory at /tmp/spark-local-20130727212240-d4f7
13/07/27 21:22:40 INFO network.ConnectionManager: Bound socket to port 53160 with id = ConnectionManagerId(tachyon-ec2-0,53160)
13/07/27 21:22:40 INFO storage.BlockManagerMaster: Trying to register BlockManager
13/07/27 21:22:40 INFO storage.BlockManagerMasterActor$BlockManagerInfo: Registering block manager tachyon-ec2-0:53160 with 1295.4 MB RAM
13/07/27 21:22:40 INFO storage.BlockManagerMaster: Registered BlockManager
13/07/27 21:22:40 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:22:40 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:44154
13/07/27 21:22:40 INFO broadcast.HttpBroadcast: Broadcast server started at http://10.151.80.188:44154
13/07/27 21:22:40 INFO spark.SparkEnv: Registering MapOutputTracker
13/07/27 21:22:40 INFO spark.HttpFileServer: HTTP File server directory is /tmp/spark-034e739b-a95c-48ea-979f-ac3112f75fc6
13/07/27 21:22:40 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:22:40 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:54237
13/07/27 21:22:41 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:22:41 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage/rdd,null}
13/07/27 21:22:41 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:22:41 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:22:41 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:22:41 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:22:41 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:22:41 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:22:41 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:22:41 INFO server.AbstractConnector: Started SelectChannelConnector@0.0.0.0:33000
13/07/27 21:22:41 INFO ui.SparkUI: Started Spark Web UI at http://tachyon-ec2-0:33000
Spark context available as sc.
Type in expressions to have them evaluated.
Type :help for more information.

scala> val s = sc.textFile("tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000")
13/07/27 21:22:42 INFO storage.MemoryStore: ensureFreeSpace(58431) called with curMem=0, maxMem=1358297825
13/07/27 21:22:42 INFO storage.MemoryStore: Block broadcast_0 stored as values to memory (estimated size 57.1 KB, free 1295.3 MB)
s: spark.RDD[String] = MappedRDD[1] at textFile at <console>:12

scala> s.count()
13/07/27 21:22:42 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
13/07/27 21:22:42 WARN snappy.LoadSnappy: Snappy native library not loaded
13/07/27 21:22:42 INFO : initialize(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml). Connecting to Tachyon: tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000
13/07/27 21:22:42 INFO : Trying to connect master @ tachyon-ec2-0/10.151.80.188:19998
13/07/27 21:22:42 INFO : User registered at the master tachyon-ec2-0/10.151.80.188:19998 got UserId 1
13/07/27 21:22:42 INFO : Trying to get local worker host : tachyon-ec2-0
13/07/27 21:22:42 INFO : Connecting local worker @ tachyon-ec2-0/10.151.80.188:29998
13/07/27 21:22:42 INFO : tachyon://tachyon-ec2-0:19998 tachyon://tachyon-ec2-0:19998 file:///mnt/tachyon
13/07/27 21:22:42 INFO : getFileStatus(/hit_data.tsv.500000): HDFS Path: file:/mnt/tachyon/hit_data.tsv.500000 TPath: tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000
13/07/27 21:22:42 INFO : tachyon.client.TachyonFS@5390cdba file:///mnt/tachyon /hit_data.tsv.500000 tachyon.PrefixList@47b29932
13/07/27 21:22:43 INFO : Create tachyon file /hit_data.tsv.500000 with file id 2 and checkpoint location file:///mnt/tachyon/hit_data.tsv.500000
13/07/27 21:22:43 INFO mapred.FileInputFormat: Total input paths to process : 1
13/07/27 21:22:43 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:22:43 INFO scheduler.DAGScheduler: Got job 0 (count at <console>:15) with 19 output partitions (allowLocal=false)
13/07/27 21:22:43 INFO scheduler.DAGScheduler: Final stage: Stage 0 (count at <console>:15)
13/07/27 21:22:43 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:22:43 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:22:43 INFO scheduler.DAGScheduler: Submitting Stage 0 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:22:43 INFO scheduler.DAGScheduler: Submitting 19 missing tasks from Stage 0 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:22:43 INFO local.LocalTaskSetManager: Size of task 0 is 1499 bytes
13/07/27 21:22:43 INFO local.LocalScheduler: Running 0
13/07/27 21:22:43 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:22:43 INFO : /mnt/ramdisk/tachyonworker/2147483648 is not on local disk.
13/07/27 21:22:43 INFO : Try to find and read from remote workers.
13/07/27 21:22:43 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:22:44 INFO : Folder /mnt/ramdisk/tachyonworker/users/1 was created!
13/07/27 21:22:44 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483648 was created!
13/07/27 21:22:44 INFO : /mnt/ramdisk/tachyonworker/2147483649 is not on local disk.
13/07/27 21:22:44 INFO : Try to find and read from remote workers.
13/07/27 21:22:44 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:22:44 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483649 was created!
13/07/27 21:22:45 INFO local.LocalScheduler: Finished 0
13/07/27 21:22:45 INFO local.LocalTaskSetManager: Size of task 1 is 1499 bytes
13/07/27 21:22:45 INFO local.LocalScheduler: Running 1
13/07/27 21:22:45 INFO scheduler.DAGScheduler: Completed ResultTask(0, 0)
13/07/27 21:22:45 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:22:45 INFO : /mnt/ramdisk/tachyonworker/2147483650 is not on local disk.
13/07/27 21:22:45 INFO : Try to find and read from remote workers.
13/07/27 21:22:45 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:22:45 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483650 was created!
13/07/27 21:22:45 INFO local.LocalScheduler: Finished 1
13/07/27 21:22:45 INFO scheduler.DAGScheduler: Completed ResultTask(0, 1)
13/07/27 21:22:45 INFO local.LocalTaskSetManager: Size of task 2 is 1499 bytes
13/07/27 21:22:45 INFO local.LocalScheduler: Running 2
13/07/27 21:22:45 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:22:46 INFO : /mnt/ramdisk/tachyonworker/2147483651 is not on local disk.
13/07/27 21:22:46 INFO : Try to find and read from remote workers.
13/07/27 21:22:46 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:22:46 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483651 was created!
13/07/27 21:22:46 INFO local.LocalScheduler: Finished 2
13/07/27 21:22:46 INFO scheduler.DAGScheduler: Completed ResultTask(0, 2)
13/07/27 21:22:46 INFO local.LocalTaskSetManager: Size of task 3 is 1499 bytes
13/07/27 21:22:46 INFO local.LocalScheduler: Running 3
13/07/27 21:22:46 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:22:46 INFO : /mnt/ramdisk/tachyonworker/2147483652 is not on local disk.
13/07/27 21:22:46 INFO : Try to find and read from remote workers.
13/07/27 21:22:46 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:22:46 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483652 was created!
13/07/27 21:22:46 INFO local.LocalScheduler: Finished 3
13/07/27 21:22:46 INFO scheduler.DAGScheduler: Completed ResultTask(0, 3)
13/07/27 21:22:46 INFO local.LocalTaskSetManager: Size of task 4 is 1499 bytes
13/07/27 21:22:46 INFO local.LocalScheduler: Running 4
13/07/27 21:22:46 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:22:47 INFO : /mnt/ramdisk/tachyonworker/2147483653 is not on local disk.
13/07/27 21:22:47 INFO : Try to find and read from remote workers.
13/07/27 21:22:47 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:22:47 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483653 was created!
13/07/27 21:22:47 INFO local.LocalScheduler: Finished 4
13/07/27 21:22:47 INFO scheduler.DAGScheduler: Completed ResultTask(0, 4)
13/07/27 21:22:47 INFO local.LocalTaskSetManager: Size of task 5 is 1499 bytes
13/07/27 21:22:47 INFO local.LocalScheduler: Running 5
13/07/27 21:22:47 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:22:47 INFO : /mnt/ramdisk/tachyonworker/2147483654 is not on local disk.
13/07/27 21:22:47 INFO : Try to find and read from remote workers.
13/07/27 21:22:47 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:22:47 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483654 was created!
13/07/27 21:22:48 INFO local.LocalScheduler: Finished 5
13/07/27 21:22:48 INFO scheduler.DAGScheduler: Completed ResultTask(0, 5)
13/07/27 21:22:48 INFO local.LocalTaskSetManager: Size of task 6 is 1499 bytes
13/07/27 21:22:48 INFO local.LocalScheduler: Running 6
13/07/27 21:22:48 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:22:48 INFO : /mnt/ramdisk/tachyonworker/2147483655 is not on local disk.
13/07/27 21:22:48 INFO : Try to find and read from remote workers.
13/07/27 21:22:48 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:22:48 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483655 was created!
13/07/27 21:22:48 INFO local.LocalScheduler: Finished 6
13/07/27 21:22:48 INFO scheduler.DAGScheduler: Completed ResultTask(0, 6)
13/07/27 21:22:48 INFO local.LocalTaskSetManager: Size of task 7 is 1499 bytes
13/07/27 21:22:48 INFO local.LocalScheduler: Running 7
13/07/27 21:22:48 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:22:48 INFO : /mnt/ramdisk/tachyonworker/2147483656 is not on local disk.
13/07/27 21:22:48 INFO : Try to find and read from remote workers.
13/07/27 21:22:48 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:22:49 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483656 was created!
13/07/27 21:22:49 INFO local.LocalScheduler: Finished 7
13/07/27 21:22:49 INFO scheduler.DAGScheduler: Completed ResultTask(0, 7)
13/07/27 21:22:49 INFO local.LocalTaskSetManager: Size of task 8 is 1499 bytes
13/07/27 21:22:49 INFO local.LocalScheduler: Running 8
13/07/27 21:22:49 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:22:49 INFO : /mnt/ramdisk/tachyonworker/2147483657 is not on local disk.
13/07/27 21:22:49 INFO : Try to find and read from remote workers.
13/07/27 21:22:49 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:22:49 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483657 was created!
13/07/27 21:22:49 INFO local.LocalScheduler: Finished 8
13/07/27 21:22:49 INFO scheduler.DAGScheduler: Completed ResultTask(0, 8)
13/07/27 21:22:49 INFO local.LocalTaskSetManager: Size of task 9 is 1499 bytes
13/07/27 21:22:49 INFO local.LocalScheduler: Running 9
13/07/27 21:22:49 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:22:50 INFO : /mnt/ramdisk/tachyonworker/2147483658 is not on local disk.
13/07/27 21:22:50 INFO : Try to find and read from remote workers.
13/07/27 21:22:50 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:22:50 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483658 was created!
13/07/27 21:22:50 INFO local.LocalScheduler: Finished 9
13/07/27 21:22:50 INFO scheduler.DAGScheduler: Completed ResultTask(0, 9)
13/07/27 21:22:50 INFO local.LocalTaskSetManager: Size of task 10 is 1499 bytes
13/07/27 21:22:50 INFO local.LocalScheduler: Running 10
13/07/27 21:22:50 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:22:50 INFO : /mnt/ramdisk/tachyonworker/2147483659 is not on local disk.
13/07/27 21:22:50 INFO : Try to find and read from remote workers.
13/07/27 21:22:50 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:22:50 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483659 was created!
13/07/27 21:22:51 INFO local.LocalScheduler: Finished 10
13/07/27 21:22:51 INFO scheduler.DAGScheduler: Completed ResultTask(0, 10)
13/07/27 21:22:51 INFO local.LocalTaskSetManager: Size of task 11 is 1499 bytes
13/07/27 21:22:51 INFO local.LocalScheduler: Running 11
13/07/27 21:22:51 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:22:51 INFO : /mnt/ramdisk/tachyonworker/2147483660 is not on local disk.
13/07/27 21:22:51 INFO : Try to find and read from remote workers.
13/07/27 21:22:51 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:22:51 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483660 was created!
13/07/27 21:22:51 INFO local.LocalScheduler: Finished 11
13/07/27 21:22:51 INFO scheduler.DAGScheduler: Completed ResultTask(0, 11)
13/07/27 21:22:51 INFO local.LocalTaskSetManager: Size of task 12 is 1499 bytes
13/07/27 21:22:51 INFO local.LocalScheduler: Running 12
13/07/27 21:22:51 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:22:51 INFO : /mnt/ramdisk/tachyonworker/2147483661 is not on local disk.
13/07/27 21:22:51 INFO : Try to find and read from remote workers.
13/07/27 21:22:51 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:22:51 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483661 was created!
13/07/27 21:22:52 INFO local.LocalScheduler: Finished 12
13/07/27 21:22:52 INFO scheduler.DAGScheduler: Completed ResultTask(0, 12)
13/07/27 21:22:52 INFO local.LocalTaskSetManager: Size of task 13 is 1499 bytes
13/07/27 21:22:52 INFO local.LocalScheduler: Running 13
13/07/27 21:22:52 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:22:52 INFO : /mnt/ramdisk/tachyonworker/2147483662 is not on local disk.
13/07/27 21:22:52 INFO : Try to find and read from remote workers.
13/07/27 21:22:52 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:22:52 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483662 was created!
13/07/27 21:22:52 INFO local.LocalScheduler: Finished 13
13/07/27 21:22:52 INFO scheduler.DAGScheduler: Completed ResultTask(0, 13)
13/07/27 21:22:52 INFO local.LocalTaskSetManager: Size of task 14 is 1499 bytes
13/07/27 21:22:52 INFO local.LocalScheduler: Running 14
13/07/27 21:22:52 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:22:52 INFO : /mnt/ramdisk/tachyonworker/2147483663 is not on local disk.
13/07/27 21:22:52 INFO : Try to find and read from remote workers.
13/07/27 21:22:52 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:22:53 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483663 was created!
13/07/27 21:22:53 INFO local.LocalScheduler: Finished 14
13/07/27 21:22:53 INFO scheduler.DAGScheduler: Completed ResultTask(0, 14)
13/07/27 21:22:53 INFO local.LocalTaskSetManager: Size of task 15 is 1499 bytes
13/07/27 21:22:53 INFO local.LocalScheduler: Running 15
13/07/27 21:22:53 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:22:53 INFO : /mnt/ramdisk/tachyonworker/2147483664 is not on local disk.
13/07/27 21:22:53 INFO : Try to find and read from remote workers.
13/07/27 21:22:53 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:22:53 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483664 was created!
13/07/27 21:22:53 INFO local.LocalScheduler: Finished 15
13/07/27 21:22:53 INFO scheduler.DAGScheduler: Completed ResultTask(0, 15)
13/07/27 21:22:53 INFO local.LocalTaskSetManager: Size of task 16 is 1499 bytes
13/07/27 21:22:53 INFO local.LocalScheduler: Running 16
13/07/27 21:22:53 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:22:54 INFO : /mnt/ramdisk/tachyonworker/2147483665 is not on local disk.
13/07/27 21:22:54 INFO : Try to find and read from remote workers.
13/07/27 21:22:54 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:22:54 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483665 was created!
13/07/27 21:22:54 INFO local.LocalScheduler: Finished 16
13/07/27 21:22:54 INFO scheduler.DAGScheduler: Completed ResultTask(0, 16)
13/07/27 21:22:54 INFO local.LocalTaskSetManager: Size of task 17 is 1499 bytes
13/07/27 21:22:54 INFO local.LocalScheduler: Running 17
13/07/27 21:22:54 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:22:54 INFO : /mnt/ramdisk/tachyonworker/2147483666 is not on local disk.
13/07/27 21:22:54 INFO : Try to find and read from remote workers.
13/07/27 21:22:54 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:22:54 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483666 was created!
13/07/27 21:22:54 INFO local.LocalScheduler: Finished 17
13/07/27 21:22:54 INFO scheduler.DAGScheduler: Completed ResultTask(0, 17)
13/07/27 21:22:54 INFO local.LocalTaskSetManager: Size of task 18 is 1499 bytes
13/07/27 21:22:54 INFO local.LocalScheduler: Running 18
13/07/27 21:22:54 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:22:54 INFO local.LocalScheduler: Finished 18
13/07/27 21:22:54 INFO scheduler.DAGScheduler: Completed ResultTask(0, 18)
13/07/27 21:22:54 INFO local.LocalScheduler: Remove TaskSet 0.0 from pool 
13/07/27 21:22:54 INFO scheduler.DAGScheduler: Stage 0 (count at <console>:15) finished in 11.173 s
13/07/27 21:22:54 INFO spark.SparkContext: Job finished: count at <console>:15, took 11.223999966 s
res0: Long = 500094

scala> 13/07/27 21:22:55 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:22:55 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:22:55 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:22:55 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:22:55 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:22:55 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:22:55 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:22:55 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage/rdd,null}
Killed 1 processes
Killed 1 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting Tachyon @ tachyon-ec2-0
2013-07-27 21:22:56,770 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data
2013-07-27 21:22:56,774 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_log.data
2013-07-27 21:22:57,260 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/data
2013-07-27 21:22:57,272 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/workers

run1 #: 5

restaring tachyon
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Killed 0 processes
Killed 0 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting RamFS: /mnt/ramdisk
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata -Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Starting master @ tachyon-ec2-0
Starting worker @ tachyon-ec2-0

spark-shell count
23618 tachyon.Master
23645 tachyon.Worker

Going to fadvise /mnt/tachyon/hit_data.tsv.1 as mode POSIX_FADV_DONTNEED
offset: 0
length: 525
mode: POSIX_FADV_DONTNEED
WIN
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/ubuntu/work/tachyon/target/tachyon-0.3.0-SNAPSHOT-jar-with-dependencies.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/ubuntu/work/spark/lib_managed/jars/slf4j-log4j12-1.7.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
Welcome to
      ____              __  
     / __/__  ___ _____/ /__
    _\ \/ _ \/ _ `/ __/  '_/
   /___/ .__/\_,_/_/ /_/\_\   version 0.8.0
      /_/                  

Using Scala version 2.9.3 (OpenJDK 64-Bit Server VM, Java 1.7.0_25)
Initializing interpreter...
13/07/27 21:23:03 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:23:03 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:38075
Creating SparkContext...
13/07/27 21:23:12 INFO slf4j.Slf4jEventHandler: Slf4jEventHandler started
13/07/27 21:23:12 INFO spark.SparkEnv: Registering BlockManagerMaster
13/07/27 21:23:12 INFO storage.MemoryStore: MemoryStore started with capacity 1295.4 MB.
13/07/27 21:23:12 INFO storage.DiskStore: Created local directory at /tmp/spark-local-20130727212312-486b
13/07/27 21:23:13 INFO network.ConnectionManager: Bound socket to port 49156 with id = ConnectionManagerId(tachyon-ec2-0,49156)
13/07/27 21:23:13 INFO storage.BlockManagerMaster: Trying to register BlockManager
13/07/27 21:23:13 INFO storage.BlockManagerMasterActor$BlockManagerInfo: Registering block manager tachyon-ec2-0:49156 with 1295.4 MB RAM
13/07/27 21:23:13 INFO storage.BlockManagerMaster: Registered BlockManager
13/07/27 21:23:13 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:23:13 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:43819
13/07/27 21:23:13 INFO broadcast.HttpBroadcast: Broadcast server started at http://10.151.80.188:43819
13/07/27 21:23:13 INFO spark.SparkEnv: Registering MapOutputTracker
13/07/27 21:23:13 INFO spark.HttpFileServer: HTTP File server directory is /tmp/spark-fe65e661-8cd1-4520-8c33-f5baea1c50c9
13/07/27 21:23:13 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:23:13 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:44181
13/07/27 21:23:13 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:23:13 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage/rdd,null}
13/07/27 21:23:13 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:23:13 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:23:13 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:23:13 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:23:13 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:23:13 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:23:13 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:23:13 INFO server.AbstractConnector: Started SelectChannelConnector@0.0.0.0:33000
13/07/27 21:23:13 INFO ui.SparkUI: Started Spark Web UI at http://tachyon-ec2-0:33000
Spark context available as sc.
Type in expressions to have them evaluated.
Type :help for more information.

scala> val s = sc.textFile("tachyon://tachyon-ec2-0:19998/hit_data.tsv.1")
13/07/27 21:23:14 INFO storage.MemoryStore: ensureFreeSpace(58415) called with curMem=0, maxMem=1358297825
13/07/27 21:23:14 INFO storage.MemoryStore: Block broadcast_0 stored as values to memory (estimated size 57.0 KB, free 1295.3 MB)
s: spark.RDD[String] = MappedRDD[1] at textFile at <console>:12

scala> s.count()
13/07/27 21:23:14 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
13/07/27 21:23:14 WARN snappy.LoadSnappy: Snappy native library not loaded
13/07/27 21:23:14 INFO : initialize(tachyon://tachyon-ec2-0:19998/hit_data.tsv.1, Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml). Connecting to Tachyon: tachyon://tachyon-ec2-0:19998/hit_data.tsv.1
13/07/27 21:23:14 INFO : Trying to connect master @ tachyon-ec2-0/10.151.80.188:19998
13/07/27 21:23:14 INFO : User registered at the master tachyon-ec2-0/10.151.80.188:19998 got UserId 1
13/07/27 21:23:14 INFO : Trying to get local worker host : tachyon-ec2-0
13/07/27 21:23:14 INFO : Connecting local worker @ tachyon-ec2-0/10.151.80.188:29998
13/07/27 21:23:14 INFO : tachyon://tachyon-ec2-0:19998 tachyon://tachyon-ec2-0:19998 file:///mnt/tachyon
13/07/27 21:23:14 INFO : getFileStatus(/hit_data.tsv.1): HDFS Path: file:/mnt/tachyon/hit_data.tsv.1 TPath: tachyon://tachyon-ec2-0:19998/hit_data.tsv.1
13/07/27 21:23:14 INFO : tachyon.client.TachyonFS@3802cf6 file:///mnt/tachyon /hit_data.tsv.1 tachyon.PrefixList@5407cc45
13/07/27 21:23:15 INFO : Create tachyon file /hit_data.tsv.1 with file id 2 and checkpoint location file:///mnt/tachyon/hit_data.tsv.1
13/07/27 21:23:15 INFO mapred.FileInputFormat: Total input paths to process : 1
13/07/27 21:23:15 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:23:15 INFO scheduler.DAGScheduler: Got job 0 (count at <console>:15) with 1 output partitions (allowLocal=false)
13/07/27 21:23:15 INFO scheduler.DAGScheduler: Final stage: Stage 0 (count at <console>:15)
13/07/27 21:23:15 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:23:15 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:23:15 INFO scheduler.DAGScheduler: Submitting Stage 0 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:23:15 INFO scheduler.DAGScheduler: Submitting 1 missing tasks from Stage 0 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:23:15 INFO local.LocalTaskSetManager: Size of task 0 is 1494 bytes
13/07/27 21:23:15 INFO local.LocalScheduler: Running 0
13/07/27 21:23:15 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.1, 65536)
13/07/27 21:23:15 INFO : /mnt/ramdisk/tachyonworker/2147483648 is not on local disk.
13/07/27 21:23:15 INFO : Try to find and read from remote workers.
13/07/27 21:23:15 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:23:15 INFO : Folder /mnt/ramdisk/tachyonworker/users/1 was created!
13/07/27 21:23:15 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483648 was created!
13/07/27 21:23:15 INFO local.LocalScheduler: Finished 0
13/07/27 21:23:15 INFO local.LocalScheduler: Remove TaskSet 0.0 from pool 
13/07/27 21:23:15 INFO scheduler.DAGScheduler: Completed ResultTask(0, 0)
13/07/27 21:23:15 INFO scheduler.DAGScheduler: Stage 0 (count at <console>:15) finished in 0.364 s
13/07/27 21:23:15 INFO spark.SparkContext: Job finished: count at <console>:15, took 0.408040182 s
res0: Long = 1

scala> 13/07/27 21:23:15 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:23:15 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:23:15 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:23:15 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:23:15 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:23:15 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:23:15 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:23:15 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage/rdd,null}
Killed 1 processes
Killed 1 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting Tachyon @ tachyon-ec2-0
2013-07-27 21:23:17,517 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data
2013-07-27 21:23:17,521 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_log.data
2013-07-27 21:23:18,009 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/data
2013-07-27 21:23:18,021 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/workers

restaring tachyon
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Killed 0 processes
Killed 0 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting RamFS: /mnt/ramdisk
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata -Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Starting master @ tachyon-ec2-0
Starting worker @ tachyon-ec2-0

spark-shell count
24174 tachyon.Master
24201 tachyon.Worker

Going to fadvise /mnt/tachyon/hit_data.tsv.100 as mode POSIX_FADV_DONTNEED
offset: 0
length: 55735
mode: POSIX_FADV_DONTNEED
WIN
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/ubuntu/work/tachyon/target/tachyon-0.3.0-SNAPSHOT-jar-with-dependencies.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/ubuntu/work/spark/lib_managed/jars/slf4j-log4j12-1.7.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
Welcome to
      ____              __  
     / __/__  ___ _____/ /__
    _\ \/ _ \/ _ `/ __/  '_/
   /___/ .__/\_,_/_/ /_/\_\   version 0.8.0
      /_/                  

Using Scala version 2.9.3 (OpenJDK 64-Bit Server VM, Java 1.7.0_25)
Initializing interpreter...
13/07/27 21:23:24 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:23:24 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:41099
Creating SparkContext...
13/07/27 21:23:33 INFO slf4j.Slf4jEventHandler: Slf4jEventHandler started
13/07/27 21:23:33 INFO spark.SparkEnv: Registering BlockManagerMaster
13/07/27 21:23:33 INFO storage.MemoryStore: MemoryStore started with capacity 1295.4 MB.
13/07/27 21:23:33 INFO storage.DiskStore: Created local directory at /tmp/spark-local-20130727212333-000f
13/07/27 21:23:33 INFO network.ConnectionManager: Bound socket to port 33254 with id = ConnectionManagerId(tachyon-ec2-0,33254)
13/07/27 21:23:33 INFO storage.BlockManagerMaster: Trying to register BlockManager
13/07/27 21:23:33 INFO storage.BlockManagerMasterActor$BlockManagerInfo: Registering block manager tachyon-ec2-0:33254 with 1295.4 MB RAM
13/07/27 21:23:33 INFO storage.BlockManagerMaster: Registered BlockManager
13/07/27 21:23:33 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:23:33 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:44769
13/07/27 21:23:33 INFO broadcast.HttpBroadcast: Broadcast server started at http://10.151.80.188:44769
13/07/27 21:23:33 INFO spark.SparkEnv: Registering MapOutputTracker
13/07/27 21:23:33 INFO spark.HttpFileServer: HTTP File server directory is /tmp/spark-91a06db5-69e3-4e6a-b346-67a986d50427
13/07/27 21:23:33 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:23:33 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:43738
13/07/27 21:23:33 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:23:33 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage/rdd,null}
13/07/27 21:23:33 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:23:33 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:23:33 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:23:33 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:23:33 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:23:33 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:23:33 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:23:33 INFO server.AbstractConnector: Started SelectChannelConnector@0.0.0.0:33000
13/07/27 21:23:33 INFO ui.SparkUI: Started Spark Web UI at http://tachyon-ec2-0:33000
Spark context available as sc.
Type in expressions to have them evaluated.
Type :help for more information.

scala> val s = sc.textFile("tachyon://tachyon-ec2-0:19998/hit_data.tsv.100")
13/07/27 21:23:35 INFO storage.MemoryStore: ensureFreeSpace(58423) called with curMem=0, maxMem=1358297825
13/07/27 21:23:35 INFO storage.MemoryStore: Block broadcast_0 stored as values to memory (estimated size 57.1 KB, free 1295.3 MB)
s: spark.RDD[String] = MappedRDD[1] at textFile at <console>:12

scala> s.count()
13/07/27 21:23:35 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
13/07/27 21:23:35 WARN snappy.LoadSnappy: Snappy native library not loaded
13/07/27 21:23:35 INFO : initialize(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100, Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml). Connecting to Tachyon: tachyon://tachyon-ec2-0:19998/hit_data.tsv.100
13/07/27 21:23:35 INFO : Trying to connect master @ tachyon-ec2-0/10.151.80.188:19998
13/07/27 21:23:35 INFO : User registered at the master tachyon-ec2-0/10.151.80.188:19998 got UserId 1
13/07/27 21:23:35 INFO : Trying to get local worker host : tachyon-ec2-0
13/07/27 21:23:35 INFO : Connecting local worker @ tachyon-ec2-0/10.151.80.188:29998
13/07/27 21:23:35 INFO : tachyon://tachyon-ec2-0:19998 tachyon://tachyon-ec2-0:19998 file:///mnt/tachyon
13/07/27 21:23:35 INFO : getFileStatus(/hit_data.tsv.100): HDFS Path: file:/mnt/tachyon/hit_data.tsv.100 TPath: tachyon://tachyon-ec2-0:19998/hit_data.tsv.100
13/07/27 21:23:35 INFO : tachyon.client.TachyonFS@1e67c664 file:///mnt/tachyon /hit_data.tsv.100 tachyon.PrefixList@2f11ded4
13/07/27 21:23:36 INFO : Create tachyon file /hit_data.tsv.100 with file id 2 and checkpoint location file:///mnt/tachyon/hit_data.tsv.100
13/07/27 21:23:36 INFO mapred.FileInputFormat: Total input paths to process : 1
13/07/27 21:23:36 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:23:36 INFO scheduler.DAGScheduler: Got job 0 (count at <console>:15) with 1 output partitions (allowLocal=false)
13/07/27 21:23:36 INFO scheduler.DAGScheduler: Final stage: Stage 0 (count at <console>:15)
13/07/27 21:23:36 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:23:36 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:23:36 INFO scheduler.DAGScheduler: Submitting Stage 0 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:23:36 INFO scheduler.DAGScheduler: Submitting 1 missing tasks from Stage 0 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:23:36 INFO local.LocalTaskSetManager: Size of task 0 is 1496 bytes
13/07/27 21:23:36 INFO local.LocalScheduler: Running 0
13/07/27 21:23:36 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100, 65536)
13/07/27 21:23:36 INFO : /mnt/ramdisk/tachyonworker/2147483648 is not on local disk.
13/07/27 21:23:36 INFO : Try to find and read from remote workers.
13/07/27 21:23:36 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:23:36 INFO : Folder /mnt/ramdisk/tachyonworker/users/1 was created!
13/07/27 21:23:36 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483648 was created!
13/07/27 21:23:36 INFO local.LocalScheduler: Finished 0
13/07/27 21:23:36 INFO local.LocalScheduler: Remove TaskSet 0.0 from pool 
13/07/27 21:23:36 INFO scheduler.DAGScheduler: Completed ResultTask(0, 0)
13/07/27 21:23:36 INFO scheduler.DAGScheduler: Stage 0 (count at <console>:15) finished in 0.383 s
13/07/27 21:23:36 INFO spark.SparkContext: Job finished: count at <console>:15, took 0.427005643 s
res0: Long = 100

scala> 13/07/27 21:23:36 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:23:36 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:23:36 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:23:36 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:23:36 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:23:36 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:23:36 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:23:36 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage/rdd,null}
Killed 1 processes
Killed 1 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting Tachyon @ tachyon-ec2-0
2013-07-27 21:23:38,300 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data
2013-07-27 21:23:38,303 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_log.data
2013-07-27 21:23:38,789 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/data
2013-07-27 21:23:38,801 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/workers

restaring tachyon
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Killed 0 processes
Killed 0 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting RamFS: /mnt/ramdisk
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata -Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Starting master @ tachyon-ec2-0
Starting worker @ tachyon-ec2-0

spark-shell count
24731 tachyon.Master
24758 tachyon.Worker

Going to fadvise /mnt/tachyon/hit_data.tsv.1000 as mode POSIX_FADV_DONTNEED
offset: 0
length: 776400
mode: POSIX_FADV_DONTNEED
WIN
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/ubuntu/work/tachyon/target/tachyon-0.3.0-SNAPSHOT-jar-with-dependencies.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/ubuntu/work/spark/lib_managed/jars/slf4j-log4j12-1.7.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
Welcome to
      ____              __  
     / __/__  ___ _____/ /__
    _\ \/ _ \/ _ `/ __/  '_/
   /___/ .__/\_,_/_/ /_/\_\   version 0.8.0
      /_/                  

Using Scala version 2.9.3 (OpenJDK 64-Bit Server VM, Java 1.7.0_25)
Initializing interpreter...
13/07/27 21:23:45 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:23:45 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:33719
Creating SparkContext...
13/07/27 21:23:54 INFO slf4j.Slf4jEventHandler: Slf4jEventHandler started
13/07/27 21:23:54 INFO spark.SparkEnv: Registering BlockManagerMaster
13/07/27 21:23:54 INFO storage.MemoryStore: MemoryStore started with capacity 1295.4 MB.
13/07/27 21:23:54 INFO storage.DiskStore: Created local directory at /tmp/spark-local-20130727212354-8244
13/07/27 21:23:54 INFO network.ConnectionManager: Bound socket to port 34675 with id = ConnectionManagerId(tachyon-ec2-0,34675)
13/07/27 21:23:54 INFO storage.BlockManagerMaster: Trying to register BlockManager
13/07/27 21:23:54 INFO storage.BlockManagerMasterActor$BlockManagerInfo: Registering block manager tachyon-ec2-0:34675 with 1295.4 MB RAM
13/07/27 21:23:54 INFO storage.BlockManagerMaster: Registered BlockManager
13/07/27 21:23:54 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:23:54 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:42644
13/07/27 21:23:54 INFO broadcast.HttpBroadcast: Broadcast server started at http://10.151.80.188:42644
13/07/27 21:23:54 INFO spark.SparkEnv: Registering MapOutputTracker
13/07/27 21:23:54 INFO spark.HttpFileServer: HTTP File server directory is /tmp/spark-2737e5dc-4762-4ded-8d39-01058fab0463
13/07/27 21:23:54 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:23:54 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:51938
13/07/27 21:23:54 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:23:54 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage/rdd,null}
13/07/27 21:23:54 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:23:54 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:23:54 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:23:54 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:23:54 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:23:54 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:23:54 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:23:54 INFO server.AbstractConnector: Started SelectChannelConnector@0.0.0.0:33000
13/07/27 21:23:54 INFO ui.SparkUI: Started Spark Web UI at http://tachyon-ec2-0:33000
Spark context available as sc.
Type in expressions to have them evaluated.
Type :help for more information.

scala> val s = sc.textFile("tachyon://tachyon-ec2-0:19998/hit_data.tsv.1000")
13/07/27 21:23:55 INFO storage.MemoryStore: ensureFreeSpace(58423) called with curMem=0, maxMem=1358297825
13/07/27 21:23:55 INFO storage.MemoryStore: Block broadcast_0 stored as values to memory (estimated size 57.1 KB, free 1295.3 MB)
s: spark.RDD[String] = MappedRDD[1] at textFile at <console>:12

scala> s.count()
13/07/27 21:23:56 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
13/07/27 21:23:56 WARN snappy.LoadSnappy: Snappy native library not loaded
13/07/27 21:23:56 INFO : initialize(tachyon://tachyon-ec2-0:19998/hit_data.tsv.1000, Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml). Connecting to Tachyon: tachyon://tachyon-ec2-0:19998/hit_data.tsv.1000
13/07/27 21:23:56 INFO : Trying to connect master @ tachyon-ec2-0/10.151.80.188:19998
13/07/27 21:23:56 INFO : User registered at the master tachyon-ec2-0/10.151.80.188:19998 got UserId 1
13/07/27 21:23:56 INFO : Trying to get local worker host : tachyon-ec2-0
13/07/27 21:23:56 INFO : Connecting local worker @ tachyon-ec2-0/10.151.80.188:29998
13/07/27 21:23:56 INFO : tachyon://tachyon-ec2-0:19998 tachyon://tachyon-ec2-0:19998 file:///mnt/tachyon
13/07/27 21:23:56 INFO : getFileStatus(/hit_data.tsv.1000): HDFS Path: file:/mnt/tachyon/hit_data.tsv.1000 TPath: tachyon://tachyon-ec2-0:19998/hit_data.tsv.1000
13/07/27 21:23:56 INFO : tachyon.client.TachyonFS@3e3c4870 file:///mnt/tachyon /hit_data.tsv.1000 tachyon.PrefixList@67b7d0fb
13/07/27 21:23:56 INFO : Create tachyon file /hit_data.tsv.1000 with file id 2 and checkpoint location file:///mnt/tachyon/hit_data.tsv.1000
13/07/27 21:23:56 INFO mapred.FileInputFormat: Total input paths to process : 1
13/07/27 21:23:56 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:23:56 INFO scheduler.DAGScheduler: Got job 0 (count at <console>:15) with 1 output partitions (allowLocal=false)
13/07/27 21:23:56 INFO scheduler.DAGScheduler: Final stage: Stage 0 (count at <console>:15)
13/07/27 21:23:56 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:23:56 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:23:56 INFO scheduler.DAGScheduler: Submitting Stage 0 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:23:56 INFO scheduler.DAGScheduler: Submitting 1 missing tasks from Stage 0 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:23:57 INFO local.LocalTaskSetManager: Size of task 0 is 1497 bytes
13/07/27 21:23:57 INFO local.LocalScheduler: Running 0
13/07/27 21:23:57 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.1000, 65536)
13/07/27 21:23:57 INFO : /mnt/ramdisk/tachyonworker/2147483648 is not on local disk.
13/07/27 21:23:57 INFO : Try to find and read from remote workers.
13/07/27 21:23:57 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:23:57 INFO : Folder /mnt/ramdisk/tachyonworker/users/1 was created!
13/07/27 21:23:57 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483648 was created!
13/07/27 21:23:57 INFO local.LocalScheduler: Finished 0
13/07/27 21:23:57 INFO local.LocalScheduler: Remove TaskSet 0.0 from pool 
13/07/27 21:23:57 INFO scheduler.DAGScheduler: Completed ResultTask(0, 0)
13/07/27 21:23:57 INFO scheduler.DAGScheduler: Stage 0 (count at <console>:15) finished in 0.394 s
13/07/27 21:23:57 INFO spark.SparkContext: Job finished: count at <console>:15, took 0.43797505 s
res0: Long = 1000

scala> 13/07/27 21:23:57 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:23:57 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:23:57 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:23:57 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:23:57 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:23:57 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:23:57 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:23:57 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage/rdd,null}
Killed 1 processes
Killed 1 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting Tachyon @ tachyon-ec2-0
2013-07-27 21:23:59,086 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data
2013-07-27 21:23:59,089 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_log.data
2013-07-27 21:23:59,577 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/data
2013-07-27 21:23:59,588 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/workers

restaring tachyon
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Killed 0 processes
Killed 0 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting RamFS: /mnt/ramdisk
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata -Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Starting master @ tachyon-ec2-0
Starting worker @ tachyon-ec2-0

spark-shell count
25287 tachyon.Master
25314 tachyon.Worker

Going to fadvise /mnt/tachyon/hit_data.tsv.10000 as mode POSIX_FADV_DONTNEED
offset: 0
length: 12330369
mode: POSIX_FADV_DONTNEED
WIN
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/ubuntu/work/tachyon/target/tachyon-0.3.0-SNAPSHOT-jar-with-dependencies.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/ubuntu/work/spark/lib_managed/jars/slf4j-log4j12-1.7.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
Welcome to
      ____              __  
     / __/__  ___ _____/ /__
    _\ \/ _ \/ _ `/ __/  '_/
   /___/ .__/\_,_/_/ /_/\_\   version 0.8.0
      /_/                  

Using Scala version 2.9.3 (OpenJDK 64-Bit Server VM, Java 1.7.0_25)
Initializing interpreter...
13/07/27 21:24:05 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:24:05 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:53433
Creating SparkContext...
13/07/27 21:24:15 INFO slf4j.Slf4jEventHandler: Slf4jEventHandler started
13/07/27 21:24:15 INFO spark.SparkEnv: Registering BlockManagerMaster
13/07/27 21:24:15 INFO storage.MemoryStore: MemoryStore started with capacity 1295.4 MB.
13/07/27 21:24:15 INFO storage.DiskStore: Created local directory at /tmp/spark-local-20130727212415-d230
13/07/27 21:24:15 INFO network.ConnectionManager: Bound socket to port 52872 with id = ConnectionManagerId(tachyon-ec2-0,52872)
13/07/27 21:24:15 INFO storage.BlockManagerMaster: Trying to register BlockManager
13/07/27 21:24:15 INFO storage.BlockManagerMasterActor$BlockManagerInfo: Registering block manager tachyon-ec2-0:52872 with 1295.4 MB RAM
13/07/27 21:24:15 INFO storage.BlockManagerMaster: Registered BlockManager
13/07/27 21:24:15 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:24:15 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:43088
13/07/27 21:24:15 INFO broadcast.HttpBroadcast: Broadcast server started at http://10.151.80.188:43088
13/07/27 21:24:15 INFO spark.SparkEnv: Registering MapOutputTracker
13/07/27 21:24:15 INFO spark.HttpFileServer: HTTP File server directory is /tmp/spark-091a3ad8-3efb-42c3-b0a9-774099aff8e7
13/07/27 21:24:15 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:24:15 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:52943
13/07/27 21:24:15 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:24:15 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage/rdd,null}
13/07/27 21:24:15 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:24:15 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:24:15 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:24:15 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:24:15 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:24:15 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:24:15 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:24:15 INFO server.AbstractConnector: Started SelectChannelConnector@0.0.0.0:33000
13/07/27 21:24:15 INFO ui.SparkUI: Started Spark Web UI at http://tachyon-ec2-0:33000
Spark context available as sc.
Type in expressions to have them evaluated.
Type :help for more information.

scala> val s = sc.textFile("tachyon://tachyon-ec2-0:19998/hit_data.tsv.10000")
13/07/27 21:24:16 INFO storage.MemoryStore: ensureFreeSpace(58423) called with curMem=0, maxMem=1358297825
13/07/27 21:24:16 INFO storage.MemoryStore: Block broadcast_0 stored as values to memory (estimated size 57.1 KB, free 1295.3 MB)
s: spark.RDD[String] = MappedRDD[1] at textFile at <console>:12

scala> s.count()
13/07/27 21:24:17 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
13/07/27 21:24:17 WARN snappy.LoadSnappy: Snappy native library not loaded
13/07/27 21:24:17 INFO : initialize(tachyon://tachyon-ec2-0:19998/hit_data.tsv.10000, Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml). Connecting to Tachyon: tachyon://tachyon-ec2-0:19998/hit_data.tsv.10000
13/07/27 21:24:17 INFO : Trying to connect master @ tachyon-ec2-0/10.151.80.188:19998
13/07/27 21:24:17 INFO : User registered at the master tachyon-ec2-0/10.151.80.188:19998 got UserId 1
13/07/27 21:24:17 INFO : Trying to get local worker host : tachyon-ec2-0
13/07/27 21:24:17 INFO : Connecting local worker @ tachyon-ec2-0/10.151.80.188:29998
13/07/27 21:24:17 INFO : tachyon://tachyon-ec2-0:19998 tachyon://tachyon-ec2-0:19998 file:///mnt/tachyon
13/07/27 21:24:17 INFO : getFileStatus(/hit_data.tsv.10000): HDFS Path: file:/mnt/tachyon/hit_data.tsv.10000 TPath: tachyon://tachyon-ec2-0:19998/hit_data.tsv.10000
13/07/27 21:24:17 INFO : tachyon.client.TachyonFS@1cabf050 file:///mnt/tachyon /hit_data.tsv.10000 tachyon.PrefixList@5c2e22e4
13/07/27 21:24:17 INFO : Create tachyon file /hit_data.tsv.10000 with file id 2 and checkpoint location file:///mnt/tachyon/hit_data.tsv.10000
13/07/27 21:24:17 INFO mapred.FileInputFormat: Total input paths to process : 1
13/07/27 21:24:17 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:24:17 INFO scheduler.DAGScheduler: Got job 0 (count at <console>:15) with 1 output partitions (allowLocal=false)
13/07/27 21:24:17 INFO scheduler.DAGScheduler: Final stage: Stage 0 (count at <console>:15)
13/07/27 21:24:17 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:24:17 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:24:17 INFO scheduler.DAGScheduler: Submitting Stage 0 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:24:17 INFO scheduler.DAGScheduler: Submitting 1 missing tasks from Stage 0 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:24:18 INFO local.LocalTaskSetManager: Size of task 0 is 1498 bytes
13/07/27 21:24:18 INFO local.LocalScheduler: Running 0
13/07/27 21:24:18 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.10000, 65536)
13/07/27 21:24:18 INFO : /mnt/ramdisk/tachyonworker/2147483648 is not on local disk.
13/07/27 21:24:18 INFO : Try to find and read from remote workers.
13/07/27 21:24:18 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:24:18 INFO : Folder /mnt/ramdisk/tachyonworker/users/1 was created!
13/07/27 21:24:18 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483648 was created!
13/07/27 21:24:18 INFO local.LocalScheduler: Finished 0
13/07/27 21:24:18 INFO local.LocalScheduler: Remove TaskSet 0.0 from pool 
13/07/27 21:24:18 INFO scheduler.DAGScheduler: Completed ResultTask(0, 0)
13/07/27 21:24:18 INFO scheduler.DAGScheduler: Stage 0 (count at <console>:15) finished in 0.657 s
13/07/27 21:24:18 INFO spark.SparkContext: Job finished: count at <console>:15, took 0.700475741 s
res0: Long = 10000

scala> 13/07/27 21:24:18 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:24:18 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:24:18 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:24:18 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:24:18 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:24:18 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:24:18 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:24:18 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage/rdd,null}
Killed 1 processes
Killed 1 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting Tachyon @ tachyon-ec2-0
2013-07-27 21:24:20,312 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data
2013-07-27 21:24:20,316 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_log.data
2013-07-27 21:24:20,806 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/data
2013-07-27 21:24:20,818 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/workers

restaring tachyon
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Killed 0 processes
Killed 0 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting RamFS: /mnt/ramdisk
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata -Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Starting master @ tachyon-ec2-0
Starting worker @ tachyon-ec2-0

spark-shell count
25844 tachyon.Master
25871 tachyon.Worker

Going to fadvise /mnt/tachyon/hit_data.tsv.100000 as mode POSIX_FADV_DONTNEED
offset: 0
length: 125141299
mode: POSIX_FADV_DONTNEED
WIN
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/ubuntu/work/tachyon/target/tachyon-0.3.0-SNAPSHOT-jar-with-dependencies.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/ubuntu/work/spark/lib_managed/jars/slf4j-log4j12-1.7.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
Welcome to
      ____              __  
     / __/__  ___ _____/ /__
    _\ \/ _ \/ _ `/ __/  '_/
   /___/ .__/\_,_/_/ /_/\_\   version 0.8.0
      /_/                  

Using Scala version 2.9.3 (OpenJDK 64-Bit Server VM, Java 1.7.0_25)
Initializing interpreter...
13/07/27 21:24:27 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:24:27 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:55953
Creating SparkContext...
13/07/27 21:24:36 INFO slf4j.Slf4jEventHandler: Slf4jEventHandler started
13/07/27 21:24:36 INFO spark.SparkEnv: Registering BlockManagerMaster
13/07/27 21:24:36 INFO storage.MemoryStore: MemoryStore started with capacity 1295.4 MB.
13/07/27 21:24:36 INFO storage.DiskStore: Created local directory at /tmp/spark-local-20130727212436-576f
13/07/27 21:24:36 INFO network.ConnectionManager: Bound socket to port 52116 with id = ConnectionManagerId(tachyon-ec2-0,52116)
13/07/27 21:24:36 INFO storage.BlockManagerMaster: Trying to register BlockManager
13/07/27 21:24:36 INFO storage.BlockManagerMasterActor$BlockManagerInfo: Registering block manager tachyon-ec2-0:52116 with 1295.4 MB RAM
13/07/27 21:24:36 INFO storage.BlockManagerMaster: Registered BlockManager
13/07/27 21:24:36 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:24:36 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:46886
13/07/27 21:24:36 INFO broadcast.HttpBroadcast: Broadcast server started at http://10.151.80.188:46886
13/07/27 21:24:36 INFO spark.SparkEnv: Registering MapOutputTracker
13/07/27 21:24:36 INFO spark.HttpFileServer: HTTP File server directory is /tmp/spark-454a52db-ffc8-496c-89e5-f9ac03edeab6
13/07/27 21:24:36 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:24:36 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:41483
13/07/27 21:24:36 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:24:36 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage/rdd,null}
13/07/27 21:24:36 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:24:36 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:24:36 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:24:36 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:24:36 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:24:36 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:24:36 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:24:36 INFO server.AbstractConnector: Started SelectChannelConnector@0.0.0.0:33000
13/07/27 21:24:36 INFO ui.SparkUI: Started Spark Web UI at http://tachyon-ec2-0:33000
Spark context available as sc.
Type in expressions to have them evaluated.
Type :help for more information.

scala> val s = sc.textFile("tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000")
13/07/27 21:24:38 INFO storage.MemoryStore: ensureFreeSpace(58431) called with curMem=0, maxMem=1358297825
13/07/27 21:24:38 INFO storage.MemoryStore: Block broadcast_0 stored as values to memory (estimated size 57.1 KB, free 1295.3 MB)
s: spark.RDD[String] = MappedRDD[1] at textFile at <console>:12

scala> s.count()
13/07/27 21:24:38 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
13/07/27 21:24:38 WARN snappy.LoadSnappy: Snappy native library not loaded
13/07/27 21:24:38 INFO : initialize(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000, Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml). Connecting to Tachyon: tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000
13/07/27 21:24:38 INFO : Trying to connect master @ tachyon-ec2-0/10.151.80.188:19998
13/07/27 21:24:38 INFO : User registered at the master tachyon-ec2-0/10.151.80.188:19998 got UserId 1
13/07/27 21:24:38 INFO : Trying to get local worker host : tachyon-ec2-0
13/07/27 21:24:38 INFO : Connecting local worker @ tachyon-ec2-0/10.151.80.188:29998
13/07/27 21:24:38 INFO : tachyon://tachyon-ec2-0:19998 tachyon://tachyon-ec2-0:19998 file:///mnt/tachyon
13/07/27 21:24:38 INFO : getFileStatus(/hit_data.tsv.100000): HDFS Path: file:/mnt/tachyon/hit_data.tsv.100000 TPath: tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000
13/07/27 21:24:38 INFO : tachyon.client.TachyonFS@2f11ded4 file:///mnt/tachyon /hit_data.tsv.100000 tachyon.PrefixList@3e3c4870
13/07/27 21:24:38 INFO : Create tachyon file /hit_data.tsv.100000 with file id 2 and checkpoint location file:///mnt/tachyon/hit_data.tsv.100000
13/07/27 21:24:38 INFO mapred.FileInputFormat: Total input paths to process : 1
13/07/27 21:24:39 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:24:39 INFO scheduler.DAGScheduler: Got job 0 (count at <console>:15) with 4 output partitions (allowLocal=false)
13/07/27 21:24:39 INFO scheduler.DAGScheduler: Final stage: Stage 0 (count at <console>:15)
13/07/27 21:24:39 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:24:39 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:24:39 INFO scheduler.DAGScheduler: Submitting Stage 0 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:24:39 INFO scheduler.DAGScheduler: Submitting 4 missing tasks from Stage 0 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:24:39 INFO local.LocalTaskSetManager: Size of task 0 is 1499 bytes
13/07/27 21:24:39 INFO local.LocalScheduler: Running 0
13/07/27 21:24:39 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000, 65536)
13/07/27 21:24:39 INFO : /mnt/ramdisk/tachyonworker/2147483648 is not on local disk.
13/07/27 21:24:39 INFO : Try to find and read from remote workers.
13/07/27 21:24:39 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:24:39 INFO : Folder /mnt/ramdisk/tachyonworker/users/1 was created!
13/07/27 21:24:39 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483648 was created!
13/07/27 21:24:40 INFO : /mnt/ramdisk/tachyonworker/2147483649 is not on local disk.
13/07/27 21:24:40 INFO : Try to find and read from remote workers.
13/07/27 21:24:40 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:24:40 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483649 was created!
13/07/27 21:24:40 INFO local.LocalScheduler: Finished 0
13/07/27 21:24:40 INFO local.LocalTaskSetManager: Size of task 1 is 1499 bytes
13/07/27 21:24:40 INFO local.LocalScheduler: Running 1
13/07/27 21:24:40 INFO scheduler.DAGScheduler: Completed ResultTask(0, 0)
13/07/27 21:24:40 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000, 65536)
13/07/27 21:24:40 INFO : /mnt/ramdisk/tachyonworker/2147483650 is not on local disk.
13/07/27 21:24:40 INFO : Try to find and read from remote workers.
13/07/27 21:24:40 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:24:40 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483650 was created!
13/07/27 21:24:41 INFO local.LocalScheduler: Finished 1
13/07/27 21:24:41 INFO scheduler.DAGScheduler: Completed ResultTask(0, 1)
13/07/27 21:24:41 INFO local.LocalTaskSetManager: Size of task 2 is 1499 bytes
13/07/27 21:24:41 INFO local.LocalScheduler: Running 2
13/07/27 21:24:41 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000, 65536)
13/07/27 21:24:41 INFO : /mnt/ramdisk/tachyonworker/2147483651 is not on local disk.
13/07/27 21:24:41 INFO : Try to find and read from remote workers.
13/07/27 21:24:41 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:24:41 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483651 was created!
13/07/27 21:24:41 INFO local.LocalScheduler: Finished 2
13/07/27 21:24:41 INFO scheduler.DAGScheduler: Completed ResultTask(0, 2)
13/07/27 21:24:41 INFO local.LocalTaskSetManager: Size of task 3 is 1499 bytes
13/07/27 21:24:41 INFO local.LocalScheduler: Running 3
13/07/27 21:24:41 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000, 65536)
13/07/27 21:24:41 INFO local.LocalScheduler: Finished 3
13/07/27 21:24:41 INFO scheduler.DAGScheduler: Completed ResultTask(0, 3)
13/07/27 21:24:41 INFO local.LocalScheduler: Remove TaskSet 0.0 from pool 
13/07/27 21:24:41 INFO scheduler.DAGScheduler: Stage 0 (count at <console>:15) finished in 2.790 s
13/07/27 21:24:41 INFO spark.SparkContext: Job finished: count at <console>:15, took 2.836112854 s
res0: Long = 100002

scala> 13/07/27 21:24:41 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:24:41 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:24:41 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:24:41 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:24:41 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:24:41 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:24:41 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:24:41 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage/rdd,null}
Killed 1 processes
Killed 1 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting Tachyon @ tachyon-ec2-0
2013-07-27 21:24:43,647 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data
2013-07-27 21:24:43,651 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_log.data
2013-07-27 21:24:44,143 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/data
2013-07-27 21:24:44,155 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/workers

restaring tachyon
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Killed 0 processes
Killed 0 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting RamFS: /mnt/ramdisk
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata -Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Starting master @ tachyon-ec2-0
Starting worker @ tachyon-ec2-0

spark-shell count
26479 tachyon.Master
26507 tachyon.Worker

Going to fadvise /mnt/tachyon/hit_data.tsv.500000 as mode POSIX_FADV_DONTNEED
offset: 0
length: 618418417
mode: POSIX_FADV_DONTNEED
WIN
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/ubuntu/work/tachyon/target/tachyon-0.3.0-SNAPSHOT-jar-with-dependencies.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/ubuntu/work/spark/lib_managed/jars/slf4j-log4j12-1.7.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
Welcome to
      ____              __  
     / __/__  ___ _____/ /__
    _\ \/ _ \/ _ `/ __/  '_/
   /___/ .__/\_,_/_/ /_/\_\   version 0.8.0
      /_/                  

Using Scala version 2.9.3 (OpenJDK 64-Bit Server VM, Java 1.7.0_25)
Initializing interpreter...
13/07/27 21:24:50 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:24:50 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:47695
Creating SparkContext...
13/07/27 21:24:59 INFO slf4j.Slf4jEventHandler: Slf4jEventHandler started
13/07/27 21:24:59 INFO spark.SparkEnv: Registering BlockManagerMaster
13/07/27 21:24:59 INFO storage.MemoryStore: MemoryStore started with capacity 1295.4 MB.
13/07/27 21:24:59 INFO storage.DiskStore: Created local directory at /tmp/spark-local-20130727212459-fe83
13/07/27 21:24:59 INFO network.ConnectionManager: Bound socket to port 50371 with id = ConnectionManagerId(tachyon-ec2-0,50371)
13/07/27 21:24:59 INFO storage.BlockManagerMaster: Trying to register BlockManager
13/07/27 21:24:59 INFO storage.BlockManagerMasterActor$BlockManagerInfo: Registering block manager tachyon-ec2-0:50371 with 1295.4 MB RAM
13/07/27 21:24:59 INFO storage.BlockManagerMaster: Registered BlockManager
13/07/27 21:25:00 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:25:00 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:37120
13/07/27 21:25:00 INFO broadcast.HttpBroadcast: Broadcast server started at http://10.151.80.188:37120
13/07/27 21:25:00 INFO spark.SparkEnv: Registering MapOutputTracker
13/07/27 21:25:00 INFO spark.HttpFileServer: HTTP File server directory is /tmp/spark-579c2aa5-fb7b-4b7e-85cb-4e3798c70b4c
13/07/27 21:25:00 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:25:00 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:38715
13/07/27 21:25:00 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:25:00 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage/rdd,null}
13/07/27 21:25:00 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:25:00 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:25:00 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:25:00 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:25:00 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:25:00 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:25:00 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:25:00 INFO server.AbstractConnector: Started SelectChannelConnector@0.0.0.0:33000
13/07/27 21:25:00 INFO ui.SparkUI: Started Spark Web UI at http://tachyon-ec2-0:33000
Spark context available as sc.
Type in expressions to have them evaluated.
Type :help for more information.

scala> val s = sc.textFile("tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000")
13/07/27 21:25:01 INFO storage.MemoryStore: ensureFreeSpace(58431) called with curMem=0, maxMem=1358297825
13/07/27 21:25:01 INFO storage.MemoryStore: Block broadcast_0 stored as values to memory (estimated size 57.1 KB, free 1295.3 MB)
s: spark.RDD[String] = MappedRDD[1] at textFile at <console>:12

scala> s.count()
13/07/27 21:25:01 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
13/07/27 21:25:01 WARN snappy.LoadSnappy: Snappy native library not loaded
13/07/27 21:25:01 INFO : initialize(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml). Connecting to Tachyon: tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000
13/07/27 21:25:01 INFO : Trying to connect master @ tachyon-ec2-0/10.151.80.188:19998
13/07/27 21:25:01 INFO : User registered at the master tachyon-ec2-0/10.151.80.188:19998 got UserId 1
13/07/27 21:25:01 INFO : Trying to get local worker host : tachyon-ec2-0
13/07/27 21:25:01 INFO : Connecting local worker @ tachyon-ec2-0/10.151.80.188:29998
13/07/27 21:25:01 INFO : tachyon://tachyon-ec2-0:19998 tachyon://tachyon-ec2-0:19998 file:///mnt/tachyon
13/07/27 21:25:01 INFO : getFileStatus(/hit_data.tsv.500000): HDFS Path: file:/mnt/tachyon/hit_data.tsv.500000 TPath: tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000
13/07/27 21:25:01 INFO : tachyon.client.TachyonFS@1e67c664 file:///mnt/tachyon /hit_data.tsv.500000 tachyon.PrefixList@2f11ded4
13/07/27 21:25:02 INFO : Create tachyon file /hit_data.tsv.500000 with file id 2 and checkpoint location file:///mnt/tachyon/hit_data.tsv.500000
13/07/27 21:25:02 INFO mapred.FileInputFormat: Total input paths to process : 1
13/07/27 21:25:02 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:25:02 INFO scheduler.DAGScheduler: Got job 0 (count at <console>:15) with 19 output partitions (allowLocal=false)
13/07/27 21:25:02 INFO scheduler.DAGScheduler: Final stage: Stage 0 (count at <console>:15)
13/07/27 21:25:02 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:25:02 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:25:02 INFO scheduler.DAGScheduler: Submitting Stage 0 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:25:02 INFO scheduler.DAGScheduler: Submitting 19 missing tasks from Stage 0 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:25:02 INFO local.LocalTaskSetManager: Size of task 0 is 1499 bytes
13/07/27 21:25:02 INFO local.LocalScheduler: Running 0
13/07/27 21:25:03 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:25:03 INFO : /mnt/ramdisk/tachyonworker/2147483648 is not on local disk.
13/07/27 21:25:03 INFO : Try to find and read from remote workers.
13/07/27 21:25:03 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:25:03 INFO : Folder /mnt/ramdisk/tachyonworker/users/1 was created!
13/07/27 21:25:03 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483648 was created!
13/07/27 21:25:03 INFO : /mnt/ramdisk/tachyonworker/2147483649 is not on local disk.
13/07/27 21:25:03 INFO : Try to find and read from remote workers.
13/07/27 21:25:03 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:25:03 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483649 was created!
13/07/27 21:25:04 INFO local.LocalScheduler: Finished 0
13/07/27 21:25:04 INFO local.LocalTaskSetManager: Size of task 1 is 1499 bytes
13/07/27 21:25:04 INFO local.LocalScheduler: Running 1
13/07/27 21:25:04 INFO scheduler.DAGScheduler: Completed ResultTask(0, 0)
13/07/27 21:25:04 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:25:04 INFO : /mnt/ramdisk/tachyonworker/2147483650 is not on local disk.
13/07/27 21:25:04 INFO : Try to find and read from remote workers.
13/07/27 21:25:04 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:25:04 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483650 was created!
13/07/27 21:25:04 INFO local.LocalScheduler: Finished 1
13/07/27 21:25:04 INFO scheduler.DAGScheduler: Completed ResultTask(0, 1)
13/07/27 21:25:04 INFO local.LocalTaskSetManager: Size of task 2 is 1499 bytes
13/07/27 21:25:04 INFO local.LocalScheduler: Running 2
13/07/27 21:25:04 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:25:05 INFO : /mnt/ramdisk/tachyonworker/2147483651 is not on local disk.
13/07/27 21:25:05 INFO : Try to find and read from remote workers.
13/07/27 21:25:05 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:25:05 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483651 was created!
13/07/27 21:25:05 INFO local.LocalScheduler: Finished 2
13/07/27 21:25:05 INFO scheduler.DAGScheduler: Completed ResultTask(0, 2)
13/07/27 21:25:05 INFO local.LocalTaskSetManager: Size of task 3 is 1499 bytes
13/07/27 21:25:05 INFO local.LocalScheduler: Running 3
13/07/27 21:25:05 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:25:05 INFO : /mnt/ramdisk/tachyonworker/2147483652 is not on local disk.
13/07/27 21:25:05 INFO : Try to find and read from remote workers.
13/07/27 21:25:05 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:25:05 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483652 was created!
13/07/27 21:25:06 INFO local.LocalScheduler: Finished 3
13/07/27 21:25:06 INFO scheduler.DAGScheduler: Completed ResultTask(0, 3)
13/07/27 21:25:06 INFO local.LocalTaskSetManager: Size of task 4 is 1499 bytes
13/07/27 21:25:06 INFO local.LocalScheduler: Running 4
13/07/27 21:25:06 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:25:06 INFO : /mnt/ramdisk/tachyonworker/2147483653 is not on local disk.
13/07/27 21:25:06 INFO : Try to find and read from remote workers.
13/07/27 21:25:06 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:25:06 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483653 was created!
13/07/27 21:25:06 INFO local.LocalScheduler: Finished 4
13/07/27 21:25:06 INFO scheduler.DAGScheduler: Completed ResultTask(0, 4)
13/07/27 21:25:06 INFO local.LocalTaskSetManager: Size of task 5 is 1499 bytes
13/07/27 21:25:06 INFO local.LocalScheduler: Running 5
13/07/27 21:25:06 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:25:07 INFO : /mnt/ramdisk/tachyonworker/2147483654 is not on local disk.
13/07/27 21:25:07 INFO : Try to find and read from remote workers.
13/07/27 21:25:07 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:25:07 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483654 was created!
13/07/27 21:25:07 INFO local.LocalScheduler: Finished 5
13/07/27 21:25:07 INFO scheduler.DAGScheduler: Completed ResultTask(0, 5)
13/07/27 21:25:07 INFO local.LocalTaskSetManager: Size of task 6 is 1499 bytes
13/07/27 21:25:07 INFO local.LocalScheduler: Running 6
13/07/27 21:25:07 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:25:07 INFO : /mnt/ramdisk/tachyonworker/2147483655 is not on local disk.
13/07/27 21:25:07 INFO : Try to find and read from remote workers.
13/07/27 21:25:07 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:25:07 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483655 was created!
13/07/27 21:25:08 INFO local.LocalScheduler: Finished 6
13/07/27 21:25:08 INFO scheduler.DAGScheduler: Completed ResultTask(0, 6)
13/07/27 21:25:08 INFO local.LocalTaskSetManager: Size of task 7 is 1499 bytes
13/07/27 21:25:08 INFO local.LocalScheduler: Running 7
13/07/27 21:25:08 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:25:08 INFO : /mnt/ramdisk/tachyonworker/2147483656 is not on local disk.
13/07/27 21:25:08 INFO : Try to find and read from remote workers.
13/07/27 21:25:08 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:25:08 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483656 was created!
13/07/27 21:25:08 INFO local.LocalScheduler: Finished 7
13/07/27 21:25:08 INFO scheduler.DAGScheduler: Completed ResultTask(0, 7)
13/07/27 21:25:08 INFO local.LocalTaskSetManager: Size of task 8 is 1499 bytes
13/07/27 21:25:08 INFO local.LocalScheduler: Running 8
13/07/27 21:25:08 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:25:08 INFO : /mnt/ramdisk/tachyonworker/2147483657 is not on local disk.
13/07/27 21:25:08 INFO : Try to find and read from remote workers.
13/07/27 21:25:08 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:25:08 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483657 was created!
13/07/27 21:25:09 INFO local.LocalScheduler: Finished 8
13/07/27 21:25:09 INFO scheduler.DAGScheduler: Completed ResultTask(0, 8)
13/07/27 21:25:09 INFO local.LocalTaskSetManager: Size of task 9 is 1499 bytes
13/07/27 21:25:09 INFO local.LocalScheduler: Running 9
13/07/27 21:25:09 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:25:09 INFO : /mnt/ramdisk/tachyonworker/2147483658 is not on local disk.
13/07/27 21:25:09 INFO : Try to find and read from remote workers.
13/07/27 21:25:09 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:25:09 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483658 was created!
13/07/27 21:25:09 INFO local.LocalScheduler: Finished 9
13/07/27 21:25:09 INFO scheduler.DAGScheduler: Completed ResultTask(0, 9)
13/07/27 21:25:09 INFO local.LocalTaskSetManager: Size of task 10 is 1499 bytes
13/07/27 21:25:09 INFO local.LocalScheduler: Running 10
13/07/27 21:25:09 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:25:10 INFO : /mnt/ramdisk/tachyonworker/2147483659 is not on local disk.
13/07/27 21:25:10 INFO : Try to find and read from remote workers.
13/07/27 21:25:10 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:25:10 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483659 was created!
13/07/27 21:25:10 INFO local.LocalScheduler: Finished 10
13/07/27 21:25:10 INFO scheduler.DAGScheduler: Completed ResultTask(0, 10)
13/07/27 21:25:10 INFO local.LocalTaskSetManager: Size of task 11 is 1499 bytes
13/07/27 21:25:10 INFO local.LocalScheduler: Running 11
13/07/27 21:25:10 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:25:10 INFO : /mnt/ramdisk/tachyonworker/2147483660 is not on local disk.
13/07/27 21:25:10 INFO : Try to find and read from remote workers.
13/07/27 21:25:10 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:25:10 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483660 was created!
13/07/27 21:25:10 INFO local.LocalScheduler: Finished 11
13/07/27 21:25:10 INFO scheduler.DAGScheduler: Completed ResultTask(0, 11)
13/07/27 21:25:10 INFO local.LocalTaskSetManager: Size of task 12 is 1499 bytes
13/07/27 21:25:10 INFO local.LocalScheduler: Running 12
13/07/27 21:25:10 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:25:11 INFO : /mnt/ramdisk/tachyonworker/2147483661 is not on local disk.
13/07/27 21:25:11 INFO : Try to find and read from remote workers.
13/07/27 21:25:11 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:25:11 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483661 was created!
13/07/27 21:25:11 INFO local.LocalScheduler: Finished 12
13/07/27 21:25:11 INFO scheduler.DAGScheduler: Completed ResultTask(0, 12)
13/07/27 21:25:11 INFO local.LocalTaskSetManager: Size of task 13 is 1499 bytes
13/07/27 21:25:11 INFO local.LocalScheduler: Running 13
13/07/27 21:25:11 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:25:11 INFO : /mnt/ramdisk/tachyonworker/2147483662 is not on local disk.
13/07/27 21:25:11 INFO : Try to find and read from remote workers.
13/07/27 21:25:11 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:25:11 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483662 was created!
13/07/27 21:25:12 INFO local.LocalScheduler: Finished 13
13/07/27 21:25:12 INFO scheduler.DAGScheduler: Completed ResultTask(0, 13)
13/07/27 21:25:12 INFO local.LocalTaskSetManager: Size of task 14 is 1499 bytes
13/07/27 21:25:12 INFO local.LocalScheduler: Running 14
13/07/27 21:25:12 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:25:12 INFO : /mnt/ramdisk/tachyonworker/2147483663 is not on local disk.
13/07/27 21:25:12 INFO : Try to find and read from remote workers.
13/07/27 21:25:12 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:25:12 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483663 was created!
13/07/27 21:25:12 INFO local.LocalScheduler: Finished 14
13/07/27 21:25:12 INFO scheduler.DAGScheduler: Completed ResultTask(0, 14)
13/07/27 21:25:12 INFO local.LocalTaskSetManager: Size of task 15 is 1499 bytes
13/07/27 21:25:12 INFO local.LocalScheduler: Running 15
13/07/27 21:25:12 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:25:12 INFO : /mnt/ramdisk/tachyonworker/2147483664 is not on local disk.
13/07/27 21:25:12 INFO : Try to find and read from remote workers.
13/07/27 21:25:12 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:25:12 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483664 was created!
13/07/27 21:25:13 INFO local.LocalScheduler: Finished 15
13/07/27 21:25:13 INFO scheduler.DAGScheduler: Completed ResultTask(0, 15)
13/07/27 21:25:13 INFO local.LocalTaskSetManager: Size of task 16 is 1499 bytes
13/07/27 21:25:13 INFO local.LocalScheduler: Running 16
13/07/27 21:25:13 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:25:13 INFO : /mnt/ramdisk/tachyonworker/2147483665 is not on local disk.
13/07/27 21:25:13 INFO : Try to find and read from remote workers.
13/07/27 21:25:13 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:25:13 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483665 was created!
13/07/27 21:25:13 INFO local.LocalScheduler: Finished 16
13/07/27 21:25:13 INFO scheduler.DAGScheduler: Completed ResultTask(0, 16)
13/07/27 21:25:13 INFO local.LocalTaskSetManager: Size of task 17 is 1499 bytes
13/07/27 21:25:13 INFO local.LocalScheduler: Running 17
13/07/27 21:25:13 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:25:13 INFO : /mnt/ramdisk/tachyonworker/2147483666 is not on local disk.
13/07/27 21:25:13 INFO : Try to find and read from remote workers.
13/07/27 21:25:13 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:25:13 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483666 was created!
13/07/27 21:25:14 INFO local.LocalScheduler: Finished 17
13/07/27 21:25:14 INFO scheduler.DAGScheduler: Completed ResultTask(0, 17)
13/07/27 21:25:14 INFO local.LocalTaskSetManager: Size of task 18 is 1499 bytes
13/07/27 21:25:14 INFO local.LocalScheduler: Running 18
13/07/27 21:25:14 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:25:14 INFO local.LocalScheduler: Finished 18
13/07/27 21:25:14 INFO scheduler.DAGScheduler: Completed ResultTask(0, 18)
13/07/27 21:25:14 INFO local.LocalScheduler: Remove TaskSet 0.0 from pool 
13/07/27 21:25:14 INFO scheduler.DAGScheduler: Stage 0 (count at <console>:15) finished in 11.334 s
13/07/27 21:25:14 INFO spark.SparkContext: Job finished: count at <console>:15, took 11.388442802 s
res0: Long = 500094

scala> 13/07/27 21:25:14 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:25:14 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:25:14 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:25:14 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:25:14 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:25:14 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:25:14 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:25:14 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage/rdd,null}
Killed 1 processes
Killed 1 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting Tachyon @ tachyon-ec2-0
2013-07-27 21:25:16,033 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data
2013-07-27 21:25:16,037 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_log.data
2013-07-27 21:25:16,525 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/data
2013-07-27 21:25:16,537 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/workers

run1 #: 6

restaring tachyon
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Killed 0 processes
Killed 0 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting RamFS: /mnt/ramdisk
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata -Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Starting master @ tachyon-ec2-0
Starting worker @ tachyon-ec2-0

spark-shell count
27264 tachyon.Master
27291 tachyon.Worker

Going to fadvise /mnt/tachyon/hit_data.tsv.1 as mode POSIX_FADV_DONTNEED
offset: 0
length: 525
mode: POSIX_FADV_DONTNEED
WIN
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/ubuntu/work/tachyon/target/tachyon-0.3.0-SNAPSHOT-jar-with-dependencies.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/ubuntu/work/spark/lib_managed/jars/slf4j-log4j12-1.7.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
Welcome to
      ____              __  
     / __/__  ___ _____/ /__
    _\ \/ _ \/ _ `/ __/  '_/
   /___/ .__/\_,_/_/ /_/\_\   version 0.8.0
      /_/                  

Using Scala version 2.9.3 (OpenJDK 64-Bit Server VM, Java 1.7.0_25)
Initializing interpreter...
13/07/27 21:25:22 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:25:22 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:54231
Creating SparkContext...
13/07/27 21:25:32 INFO slf4j.Slf4jEventHandler: Slf4jEventHandler started
13/07/27 21:25:32 INFO spark.SparkEnv: Registering BlockManagerMaster
13/07/27 21:25:32 INFO storage.MemoryStore: MemoryStore started with capacity 1295.4 MB.
13/07/27 21:25:32 INFO storage.DiskStore: Created local directory at /tmp/spark-local-20130727212532-c379
13/07/27 21:25:32 INFO network.ConnectionManager: Bound socket to port 45069 with id = ConnectionManagerId(tachyon-ec2-0,45069)
13/07/27 21:25:32 INFO storage.BlockManagerMaster: Trying to register BlockManager
13/07/27 21:25:32 INFO storage.BlockManagerMasterActor$BlockManagerInfo: Registering block manager tachyon-ec2-0:45069 with 1295.4 MB RAM
13/07/27 21:25:32 INFO storage.BlockManagerMaster: Registered BlockManager
13/07/27 21:25:32 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:25:32 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:40455
13/07/27 21:25:32 INFO broadcast.HttpBroadcast: Broadcast server started at http://10.151.80.188:40455
13/07/27 21:25:32 INFO spark.SparkEnv: Registering MapOutputTracker
13/07/27 21:25:32 INFO spark.HttpFileServer: HTTP File server directory is /tmp/spark-9d191316-a8b8-4c74-ad9e-0e20f52cf721
13/07/27 21:25:32 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:25:32 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:55110
13/07/27 21:25:32 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:25:32 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage/rdd,null}
13/07/27 21:25:32 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:25:32 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:25:32 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:25:32 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:25:32 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:25:32 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:25:32 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:25:32 INFO server.AbstractConnector: Started SelectChannelConnector@0.0.0.0:33000
13/07/27 21:25:32 INFO ui.SparkUI: Started Spark Web UI at http://tachyon-ec2-0:33000
Spark context available as sc.
Type in expressions to have them evaluated.
Type :help for more information.

scala> val s = sc.textFile("tachyon://tachyon-ec2-0:19998/hit_data.tsv.1")
13/07/27 21:25:33 INFO storage.MemoryStore: ensureFreeSpace(58415) called with curMem=0, maxMem=1358297825
13/07/27 21:25:33 INFO storage.MemoryStore: Block broadcast_0 stored as values to memory (estimated size 57.0 KB, free 1295.3 MB)
s: spark.RDD[String] = MappedRDD[1] at textFile at <console>:12

scala> s.count()
13/07/27 21:25:34 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
13/07/27 21:25:34 WARN snappy.LoadSnappy: Snappy native library not loaded
13/07/27 21:25:34 INFO : initialize(tachyon://tachyon-ec2-0:19998/hit_data.tsv.1, Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml). Connecting to Tachyon: tachyon://tachyon-ec2-0:19998/hit_data.tsv.1
13/07/27 21:25:34 INFO : Trying to connect master @ tachyon-ec2-0/10.151.80.188:19998
13/07/27 21:25:34 INFO : User registered at the master tachyon-ec2-0/10.151.80.188:19998 got UserId 1
13/07/27 21:25:34 INFO : Trying to get local worker host : tachyon-ec2-0
13/07/27 21:25:34 INFO : Connecting local worker @ tachyon-ec2-0/10.151.80.188:29998
13/07/27 21:25:34 INFO : tachyon://tachyon-ec2-0:19998 tachyon://tachyon-ec2-0:19998 file:///mnt/tachyon
13/07/27 21:25:34 INFO : getFileStatus(/hit_data.tsv.1): HDFS Path: file:/mnt/tachyon/hit_data.tsv.1 TPath: tachyon://tachyon-ec2-0:19998/hit_data.tsv.1
13/07/27 21:25:34 INFO : tachyon.client.TachyonFS@4bf3f11c file:///mnt/tachyon /hit_data.tsv.1 tachyon.PrefixList@7c5a8c38
13/07/27 21:25:34 INFO : Create tachyon file /hit_data.tsv.1 with file id 2 and checkpoint location file:///mnt/tachyon/hit_data.tsv.1
13/07/27 21:25:34 INFO mapred.FileInputFormat: Total input paths to process : 1
13/07/27 21:25:34 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:25:34 INFO scheduler.DAGScheduler: Got job 0 (count at <console>:15) with 1 output partitions (allowLocal=false)
13/07/27 21:25:34 INFO scheduler.DAGScheduler: Final stage: Stage 0 (count at <console>:15)
13/07/27 21:25:34 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:25:34 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:25:34 INFO scheduler.DAGScheduler: Submitting Stage 0 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:25:34 INFO scheduler.DAGScheduler: Submitting 1 missing tasks from Stage 0 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:25:34 INFO local.LocalTaskSetManager: Size of task 0 is 1494 bytes
13/07/27 21:25:34 INFO local.LocalScheduler: Running 0
13/07/27 21:25:34 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.1, 65536)
13/07/27 21:25:35 INFO : /mnt/ramdisk/tachyonworker/2147483648 is not on local disk.
13/07/27 21:25:35 INFO : Try to find and read from remote workers.
13/07/27 21:25:35 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:25:35 INFO : Folder /mnt/ramdisk/tachyonworker/users/1 was created!
13/07/27 21:25:35 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483648 was created!
13/07/27 21:25:35 INFO local.LocalScheduler: Finished 0
13/07/27 21:25:35 INFO local.LocalScheduler: Remove TaskSet 0.0 from pool 
13/07/27 21:25:35 INFO scheduler.DAGScheduler: Completed ResultTask(0, 0)
13/07/27 21:25:35 INFO scheduler.DAGScheduler: Stage 0 (count at <console>:15) finished in 0.361 s
13/07/27 21:25:35 INFO spark.SparkContext: Job finished: count at <console>:15, took 0.405340611 s
res0: Long = 1

scala> 13/07/27 21:25:35 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:25:35 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:25:35 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:25:35 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:25:35 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:25:35 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:25:35 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:25:35 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage/rdd,null}
Killed 1 processes
Killed 1 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting Tachyon @ tachyon-ec2-0
2013-07-27 21:25:36,836 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data
2013-07-27 21:25:36,840 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_log.data
2013-07-27 21:25:37,327 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/data
2013-07-27 21:25:37,339 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/workers

restaring tachyon
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Killed 0 processes
Killed 0 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting RamFS: /mnt/ramdisk
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata -Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Starting master @ tachyon-ec2-0
Starting worker @ tachyon-ec2-0

spark-shell count
27821 tachyon.Master
27848 tachyon.Worker

Going to fadvise /mnt/tachyon/hit_data.tsv.100 as mode POSIX_FADV_DONTNEED
offset: 0
length: 55735
mode: POSIX_FADV_DONTNEED
WIN
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/ubuntu/work/tachyon/target/tachyon-0.3.0-SNAPSHOT-jar-with-dependencies.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/ubuntu/work/spark/lib_managed/jars/slf4j-log4j12-1.7.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
Welcome to
      ____              __  
     / __/__  ___ _____/ /__
    _\ \/ _ \/ _ `/ __/  '_/
   /___/ .__/\_,_/_/ /_/\_\   version 0.8.0
      /_/                  

Using Scala version 2.9.3 (OpenJDK 64-Bit Server VM, Java 1.7.0_25)
Initializing interpreter...
13/07/27 21:25:43 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:25:43 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:41907
Creating SparkContext...
13/07/27 21:25:52 INFO slf4j.Slf4jEventHandler: Slf4jEventHandler started
13/07/27 21:25:52 INFO spark.SparkEnv: Registering BlockManagerMaster
13/07/27 21:25:52 INFO storage.MemoryStore: MemoryStore started with capacity 1295.4 MB.
13/07/27 21:25:53 INFO storage.DiskStore: Created local directory at /tmp/spark-local-20130727212553-7142
13/07/27 21:25:53 INFO network.ConnectionManager: Bound socket to port 44759 with id = ConnectionManagerId(tachyon-ec2-0,44759)
13/07/27 21:25:53 INFO storage.BlockManagerMaster: Trying to register BlockManager
13/07/27 21:25:53 INFO storage.BlockManagerMasterActor$BlockManagerInfo: Registering block manager tachyon-ec2-0:44759 with 1295.4 MB RAM
13/07/27 21:25:53 INFO storage.BlockManagerMaster: Registered BlockManager
13/07/27 21:25:53 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:25:53 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:52218
13/07/27 21:25:53 INFO broadcast.HttpBroadcast: Broadcast server started at http://10.151.80.188:52218
13/07/27 21:25:53 INFO spark.SparkEnv: Registering MapOutputTracker
13/07/27 21:25:53 INFO spark.HttpFileServer: HTTP File server directory is /tmp/spark-7c191b50-c50e-4682-8b7f-6f68e75298c8
13/07/27 21:25:53 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:25:53 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:33553
13/07/27 21:25:53 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:25:53 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage/rdd,null}
13/07/27 21:25:53 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:25:53 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:25:53 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:25:53 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:25:53 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:25:53 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:25:53 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:25:53 INFO server.AbstractConnector: Started SelectChannelConnector@0.0.0.0:33000
13/07/27 21:25:53 INFO ui.SparkUI: Started Spark Web UI at http://tachyon-ec2-0:33000
Spark context available as sc.
Type in expressions to have them evaluated.
Type :help for more information.

scala> val s = sc.textFile("tachyon://tachyon-ec2-0:19998/hit_data.tsv.100")
13/07/27 21:25:54 INFO storage.MemoryStore: ensureFreeSpace(58423) called with curMem=0, maxMem=1358297825
13/07/27 21:25:54 INFO storage.MemoryStore: Block broadcast_0 stored as values to memory (estimated size 57.1 KB, free 1295.3 MB)
s: spark.RDD[String] = MappedRDD[1] at textFile at <console>:12

scala> s.count()
13/07/27 21:25:54 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
13/07/27 21:25:54 WARN snappy.LoadSnappy: Snappy native library not loaded
13/07/27 21:25:54 INFO : initialize(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100, Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml). Connecting to Tachyon: tachyon://tachyon-ec2-0:19998/hit_data.tsv.100
13/07/27 21:25:54 INFO : Trying to connect master @ tachyon-ec2-0/10.151.80.188:19998
13/07/27 21:25:54 INFO : User registered at the master tachyon-ec2-0/10.151.80.188:19998 got UserId 1
13/07/27 21:25:54 INFO : Trying to get local worker host : tachyon-ec2-0
13/07/27 21:25:54 INFO : Connecting local worker @ tachyon-ec2-0/10.151.80.188:29998
13/07/27 21:25:54 INFO : tachyon://tachyon-ec2-0:19998 tachyon://tachyon-ec2-0:19998 file:///mnt/tachyon
13/07/27 21:25:54 INFO : getFileStatus(/hit_data.tsv.100): HDFS Path: file:/mnt/tachyon/hit_data.tsv.100 TPath: tachyon://tachyon-ec2-0:19998/hit_data.tsv.100
13/07/27 21:25:54 INFO : tachyon.client.TachyonFS@1ea5113a file:///mnt/tachyon /hit_data.tsv.100 tachyon.PrefixList@670e068d
13/07/27 21:25:55 INFO : Create tachyon file /hit_data.tsv.100 with file id 2 and checkpoint location file:///mnt/tachyon/hit_data.tsv.100
13/07/27 21:25:55 INFO mapred.FileInputFormat: Total input paths to process : 1
13/07/27 21:25:55 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:25:55 INFO scheduler.DAGScheduler: Got job 0 (count at <console>:15) with 1 output partitions (allowLocal=false)
13/07/27 21:25:55 INFO scheduler.DAGScheduler: Final stage: Stage 0 (count at <console>:15)
13/07/27 21:25:55 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:25:55 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:25:55 INFO scheduler.DAGScheduler: Submitting Stage 0 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:25:55 INFO scheduler.DAGScheduler: Submitting 1 missing tasks from Stage 0 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:25:55 INFO local.LocalTaskSetManager: Size of task 0 is 1496 bytes
13/07/27 21:25:55 INFO local.LocalScheduler: Running 0
13/07/27 21:25:55 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100, 65536)
13/07/27 21:25:55 INFO : /mnt/ramdisk/tachyonworker/2147483648 is not on local disk.
13/07/27 21:25:55 INFO : Try to find and read from remote workers.
13/07/27 21:25:55 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:25:55 INFO : Folder /mnt/ramdisk/tachyonworker/users/1 was created!
13/07/27 21:25:55 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483648 was created!
13/07/27 21:25:55 INFO local.LocalScheduler: Finished 0
13/07/27 21:25:55 INFO local.LocalScheduler: Remove TaskSet 0.0 from pool 
13/07/27 21:25:55 INFO scheduler.DAGScheduler: Completed ResultTask(0, 0)
13/07/27 21:25:55 INFO scheduler.DAGScheduler: Stage 0 (count at <console>:15) finished in 0.385 s
13/07/27 21:25:55 INFO spark.SparkContext: Job finished: count at <console>:15, took 0.4295858 s
res0: Long = 100

scala> 13/07/27 21:25:55 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:25:55 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:25:55 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:25:55 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:25:55 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:25:55 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:25:55 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:25:55 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage/rdd,null}
Killed 1 processes
Killed 1 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting Tachyon @ tachyon-ec2-0
2013-07-27 21:25:57,627 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data
2013-07-27 21:25:57,631 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_log.data
2013-07-27 21:25:58,118 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/data
2013-07-27 21:25:58,129 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/workers

restaring tachyon
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Killed 0 processes
Killed 0 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting RamFS: /mnt/ramdisk
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata -Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Starting master @ tachyon-ec2-0
Starting worker @ tachyon-ec2-0

spark-shell count
28377 tachyon.Master
28404 tachyon.Worker

Going to fadvise /mnt/tachyon/hit_data.tsv.1000 as mode POSIX_FADV_DONTNEED
offset: 0
length: 776400
mode: POSIX_FADV_DONTNEED
WIN
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/ubuntu/work/tachyon/target/tachyon-0.3.0-SNAPSHOT-jar-with-dependencies.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/ubuntu/work/spark/lib_managed/jars/slf4j-log4j12-1.7.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
Welcome to
      ____              __  
     / __/__  ___ _____/ /__
    _\ \/ _ \/ _ `/ __/  '_/
   /___/ .__/\_,_/_/ /_/\_\   version 0.8.0
      /_/                  

Using Scala version 2.9.3 (OpenJDK 64-Bit Server VM, Java 1.7.0_25)
Initializing interpreter...
13/07/27 21:26:04 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:26:04 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:44311
Creating SparkContext...
13/07/27 21:26:13 INFO slf4j.Slf4jEventHandler: Slf4jEventHandler started
13/07/27 21:26:13 INFO spark.SparkEnv: Registering BlockManagerMaster
13/07/27 21:26:13 INFO storage.MemoryStore: MemoryStore started with capacity 1295.4 MB.
13/07/27 21:26:13 INFO storage.DiskStore: Created local directory at /tmp/spark-local-20130727212613-cf9c
13/07/27 21:26:13 INFO network.ConnectionManager: Bound socket to port 56325 with id = ConnectionManagerId(tachyon-ec2-0,56325)
13/07/27 21:26:13 INFO storage.BlockManagerMaster: Trying to register BlockManager
13/07/27 21:26:13 INFO storage.BlockManagerMasterActor$BlockManagerInfo: Registering block manager tachyon-ec2-0:56325 with 1295.4 MB RAM
13/07/27 21:26:13 INFO storage.BlockManagerMaster: Registered BlockManager
13/07/27 21:26:13 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:26:13 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:43638
13/07/27 21:26:13 INFO broadcast.HttpBroadcast: Broadcast server started at http://10.151.80.188:43638
13/07/27 21:26:13 INFO spark.SparkEnv: Registering MapOutputTracker
13/07/27 21:26:13 INFO spark.HttpFileServer: HTTP File server directory is /tmp/spark-78551b2e-c8a6-4c97-957f-8d195adaca32
13/07/27 21:26:13 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:26:13 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:41722
13/07/27 21:26:13 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:26:13 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage/rdd,null}
13/07/27 21:26:13 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:26:13 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:26:13 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:26:13 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:26:13 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:26:13 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:26:13 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:26:13 INFO server.AbstractConnector: Started SelectChannelConnector@0.0.0.0:33000
13/07/27 21:26:13 INFO ui.SparkUI: Started Spark Web UI at http://tachyon-ec2-0:33000
Spark context available as sc.
Type in expressions to have them evaluated.
Type :help for more information.

scala> val s = sc.textFile("tachyon://tachyon-ec2-0:19998/hit_data.tsv.1000")
13/07/27 21:26:15 INFO storage.MemoryStore: ensureFreeSpace(58423) called with curMem=0, maxMem=1358297825
13/07/27 21:26:15 INFO storage.MemoryStore: Block broadcast_0 stored as values to memory (estimated size 57.1 KB, free 1295.3 MB)
s: spark.RDD[String] = MappedRDD[1] at textFile at <console>:12

scala> s.count()
13/07/27 21:26:15 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
13/07/27 21:26:15 WARN snappy.LoadSnappy: Snappy native library not loaded
13/07/27 21:26:15 INFO : initialize(tachyon://tachyon-ec2-0:19998/hit_data.tsv.1000, Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml). Connecting to Tachyon: tachyon://tachyon-ec2-0:19998/hit_data.tsv.1000
13/07/27 21:26:15 INFO : Trying to connect master @ tachyon-ec2-0/10.151.80.188:19998
13/07/27 21:26:15 INFO : User registered at the master tachyon-ec2-0/10.151.80.188:19998 got UserId 1
13/07/27 21:26:15 INFO : Trying to get local worker host : tachyon-ec2-0
13/07/27 21:26:15 INFO : Connecting local worker @ tachyon-ec2-0/10.151.80.188:29998
13/07/27 21:26:15 INFO : tachyon://tachyon-ec2-0:19998 tachyon://tachyon-ec2-0:19998 file:///mnt/tachyon
13/07/27 21:26:15 INFO : getFileStatus(/hit_data.tsv.1000): HDFS Path: file:/mnt/tachyon/hit_data.tsv.1000 TPath: tachyon://tachyon-ec2-0:19998/hit_data.tsv.1000
13/07/27 21:26:15 INFO : tachyon.client.TachyonFS@773298a2 file:///mnt/tachyon /hit_data.tsv.1000 tachyon.PrefixList@1ac2f0d1
13/07/27 21:26:16 INFO : Create tachyon file /hit_data.tsv.1000 with file id 2 and checkpoint location file:///mnt/tachyon/hit_data.tsv.1000
13/07/27 21:26:16 INFO mapred.FileInputFormat: Total input paths to process : 1
13/07/27 21:26:16 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:26:16 INFO scheduler.DAGScheduler: Got job 0 (count at <console>:15) with 1 output partitions (allowLocal=false)
13/07/27 21:26:16 INFO scheduler.DAGScheduler: Final stage: Stage 0 (count at <console>:15)
13/07/27 21:26:16 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:26:16 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:26:16 INFO scheduler.DAGScheduler: Submitting Stage 0 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:26:16 INFO scheduler.DAGScheduler: Submitting 1 missing tasks from Stage 0 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:26:16 INFO local.LocalTaskSetManager: Size of task 0 is 1497 bytes
13/07/27 21:26:16 INFO local.LocalScheduler: Running 0
13/07/27 21:26:16 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.1000, 65536)
13/07/27 21:26:16 INFO : /mnt/ramdisk/tachyonworker/2147483648 is not on local disk.
13/07/27 21:26:16 INFO : Try to find and read from remote workers.
13/07/27 21:26:16 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:26:16 INFO : Folder /mnt/ramdisk/tachyonworker/users/1 was created!
13/07/27 21:26:16 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483648 was created!
13/07/27 21:26:16 INFO local.LocalScheduler: Finished 0
13/07/27 21:26:16 INFO local.LocalScheduler: Remove TaskSet 0.0 from pool 
13/07/27 21:26:16 INFO scheduler.DAGScheduler: Completed ResultTask(0, 0)
13/07/27 21:26:16 INFO scheduler.DAGScheduler: Stage 0 (count at <console>:15) finished in 0.397 s
13/07/27 21:26:16 INFO spark.SparkContext: Job finished: count at <console>:15, took 0.441242719 s
res0: Long = 1000

scala> 13/07/27 21:26:16 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:26:16 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:26:16 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:26:16 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:26:16 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:26:16 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:26:16 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:26:16 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage/rdd,null}
Killed 1 processes
Killed 1 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting Tachyon @ tachyon-ec2-0
2013-07-27 21:26:18,471 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data
2013-07-27 21:26:18,474 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_log.data
2013-07-27 21:26:18,970 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/data
2013-07-27 21:26:18,982 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/workers

restaring tachyon
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Killed 0 processes
Killed 0 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting RamFS: /mnt/ramdisk
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata -Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Starting master @ tachyon-ec2-0
Starting worker @ tachyon-ec2-0

spark-shell count
28934 tachyon.Master
28961 tachyon.Worker

Going to fadvise /mnt/tachyon/hit_data.tsv.10000 as mode POSIX_FADV_DONTNEED
offset: 0
length: 12330369
mode: POSIX_FADV_DONTNEED
WIN
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/ubuntu/work/tachyon/target/tachyon-0.3.0-SNAPSHOT-jar-with-dependencies.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/ubuntu/work/spark/lib_managed/jars/slf4j-log4j12-1.7.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
Welcome to
      ____              __  
     / __/__  ___ _____/ /__
    _\ \/ _ \/ _ `/ __/  '_/
   /___/ .__/\_,_/_/ /_/\_\   version 0.8.0
      /_/                  

Using Scala version 2.9.3 (OpenJDK 64-Bit Server VM, Java 1.7.0_25)
Initializing interpreter...
13/07/27 21:26:25 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:26:25 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:55385
Creating SparkContext...
13/07/27 21:26:34 INFO slf4j.Slf4jEventHandler: Slf4jEventHandler started
13/07/27 21:26:34 INFO spark.SparkEnv: Registering BlockManagerMaster
13/07/27 21:26:34 INFO storage.MemoryStore: MemoryStore started with capacity 1295.4 MB.
13/07/27 21:26:34 INFO storage.DiskStore: Created local directory at /tmp/spark-local-20130727212634-d003
13/07/27 21:26:34 INFO network.ConnectionManager: Bound socket to port 47610 with id = ConnectionManagerId(tachyon-ec2-0,47610)
13/07/27 21:26:34 INFO storage.BlockManagerMaster: Trying to register BlockManager
13/07/27 21:26:34 INFO storage.BlockManagerMasterActor$BlockManagerInfo: Registering block manager tachyon-ec2-0:47610 with 1295.4 MB RAM
13/07/27 21:26:34 INFO storage.BlockManagerMaster: Registered BlockManager
13/07/27 21:26:34 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:26:34 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:54067
13/07/27 21:26:34 INFO broadcast.HttpBroadcast: Broadcast server started at http://10.151.80.188:54067
13/07/27 21:26:34 INFO spark.SparkEnv: Registering MapOutputTracker
13/07/27 21:26:34 INFO spark.HttpFileServer: HTTP File server directory is /tmp/spark-6890516a-9a33-485e-8fd3-ed2f05cf336c
13/07/27 21:26:34 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:26:34 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:45202
13/07/27 21:26:34 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:26:34 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage/rdd,null}
13/07/27 21:26:34 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:26:34 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:26:34 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:26:34 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:26:34 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:26:34 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:26:34 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:26:34 INFO server.AbstractConnector: Started SelectChannelConnector@0.0.0.0:33000
13/07/27 21:26:34 INFO ui.SparkUI: Started Spark Web UI at http://tachyon-ec2-0:33000
Spark context available as sc.
Type in expressions to have them evaluated.
Type :help for more information.

scala> val s = sc.textFile("tachyon://tachyon-ec2-0:19998/hit_data.tsv.10000")
13/07/27 21:26:36 INFO storage.MemoryStore: ensureFreeSpace(58423) called with curMem=0, maxMem=1358297825
13/07/27 21:26:36 INFO storage.MemoryStore: Block broadcast_0 stored as values to memory (estimated size 57.1 KB, free 1295.3 MB)
s: spark.RDD[String] = MappedRDD[1] at textFile at <console>:12

scala> s.count()
13/07/27 21:26:36 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
13/07/27 21:26:36 WARN snappy.LoadSnappy: Snappy native library not loaded
13/07/27 21:26:36 INFO : initialize(tachyon://tachyon-ec2-0:19998/hit_data.tsv.10000, Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml). Connecting to Tachyon: tachyon://tachyon-ec2-0:19998/hit_data.tsv.10000
13/07/27 21:26:36 INFO : Trying to connect master @ tachyon-ec2-0/10.151.80.188:19998
13/07/27 21:26:36 INFO : User registered at the master tachyon-ec2-0/10.151.80.188:19998 got UserId 1
13/07/27 21:26:36 INFO : Trying to get local worker host : tachyon-ec2-0
13/07/27 21:26:36 INFO : Connecting local worker @ tachyon-ec2-0/10.151.80.188:29998
13/07/27 21:26:36 INFO : tachyon://tachyon-ec2-0:19998 tachyon://tachyon-ec2-0:19998 file:///mnt/tachyon
13/07/27 21:26:36 INFO : getFileStatus(/hit_data.tsv.10000): HDFS Path: file:/mnt/tachyon/hit_data.tsv.10000 TPath: tachyon://tachyon-ec2-0:19998/hit_data.tsv.10000
13/07/27 21:26:36 INFO : tachyon.client.TachyonFS@5407cc45 file:///mnt/tachyon /hit_data.tsv.10000 tachyon.PrefixList@4bf3f11c
13/07/27 21:26:37 INFO : Create tachyon file /hit_data.tsv.10000 with file id 2 and checkpoint location file:///mnt/tachyon/hit_data.tsv.10000
13/07/27 21:26:37 INFO mapred.FileInputFormat: Total input paths to process : 1
13/07/27 21:26:37 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:26:37 INFO scheduler.DAGScheduler: Got job 0 (count at <console>:15) with 1 output partitions (allowLocal=false)
13/07/27 21:26:37 INFO scheduler.DAGScheduler: Final stage: Stage 0 (count at <console>:15)
13/07/27 21:26:37 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:26:37 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:26:37 INFO scheduler.DAGScheduler: Submitting Stage 0 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:26:37 INFO scheduler.DAGScheduler: Submitting 1 missing tasks from Stage 0 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:26:37 INFO local.LocalTaskSetManager: Size of task 0 is 1498 bytes
13/07/27 21:26:37 INFO local.LocalScheduler: Running 0
13/07/27 21:26:37 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.10000, 65536)
13/07/27 21:26:37 INFO : /mnt/ramdisk/tachyonworker/2147483648 is not on local disk.
13/07/27 21:26:37 INFO : Try to find and read from remote workers.
13/07/27 21:26:37 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:26:37 INFO : Folder /mnt/ramdisk/tachyonworker/users/1 was created!
13/07/27 21:26:37 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483648 was created!
13/07/27 21:26:37 INFO local.LocalScheduler: Finished 0
13/07/27 21:26:37 INFO local.LocalScheduler: Remove TaskSet 0.0 from pool 
13/07/27 21:26:37 INFO scheduler.DAGScheduler: Completed ResultTask(0, 0)
13/07/27 21:26:37 INFO scheduler.DAGScheduler: Stage 0 (count at <console>:15) finished in 0.641 s
13/07/27 21:26:37 INFO spark.SparkContext: Job finished: count at <console>:15, took 0.683841371 s
res0: Long = 10000

scala> 13/07/27 21:26:37 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:26:37 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:26:37 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:26:37 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:26:37 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:26:37 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:26:37 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:26:37 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage/rdd,null}
Killed 1 processes
Killed 1 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting Tachyon @ tachyon-ec2-0
2013-07-27 21:26:39,578 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data
2013-07-27 21:26:39,582 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_log.data
2013-07-27 21:26:40,069 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/data
2013-07-27 21:26:40,081 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/workers

restaring tachyon
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Killed 0 processes
Killed 0 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting RamFS: /mnt/ramdisk
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata -Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Starting master @ tachyon-ec2-0
Starting worker @ tachyon-ec2-0

spark-shell count
29494 tachyon.Master
29521 tachyon.Worker

Going to fadvise /mnt/tachyon/hit_data.tsv.100000 as mode POSIX_FADV_DONTNEED
offset: 0
length: 125141299
mode: POSIX_FADV_DONTNEED
WIN
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/ubuntu/work/tachyon/target/tachyon-0.3.0-SNAPSHOT-jar-with-dependencies.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/ubuntu/work/spark/lib_managed/jars/slf4j-log4j12-1.7.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
Welcome to
      ____              __  
     / __/__  ___ _____/ /__
    _\ \/ _ \/ _ `/ __/  '_/
   /___/ .__/\_,_/_/ /_/\_\   version 0.8.0
      /_/                  

Using Scala version 2.9.3 (OpenJDK 64-Bit Server VM, Java 1.7.0_25)
Initializing interpreter...
13/07/27 21:26:46 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:26:46 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:53781
Creating SparkContext...
13/07/27 21:26:55 INFO slf4j.Slf4jEventHandler: Slf4jEventHandler started
13/07/27 21:26:55 INFO spark.SparkEnv: Registering BlockManagerMaster
13/07/27 21:26:55 INFO storage.MemoryStore: MemoryStore started with capacity 1295.4 MB.
13/07/27 21:26:55 INFO storage.DiskStore: Created local directory at /tmp/spark-local-20130727212655-b335
13/07/27 21:26:55 INFO network.ConnectionManager: Bound socket to port 39343 with id = ConnectionManagerId(tachyon-ec2-0,39343)
13/07/27 21:26:55 INFO storage.BlockManagerMaster: Trying to register BlockManager
13/07/27 21:26:55 INFO storage.BlockManagerMasterActor$BlockManagerInfo: Registering block manager tachyon-ec2-0:39343 with 1295.4 MB RAM
13/07/27 21:26:55 INFO storage.BlockManagerMaster: Registered BlockManager
13/07/27 21:26:55 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:26:55 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:50462
13/07/27 21:26:55 INFO broadcast.HttpBroadcast: Broadcast server started at http://10.151.80.188:50462
13/07/27 21:26:55 INFO spark.SparkEnv: Registering MapOutputTracker
13/07/27 21:26:55 INFO spark.HttpFileServer: HTTP File server directory is /tmp/spark-188d14c8-2763-48d4-99bf-ed9a49f645aa
13/07/27 21:26:55 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:26:55 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:49605
13/07/27 21:26:55 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:26:55 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage/rdd,null}
13/07/27 21:26:55 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:26:55 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:26:55 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:26:55 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:26:55 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:26:55 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:26:55 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:26:55 INFO server.AbstractConnector: Started SelectChannelConnector@0.0.0.0:33000
13/07/27 21:26:55 INFO ui.SparkUI: Started Spark Web UI at http://tachyon-ec2-0:33000
Spark context available as sc.
Type in expressions to have them evaluated.
Type :help for more information.

scala> val s = sc.textFile("tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000")
13/07/27 21:26:57 INFO storage.MemoryStore: ensureFreeSpace(58431) called with curMem=0, maxMem=1358297825
13/07/27 21:26:57 INFO storage.MemoryStore: Block broadcast_0 stored as values to memory (estimated size 57.1 KB, free 1295.3 MB)
s: spark.RDD[String] = MappedRDD[1] at textFile at <console>:12

scala> s.count()
13/07/27 21:26:57 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
13/07/27 21:26:57 WARN snappy.LoadSnappy: Snappy native library not loaded
13/07/27 21:26:57 INFO : initialize(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000, Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml). Connecting to Tachyon: tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000
13/07/27 21:26:57 INFO : Trying to connect master @ tachyon-ec2-0/10.151.80.188:19998
13/07/27 21:26:57 INFO : User registered at the master tachyon-ec2-0/10.151.80.188:19998 got UserId 1
13/07/27 21:26:57 INFO : Trying to get local worker host : tachyon-ec2-0
13/07/27 21:26:57 INFO : Connecting local worker @ tachyon-ec2-0/10.151.80.188:29998
13/07/27 21:26:57 INFO : tachyon://tachyon-ec2-0:19998 tachyon://tachyon-ec2-0:19998 file:///mnt/tachyon
13/07/27 21:26:57 INFO : getFileStatus(/hit_data.tsv.100000): HDFS Path: file:/mnt/tachyon/hit_data.tsv.100000 TPath: tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000
13/07/27 21:26:57 INFO : tachyon.client.TachyonFS@7c5a8c38 file:///mnt/tachyon /hit_data.tsv.100000 tachyon.PrefixList@1cabf050
13/07/27 21:26:58 INFO : Create tachyon file /hit_data.tsv.100000 with file id 2 and checkpoint location file:///mnt/tachyon/hit_data.tsv.100000
13/07/27 21:26:58 INFO mapred.FileInputFormat: Total input paths to process : 1
13/07/27 21:26:58 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:26:58 INFO scheduler.DAGScheduler: Got job 0 (count at <console>:15) with 4 output partitions (allowLocal=false)
13/07/27 21:26:58 INFO scheduler.DAGScheduler: Final stage: Stage 0 (count at <console>:15)
13/07/27 21:26:58 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:26:58 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:26:58 INFO scheduler.DAGScheduler: Submitting Stage 0 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:26:58 INFO scheduler.DAGScheduler: Submitting 4 missing tasks from Stage 0 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:26:58 INFO local.LocalTaskSetManager: Size of task 0 is 1499 bytes
13/07/27 21:26:58 INFO local.LocalScheduler: Running 0
13/07/27 21:26:58 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000, 65536)
13/07/27 21:26:58 INFO : /mnt/ramdisk/tachyonworker/2147483648 is not on local disk.
13/07/27 21:26:58 INFO : Try to find and read from remote workers.
13/07/27 21:26:58 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:26:58 INFO : Folder /mnt/ramdisk/tachyonworker/users/1 was created!
13/07/27 21:26:58 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483648 was created!
13/07/27 21:26:59 INFO : /mnt/ramdisk/tachyonworker/2147483649 is not on local disk.
13/07/27 21:26:59 INFO : Try to find and read from remote workers.
13/07/27 21:26:59 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:26:59 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483649 was created!
13/07/27 21:26:59 INFO local.LocalScheduler: Finished 0
13/07/27 21:26:59 INFO local.LocalTaskSetManager: Size of task 1 is 1499 bytes
13/07/27 21:26:59 INFO local.LocalScheduler: Running 1
13/07/27 21:26:59 INFO scheduler.DAGScheduler: Completed ResultTask(0, 0)
13/07/27 21:26:59 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000, 65536)
13/07/27 21:26:59 INFO : /mnt/ramdisk/tachyonworker/2147483650 is not on local disk.
13/07/27 21:26:59 INFO : Try to find and read from remote workers.
13/07/27 21:26:59 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:27:00 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483650 was created!
13/07/27 21:27:00 INFO local.LocalScheduler: Finished 1
13/07/27 21:27:00 INFO scheduler.DAGScheduler: Completed ResultTask(0, 1)
13/07/27 21:27:00 INFO local.LocalTaskSetManager: Size of task 2 is 1499 bytes
13/07/27 21:27:00 INFO local.LocalScheduler: Running 2
13/07/27 21:27:00 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000, 65536)
13/07/27 21:27:00 INFO : /mnt/ramdisk/tachyonworker/2147483651 is not on local disk.
13/07/27 21:27:00 INFO : Try to find and read from remote workers.
13/07/27 21:27:00 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:27:00 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483651 was created!
13/07/27 21:27:01 INFO local.LocalScheduler: Finished 2
13/07/27 21:27:01 INFO scheduler.DAGScheduler: Completed ResultTask(0, 2)
13/07/27 21:27:01 INFO local.LocalTaskSetManager: Size of task 3 is 1499 bytes
13/07/27 21:27:01 INFO local.LocalScheduler: Running 3
13/07/27 21:27:01 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000, 65536)
13/07/27 21:27:01 INFO local.LocalScheduler: Finished 3
13/07/27 21:27:01 INFO scheduler.DAGScheduler: Completed ResultTask(0, 3)
13/07/27 21:27:01 INFO local.LocalScheduler: Remove TaskSet 0.0 from pool 
13/07/27 21:27:01 INFO scheduler.DAGScheduler: Stage 0 (count at <console>:15) finished in 2.793 s
13/07/27 21:27:01 INFO spark.SparkContext: Job finished: count at <console>:15, took 2.846578981 s
res0: Long = 100002

scala> 13/07/27 21:27:01 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:27:01 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:27:01 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:27:01 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:27:01 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:27:01 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:27:01 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:27:01 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage/rdd,null}
Killed 1 processes
Killed 1 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting Tachyon @ tachyon-ec2-0
2013-07-27 21:27:02,954 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data
2013-07-27 21:27:02,958 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_log.data
2013-07-27 21:27:03,455 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/data
2013-07-27 21:27:03,467 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/workers

restaring tachyon
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Killed 0 processes
Killed 0 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting RamFS: /mnt/ramdisk
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata -Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Starting master @ tachyon-ec2-0
Starting worker @ tachyon-ec2-0

spark-shell count
30128 tachyon.Master
30155 tachyon.Worker

Going to fadvise /mnt/tachyon/hit_data.tsv.500000 as mode POSIX_FADV_DONTNEED
offset: 0
length: 618418417
mode: POSIX_FADV_DONTNEED
WIN
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/ubuntu/work/tachyon/target/tachyon-0.3.0-SNAPSHOT-jar-with-dependencies.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/ubuntu/work/spark/lib_managed/jars/slf4j-log4j12-1.7.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
Welcome to
      ____              __  
     / __/__  ___ _____/ /__
    _\ \/ _ \/ _ `/ __/  '_/
   /___/ .__/\_,_/_/ /_/\_\   version 0.8.0
      /_/                  

Using Scala version 2.9.3 (OpenJDK 64-Bit Server VM, Java 1.7.0_25)
Initializing interpreter...
13/07/27 21:27:09 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:27:09 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:45113
Creating SparkContext...
13/07/27 21:27:19 INFO slf4j.Slf4jEventHandler: Slf4jEventHandler started
13/07/27 21:27:19 INFO spark.SparkEnv: Registering BlockManagerMaster
13/07/27 21:27:19 INFO storage.MemoryStore: MemoryStore started with capacity 1295.4 MB.
13/07/27 21:27:19 INFO storage.DiskStore: Created local directory at /tmp/spark-local-20130727212719-22ac
13/07/27 21:27:19 INFO network.ConnectionManager: Bound socket to port 46124 with id = ConnectionManagerId(tachyon-ec2-0,46124)
13/07/27 21:27:19 INFO storage.BlockManagerMaster: Trying to register BlockManager
13/07/27 21:27:19 INFO storage.BlockManagerMasterActor$BlockManagerInfo: Registering block manager tachyon-ec2-0:46124 with 1295.4 MB RAM
13/07/27 21:27:19 INFO storage.BlockManagerMaster: Registered BlockManager
13/07/27 21:27:19 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:27:19 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:56518
13/07/27 21:27:19 INFO broadcast.HttpBroadcast: Broadcast server started at http://10.151.80.188:56518
13/07/27 21:27:19 INFO spark.SparkEnv: Registering MapOutputTracker
13/07/27 21:27:19 INFO spark.HttpFileServer: HTTP File server directory is /tmp/spark-0df3b5ae-ca7b-4775-b85c-f9af85c5f9a1
13/07/27 21:27:19 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:27:19 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:55481
13/07/27 21:27:19 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:27:19 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage/rdd,null}
13/07/27 21:27:19 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:27:19 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:27:19 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:27:19 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:27:19 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:27:19 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:27:19 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:27:19 INFO server.AbstractConnector: Started SelectChannelConnector@0.0.0.0:33000
13/07/27 21:27:19 INFO ui.SparkUI: Started Spark Web UI at http://tachyon-ec2-0:33000
Spark context available as sc.
Type in expressions to have them evaluated.
Type :help for more information.

scala> val s = sc.textFile("tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000")
13/07/27 21:27:20 INFO storage.MemoryStore: ensureFreeSpace(58431) called with curMem=0, maxMem=1358297825
13/07/27 21:27:20 INFO storage.MemoryStore: Block broadcast_0 stored as values to memory (estimated size 57.1 KB, free 1295.3 MB)
s: spark.RDD[String] = MappedRDD[1] at textFile at <console>:12

scala> s.count()
13/07/27 21:27:21 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
13/07/27 21:27:21 WARN snappy.LoadSnappy: Snappy native library not loaded
13/07/27 21:27:21 INFO : initialize(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml). Connecting to Tachyon: tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000
13/07/27 21:27:21 INFO : Trying to connect master @ tachyon-ec2-0/10.151.80.188:19998
13/07/27 21:27:21 INFO : User registered at the master tachyon-ec2-0/10.151.80.188:19998 got UserId 1
13/07/27 21:27:21 INFO : Trying to get local worker host : tachyon-ec2-0
13/07/27 21:27:21 INFO : Connecting local worker @ tachyon-ec2-0/10.151.80.188:29998
13/07/27 21:27:21 INFO : tachyon://tachyon-ec2-0:19998 tachyon://tachyon-ec2-0:19998 file:///mnt/tachyon
13/07/27 21:27:21 INFO : getFileStatus(/hit_data.tsv.500000): HDFS Path: file:/mnt/tachyon/hit_data.tsv.500000 TPath: tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000
13/07/27 21:27:21 INFO : tachyon.client.TachyonFS@592fa3df file:///mnt/tachyon /hit_data.tsv.500000 tachyon.PrefixList@46afb337
13/07/27 21:27:21 INFO : Create tachyon file /hit_data.tsv.500000 with file id 2 and checkpoint location file:///mnt/tachyon/hit_data.tsv.500000
13/07/27 21:27:21 INFO mapred.FileInputFormat: Total input paths to process : 1
13/07/27 21:27:22 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:27:22 INFO scheduler.DAGScheduler: Got job 0 (count at <console>:15) with 19 output partitions (allowLocal=false)
13/07/27 21:27:22 INFO scheduler.DAGScheduler: Final stage: Stage 0 (count at <console>:15)
13/07/27 21:27:22 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:27:22 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:27:22 INFO scheduler.DAGScheduler: Submitting Stage 0 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:27:22 INFO scheduler.DAGScheduler: Submitting 19 missing tasks from Stage 0 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:27:22 INFO local.LocalTaskSetManager: Size of task 0 is 1499 bytes
13/07/27 21:27:22 INFO local.LocalScheduler: Running 0
13/07/27 21:27:22 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:27:22 INFO : /mnt/ramdisk/tachyonworker/2147483648 is not on local disk.
13/07/27 21:27:22 INFO : Try to find and read from remote workers.
13/07/27 21:27:22 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:27:22 INFO : Folder /mnt/ramdisk/tachyonworker/users/1 was created!
13/07/27 21:27:22 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483648 was created!
13/07/27 21:27:23 INFO : /mnt/ramdisk/tachyonworker/2147483649 is not on local disk.
13/07/27 21:27:23 INFO : Try to find and read from remote workers.
13/07/27 21:27:23 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:27:23 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483649 was created!
13/07/27 21:27:23 INFO local.LocalScheduler: Finished 0
13/07/27 21:27:23 INFO local.LocalTaskSetManager: Size of task 1 is 1499 bytes
13/07/27 21:27:23 INFO local.LocalScheduler: Running 1
13/07/27 21:27:23 INFO scheduler.DAGScheduler: Completed ResultTask(0, 0)
13/07/27 21:27:23 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:27:23 INFO : /mnt/ramdisk/tachyonworker/2147483650 is not on local disk.
13/07/27 21:27:23 INFO : Try to find and read from remote workers.
13/07/27 21:27:23 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:27:23 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483650 was created!
13/07/27 21:27:24 INFO local.LocalScheduler: Finished 1
13/07/27 21:27:24 INFO scheduler.DAGScheduler: Completed ResultTask(0, 1)
13/07/27 21:27:24 INFO local.LocalTaskSetManager: Size of task 2 is 1499 bytes
13/07/27 21:27:24 INFO local.LocalScheduler: Running 2
13/07/27 21:27:24 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:27:24 INFO : /mnt/ramdisk/tachyonworker/2147483651 is not on local disk.
13/07/27 21:27:24 INFO : Try to find and read from remote workers.
13/07/27 21:27:24 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:27:24 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483651 was created!
13/07/27 21:27:24 INFO local.LocalScheduler: Finished 2
13/07/27 21:27:24 INFO scheduler.DAGScheduler: Completed ResultTask(0, 2)
13/07/27 21:27:24 INFO local.LocalTaskSetManager: Size of task 3 is 1499 bytes
13/07/27 21:27:24 INFO local.LocalScheduler: Running 3
13/07/27 21:27:24 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:27:25 INFO : /mnt/ramdisk/tachyonworker/2147483652 is not on local disk.
13/07/27 21:27:25 INFO : Try to find and read from remote workers.
13/07/27 21:27:25 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:27:25 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483652 was created!
13/07/27 21:27:25 INFO local.LocalScheduler: Finished 3
13/07/27 21:27:25 INFO scheduler.DAGScheduler: Completed ResultTask(0, 3)
13/07/27 21:27:25 INFO local.LocalTaskSetManager: Size of task 4 is 1499 bytes
13/07/27 21:27:25 INFO local.LocalScheduler: Running 4
13/07/27 21:27:25 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:27:25 INFO : /mnt/ramdisk/tachyonworker/2147483653 is not on local disk.
13/07/27 21:27:25 INFO : Try to find and read from remote workers.
13/07/27 21:27:25 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:27:25 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483653 was created!
13/07/27 21:27:25 INFO local.LocalScheduler: Finished 4
13/07/27 21:27:25 INFO scheduler.DAGScheduler: Completed ResultTask(0, 4)
13/07/27 21:27:25 INFO local.LocalTaskSetManager: Size of task 5 is 1499 bytes
13/07/27 21:27:25 INFO local.LocalScheduler: Running 5
13/07/27 21:27:25 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:27:26 INFO : /mnt/ramdisk/tachyonworker/2147483654 is not on local disk.
13/07/27 21:27:26 INFO : Try to find and read from remote workers.
13/07/27 21:27:26 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:27:26 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483654 was created!
13/07/27 21:27:26 INFO local.LocalScheduler: Finished 5
13/07/27 21:27:26 INFO scheduler.DAGScheduler: Completed ResultTask(0, 5)
13/07/27 21:27:26 INFO local.LocalTaskSetManager: Size of task 6 is 1499 bytes
13/07/27 21:27:26 INFO local.LocalScheduler: Running 6
13/07/27 21:27:26 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:27:26 INFO : /mnt/ramdisk/tachyonworker/2147483655 is not on local disk.
13/07/27 21:27:26 INFO : Try to find and read from remote workers.
13/07/27 21:27:26 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:27:26 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483655 was created!
13/07/27 21:27:27 INFO local.LocalScheduler: Finished 6
13/07/27 21:27:27 INFO scheduler.DAGScheduler: Completed ResultTask(0, 6)
13/07/27 21:27:27 INFO local.LocalTaskSetManager: Size of task 7 is 1499 bytes
13/07/27 21:27:27 INFO local.LocalScheduler: Running 7
13/07/27 21:27:27 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:27:27 INFO : /mnt/ramdisk/tachyonworker/2147483656 is not on local disk.
13/07/27 21:27:27 INFO : Try to find and read from remote workers.
13/07/27 21:27:27 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:27:27 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483656 was created!
13/07/27 21:27:27 INFO local.LocalScheduler: Finished 7
13/07/27 21:27:27 INFO scheduler.DAGScheduler: Completed ResultTask(0, 7)
13/07/27 21:27:27 INFO local.LocalTaskSetManager: Size of task 8 is 1499 bytes
13/07/27 21:27:27 INFO local.LocalScheduler: Running 8
13/07/27 21:27:27 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:27:27 INFO : /mnt/ramdisk/tachyonworker/2147483657 is not on local disk.
13/07/27 21:27:27 INFO : Try to find and read from remote workers.
13/07/27 21:27:27 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:27:28 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483657 was created!
13/07/27 21:27:28 INFO local.LocalScheduler: Finished 8
13/07/27 21:27:28 INFO scheduler.DAGScheduler: Completed ResultTask(0, 8)
13/07/27 21:27:28 INFO local.LocalTaskSetManager: Size of task 9 is 1499 bytes
13/07/27 21:27:28 INFO local.LocalScheduler: Running 9
13/07/27 21:27:28 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:27:28 INFO : /mnt/ramdisk/tachyonworker/2147483658 is not on local disk.
13/07/27 21:27:28 INFO : Try to find and read from remote workers.
13/07/27 21:27:28 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:27:28 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483658 was created!
13/07/27 21:27:28 INFO local.LocalScheduler: Finished 9
13/07/27 21:27:28 INFO scheduler.DAGScheduler: Completed ResultTask(0, 9)
13/07/27 21:27:28 INFO local.LocalTaskSetManager: Size of task 10 is 1499 bytes
13/07/27 21:27:28 INFO local.LocalScheduler: Running 10
13/07/27 21:27:28 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:27:29 INFO : /mnt/ramdisk/tachyonworker/2147483659 is not on local disk.
13/07/27 21:27:29 INFO : Try to find and read from remote workers.
13/07/27 21:27:29 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:27:29 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483659 was created!
13/07/27 21:27:29 INFO local.LocalScheduler: Finished 10
13/07/27 21:27:29 INFO scheduler.DAGScheduler: Completed ResultTask(0, 10)
13/07/27 21:27:29 INFO local.LocalTaskSetManager: Size of task 11 is 1499 bytes
13/07/27 21:27:29 INFO local.LocalScheduler: Running 11
13/07/27 21:27:29 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:27:29 INFO : /mnt/ramdisk/tachyonworker/2147483660 is not on local disk.
13/07/27 21:27:29 INFO : Try to find and read from remote workers.
13/07/27 21:27:29 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:27:29 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483660 was created!
13/07/27 21:27:29 INFO local.LocalScheduler: Finished 11
13/07/27 21:27:29 INFO scheduler.DAGScheduler: Completed ResultTask(0, 11)
13/07/27 21:27:29 INFO local.LocalTaskSetManager: Size of task 12 is 1499 bytes
13/07/27 21:27:29 INFO local.LocalScheduler: Running 12
13/07/27 21:27:29 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:27:30 INFO : /mnt/ramdisk/tachyonworker/2147483661 is not on local disk.
13/07/27 21:27:30 INFO : Try to find and read from remote workers.
13/07/27 21:27:30 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:27:30 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483661 was created!
13/07/27 21:27:30 INFO local.LocalScheduler: Finished 12
13/07/27 21:27:30 INFO scheduler.DAGScheduler: Completed ResultTask(0, 12)
13/07/27 21:27:30 INFO local.LocalTaskSetManager: Size of task 13 is 1499 bytes
13/07/27 21:27:30 INFO local.LocalScheduler: Running 13
13/07/27 21:27:30 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:27:30 INFO : /mnt/ramdisk/tachyonworker/2147483662 is not on local disk.
13/07/27 21:27:30 INFO : Try to find and read from remote workers.
13/07/27 21:27:30 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:27:30 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483662 was created!
13/07/27 21:27:31 INFO local.LocalScheduler: Finished 13
13/07/27 21:27:31 INFO scheduler.DAGScheduler: Completed ResultTask(0, 13)
13/07/27 21:27:31 INFO local.LocalTaskSetManager: Size of task 14 is 1499 bytes
13/07/27 21:27:31 INFO local.LocalScheduler: Running 14
13/07/27 21:27:31 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:27:31 INFO : /mnt/ramdisk/tachyonworker/2147483663 is not on local disk.
13/07/27 21:27:31 INFO : Try to find and read from remote workers.
13/07/27 21:27:31 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:27:31 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483663 was created!
13/07/27 21:27:31 INFO local.LocalScheduler: Finished 14
13/07/27 21:27:31 INFO scheduler.DAGScheduler: Completed ResultTask(0, 14)
13/07/27 21:27:31 INFO local.LocalTaskSetManager: Size of task 15 is 1499 bytes
13/07/27 21:27:31 INFO local.LocalScheduler: Running 15
13/07/27 21:27:31 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:27:31 INFO : /mnt/ramdisk/tachyonworker/2147483664 is not on local disk.
13/07/27 21:27:31 INFO : Try to find and read from remote workers.
13/07/27 21:27:31 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:27:31 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483664 was created!
13/07/27 21:27:32 INFO local.LocalScheduler: Finished 15
13/07/27 21:27:32 INFO scheduler.DAGScheduler: Completed ResultTask(0, 15)
13/07/27 21:27:32 INFO local.LocalTaskSetManager: Size of task 16 is 1499 bytes
13/07/27 21:27:32 INFO local.LocalScheduler: Running 16
13/07/27 21:27:32 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:27:32 INFO : /mnt/ramdisk/tachyonworker/2147483665 is not on local disk.
13/07/27 21:27:32 INFO : Try to find and read from remote workers.
13/07/27 21:27:32 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:27:32 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483665 was created!
13/07/27 21:27:32 INFO local.LocalScheduler: Finished 16
13/07/27 21:27:32 INFO scheduler.DAGScheduler: Completed ResultTask(0, 16)
13/07/27 21:27:32 INFO local.LocalTaskSetManager: Size of task 17 is 1499 bytes
13/07/27 21:27:32 INFO local.LocalScheduler: Running 17
13/07/27 21:27:32 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:27:32 INFO : /mnt/ramdisk/tachyonworker/2147483666 is not on local disk.
13/07/27 21:27:32 INFO : Try to find and read from remote workers.
13/07/27 21:27:32 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:27:33 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483666 was created!
13/07/27 21:27:33 INFO local.LocalScheduler: Finished 17
13/07/27 21:27:33 INFO scheduler.DAGScheduler: Completed ResultTask(0, 17)
13/07/27 21:27:33 INFO local.LocalTaskSetManager: Size of task 18 is 1499 bytes
13/07/27 21:27:33 INFO local.LocalScheduler: Running 18
13/07/27 21:27:33 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:27:33 INFO local.LocalScheduler: Finished 18
13/07/27 21:27:33 INFO scheduler.DAGScheduler: Completed ResultTask(0, 18)
13/07/27 21:27:33 INFO local.LocalScheduler: Remove TaskSet 0.0 from pool 
13/07/27 21:27:33 INFO scheduler.DAGScheduler: Stage 0 (count at <console>:15) finished in 11.061 s
13/07/27 21:27:33 INFO spark.SparkContext: Job finished: count at <console>:15, took 11.112068942 s
res0: Long = 500094

scala> 13/07/27 21:27:33 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:27:33 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:27:33 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:27:33 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:27:33 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:27:33 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:27:33 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:27:33 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage/rdd,null}
Killed 1 processes
Killed 1 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting Tachyon @ tachyon-ec2-0
2013-07-27 21:27:35,044 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data
2013-07-27 21:27:35,047 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_log.data
2013-07-27 21:27:35,534 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/data
2013-07-27 21:27:35,546 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/workers

run1 #: 7

restaring tachyon
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Killed 0 processes
Killed 0 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting RamFS: /mnt/ramdisk
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata -Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Starting master @ tachyon-ec2-0
Starting worker @ tachyon-ec2-0

spark-shell count
30900 tachyon.Master
30927 tachyon.Worker

Going to fadvise /mnt/tachyon/hit_data.tsv.1 as mode POSIX_FADV_DONTNEED
offset: 0
length: 525
mode: POSIX_FADV_DONTNEED
WIN
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/ubuntu/work/tachyon/target/tachyon-0.3.0-SNAPSHOT-jar-with-dependencies.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/ubuntu/work/spark/lib_managed/jars/slf4j-log4j12-1.7.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
Welcome to
      ____              __  
     / __/__  ___ _____/ /__
    _\ \/ _ \/ _ `/ __/  '_/
   /___/ .__/\_,_/_/ /_/\_\   version 0.8.0
      /_/                  

Using Scala version 2.9.3 (OpenJDK 64-Bit Server VM, Java 1.7.0_25)
Initializing interpreter...
13/07/27 21:27:41 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:27:41 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:32802
Creating SparkContext...
13/07/27 21:27:50 INFO slf4j.Slf4jEventHandler: Slf4jEventHandler started
13/07/27 21:27:51 INFO spark.SparkEnv: Registering BlockManagerMaster
13/07/27 21:27:51 INFO storage.MemoryStore: MemoryStore started with capacity 1295.4 MB.
13/07/27 21:27:51 INFO storage.DiskStore: Created local directory at /tmp/spark-local-20130727212751-1810
13/07/27 21:27:51 INFO network.ConnectionManager: Bound socket to port 41531 with id = ConnectionManagerId(tachyon-ec2-0,41531)
13/07/27 21:27:51 INFO storage.BlockManagerMaster: Trying to register BlockManager
13/07/27 21:27:51 INFO storage.BlockManagerMasterActor$BlockManagerInfo: Registering block manager tachyon-ec2-0:41531 with 1295.4 MB RAM
13/07/27 21:27:51 INFO storage.BlockManagerMaster: Registered BlockManager
13/07/27 21:27:51 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:27:51 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:46491
13/07/27 21:27:51 INFO broadcast.HttpBroadcast: Broadcast server started at http://10.151.80.188:46491
13/07/27 21:27:51 INFO spark.SparkEnv: Registering MapOutputTracker
13/07/27 21:27:51 INFO spark.HttpFileServer: HTTP File server directory is /tmp/spark-7355acfa-4d24-4cce-9080-50875170bb1f
13/07/27 21:27:51 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:27:51 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:58437
13/07/27 21:27:51 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:27:51 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage/rdd,null}
13/07/27 21:27:51 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:27:51 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:27:51 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:27:51 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:27:51 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:27:51 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:27:51 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:27:51 INFO server.AbstractConnector: Started SelectChannelConnector@0.0.0.0:33000
13/07/27 21:27:51 INFO ui.SparkUI: Started Spark Web UI at http://tachyon-ec2-0:33000
Spark context available as sc.
Type in expressions to have them evaluated.
Type :help for more information.

scala> val s = sc.textFile("tachyon://tachyon-ec2-0:19998/hit_data.tsv.1")
13/07/27 21:27:52 INFO storage.MemoryStore: ensureFreeSpace(58415) called with curMem=0, maxMem=1358297825
13/07/27 21:27:52 INFO storage.MemoryStore: Block broadcast_0 stored as values to memory (estimated size 57.0 KB, free 1295.3 MB)
s: spark.RDD[String] = MappedRDD[1] at textFile at <console>:12

scala> s.count()
13/07/27 21:27:53 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
13/07/27 21:27:53 WARN snappy.LoadSnappy: Snappy native library not loaded
13/07/27 21:27:53 INFO : initialize(tachyon://tachyon-ec2-0:19998/hit_data.tsv.1, Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml). Connecting to Tachyon: tachyon://tachyon-ec2-0:19998/hit_data.tsv.1
13/07/27 21:27:53 INFO : Trying to connect master @ tachyon-ec2-0/10.151.80.188:19998
13/07/27 21:27:53 INFO : User registered at the master tachyon-ec2-0/10.151.80.188:19998 got UserId 1
13/07/27 21:27:53 INFO : Trying to get local worker host : tachyon-ec2-0
13/07/27 21:27:53 INFO : Connecting local worker @ tachyon-ec2-0/10.151.80.188:29998
13/07/27 21:27:53 INFO : tachyon://tachyon-ec2-0:19998 tachyon://tachyon-ec2-0:19998 file:///mnt/tachyon
13/07/27 21:27:53 INFO : getFileStatus(/hit_data.tsv.1): HDFS Path: file:/mnt/tachyon/hit_data.tsv.1 TPath: tachyon://tachyon-ec2-0:19998/hit_data.tsv.1
13/07/27 21:27:53 INFO : tachyon.client.TachyonFS@46afb337 file:///mnt/tachyon /hit_data.tsv.1 tachyon.PrefixList@391f0422
13/07/27 21:27:53 INFO : Create tachyon file /hit_data.tsv.1 with file id 2 and checkpoint location file:///mnt/tachyon/hit_data.tsv.1
13/07/27 21:27:53 INFO mapred.FileInputFormat: Total input paths to process : 1
13/07/27 21:27:53 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:27:53 INFO scheduler.DAGScheduler: Got job 0 (count at <console>:15) with 1 output partitions (allowLocal=false)
13/07/27 21:27:53 INFO scheduler.DAGScheduler: Final stage: Stage 0 (count at <console>:15)
13/07/27 21:27:53 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:27:53 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:27:53 INFO scheduler.DAGScheduler: Submitting Stage 0 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:27:53 INFO scheduler.DAGScheduler: Submitting 1 missing tasks from Stage 0 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:27:53 INFO local.LocalTaskSetManager: Size of task 0 is 1494 bytes
13/07/27 21:27:53 INFO local.LocalScheduler: Running 0
13/07/27 21:27:53 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.1, 65536)
13/07/27 21:27:53 INFO : /mnt/ramdisk/tachyonworker/2147483648 is not on local disk.
13/07/27 21:27:53 INFO : Try to find and read from remote workers.
13/07/27 21:27:53 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:27:54 INFO : Folder /mnt/ramdisk/tachyonworker/users/1 was created!
13/07/27 21:27:54 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483648 was created!
13/07/27 21:27:54 INFO local.LocalScheduler: Finished 0
13/07/27 21:27:54 INFO local.LocalScheduler: Remove TaskSet 0.0 from pool 
13/07/27 21:27:54 INFO scheduler.DAGScheduler: Completed ResultTask(0, 0)
13/07/27 21:27:54 INFO scheduler.DAGScheduler: Stage 0 (count at <console>:15) finished in 0.359 s
13/07/27 21:27:54 INFO spark.SparkContext: Job finished: count at <console>:15, took 0.403150155 s
res0: Long = 1

scala> 13/07/27 21:27:54 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:27:54 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:27:54 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:27:54 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:27:54 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:27:54 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:27:54 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:27:54 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage/rdd,null}
Killed 1 processes
Killed 1 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting Tachyon @ tachyon-ec2-0
2013-07-27 21:27:55,780 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data
2013-07-27 21:27:55,784 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_log.data
2013-07-27 21:27:56,273 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/data
2013-07-27 21:27:56,285 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/workers

restaring tachyon
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Killed 0 processes
Killed 0 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting RamFS: /mnt/ramdisk
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata -Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Starting master @ tachyon-ec2-0
Starting worker @ tachyon-ec2-0

spark-shell count
31467 tachyon.Master
31494 tachyon.Worker

Going to fadvise /mnt/tachyon/hit_data.tsv.100 as mode POSIX_FADV_DONTNEED
offset: 0
length: 55735
mode: POSIX_FADV_DONTNEED
WIN
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/ubuntu/work/tachyon/target/tachyon-0.3.0-SNAPSHOT-jar-with-dependencies.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/ubuntu/work/spark/lib_managed/jars/slf4j-log4j12-1.7.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
Welcome to
      ____              __  
     / __/__  ___ _____/ /__
    _\ \/ _ \/ _ `/ __/  '_/
   /___/ .__/\_,_/_/ /_/\_\   version 0.8.0
      /_/                  

Using Scala version 2.9.3 (OpenJDK 64-Bit Server VM, Java 1.7.0_25)
Initializing interpreter...
13/07/27 21:28:02 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:28:02 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:45793
Creating SparkContext...
13/07/27 21:28:11 INFO slf4j.Slf4jEventHandler: Slf4jEventHandler started
13/07/27 21:28:12 INFO spark.SparkEnv: Registering BlockManagerMaster
13/07/27 21:28:12 INFO storage.MemoryStore: MemoryStore started with capacity 1295.4 MB.
13/07/27 21:28:12 INFO storage.DiskStore: Created local directory at /tmp/spark-local-20130727212812-db22
13/07/27 21:28:12 INFO network.ConnectionManager: Bound socket to port 41461 with id = ConnectionManagerId(tachyon-ec2-0,41461)
13/07/27 21:28:12 INFO storage.BlockManagerMaster: Trying to register BlockManager
13/07/27 21:28:12 INFO storage.BlockManagerMasterActor$BlockManagerInfo: Registering block manager tachyon-ec2-0:41461 with 1295.4 MB RAM
13/07/27 21:28:12 INFO storage.BlockManagerMaster: Registered BlockManager
13/07/27 21:28:12 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:28:12 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:45644
13/07/27 21:28:12 INFO broadcast.HttpBroadcast: Broadcast server started at http://10.151.80.188:45644
13/07/27 21:28:12 INFO spark.SparkEnv: Registering MapOutputTracker
13/07/27 21:28:12 INFO spark.HttpFileServer: HTTP File server directory is /tmp/spark-cd978fc7-aeba-46b6-9948-f2f62f102829
13/07/27 21:28:12 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:28:12 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:43395
13/07/27 21:28:12 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:28:12 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage/rdd,null}
13/07/27 21:28:12 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:28:12 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:28:12 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:28:12 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:28:12 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:28:12 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:28:12 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:28:12 INFO server.AbstractConnector: Started SelectChannelConnector@0.0.0.0:33000
13/07/27 21:28:12 INFO ui.SparkUI: Started Spark Web UI at http://tachyon-ec2-0:33000
Spark context available as sc.
Type in expressions to have them evaluated.
Type :help for more information.

scala> val s = sc.textFile("tachyon://tachyon-ec2-0:19998/hit_data.tsv.100")
13/07/27 21:28:13 INFO storage.MemoryStore: ensureFreeSpace(58423) called with curMem=0, maxMem=1358297825
13/07/27 21:28:13 INFO storage.MemoryStore: Block broadcast_0 stored as values to memory (estimated size 57.1 KB, free 1295.3 MB)
s: spark.RDD[String] = MappedRDD[1] at textFile at <console>:12

scala> s.count()
13/07/27 21:28:13 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
13/07/27 21:28:13 WARN snappy.LoadSnappy: Snappy native library not loaded
13/07/27 21:28:13 INFO : initialize(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100, Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml). Connecting to Tachyon: tachyon://tachyon-ec2-0:19998/hit_data.tsv.100
13/07/27 21:28:13 INFO : Trying to connect master @ tachyon-ec2-0/10.151.80.188:19998
13/07/27 21:28:13 INFO : User registered at the master tachyon-ec2-0/10.151.80.188:19998 got UserId 1
13/07/27 21:28:13 INFO : Trying to get local worker host : tachyon-ec2-0
13/07/27 21:28:13 INFO : Connecting local worker @ tachyon-ec2-0/10.151.80.188:29998
13/07/27 21:28:13 INFO : tachyon://tachyon-ec2-0:19998 tachyon://tachyon-ec2-0:19998 file:///mnt/tachyon
13/07/27 21:28:13 INFO : getFileStatus(/hit_data.tsv.100): HDFS Path: file:/mnt/tachyon/hit_data.tsv.100 TPath: tachyon://tachyon-ec2-0:19998/hit_data.tsv.100
13/07/27 21:28:13 INFO : tachyon.client.TachyonFS@5c2e22e4 file:///mnt/tachyon /hit_data.tsv.100 tachyon.PrefixList@58f4d603
13/07/27 21:28:14 INFO : Create tachyon file /hit_data.tsv.100 with file id 2 and checkpoint location file:///mnt/tachyon/hit_data.tsv.100
13/07/27 21:28:14 INFO mapred.FileInputFormat: Total input paths to process : 1
13/07/27 21:28:14 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:28:14 INFO scheduler.DAGScheduler: Got job 0 (count at <console>:15) with 1 output partitions (allowLocal=false)
13/07/27 21:28:14 INFO scheduler.DAGScheduler: Final stage: Stage 0 (count at <console>:15)
13/07/27 21:28:14 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:28:14 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:28:14 INFO scheduler.DAGScheduler: Submitting Stage 0 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:28:14 INFO scheduler.DAGScheduler: Submitting 1 missing tasks from Stage 0 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:28:14 INFO local.LocalTaskSetManager: Size of task 0 is 1496 bytes
13/07/27 21:28:14 INFO local.LocalScheduler: Running 0
13/07/27 21:28:14 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100, 65536)
13/07/27 21:28:14 INFO : /mnt/ramdisk/tachyonworker/2147483648 is not on local disk.
13/07/27 21:28:14 INFO : Try to find and read from remote workers.
13/07/27 21:28:14 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:28:14 INFO : Folder /mnt/ramdisk/tachyonworker/users/1 was created!
13/07/27 21:28:14 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483648 was created!
13/07/27 21:28:14 INFO local.LocalScheduler: Finished 0
13/07/27 21:28:14 INFO local.LocalScheduler: Remove TaskSet 0.0 from pool 
13/07/27 21:28:14 INFO scheduler.DAGScheduler: Completed ResultTask(0, 0)
13/07/27 21:28:14 INFO scheduler.DAGScheduler: Stage 0 (count at <console>:15) finished in 0.362 s
13/07/27 21:28:14 INFO spark.SparkContext: Job finished: count at <console>:15, took 0.405426975 s
res0: Long = 100

scala> 13/07/27 21:28:15 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:28:15 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:28:15 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:28:15 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:28:15 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:28:15 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:28:15 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:28:15 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage/rdd,null}
Killed 1 processes
Killed 1 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting Tachyon @ tachyon-ec2-0
2013-07-27 21:28:16,639 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data
2013-07-27 21:28:16,643 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_log.data
2013-07-27 21:28:17,131 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/data
2013-07-27 21:28:17,142 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/workers

restaring tachyon
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Killed 0 processes
Killed 0 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting RamFS: /mnt/ramdisk
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata -Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Starting master @ tachyon-ec2-0
Starting worker @ tachyon-ec2-0

spark-shell count
32023 tachyon.Master
32050 tachyon.Worker

Going to fadvise /mnt/tachyon/hit_data.tsv.1000 as mode POSIX_FADV_DONTNEED
offset: 0
length: 776400
mode: POSIX_FADV_DONTNEED
WIN
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/ubuntu/work/tachyon/target/tachyon-0.3.0-SNAPSHOT-jar-with-dependencies.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/ubuntu/work/spark/lib_managed/jars/slf4j-log4j12-1.7.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
Welcome to
      ____              __  
     / __/__  ___ _____/ /__
    _\ \/ _ \/ _ `/ __/  '_/
   /___/ .__/\_,_/_/ /_/\_\   version 0.8.0
      /_/                  

Using Scala version 2.9.3 (OpenJDK 64-Bit Server VM, Java 1.7.0_25)
Initializing interpreter...
13/07/27 21:28:23 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:28:23 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:51961
Creating SparkContext...
13/07/27 21:28:32 INFO slf4j.Slf4jEventHandler: Slf4jEventHandler started
13/07/27 21:28:32 INFO spark.SparkEnv: Registering BlockManagerMaster
13/07/27 21:28:32 INFO storage.MemoryStore: MemoryStore started with capacity 1295.4 MB.
13/07/27 21:28:32 INFO storage.DiskStore: Created local directory at /tmp/spark-local-20130727212832-c50b
13/07/27 21:28:32 INFO network.ConnectionManager: Bound socket to port 50240 with id = ConnectionManagerId(tachyon-ec2-0,50240)
13/07/27 21:28:32 INFO storage.BlockManagerMaster: Trying to register BlockManager
13/07/27 21:28:32 INFO storage.BlockManagerMasterActor$BlockManagerInfo: Registering block manager tachyon-ec2-0:50240 with 1295.4 MB RAM
13/07/27 21:28:32 INFO storage.BlockManagerMaster: Registered BlockManager
13/07/27 21:28:32 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:28:32 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:40014
13/07/27 21:28:32 INFO broadcast.HttpBroadcast: Broadcast server started at http://10.151.80.188:40014
13/07/27 21:28:32 INFO spark.SparkEnv: Registering MapOutputTracker
13/07/27 21:28:32 INFO spark.HttpFileServer: HTTP File server directory is /tmp/spark-a07453d3-92ab-40b0-8f28-28031ed1c583
13/07/27 21:28:32 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:28:32 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:48324
13/07/27 21:28:32 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:28:32 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage/rdd,null}
13/07/27 21:28:32 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:28:32 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:28:32 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:28:32 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:28:32 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:28:32 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:28:32 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:28:33 INFO server.AbstractConnector: Started SelectChannelConnector@0.0.0.0:33000
13/07/27 21:28:33 INFO ui.SparkUI: Started Spark Web UI at http://tachyon-ec2-0:33000
Spark context available as sc.
Type in expressions to have them evaluated.
Type :help for more information.

scala> val s = sc.textFile("tachyon://tachyon-ec2-0:19998/hit_data.tsv.1000")
13/07/27 21:28:34 INFO storage.MemoryStore: ensureFreeSpace(58423) called with curMem=0, maxMem=1358297825
13/07/27 21:28:34 INFO storage.MemoryStore: Block broadcast_0 stored as values to memory (estimated size 57.1 KB, free 1295.3 MB)
s: spark.RDD[String] = MappedRDD[1] at textFile at <console>:12

scala> s.count()
13/07/27 21:28:34 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
13/07/27 21:28:34 WARN snappy.LoadSnappy: Snappy native library not loaded
13/07/27 21:28:34 INFO : initialize(tachyon://tachyon-ec2-0:19998/hit_data.tsv.1000, Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml). Connecting to Tachyon: tachyon://tachyon-ec2-0:19998/hit_data.tsv.1000
13/07/27 21:28:34 INFO : Trying to connect master @ tachyon-ec2-0/10.151.80.188:19998
13/07/27 21:28:34 INFO : User registered at the master tachyon-ec2-0/10.151.80.188:19998 got UserId 1
13/07/27 21:28:34 INFO : Trying to get local worker host : tachyon-ec2-0
13/07/27 21:28:34 INFO : Connecting local worker @ tachyon-ec2-0/10.151.80.188:29998
13/07/27 21:28:34 INFO : tachyon://tachyon-ec2-0:19998 tachyon://tachyon-ec2-0:19998 file:///mnt/tachyon
13/07/27 21:28:34 INFO : getFileStatus(/hit_data.tsv.1000): HDFS Path: file:/mnt/tachyon/hit_data.tsv.1000 TPath: tachyon://tachyon-ec2-0:19998/hit_data.tsv.1000
13/07/27 21:28:34 INFO : tachyon.client.TachyonFS@47b29932 file:///mnt/tachyon /hit_data.tsv.1000 tachyon.PrefixList@1e67c664
13/07/27 21:28:35 INFO : Create tachyon file /hit_data.tsv.1000 with file id 2 and checkpoint location file:///mnt/tachyon/hit_data.tsv.1000
13/07/27 21:28:35 INFO mapred.FileInputFormat: Total input paths to process : 1
13/07/27 21:28:35 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:28:35 INFO scheduler.DAGScheduler: Got job 0 (count at <console>:15) with 1 output partitions (allowLocal=false)
13/07/27 21:28:35 INFO scheduler.DAGScheduler: Final stage: Stage 0 (count at <console>:15)
13/07/27 21:28:35 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:28:35 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:28:35 INFO scheduler.DAGScheduler: Submitting Stage 0 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:28:35 INFO scheduler.DAGScheduler: Submitting 1 missing tasks from Stage 0 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:28:35 INFO local.LocalTaskSetManager: Size of task 0 is 1497 bytes
13/07/27 21:28:35 INFO local.LocalScheduler: Running 0
13/07/27 21:28:35 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.1000, 65536)
13/07/27 21:28:35 INFO : /mnt/ramdisk/tachyonworker/2147483648 is not on local disk.
13/07/27 21:28:35 INFO : Try to find and read from remote workers.
13/07/27 21:28:35 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:28:35 INFO : Folder /mnt/ramdisk/tachyonworker/users/1 was created!
13/07/27 21:28:35 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483648 was created!
13/07/27 21:28:35 INFO local.LocalScheduler: Finished 0
13/07/27 21:28:35 INFO local.LocalScheduler: Remove TaskSet 0.0 from pool 
13/07/27 21:28:35 INFO scheduler.DAGScheduler: Completed ResultTask(0, 0)
13/07/27 21:28:35 INFO scheduler.DAGScheduler: Stage 0 (count at <console>:15) finished in 0.392 s
13/07/27 21:28:35 INFO spark.SparkContext: Job finished: count at <console>:15, took 0.437063635 s
res0: Long = 1000

scala> 13/07/27 21:28:35 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:28:35 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:28:35 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:28:35 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:28:35 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:28:35 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:28:35 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:28:35 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage/rdd,null}
Killed 1 processes
Killed 1 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting Tachyon @ tachyon-ec2-0
2013-07-27 21:28:37,487 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data
2013-07-27 21:28:37,491 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_log.data
2013-07-27 21:28:37,982 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/data
2013-07-27 21:28:37,994 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/workers

restaring tachyon
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Killed 0 processes
Killed 0 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting RamFS: /mnt/ramdisk
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata -Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Starting master @ tachyon-ec2-0
Starting worker @ tachyon-ec2-0

spark-shell count
32579 tachyon.Master
32606 tachyon.Worker

Going to fadvise /mnt/tachyon/hit_data.tsv.10000 as mode POSIX_FADV_DONTNEED
offset: 0
length: 12330369
mode: POSIX_FADV_DONTNEED
WIN
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/ubuntu/work/tachyon/target/tachyon-0.3.0-SNAPSHOT-jar-with-dependencies.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/ubuntu/work/spark/lib_managed/jars/slf4j-log4j12-1.7.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
Welcome to
      ____              __  
     / __/__  ___ _____/ /__
    _\ \/ _ \/ _ `/ __/  '_/
   /___/ .__/\_,_/_/ /_/\_\   version 0.8.0
      /_/                  

Using Scala version 2.9.3 (OpenJDK 64-Bit Server VM, Java 1.7.0_25)
Initializing interpreter...
13/07/27 21:28:44 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:28:44 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:56031
Creating SparkContext...
13/07/27 21:28:53 INFO slf4j.Slf4jEventHandler: Slf4jEventHandler started
13/07/27 21:28:53 INFO spark.SparkEnv: Registering BlockManagerMaster
13/07/27 21:28:53 INFO storage.MemoryStore: MemoryStore started with capacity 1295.4 MB.
13/07/27 21:28:53 INFO storage.DiskStore: Created local directory at /tmp/spark-local-20130727212853-830d
13/07/27 21:28:53 INFO network.ConnectionManager: Bound socket to port 54329 with id = ConnectionManagerId(tachyon-ec2-0,54329)
13/07/27 21:28:53 INFO storage.BlockManagerMaster: Trying to register BlockManager
13/07/27 21:28:53 INFO storage.BlockManagerMasterActor$BlockManagerInfo: Registering block manager tachyon-ec2-0:54329 with 1295.4 MB RAM
13/07/27 21:28:53 INFO storage.BlockManagerMaster: Registered BlockManager
13/07/27 21:28:53 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:28:53 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:46565
13/07/27 21:28:53 INFO broadcast.HttpBroadcast: Broadcast server started at http://10.151.80.188:46565
13/07/27 21:28:53 INFO spark.SparkEnv: Registering MapOutputTracker
13/07/27 21:28:53 INFO spark.HttpFileServer: HTTP File server directory is /tmp/spark-a17869e7-9dea-4f2c-bfa2-89d3760d8bec
13/07/27 21:28:53 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:28:53 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:40992
13/07/27 21:28:53 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:28:53 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage/rdd,null}
13/07/27 21:28:53 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:28:53 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:28:53 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:28:53 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:28:53 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:28:53 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:28:53 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:28:53 INFO server.AbstractConnector: Started SelectChannelConnector@0.0.0.0:33000
13/07/27 21:28:53 INFO ui.SparkUI: Started Spark Web UI at http://tachyon-ec2-0:33000
Spark context available as sc.
Type in expressions to have them evaluated.
Type :help for more information.

scala> val s = sc.textFile("tachyon://tachyon-ec2-0:19998/hit_data.tsv.10000")
13/07/27 21:28:55 INFO storage.MemoryStore: ensureFreeSpace(58423) called with curMem=0, maxMem=1358297825
13/07/27 21:28:55 INFO storage.MemoryStore: Block broadcast_0 stored as values to memory (estimated size 57.1 KB, free 1295.3 MB)
s: spark.RDD[String] = MappedRDD[1] at textFile at <console>:12

scala> s.count()
13/07/27 21:28:55 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
13/07/27 21:28:55 WARN snappy.LoadSnappy: Snappy native library not loaded
13/07/27 21:28:55 INFO : initialize(tachyon://tachyon-ec2-0:19998/hit_data.tsv.10000, Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml). Connecting to Tachyon: tachyon://tachyon-ec2-0:19998/hit_data.tsv.10000
13/07/27 21:28:55 INFO : Trying to connect master @ tachyon-ec2-0/10.151.80.188:19998
13/07/27 21:28:55 INFO : User registered at the master tachyon-ec2-0/10.151.80.188:19998 got UserId 1
13/07/27 21:28:55 INFO : Trying to get local worker host : tachyon-ec2-0
13/07/27 21:28:55 INFO : Connecting local worker @ tachyon-ec2-0/10.151.80.188:29998
13/07/27 21:28:55 INFO : tachyon://tachyon-ec2-0:19998 tachyon://tachyon-ec2-0:19998 file:///mnt/tachyon
13/07/27 21:28:55 INFO : getFileStatus(/hit_data.tsv.10000): HDFS Path: file:/mnt/tachyon/hit_data.tsv.10000 TPath: tachyon://tachyon-ec2-0:19998/hit_data.tsv.10000
13/07/27 21:28:55 INFO : tachyon.client.TachyonFS@4bf3f11c file:///mnt/tachyon /hit_data.tsv.10000 tachyon.PrefixList@7c5a8c38
13/07/27 21:28:56 INFO : Create tachyon file /hit_data.tsv.10000 with file id 2 and checkpoint location file:///mnt/tachyon/hit_data.tsv.10000
13/07/27 21:28:56 INFO mapred.FileInputFormat: Total input paths to process : 1
13/07/27 21:28:56 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:28:56 INFO scheduler.DAGScheduler: Got job 0 (count at <console>:15) with 1 output partitions (allowLocal=false)
13/07/27 21:28:56 INFO scheduler.DAGScheduler: Final stage: Stage 0 (count at <console>:15)
13/07/27 21:28:56 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:28:56 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:28:56 INFO scheduler.DAGScheduler: Submitting Stage 0 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:28:56 INFO scheduler.DAGScheduler: Submitting 1 missing tasks from Stage 0 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:28:56 INFO local.LocalTaskSetManager: Size of task 0 is 1498 bytes
13/07/27 21:28:56 INFO local.LocalScheduler: Running 0
13/07/27 21:28:56 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.10000, 65536)
13/07/27 21:28:56 INFO : /mnt/ramdisk/tachyonworker/2147483648 is not on local disk.
13/07/27 21:28:56 INFO : Try to find and read from remote workers.
13/07/27 21:28:56 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:28:56 INFO : Folder /mnt/ramdisk/tachyonworker/users/1 was created!
13/07/27 21:28:56 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483648 was created!
13/07/27 21:28:56 INFO local.LocalScheduler: Finished 0
13/07/27 21:28:56 INFO local.LocalScheduler: Remove TaskSet 0.0 from pool 
13/07/27 21:28:56 INFO scheduler.DAGScheduler: Completed ResultTask(0, 0)
13/07/27 21:28:56 INFO scheduler.DAGScheduler: Stage 0 (count at <console>:15) finished in 0.643 s
13/07/27 21:28:56 INFO spark.SparkContext: Job finished: count at <console>:15, took 0.68644165 s
res0: Long = 10000

scala> 13/07/27 21:28:56 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:28:56 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:28:56 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:28:56 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:28:56 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:28:56 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:28:56 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:28:56 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage/rdd,null}
Killed 1 processes
Killed 1 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting Tachyon @ tachyon-ec2-0
2013-07-27 21:28:58,493 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data
2013-07-27 21:28:58,497 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_log.data
2013-07-27 21:28:58,984 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/data
2013-07-27 21:28:58,995 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/workers

restaring tachyon
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Killed 0 processes
Killed 0 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting RamFS: /mnt/ramdisk
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata -Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Starting master @ tachyon-ec2-0
Starting worker @ tachyon-ec2-0

spark-shell count
679 tachyon.Master
706 tachyon.Worker

Going to fadvise /mnt/tachyon/hit_data.tsv.100000 as mode POSIX_FADV_DONTNEED
offset: 0
length: 125141299
mode: POSIX_FADV_DONTNEED
WIN
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/ubuntu/work/tachyon/target/tachyon-0.3.0-SNAPSHOT-jar-with-dependencies.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/ubuntu/work/spark/lib_managed/jars/slf4j-log4j12-1.7.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
Welcome to
      ____              __  
     / __/__  ___ _____/ /__
    _\ \/ _ \/ _ `/ __/  '_/
   /___/ .__/\_,_/_/ /_/\_\   version 0.8.0
      /_/                  

Using Scala version 2.9.3 (OpenJDK 64-Bit Server VM, Java 1.7.0_25)
Initializing interpreter...
13/07/27 21:29:05 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:29:05 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:41743
Creating SparkContext...
13/07/27 21:29:14 INFO slf4j.Slf4jEventHandler: Slf4jEventHandler started
13/07/27 21:29:14 INFO spark.SparkEnv: Registering BlockManagerMaster
13/07/27 21:29:14 INFO storage.MemoryStore: MemoryStore started with capacity 1295.4 MB.
13/07/27 21:29:14 INFO storage.DiskStore: Created local directory at /tmp/spark-local-20130727212914-b26e
13/07/27 21:29:14 INFO network.ConnectionManager: Bound socket to port 60556 with id = ConnectionManagerId(tachyon-ec2-0,60556)
13/07/27 21:29:14 INFO storage.BlockManagerMaster: Trying to register BlockManager
13/07/27 21:29:14 INFO storage.BlockManagerMasterActor$BlockManagerInfo: Registering block manager tachyon-ec2-0:60556 with 1295.4 MB RAM
13/07/27 21:29:14 INFO storage.BlockManagerMaster: Registered BlockManager
13/07/27 21:29:14 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:29:14 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:33702
13/07/27 21:29:14 INFO broadcast.HttpBroadcast: Broadcast server started at http://10.151.80.188:33702
13/07/27 21:29:14 INFO spark.SparkEnv: Registering MapOutputTracker
13/07/27 21:29:14 INFO spark.HttpFileServer: HTTP File server directory is /tmp/spark-6b0680f0-60c6-4e99-a988-99b452989968
13/07/27 21:29:14 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:29:14 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:40321
13/07/27 21:29:14 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:29:14 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage/rdd,null}
13/07/27 21:29:14 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:29:14 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:29:14 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:29:14 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:29:14 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:29:14 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:29:14 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:29:14 INFO server.AbstractConnector: Started SelectChannelConnector@0.0.0.0:33000
13/07/27 21:29:14 INFO ui.SparkUI: Started Spark Web UI at http://tachyon-ec2-0:33000
Spark context available as sc.
Type in expressions to have them evaluated.
Type :help for more information.

scala> val s = sc.textFile("tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000")
13/07/27 21:29:16 INFO storage.MemoryStore: ensureFreeSpace(58431) called with curMem=0, maxMem=1358297825
13/07/27 21:29:16 INFO storage.MemoryStore: Block broadcast_0 stored as values to memory (estimated size 57.1 KB, free 1295.3 MB)
s: spark.RDD[String] = MappedRDD[1] at textFile at <console>:12

scala> s.count()
13/07/27 21:29:16 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
13/07/27 21:29:16 WARN snappy.LoadSnappy: Snappy native library not loaded
13/07/27 21:29:16 INFO : initialize(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000, Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml). Connecting to Tachyon: tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000
13/07/27 21:29:16 INFO : Trying to connect master @ tachyon-ec2-0/10.151.80.188:19998
13/07/27 21:29:16 INFO : User registered at the master tachyon-ec2-0/10.151.80.188:19998 got UserId 1
13/07/27 21:29:16 INFO : Trying to get local worker host : tachyon-ec2-0
13/07/27 21:29:16 INFO : Connecting local worker @ tachyon-ec2-0/10.151.80.188:29998
13/07/27 21:29:16 INFO : tachyon://tachyon-ec2-0:19998 tachyon://tachyon-ec2-0:19998 file:///mnt/tachyon
13/07/27 21:29:16 INFO : getFileStatus(/hit_data.tsv.100000): HDFS Path: file:/mnt/tachyon/hit_data.tsv.100000 TPath: tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000
13/07/27 21:29:16 INFO : tachyon.client.TachyonFS@691212ae file:///mnt/tachyon /hit_data.tsv.100000 tachyon.PrefixList@21889366
13/07/27 21:29:17 INFO : Create tachyon file /hit_data.tsv.100000 with file id 2 and checkpoint location file:///mnt/tachyon/hit_data.tsv.100000
13/07/27 21:29:17 INFO mapred.FileInputFormat: Total input paths to process : 1
13/07/27 21:29:17 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:29:17 INFO scheduler.DAGScheduler: Got job 0 (count at <console>:15) with 4 output partitions (allowLocal=false)
13/07/27 21:29:17 INFO scheduler.DAGScheduler: Final stage: Stage 0 (count at <console>:15)
13/07/27 21:29:17 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:29:17 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:29:17 INFO scheduler.DAGScheduler: Submitting Stage 0 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:29:17 INFO scheduler.DAGScheduler: Submitting 4 missing tasks from Stage 0 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:29:17 INFO local.LocalTaskSetManager: Size of task 0 is 1499 bytes
13/07/27 21:29:17 INFO local.LocalScheduler: Running 0
13/07/27 21:29:17 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000, 65536)
13/07/27 21:29:17 INFO : /mnt/ramdisk/tachyonworker/2147483648 is not on local disk.
13/07/27 21:29:17 INFO : Try to find and read from remote workers.
13/07/27 21:29:17 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:29:17 INFO : Folder /mnt/ramdisk/tachyonworker/users/1 was created!
13/07/27 21:29:17 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483648 was created!
13/07/27 21:29:18 INFO : /mnt/ramdisk/tachyonworker/2147483649 is not on local disk.
13/07/27 21:29:18 INFO : Try to find and read from remote workers.
13/07/27 21:29:18 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:29:18 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483649 was created!
13/07/27 21:29:18 INFO local.LocalScheduler: Finished 0
13/07/27 21:29:18 INFO local.LocalTaskSetManager: Size of task 1 is 1499 bytes
13/07/27 21:29:18 INFO local.LocalScheduler: Running 1
13/07/27 21:29:18 INFO scheduler.DAGScheduler: Completed ResultTask(0, 0)
13/07/27 21:29:18 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000, 65536)
13/07/27 21:29:18 INFO : /mnt/ramdisk/tachyonworker/2147483650 is not on local disk.
13/07/27 21:29:18 INFO : Try to find and read from remote workers.
13/07/27 21:29:18 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:29:18 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483650 was created!
13/07/27 21:29:19 INFO local.LocalScheduler: Finished 1
13/07/27 21:29:19 INFO scheduler.DAGScheduler: Completed ResultTask(0, 1)
13/07/27 21:29:19 INFO local.LocalTaskSetManager: Size of task 2 is 1499 bytes
13/07/27 21:29:19 INFO local.LocalScheduler: Running 2
13/07/27 21:29:19 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000, 65536)
13/07/27 21:29:19 INFO : /mnt/ramdisk/tachyonworker/2147483651 is not on local disk.
13/07/27 21:29:19 INFO : Try to find and read from remote workers.
13/07/27 21:29:19 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:29:19 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483651 was created!
13/07/27 21:29:19 INFO local.LocalScheduler: Finished 2
13/07/27 21:29:19 INFO scheduler.DAGScheduler: Completed ResultTask(0, 2)
13/07/27 21:29:19 INFO local.LocalTaskSetManager: Size of task 3 is 1499 bytes
13/07/27 21:29:19 INFO local.LocalScheduler: Running 3
13/07/27 21:29:19 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000, 65536)
13/07/27 21:29:20 INFO local.LocalScheduler: Finished 3
13/07/27 21:29:20 INFO scheduler.DAGScheduler: Completed ResultTask(0, 3)
13/07/27 21:29:20 INFO local.LocalScheduler: Remove TaskSet 0.0 from pool 
13/07/27 21:29:20 INFO scheduler.DAGScheduler: Stage 0 (count at <console>:15) finished in 2.754 s
13/07/27 21:29:20 INFO spark.SparkContext: Job finished: count at <console>:15, took 2.801280615 s
res0: Long = 100002

scala> 13/07/27 21:29:20 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:29:20 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:29:20 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:29:20 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:29:20 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:29:20 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:29:20 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:29:20 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage/rdd,null}
Killed 1 processes
Killed 1 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting Tachyon @ tachyon-ec2-0
2013-07-27 21:29:21,757 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data
2013-07-27 21:29:21,761 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_log.data
2013-07-27 21:29:22,246 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/data
2013-07-27 21:29:22,258 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/workers

restaring tachyon
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Killed 0 processes
Killed 0 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting RamFS: /mnt/ramdisk
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata -Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Starting master @ tachyon-ec2-0
Starting worker @ tachyon-ec2-0

spark-shell count
1409 tachyon.Master
1436 tachyon.Worker

Going to fadvise /mnt/tachyon/hit_data.tsv.500000 as mode POSIX_FADV_DONTNEED
offset: 0
length: 618418417
mode: POSIX_FADV_DONTNEED
WIN
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/ubuntu/work/tachyon/target/tachyon-0.3.0-SNAPSHOT-jar-with-dependencies.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/ubuntu/work/spark/lib_managed/jars/slf4j-log4j12-1.7.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
Welcome to
      ____              __  
     / __/__  ___ _____/ /__
    _\ \/ _ \/ _ `/ __/  '_/
   /___/ .__/\_,_/_/ /_/\_\   version 0.8.0
      /_/                  

Using Scala version 2.9.3 (OpenJDK 64-Bit Server VM, Java 1.7.0_25)
Initializing interpreter...
13/07/27 21:29:28 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:29:28 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:44043
Creating SparkContext...
13/07/27 21:29:37 INFO slf4j.Slf4jEventHandler: Slf4jEventHandler started
13/07/27 21:29:38 INFO spark.SparkEnv: Registering BlockManagerMaster
13/07/27 21:29:38 INFO storage.MemoryStore: MemoryStore started with capacity 1295.4 MB.
13/07/27 21:29:38 INFO storage.DiskStore: Created local directory at /tmp/spark-local-20130727212938-3043
13/07/27 21:29:38 INFO network.ConnectionManager: Bound socket to port 46978 with id = ConnectionManagerId(tachyon-ec2-0,46978)
13/07/27 21:29:38 INFO storage.BlockManagerMaster: Trying to register BlockManager
13/07/27 21:29:38 INFO storage.BlockManagerMasterActor$BlockManagerInfo: Registering block manager tachyon-ec2-0:46978 with 1295.4 MB RAM
13/07/27 21:29:38 INFO storage.BlockManagerMaster: Registered BlockManager
13/07/27 21:29:38 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:29:38 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:43749
13/07/27 21:29:38 INFO broadcast.HttpBroadcast: Broadcast server started at http://10.151.80.188:43749
13/07/27 21:29:38 INFO spark.SparkEnv: Registering MapOutputTracker
13/07/27 21:29:38 INFO spark.HttpFileServer: HTTP File server directory is /tmp/spark-517954e9-c6bf-4026-aa16-f8663169b1a0
13/07/27 21:29:38 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:29:38 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:44045
13/07/27 21:29:38 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:29:38 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage/rdd,null}
13/07/27 21:29:38 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:29:38 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:29:38 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:29:38 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:29:38 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:29:38 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:29:38 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:29:38 INFO server.AbstractConnector: Started SelectChannelConnector@0.0.0.0:33000
13/07/27 21:29:38 INFO ui.SparkUI: Started Spark Web UI at http://tachyon-ec2-0:33000
Spark context available as sc.
Type in expressions to have them evaluated.
Type :help for more information.

scala> val s = sc.textFile("tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000")
13/07/27 21:29:39 INFO storage.MemoryStore: ensureFreeSpace(58431) called with curMem=0, maxMem=1358297825
13/07/27 21:29:39 INFO storage.MemoryStore: Block broadcast_0 stored as values to memory (estimated size 57.1 KB, free 1295.3 MB)
s: spark.RDD[String] = MappedRDD[1] at textFile at <console>:12

scala> s.count()
13/07/27 21:29:39 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
13/07/27 21:29:39 WARN snappy.LoadSnappy: Snappy native library not loaded
13/07/27 21:29:39 INFO : initialize(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml). Connecting to Tachyon: tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000
13/07/27 21:29:39 INFO : Trying to connect master @ tachyon-ec2-0/10.151.80.188:19998
13/07/27 21:29:39 INFO : User registered at the master tachyon-ec2-0/10.151.80.188:19998 got UserId 1
13/07/27 21:29:39 INFO : Trying to get local worker host : tachyon-ec2-0
13/07/27 21:29:39 INFO : Connecting local worker @ tachyon-ec2-0/10.151.80.188:29998
13/07/27 21:29:39 INFO : tachyon://tachyon-ec2-0:19998 tachyon://tachyon-ec2-0:19998 file:///mnt/tachyon
13/07/27 21:29:39 INFO : getFileStatus(/hit_data.tsv.500000): HDFS Path: file:/mnt/tachyon/hit_data.tsv.500000 TPath: tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000
13/07/27 21:29:39 INFO : tachyon.client.TachyonFS@38db2b7e file:///mnt/tachyon /hit_data.tsv.500000 tachyon.PrefixList@3d047a5b
13/07/27 21:29:40 INFO : Create tachyon file /hit_data.tsv.500000 with file id 2 and checkpoint location file:///mnt/tachyon/hit_data.tsv.500000
13/07/27 21:29:40 INFO mapred.FileInputFormat: Total input paths to process : 1
13/07/27 21:29:40 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:29:40 INFO scheduler.DAGScheduler: Got job 0 (count at <console>:15) with 19 output partitions (allowLocal=false)
13/07/27 21:29:40 INFO scheduler.DAGScheduler: Final stage: Stage 0 (count at <console>:15)
13/07/27 21:29:40 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:29:40 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:29:40 INFO scheduler.DAGScheduler: Submitting Stage 0 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:29:40 INFO scheduler.DAGScheduler: Submitting 19 missing tasks from Stage 0 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:29:41 INFO local.LocalTaskSetManager: Size of task 0 is 1499 bytes
13/07/27 21:29:41 INFO local.LocalScheduler: Running 0
13/07/27 21:29:41 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:29:41 INFO : /mnt/ramdisk/tachyonworker/2147483648 is not on local disk.
13/07/27 21:29:41 INFO : Try to find and read from remote workers.
13/07/27 21:29:41 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:29:41 INFO : Folder /mnt/ramdisk/tachyonworker/users/1 was created!
13/07/27 21:29:41 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483648 was created!
13/07/27 21:29:41 INFO : /mnt/ramdisk/tachyonworker/2147483649 is not on local disk.
13/07/27 21:29:41 INFO : Try to find and read from remote workers.
13/07/27 21:29:41 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:29:41 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483649 was created!
13/07/27 21:29:42 INFO local.LocalScheduler: Finished 0
13/07/27 21:29:42 INFO local.LocalTaskSetManager: Size of task 1 is 1499 bytes
13/07/27 21:29:42 INFO local.LocalScheduler: Running 1
13/07/27 21:29:42 INFO scheduler.DAGScheduler: Completed ResultTask(0, 0)
13/07/27 21:29:42 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:29:42 INFO : /mnt/ramdisk/tachyonworker/2147483650 is not on local disk.
13/07/27 21:29:42 INFO : Try to find and read from remote workers.
13/07/27 21:29:42 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:29:42 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483650 was created!
13/07/27 21:29:42 INFO local.LocalScheduler: Finished 1
13/07/27 21:29:42 INFO scheduler.DAGScheduler: Completed ResultTask(0, 1)
13/07/27 21:29:42 INFO local.LocalTaskSetManager: Size of task 2 is 1499 bytes
13/07/27 21:29:42 INFO local.LocalScheduler: Running 2
13/07/27 21:29:42 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:29:43 INFO : /mnt/ramdisk/tachyonworker/2147483651 is not on local disk.
13/07/27 21:29:43 INFO : Try to find and read from remote workers.
13/07/27 21:29:43 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:29:43 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483651 was created!
13/07/27 21:29:43 INFO local.LocalScheduler: Finished 2
13/07/27 21:29:43 INFO scheduler.DAGScheduler: Completed ResultTask(0, 2)
13/07/27 21:29:43 INFO local.LocalTaskSetManager: Size of task 3 is 1499 bytes
13/07/27 21:29:43 INFO local.LocalScheduler: Running 3
13/07/27 21:29:43 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:29:43 INFO : /mnt/ramdisk/tachyonworker/2147483652 is not on local disk.
13/07/27 21:29:43 INFO : Try to find and read from remote workers.
13/07/27 21:29:43 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:29:43 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483652 was created!
13/07/27 21:29:44 INFO local.LocalScheduler: Finished 3
13/07/27 21:29:44 INFO scheduler.DAGScheduler: Completed ResultTask(0, 3)
13/07/27 21:29:44 INFO local.LocalTaskSetManager: Size of task 4 is 1499 bytes
13/07/27 21:29:44 INFO local.LocalScheduler: Running 4
13/07/27 21:29:44 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:29:44 INFO : /mnt/ramdisk/tachyonworker/2147483653 is not on local disk.
13/07/27 21:29:44 INFO : Try to find and read from remote workers.
13/07/27 21:29:44 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:29:44 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483653 was created!
13/07/27 21:29:44 INFO local.LocalScheduler: Finished 4
13/07/27 21:29:44 INFO scheduler.DAGScheduler: Completed ResultTask(0, 4)
13/07/27 21:29:44 INFO local.LocalTaskSetManager: Size of task 5 is 1499 bytes
13/07/27 21:29:44 INFO local.LocalScheduler: Running 5
13/07/27 21:29:44 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:29:44 INFO : /mnt/ramdisk/tachyonworker/2147483654 is not on local disk.
13/07/27 21:29:44 INFO : Try to find and read from remote workers.
13/07/27 21:29:44 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:29:44 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483654 was created!
13/07/27 21:29:45 INFO local.LocalScheduler: Finished 5
13/07/27 21:29:45 INFO scheduler.DAGScheduler: Completed ResultTask(0, 5)
13/07/27 21:29:45 INFO local.LocalTaskSetManager: Size of task 6 is 1499 bytes
13/07/27 21:29:45 INFO local.LocalScheduler: Running 6
13/07/27 21:29:45 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:29:45 INFO : /mnt/ramdisk/tachyonworker/2147483655 is not on local disk.
13/07/27 21:29:45 INFO : Try to find and read from remote workers.
13/07/27 21:29:45 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:29:45 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483655 was created!
13/07/27 21:29:45 INFO local.LocalScheduler: Finished 6
13/07/27 21:29:45 INFO scheduler.DAGScheduler: Completed ResultTask(0, 6)
13/07/27 21:29:45 INFO local.LocalTaskSetManager: Size of task 7 is 1499 bytes
13/07/27 21:29:45 INFO local.LocalScheduler: Running 7
13/07/27 21:29:45 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:29:46 INFO : /mnt/ramdisk/tachyonworker/2147483656 is not on local disk.
13/07/27 21:29:46 INFO : Try to find and read from remote workers.
13/07/27 21:29:46 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:29:46 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483656 was created!
13/07/27 21:29:46 INFO local.LocalScheduler: Finished 7
13/07/27 21:29:46 INFO scheduler.DAGScheduler: Completed ResultTask(0, 7)
13/07/27 21:29:46 INFO local.LocalTaskSetManager: Size of task 8 is 1499 bytes
13/07/27 21:29:46 INFO local.LocalScheduler: Running 8
13/07/27 21:29:46 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:29:46 INFO : /mnt/ramdisk/tachyonworker/2147483657 is not on local disk.
13/07/27 21:29:46 INFO : Try to find and read from remote workers.
13/07/27 21:29:46 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:29:46 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483657 was created!
13/07/27 21:29:47 INFO local.LocalScheduler: Finished 8
13/07/27 21:29:47 INFO scheduler.DAGScheduler: Completed ResultTask(0, 8)
13/07/27 21:29:47 INFO local.LocalTaskSetManager: Size of task 9 is 1499 bytes
13/07/27 21:29:47 INFO local.LocalScheduler: Running 9
13/07/27 21:29:47 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:29:47 INFO : /mnt/ramdisk/tachyonworker/2147483658 is not on local disk.
13/07/27 21:29:47 INFO : Try to find and read from remote workers.
13/07/27 21:29:47 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:29:47 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483658 was created!
13/07/27 21:29:47 INFO local.LocalScheduler: Finished 9
13/07/27 21:29:47 INFO scheduler.DAGScheduler: Completed ResultTask(0, 9)
13/07/27 21:29:47 INFO local.LocalTaskSetManager: Size of task 10 is 1499 bytes
13/07/27 21:29:47 INFO local.LocalScheduler: Running 10
13/07/27 21:29:47 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:29:47 INFO : /mnt/ramdisk/tachyonworker/2147483659 is not on local disk.
13/07/27 21:29:47 INFO : Try to find and read from remote workers.
13/07/27 21:29:47 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:29:47 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483659 was created!
13/07/27 21:29:48 INFO local.LocalScheduler: Finished 10
13/07/27 21:29:48 INFO scheduler.DAGScheduler: Completed ResultTask(0, 10)
13/07/27 21:29:48 INFO local.LocalTaskSetManager: Size of task 11 is 1499 bytes
13/07/27 21:29:48 INFO local.LocalScheduler: Running 11
13/07/27 21:29:48 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:29:48 INFO : /mnt/ramdisk/tachyonworker/2147483660 is not on local disk.
13/07/27 21:29:48 INFO : Try to find and read from remote workers.
13/07/27 21:29:48 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:29:48 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483660 was created!
13/07/27 21:29:48 INFO local.LocalScheduler: Finished 11
13/07/27 21:29:48 INFO scheduler.DAGScheduler: Completed ResultTask(0, 11)
13/07/27 21:29:48 INFO local.LocalTaskSetManager: Size of task 12 is 1499 bytes
13/07/27 21:29:48 INFO local.LocalScheduler: Running 12
13/07/27 21:29:48 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:29:48 INFO : /mnt/ramdisk/tachyonworker/2147483661 is not on local disk.
13/07/27 21:29:48 INFO : Try to find and read from remote workers.
13/07/27 21:29:48 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:29:49 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483661 was created!
13/07/27 21:29:49 INFO local.LocalScheduler: Finished 12
13/07/27 21:29:49 INFO scheduler.DAGScheduler: Completed ResultTask(0, 12)
13/07/27 21:29:49 INFO local.LocalTaskSetManager: Size of task 13 is 1499 bytes
13/07/27 21:29:49 INFO local.LocalScheduler: Running 13
13/07/27 21:29:49 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:29:49 INFO : /mnt/ramdisk/tachyonworker/2147483662 is not on local disk.
13/07/27 21:29:49 INFO : Try to find and read from remote workers.
13/07/27 21:29:49 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:29:49 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483662 was created!
13/07/27 21:29:49 INFO local.LocalScheduler: Finished 13
13/07/27 21:29:49 INFO scheduler.DAGScheduler: Completed ResultTask(0, 13)
13/07/27 21:29:49 INFO local.LocalTaskSetManager: Size of task 14 is 1499 bytes
13/07/27 21:29:49 INFO local.LocalScheduler: Running 14
13/07/27 21:29:49 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:29:50 INFO : /mnt/ramdisk/tachyonworker/2147483663 is not on local disk.
13/07/27 21:29:50 INFO : Try to find and read from remote workers.
13/07/27 21:29:50 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:29:50 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483663 was created!
13/07/27 21:29:50 INFO local.LocalScheduler: Finished 14
13/07/27 21:29:50 INFO scheduler.DAGScheduler: Completed ResultTask(0, 14)
13/07/27 21:29:50 INFO local.LocalTaskSetManager: Size of task 15 is 1499 bytes
13/07/27 21:29:50 INFO local.LocalScheduler: Running 15
13/07/27 21:29:50 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:29:50 INFO : /mnt/ramdisk/tachyonworker/2147483664 is not on local disk.
13/07/27 21:29:50 INFO : Try to find and read from remote workers.
13/07/27 21:29:50 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:29:50 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483664 was created!
13/07/27 21:29:51 INFO local.LocalScheduler: Finished 15
13/07/27 21:29:51 INFO scheduler.DAGScheduler: Completed ResultTask(0, 15)
13/07/27 21:29:51 INFO local.LocalTaskSetManager: Size of task 16 is 1499 bytes
13/07/27 21:29:51 INFO local.LocalScheduler: Running 16
13/07/27 21:29:51 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:29:51 INFO : /mnt/ramdisk/tachyonworker/2147483665 is not on local disk.
13/07/27 21:29:51 INFO : Try to find and read from remote workers.
13/07/27 21:29:51 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:29:51 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483665 was created!
13/07/27 21:29:51 INFO local.LocalScheduler: Finished 16
13/07/27 21:29:51 INFO scheduler.DAGScheduler: Completed ResultTask(0, 16)
13/07/27 21:29:51 INFO local.LocalTaskSetManager: Size of task 17 is 1499 bytes
13/07/27 21:29:51 INFO local.LocalScheduler: Running 17
13/07/27 21:29:51 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:29:51 INFO : /mnt/ramdisk/tachyonworker/2147483666 is not on local disk.
13/07/27 21:29:51 INFO : Try to find and read from remote workers.
13/07/27 21:29:51 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:29:51 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483666 was created!
13/07/27 21:29:51 INFO local.LocalScheduler: Finished 17
13/07/27 21:29:51 INFO scheduler.DAGScheduler: Completed ResultTask(0, 17)
13/07/27 21:29:51 INFO local.LocalTaskSetManager: Size of task 18 is 1499 bytes
13/07/27 21:29:51 INFO local.LocalScheduler: Running 18
13/07/27 21:29:51 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:29:52 INFO local.LocalScheduler: Finished 18
13/07/27 21:29:52 INFO scheduler.DAGScheduler: Completed ResultTask(0, 18)
13/07/27 21:29:52 INFO local.LocalScheduler: Remove TaskSet 0.0 from pool 
13/07/27 21:29:52 INFO scheduler.DAGScheduler: Stage 0 (count at <console>:15) finished in 11.135 s
13/07/27 21:29:52 INFO spark.SparkContext: Job finished: count at <console>:15, took 11.187554862 s
res0: Long = 500094

scala> 13/07/27 21:29:52 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:29:52 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:29:52 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:29:52 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:29:52 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:29:52 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:29:52 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:29:52 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage/rdd,null}
Killed 1 processes
Killed 1 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting Tachyon @ tachyon-ec2-0
2013-07-27 21:29:53,872 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data
2013-07-27 21:29:53,876 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_log.data
2013-07-27 21:29:54,363 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/data
2013-07-27 21:29:54,375 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/workers

run1 #: 8

restaring tachyon
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Killed 0 processes
Killed 0 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting RamFS: /mnt/ramdisk
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata -Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Starting master @ tachyon-ec2-0
Starting worker @ tachyon-ec2-0

spark-shell count
2184 tachyon.Master
2211 tachyon.Worker

Going to fadvise /mnt/tachyon/hit_data.tsv.1 as mode POSIX_FADV_DONTNEED
offset: 0
length: 525
mode: POSIX_FADV_DONTNEED
WIN
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/ubuntu/work/tachyon/target/tachyon-0.3.0-SNAPSHOT-jar-with-dependencies.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/ubuntu/work/spark/lib_managed/jars/slf4j-log4j12-1.7.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
Welcome to
      ____              __  
     / __/__  ___ _____/ /__
    _\ \/ _ \/ _ `/ __/  '_/
   /___/ .__/\_,_/_/ /_/\_\   version 0.8.0
      /_/                  

Using Scala version 2.9.3 (OpenJDK 64-Bit Server VM, Java 1.7.0_25)
Initializing interpreter...
13/07/27 21:30:00 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:30:00 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:39134
Creating SparkContext...
13/07/27 21:30:09 INFO slf4j.Slf4jEventHandler: Slf4jEventHandler started
13/07/27 21:30:10 INFO spark.SparkEnv: Registering BlockManagerMaster
13/07/27 21:30:10 INFO storage.MemoryStore: MemoryStore started with capacity 1295.4 MB.
13/07/27 21:30:10 INFO storage.DiskStore: Created local directory at /tmp/spark-local-20130727213010-6f9f
13/07/27 21:30:10 INFO network.ConnectionManager: Bound socket to port 49354 with id = ConnectionManagerId(tachyon-ec2-0,49354)
13/07/27 21:30:10 INFO storage.BlockManagerMaster: Trying to register BlockManager
13/07/27 21:30:10 INFO storage.BlockManagerMasterActor$BlockManagerInfo: Registering block manager tachyon-ec2-0:49354 with 1295.4 MB RAM
13/07/27 21:30:10 INFO storage.BlockManagerMaster: Registered BlockManager
13/07/27 21:30:10 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:30:10 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:39104
13/07/27 21:30:10 INFO broadcast.HttpBroadcast: Broadcast server started at http://10.151.80.188:39104
13/07/27 21:30:10 INFO spark.SparkEnv: Registering MapOutputTracker
13/07/27 21:30:10 INFO spark.HttpFileServer: HTTP File server directory is /tmp/spark-2e63d70f-ff1d-43a7-9f9d-44c878926205
13/07/27 21:30:10 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:30:10 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:58965
13/07/27 21:30:10 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:30:10 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage/rdd,null}
13/07/27 21:30:10 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:30:10 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:30:10 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:30:10 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:30:10 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:30:10 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:30:10 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:30:10 INFO server.AbstractConnector: Started SelectChannelConnector@0.0.0.0:33000
13/07/27 21:30:10 INFO ui.SparkUI: Started Spark Web UI at http://tachyon-ec2-0:33000
Spark context available as sc.
Type in expressions to have them evaluated.
Type :help for more information.

scala> val s = sc.textFile("tachyon://tachyon-ec2-0:19998/hit_data.tsv.1")
13/07/27 21:30:11 INFO storage.MemoryStore: ensureFreeSpace(58415) called with curMem=0, maxMem=1358297825
13/07/27 21:30:11 INFO storage.MemoryStore: Block broadcast_0 stored as values to memory (estimated size 57.0 KB, free 1295.3 MB)
s: spark.RDD[String] = MappedRDD[1] at textFile at <console>:12

scala> s.count()
13/07/27 21:30:11 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
13/07/27 21:30:11 WARN snappy.LoadSnappy: Snappy native library not loaded
13/07/27 21:30:11 INFO : initialize(tachyon://tachyon-ec2-0:19998/hit_data.tsv.1, Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml). Connecting to Tachyon: tachyon://tachyon-ec2-0:19998/hit_data.tsv.1
13/07/27 21:30:11 INFO : Trying to connect master @ tachyon-ec2-0/10.151.80.188:19998
13/07/27 21:30:11 INFO : User registered at the master tachyon-ec2-0/10.151.80.188:19998 got UserId 1
13/07/27 21:30:11 INFO : Trying to get local worker host : tachyon-ec2-0
13/07/27 21:30:11 INFO : Connecting local worker @ tachyon-ec2-0/10.151.80.188:29998
13/07/27 21:30:11 INFO : tachyon://tachyon-ec2-0:19998 tachyon://tachyon-ec2-0:19998 file:///mnt/tachyon
13/07/27 21:30:11 INFO : getFileStatus(/hit_data.tsv.1): HDFS Path: file:/mnt/tachyon/hit_data.tsv.1 TPath: tachyon://tachyon-ec2-0:19998/hit_data.tsv.1
13/07/27 21:30:12 INFO : tachyon.client.TachyonFS@47b29932 file:///mnt/tachyon /hit_data.tsv.1 tachyon.PrefixList@1e67c664
13/07/27 21:30:12 INFO : Create tachyon file /hit_data.tsv.1 with file id 2 and checkpoint location file:///mnt/tachyon/hit_data.tsv.1
13/07/27 21:30:12 INFO mapred.FileInputFormat: Total input paths to process : 1
13/07/27 21:30:12 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:30:12 INFO scheduler.DAGScheduler: Got job 0 (count at <console>:15) with 1 output partitions (allowLocal=false)
13/07/27 21:30:12 INFO scheduler.DAGScheduler: Final stage: Stage 0 (count at <console>:15)
13/07/27 21:30:12 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:30:12 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:30:12 INFO scheduler.DAGScheduler: Submitting Stage 0 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:30:12 INFO scheduler.DAGScheduler: Submitting 1 missing tasks from Stage 0 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:30:12 INFO local.LocalTaskSetManager: Size of task 0 is 1494 bytes
13/07/27 21:30:12 INFO local.LocalScheduler: Running 0
13/07/27 21:30:12 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.1, 65536)
13/07/27 21:30:12 INFO : /mnt/ramdisk/tachyonworker/2147483648 is not on local disk.
13/07/27 21:30:12 INFO : Try to find and read from remote workers.
13/07/27 21:30:12 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:30:12 INFO : Folder /mnt/ramdisk/tachyonworker/users/1 was created!
13/07/27 21:30:12 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483648 was created!
13/07/27 21:30:12 INFO local.LocalScheduler: Finished 0
13/07/27 21:30:12 INFO local.LocalScheduler: Remove TaskSet 0.0 from pool 
13/07/27 21:30:12 INFO scheduler.DAGScheduler: Completed ResultTask(0, 0)
13/07/27 21:30:12 INFO scheduler.DAGScheduler: Stage 0 (count at <console>:15) finished in 0.359 s
13/07/27 21:30:12 INFO spark.SparkContext: Job finished: count at <console>:15, took 0.401825393 s
res0: Long = 1

scala> 13/07/27 21:30:13 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:30:13 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:30:13 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:30:13 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:30:13 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:30:13 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:30:13 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:30:13 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage/rdd,null}
Killed 1 processes
Killed 1 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting Tachyon @ tachyon-ec2-0
2013-07-27 21:30:14,640 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data
2013-07-27 21:30:14,644 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_log.data
2013-07-27 21:30:15,130 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/data
2013-07-27 21:30:15,142 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/workers

restaring tachyon
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Killed 0 processes
Killed 0 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting RamFS: /mnt/ramdisk
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata -Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Starting master @ tachyon-ec2-0
Starting worker @ tachyon-ec2-0

spark-shell count
2739 tachyon.Master
2766 tachyon.Worker

Going to fadvise /mnt/tachyon/hit_data.tsv.100 as mode POSIX_FADV_DONTNEED
offset: 0
length: 55735
mode: POSIX_FADV_DONTNEED
WIN
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/ubuntu/work/tachyon/target/tachyon-0.3.0-SNAPSHOT-jar-with-dependencies.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/ubuntu/work/spark/lib_managed/jars/slf4j-log4j12-1.7.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
Welcome to
      ____              __  
     / __/__  ___ _____/ /__
    _\ \/ _ \/ _ `/ __/  '_/
   /___/ .__/\_,_/_/ /_/\_\   version 0.8.0
      /_/                  

Using Scala version 2.9.3 (OpenJDK 64-Bit Server VM, Java 1.7.0_25)
Initializing interpreter...
13/07/27 21:30:21 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:30:21 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:41310
Creating SparkContext...
13/07/27 21:30:30 INFO slf4j.Slf4jEventHandler: Slf4jEventHandler started
13/07/27 21:30:30 INFO spark.SparkEnv: Registering BlockManagerMaster
13/07/27 21:30:30 INFO storage.MemoryStore: MemoryStore started with capacity 1295.4 MB.
13/07/27 21:30:30 INFO storage.DiskStore: Created local directory at /tmp/spark-local-20130727213030-dfb5
13/07/27 21:30:30 INFO network.ConnectionManager: Bound socket to port 36011 with id = ConnectionManagerId(tachyon-ec2-0,36011)
13/07/27 21:30:30 INFO storage.BlockManagerMaster: Trying to register BlockManager
13/07/27 21:30:30 INFO storage.BlockManagerMasterActor$BlockManagerInfo: Registering block manager tachyon-ec2-0:36011 with 1295.4 MB RAM
13/07/27 21:30:30 INFO storage.BlockManagerMaster: Registered BlockManager
13/07/27 21:30:30 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:30:30 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:60500
13/07/27 21:30:30 INFO broadcast.HttpBroadcast: Broadcast server started at http://10.151.80.188:60500
13/07/27 21:30:30 INFO spark.SparkEnv: Registering MapOutputTracker
13/07/27 21:30:30 INFO spark.HttpFileServer: HTTP File server directory is /tmp/spark-6d343d9a-eece-4d35-afee-4c61cdfe7731
13/07/27 21:30:30 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:30:30 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:60159
13/07/27 21:30:30 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:30:30 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage/rdd,null}
13/07/27 21:30:30 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:30:30 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:30:30 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:30:30 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:30:30 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:30:30 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:30:30 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:30:30 INFO server.AbstractConnector: Started SelectChannelConnector@0.0.0.0:33000
13/07/27 21:30:30 INFO ui.SparkUI: Started Spark Web UI at http://tachyon-ec2-0:33000
Spark context available as sc.
Type in expressions to have them evaluated.
Type :help for more information.

scala> val s = sc.textFile("tachyon://tachyon-ec2-0:19998/hit_data.tsv.100")
13/07/27 21:30:32 INFO storage.MemoryStore: ensureFreeSpace(58423) called with curMem=0, maxMem=1358297825
13/07/27 21:30:32 INFO storage.MemoryStore: Block broadcast_0 stored as values to memory (estimated size 57.1 KB, free 1295.3 MB)
s: spark.RDD[String] = MappedRDD[1] at textFile at <console>:12

scala> s.count()
13/07/27 21:30:32 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
13/07/27 21:30:32 WARN snappy.LoadSnappy: Snappy native library not loaded
13/07/27 21:30:32 INFO : initialize(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100, Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml). Connecting to Tachyon: tachyon://tachyon-ec2-0:19998/hit_data.tsv.100
13/07/27 21:30:32 INFO : Trying to connect master @ tachyon-ec2-0/10.151.80.188:19998
13/07/27 21:30:32 INFO : User registered at the master tachyon-ec2-0/10.151.80.188:19998 got UserId 1
13/07/27 21:30:32 INFO : Trying to get local worker host : tachyon-ec2-0
13/07/27 21:30:32 INFO : Connecting local worker @ tachyon-ec2-0/10.151.80.188:29998
13/07/27 21:30:32 INFO : tachyon://tachyon-ec2-0:19998 tachyon://tachyon-ec2-0:19998 file:///mnt/tachyon
13/07/27 21:30:32 INFO : getFileStatus(/hit_data.tsv.100): HDFS Path: file:/mnt/tachyon/hit_data.tsv.100 TPath: tachyon://tachyon-ec2-0:19998/hit_data.tsv.100
13/07/27 21:30:32 INFO : tachyon.client.TachyonFS@391f0422 file:///mnt/tachyon /hit_data.tsv.100 tachyon.PrefixList@2348717a
13/07/27 21:30:33 INFO : Create tachyon file /hit_data.tsv.100 with file id 2 and checkpoint location file:///mnt/tachyon/hit_data.tsv.100
13/07/27 21:30:33 INFO mapred.FileInputFormat: Total input paths to process : 1
13/07/27 21:30:33 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:30:33 INFO scheduler.DAGScheduler: Got job 0 (count at <console>:15) with 1 output partitions (allowLocal=false)
13/07/27 21:30:33 INFO scheduler.DAGScheduler: Final stage: Stage 0 (count at <console>:15)
13/07/27 21:30:33 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:30:33 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:30:33 INFO scheduler.DAGScheduler: Submitting Stage 0 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:30:33 INFO scheduler.DAGScheduler: Submitting 1 missing tasks from Stage 0 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:30:33 INFO local.LocalTaskSetManager: Size of task 0 is 1496 bytes
13/07/27 21:30:33 INFO local.LocalScheduler: Running 0
13/07/27 21:30:33 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100, 65536)
13/07/27 21:30:33 INFO : /mnt/ramdisk/tachyonworker/2147483648 is not on local disk.
13/07/27 21:30:33 INFO : Try to find and read from remote workers.
13/07/27 21:30:33 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:30:33 INFO : Folder /mnt/ramdisk/tachyonworker/users/1 was created!
13/07/27 21:30:33 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483648 was created!
13/07/27 21:30:33 INFO local.LocalScheduler: Finished 0
13/07/27 21:30:33 INFO local.LocalScheduler: Remove TaskSet 0.0 from pool 
13/07/27 21:30:33 INFO scheduler.DAGScheduler: Completed ResultTask(0, 0)
13/07/27 21:30:33 INFO scheduler.DAGScheduler: Stage 0 (count at <console>:15) finished in 0.360 s
13/07/27 21:30:33 INFO spark.SparkContext: Job finished: count at <console>:15, took 0.404679988 s
res0: Long = 100

scala> 13/07/27 21:30:33 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:30:33 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:30:33 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:30:33 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:30:33 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:30:33 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:30:33 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:30:33 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage/rdd,null}
Killed 1 processes
Killed 1 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting Tachyon @ tachyon-ec2-0
2013-07-27 21:30:35,365 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data
2013-07-27 21:30:35,369 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_log.data
2013-07-27 21:30:35,859 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/data
2013-07-27 21:30:35,871 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/workers

restaring tachyon
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Killed 0 processes
Killed 0 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting RamFS: /mnt/ramdisk
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata -Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Starting master @ tachyon-ec2-0
Starting worker @ tachyon-ec2-0

spark-shell count
3314 tachyon.Master
3341 tachyon.Worker

Going to fadvise /mnt/tachyon/hit_data.tsv.1000 as mode POSIX_FADV_DONTNEED
offset: 0
length: 776400
mode: POSIX_FADV_DONTNEED
WIN
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/ubuntu/work/tachyon/target/tachyon-0.3.0-SNAPSHOT-jar-with-dependencies.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/ubuntu/work/spark/lib_managed/jars/slf4j-log4j12-1.7.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
Welcome to
      ____              __  
     / __/__  ___ _____/ /__
    _\ \/ _ \/ _ `/ __/  '_/
   /___/ .__/\_,_/_/ /_/\_\   version 0.8.0
      /_/                  

Using Scala version 2.9.3 (OpenJDK 64-Bit Server VM, Java 1.7.0_25)
Initializing interpreter...
13/07/27 21:30:42 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:30:42 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:37464
Creating SparkContext...
13/07/27 21:30:51 INFO slf4j.Slf4jEventHandler: Slf4jEventHandler started
13/07/27 21:30:51 INFO spark.SparkEnv: Registering BlockManagerMaster
13/07/27 21:30:51 INFO storage.MemoryStore: MemoryStore started with capacity 1295.4 MB.
13/07/27 21:30:51 INFO storage.DiskStore: Created local directory at /tmp/spark-local-20130727213051-a2a3
13/07/27 21:30:51 INFO network.ConnectionManager: Bound socket to port 52016 with id = ConnectionManagerId(tachyon-ec2-0,52016)
13/07/27 21:30:51 INFO storage.BlockManagerMaster: Trying to register BlockManager
13/07/27 21:30:51 INFO storage.BlockManagerMasterActor$BlockManagerInfo: Registering block manager tachyon-ec2-0:52016 with 1295.4 MB RAM
13/07/27 21:30:51 INFO storage.BlockManagerMaster: Registered BlockManager
13/07/27 21:30:51 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:30:51 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:53901
13/07/27 21:30:51 INFO broadcast.HttpBroadcast: Broadcast server started at http://10.151.80.188:53901
13/07/27 21:30:51 INFO spark.SparkEnv: Registering MapOutputTracker
13/07/27 21:30:51 INFO spark.HttpFileServer: HTTP File server directory is /tmp/spark-c7bafef5-69ec-4bfb-a243-8ca373cf13c5
13/07/27 21:30:51 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:30:51 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:55666
13/07/27 21:30:51 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:30:51 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage/rdd,null}
13/07/27 21:30:51 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:30:51 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:30:51 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:30:51 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:30:51 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:30:51 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:30:51 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:30:51 INFO server.AbstractConnector: Started SelectChannelConnector@0.0.0.0:33000
13/07/27 21:30:51 INFO ui.SparkUI: Started Spark Web UI at http://tachyon-ec2-0:33000
Spark context available as sc.
Type in expressions to have them evaluated.
Type :help for more information.

scala> val s = sc.textFile("tachyon://tachyon-ec2-0:19998/hit_data.tsv.1000")
13/07/27 21:30:53 INFO storage.MemoryStore: ensureFreeSpace(58423) called with curMem=0, maxMem=1358297825
13/07/27 21:30:53 INFO storage.MemoryStore: Block broadcast_0 stored as values to memory (estimated size 57.1 KB, free 1295.3 MB)
s: spark.RDD[String] = MappedRDD[1] at textFile at <console>:12

scala> s.count()
13/07/27 21:30:53 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
13/07/27 21:30:53 WARN snappy.LoadSnappy: Snappy native library not loaded
13/07/27 21:30:53 INFO : initialize(tachyon://tachyon-ec2-0:19998/hit_data.tsv.1000, Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml). Connecting to Tachyon: tachyon://tachyon-ec2-0:19998/hit_data.tsv.1000
13/07/27 21:30:53 INFO : Trying to connect master @ tachyon-ec2-0/10.151.80.188:19998
13/07/27 21:30:53 INFO : User registered at the master tachyon-ec2-0/10.151.80.188:19998 got UserId 1
13/07/27 21:30:53 INFO : Trying to get local worker host : tachyon-ec2-0
13/07/27 21:30:53 INFO : Connecting local worker @ tachyon-ec2-0/10.151.80.188:29998
13/07/27 21:30:53 INFO : tachyon://tachyon-ec2-0:19998 tachyon://tachyon-ec2-0:19998 file:///mnt/tachyon
13/07/27 21:30:53 INFO : getFileStatus(/hit_data.tsv.1000): HDFS Path: file:/mnt/tachyon/hit_data.tsv.1000 TPath: tachyon://tachyon-ec2-0:19998/hit_data.tsv.1000
13/07/27 21:30:53 INFO : tachyon.client.TachyonFS@5407cc45 file:///mnt/tachyon /hit_data.tsv.1000 tachyon.PrefixList@4bf3f11c
13/07/27 21:30:53 INFO : Create tachyon file /hit_data.tsv.1000 with file id 2 and checkpoint location file:///mnt/tachyon/hit_data.tsv.1000
13/07/27 21:30:53 INFO mapred.FileInputFormat: Total input paths to process : 1
13/07/27 21:30:54 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:30:54 INFO scheduler.DAGScheduler: Got job 0 (count at <console>:15) with 1 output partitions (allowLocal=false)
13/07/27 21:30:54 INFO scheduler.DAGScheduler: Final stage: Stage 0 (count at <console>:15)
13/07/27 21:30:54 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:30:54 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:30:54 INFO scheduler.DAGScheduler: Submitting Stage 0 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:30:54 INFO scheduler.DAGScheduler: Submitting 1 missing tasks from Stage 0 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:30:54 INFO local.LocalTaskSetManager: Size of task 0 is 1497 bytes
13/07/27 21:30:54 INFO local.LocalScheduler: Running 0
13/07/27 21:30:54 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.1000, 65536)
13/07/27 21:30:54 INFO : /mnt/ramdisk/tachyonworker/2147483648 is not on local disk.
13/07/27 21:30:54 INFO : Try to find and read from remote workers.
13/07/27 21:30:54 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:30:54 INFO : Folder /mnt/ramdisk/tachyonworker/users/1 was created!
13/07/27 21:30:54 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483648 was created!
13/07/27 21:30:54 INFO local.LocalScheduler: Finished 0
13/07/27 21:30:54 INFO local.LocalScheduler: Remove TaskSet 0.0 from pool 
13/07/27 21:30:54 INFO scheduler.DAGScheduler: Completed ResultTask(0, 0)
13/07/27 21:30:54 INFO scheduler.DAGScheduler: Stage 0 (count at <console>:15) finished in 0.392 s
13/07/27 21:30:54 INFO spark.SparkContext: Job finished: count at <console>:15, took 0.435652753 s
res0: Long = 1000

scala> 13/07/27 21:30:54 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:30:54 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:30:54 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:30:54 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:30:54 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:30:54 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:30:54 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:30:54 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage/rdd,null}
Killed 1 processes
Killed 1 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting Tachyon @ tachyon-ec2-0
2013-07-27 21:30:56,163 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data
2013-07-27 21:30:56,167 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_log.data
2013-07-27 21:30:56,653 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/data
2013-07-27 21:30:56,664 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/workers

restaring tachyon
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Killed 0 processes
Killed 0 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting RamFS: /mnt/ramdisk
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata -Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Starting master @ tachyon-ec2-0
Starting worker @ tachyon-ec2-0

spark-shell count
3872 tachyon.Master
3899 tachyon.Worker

Going to fadvise /mnt/tachyon/hit_data.tsv.10000 as mode POSIX_FADV_DONTNEED
offset: 0
length: 12330369
mode: POSIX_FADV_DONTNEED
WIN
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/ubuntu/work/tachyon/target/tachyon-0.3.0-SNAPSHOT-jar-with-dependencies.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/ubuntu/work/spark/lib_managed/jars/slf4j-log4j12-1.7.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
Welcome to
      ____              __  
     / __/__  ___ _____/ /__
    _\ \/ _ \/ _ `/ __/  '_/
   /___/ .__/\_,_/_/ /_/\_\   version 0.8.0
      /_/                  

Using Scala version 2.9.3 (OpenJDK 64-Bit Server VM, Java 1.7.0_25)
Initializing interpreter...
13/07/27 21:31:02 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:31:02 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:45762
Creating SparkContext...
13/07/27 21:31:12 INFO slf4j.Slf4jEventHandler: Slf4jEventHandler started
13/07/27 21:31:12 INFO spark.SparkEnv: Registering BlockManagerMaster
13/07/27 21:31:12 INFO storage.MemoryStore: MemoryStore started with capacity 1295.4 MB.
13/07/27 21:31:12 INFO storage.DiskStore: Created local directory at /tmp/spark-local-20130727213112-bdb5
13/07/27 21:31:12 INFO network.ConnectionManager: Bound socket to port 43907 with id = ConnectionManagerId(tachyon-ec2-0,43907)
13/07/27 21:31:12 INFO storage.BlockManagerMaster: Trying to register BlockManager
13/07/27 21:31:12 INFO storage.BlockManagerMasterActor$BlockManagerInfo: Registering block manager tachyon-ec2-0:43907 with 1295.4 MB RAM
13/07/27 21:31:12 INFO storage.BlockManagerMaster: Registered BlockManager
13/07/27 21:31:12 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:31:12 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:53366
13/07/27 21:31:12 INFO broadcast.HttpBroadcast: Broadcast server started at http://10.151.80.188:53366
13/07/27 21:31:12 INFO spark.SparkEnv: Registering MapOutputTracker
13/07/27 21:31:12 INFO spark.HttpFileServer: HTTP File server directory is /tmp/spark-977f6896-4133-4481-914f-b8a98edfd641
13/07/27 21:31:12 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:31:12 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:39331
13/07/27 21:31:12 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:31:12 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage/rdd,null}
13/07/27 21:31:12 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:31:12 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:31:12 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:31:12 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:31:12 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:31:12 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:31:12 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:31:12 INFO server.AbstractConnector: Started SelectChannelConnector@0.0.0.0:33000
13/07/27 21:31:12 INFO ui.SparkUI: Started Spark Web UI at http://tachyon-ec2-0:33000
Spark context available as sc.
Type in expressions to have them evaluated.
Type :help for more information.

scala> val s = sc.textFile("tachyon://tachyon-ec2-0:19998/hit_data.tsv.10000")
13/07/27 21:31:13 INFO storage.MemoryStore: ensureFreeSpace(58423) called with curMem=0, maxMem=1358297825
13/07/27 21:31:13 INFO storage.MemoryStore: Block broadcast_0 stored as values to memory (estimated size 57.1 KB, free 1295.3 MB)
s: spark.RDD[String] = MappedRDD[1] at textFile at <console>:12

scala> s.count()
13/07/27 21:31:14 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
13/07/27 21:31:14 WARN snappy.LoadSnappy: Snappy native library not loaded
13/07/27 21:31:14 INFO : initialize(tachyon://tachyon-ec2-0:19998/hit_data.tsv.10000, Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml). Connecting to Tachyon: tachyon://tachyon-ec2-0:19998/hit_data.tsv.10000
13/07/27 21:31:14 INFO : Trying to connect master @ tachyon-ec2-0/10.151.80.188:19998
13/07/27 21:31:14 INFO : User registered at the master tachyon-ec2-0/10.151.80.188:19998 got UserId 1
13/07/27 21:31:14 INFO : Trying to get local worker host : tachyon-ec2-0
13/07/27 21:31:14 INFO : Connecting local worker @ tachyon-ec2-0/10.151.80.188:29998
13/07/27 21:31:14 INFO : tachyon://tachyon-ec2-0:19998 tachyon://tachyon-ec2-0:19998 file:///mnt/tachyon
13/07/27 21:31:14 INFO : getFileStatus(/hit_data.tsv.10000): HDFS Path: file:/mnt/tachyon/hit_data.tsv.10000 TPath: tachyon://tachyon-ec2-0:19998/hit_data.tsv.10000
13/07/27 21:31:14 INFO : tachyon.client.TachyonFS@d851ebd file:///mnt/tachyon /hit_data.tsv.10000 tachyon.PrefixList@1ea5113a
13/07/27 21:31:14 INFO : Create tachyon file /hit_data.tsv.10000 with file id 2 and checkpoint location file:///mnt/tachyon/hit_data.tsv.10000
13/07/27 21:31:14 INFO mapred.FileInputFormat: Total input paths to process : 1
13/07/27 21:31:14 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:31:14 INFO scheduler.DAGScheduler: Got job 0 (count at <console>:15) with 1 output partitions (allowLocal=false)
13/07/27 21:31:14 INFO scheduler.DAGScheduler: Final stage: Stage 0 (count at <console>:15)
13/07/27 21:31:14 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:31:14 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:31:14 INFO scheduler.DAGScheduler: Submitting Stage 0 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:31:14 INFO scheduler.DAGScheduler: Submitting 1 missing tasks from Stage 0 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:31:14 INFO local.LocalTaskSetManager: Size of task 0 is 1498 bytes
13/07/27 21:31:14 INFO local.LocalScheduler: Running 0
13/07/27 21:31:15 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.10000, 65536)
13/07/27 21:31:15 INFO : /mnt/ramdisk/tachyonworker/2147483648 is not on local disk.
13/07/27 21:31:15 INFO : Try to find and read from remote workers.
13/07/27 21:31:15 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:31:15 INFO : Folder /mnt/ramdisk/tachyonworker/users/1 was created!
13/07/27 21:31:15 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483648 was created!
13/07/27 21:31:15 INFO local.LocalScheduler: Finished 0
13/07/27 21:31:15 INFO local.LocalScheduler: Remove TaskSet 0.0 from pool 
13/07/27 21:31:15 INFO scheduler.DAGScheduler: Completed ResultTask(0, 0)
13/07/27 21:31:15 INFO scheduler.DAGScheduler: Stage 0 (count at <console>:15) finished in 0.650 s
13/07/27 21:31:15 INFO spark.SparkContext: Job finished: count at <console>:15, took 0.692575541 s
res0: Long = 10000

scala> 13/07/27 21:31:15 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:31:15 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:31:15 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:31:15 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:31:15 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:31:15 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:31:15 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:31:15 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage/rdd,null}
Killed 1 processes
Killed 1 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting Tachyon @ tachyon-ec2-0
2013-07-27 21:31:17,257 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data
2013-07-27 21:31:17,261 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_log.data
2013-07-27 21:31:17,748 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/data
2013-07-27 21:31:17,760 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/workers

restaring tachyon
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Killed 0 processes
Killed 0 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting RamFS: /mnt/ramdisk
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata -Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Starting master @ tachyon-ec2-0
Starting worker @ tachyon-ec2-0

spark-shell count
4431 tachyon.Master
4458 tachyon.Worker

Going to fadvise /mnt/tachyon/hit_data.tsv.100000 as mode POSIX_FADV_DONTNEED
offset: 0
length: 125141299
mode: POSIX_FADV_DONTNEED
WIN
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/ubuntu/work/tachyon/target/tachyon-0.3.0-SNAPSHOT-jar-with-dependencies.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/ubuntu/work/spark/lib_managed/jars/slf4j-log4j12-1.7.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
Welcome to
      ____              __  
     / __/__  ___ _____/ /__
    _\ \/ _ \/ _ `/ __/  '_/
   /___/ .__/\_,_/_/ /_/\_\   version 0.8.0
      /_/                  

Using Scala version 2.9.3 (OpenJDK 64-Bit Server VM, Java 1.7.0_25)
Initializing interpreter...
13/07/27 21:31:24 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:31:24 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:56315
Creating SparkContext...
13/07/27 21:31:33 INFO slf4j.Slf4jEventHandler: Slf4jEventHandler started
13/07/27 21:31:33 INFO spark.SparkEnv: Registering BlockManagerMaster
13/07/27 21:31:33 INFO storage.MemoryStore: MemoryStore started with capacity 1295.4 MB.
13/07/27 21:31:33 INFO storage.DiskStore: Created local directory at /tmp/spark-local-20130727213133-30a7
13/07/27 21:31:33 INFO network.ConnectionManager: Bound socket to port 47388 with id = ConnectionManagerId(tachyon-ec2-0,47388)
13/07/27 21:31:33 INFO storage.BlockManagerMaster: Trying to register BlockManager
13/07/27 21:31:33 INFO storage.BlockManagerMasterActor$BlockManagerInfo: Registering block manager tachyon-ec2-0:47388 with 1295.4 MB RAM
13/07/27 21:31:33 INFO storage.BlockManagerMaster: Registered BlockManager
13/07/27 21:31:33 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:31:33 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:35801
13/07/27 21:31:33 INFO broadcast.HttpBroadcast: Broadcast server started at http://10.151.80.188:35801
13/07/27 21:31:33 INFO spark.SparkEnv: Registering MapOutputTracker
13/07/27 21:31:33 INFO spark.HttpFileServer: HTTP File server directory is /tmp/spark-ec848954-77e7-4e5a-9765-a66058b35daa
13/07/27 21:31:33 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:31:33 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:50651
13/07/27 21:31:33 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:31:33 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage/rdd,null}
13/07/27 21:31:33 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:31:33 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:31:33 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:31:33 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:31:33 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:31:33 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:31:33 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:31:33 INFO server.AbstractConnector: Started SelectChannelConnector@0.0.0.0:33000
13/07/27 21:31:33 INFO ui.SparkUI: Started Spark Web UI at http://tachyon-ec2-0:33000
Spark context available as sc.
Type in expressions to have them evaluated.
Type :help for more information.

scala> val s = sc.textFile("tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000")
13/07/27 21:31:35 INFO storage.MemoryStore: ensureFreeSpace(58431) called with curMem=0, maxMem=1358297825
13/07/27 21:31:35 INFO storage.MemoryStore: Block broadcast_0 stored as values to memory (estimated size 57.1 KB, free 1295.3 MB)
s: spark.RDD[String] = MappedRDD[1] at textFile at <console>:12

scala> s.count()
13/07/27 21:31:35 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
13/07/27 21:31:35 WARN snappy.LoadSnappy: Snappy native library not loaded
13/07/27 21:31:35 INFO : initialize(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000, Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml). Connecting to Tachyon: tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000
13/07/27 21:31:35 INFO : Trying to connect master @ tachyon-ec2-0/10.151.80.188:19998
13/07/27 21:31:35 INFO : User registered at the master tachyon-ec2-0/10.151.80.188:19998 got UserId 1
13/07/27 21:31:35 INFO : Trying to get local worker host : tachyon-ec2-0
13/07/27 21:31:35 INFO : Connecting local worker @ tachyon-ec2-0/10.151.80.188:29998
13/07/27 21:31:35 INFO : tachyon://tachyon-ec2-0:19998 tachyon://tachyon-ec2-0:19998 file:///mnt/tachyon
13/07/27 21:31:35 INFO : getFileStatus(/hit_data.tsv.100000): HDFS Path: file:/mnt/tachyon/hit_data.tsv.100000 TPath: tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000
13/07/27 21:31:35 INFO : tachyon.client.TachyonFS@54f943ef file:///mnt/tachyon /hit_data.tsv.100000 tachyon.PrefixList@38db2b7e
13/07/27 21:31:35 INFO : Create tachyon file /hit_data.tsv.100000 with file id 2 and checkpoint location file:///mnt/tachyon/hit_data.tsv.100000
13/07/27 21:31:35 INFO mapred.FileInputFormat: Total input paths to process : 1
13/07/27 21:31:36 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:31:36 INFO scheduler.DAGScheduler: Got job 0 (count at <console>:15) with 4 output partitions (allowLocal=false)
13/07/27 21:31:36 INFO scheduler.DAGScheduler: Final stage: Stage 0 (count at <console>:15)
13/07/27 21:31:36 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:31:36 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:31:36 INFO scheduler.DAGScheduler: Submitting Stage 0 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:31:36 INFO scheduler.DAGScheduler: Submitting 4 missing tasks from Stage 0 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:31:36 INFO local.LocalTaskSetManager: Size of task 0 is 1499 bytes
13/07/27 21:31:36 INFO local.LocalScheduler: Running 0
13/07/27 21:31:36 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000, 65536)
13/07/27 21:31:36 INFO : /mnt/ramdisk/tachyonworker/2147483648 is not on local disk.
13/07/27 21:31:36 INFO : Try to find and read from remote workers.
13/07/27 21:31:36 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:31:36 INFO : Folder /mnt/ramdisk/tachyonworker/users/1 was created!
13/07/27 21:31:36 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483648 was created!
13/07/27 21:31:37 INFO : /mnt/ramdisk/tachyonworker/2147483649 is not on local disk.
13/07/27 21:31:37 INFO : Try to find and read from remote workers.
13/07/27 21:31:37 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:31:37 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483649 was created!
13/07/27 21:31:37 INFO local.LocalScheduler: Finished 0
13/07/27 21:31:37 INFO local.LocalTaskSetManager: Size of task 1 is 1499 bytes
13/07/27 21:31:37 INFO local.LocalScheduler: Running 1
13/07/27 21:31:37 INFO scheduler.DAGScheduler: Completed ResultTask(0, 0)
13/07/27 21:31:37 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000, 65536)
13/07/27 21:31:37 INFO : /mnt/ramdisk/tachyonworker/2147483650 is not on local disk.
13/07/27 21:31:37 INFO : Try to find and read from remote workers.
13/07/27 21:31:37 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:31:37 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483650 was created!
13/07/27 21:31:38 INFO local.LocalScheduler: Finished 1
13/07/27 21:31:38 INFO scheduler.DAGScheduler: Completed ResultTask(0, 1)
13/07/27 21:31:38 INFO local.LocalTaskSetManager: Size of task 2 is 1499 bytes
13/07/27 21:31:38 INFO local.LocalScheduler: Running 2
13/07/27 21:31:38 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000, 65536)
13/07/27 21:31:38 INFO : /mnt/ramdisk/tachyonworker/2147483651 is not on local disk.
13/07/27 21:31:38 INFO : Try to find and read from remote workers.
13/07/27 21:31:38 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:31:38 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483651 was created!
13/07/27 21:31:38 INFO local.LocalScheduler: Finished 2
13/07/27 21:31:38 INFO scheduler.DAGScheduler: Completed ResultTask(0, 2)
13/07/27 21:31:38 INFO local.LocalTaskSetManager: Size of task 3 is 1499 bytes
13/07/27 21:31:38 INFO local.LocalScheduler: Running 3
13/07/27 21:31:38 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000, 65536)
13/07/27 21:31:38 INFO local.LocalScheduler: Finished 3
13/07/27 21:31:38 INFO scheduler.DAGScheduler: Completed ResultTask(0, 3)
13/07/27 21:31:38 INFO local.LocalScheduler: Remove TaskSet 0.0 from pool 
13/07/27 21:31:38 INFO scheduler.DAGScheduler: Stage 0 (count at <console>:15) finished in 2.788 s
13/07/27 21:31:38 INFO spark.SparkContext: Job finished: count at <console>:15, took 2.832779359 s
res0: Long = 100002

scala> 13/07/27 21:31:38 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:31:38 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:31:38 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:31:38 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:31:38 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:31:38 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:31:38 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:31:38 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage/rdd,null}
Killed 1 processes
Killed 1 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting Tachyon @ tachyon-ec2-0
2013-07-27 21:31:40,639 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data
2013-07-27 21:31:40,643 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_log.data
2013-07-27 21:31:41,131 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/data
2013-07-27 21:31:41,143 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/workers

restaring tachyon
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Killed 0 processes
Killed 0 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting RamFS: /mnt/ramdisk
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata -Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Starting master @ tachyon-ec2-0
Starting worker @ tachyon-ec2-0

spark-shell count
5069 tachyon.Master
5098 tachyon.Worker

Going to fadvise /mnt/tachyon/hit_data.tsv.500000 as mode POSIX_FADV_DONTNEED
offset: 0
length: 618418417
mode: POSIX_FADV_DONTNEED
WIN
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/ubuntu/work/tachyon/target/tachyon-0.3.0-SNAPSHOT-jar-with-dependencies.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/ubuntu/work/spark/lib_managed/jars/slf4j-log4j12-1.7.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
Welcome to
      ____              __  
     / __/__  ___ _____/ /__
    _\ \/ _ \/ _ `/ __/  '_/
   /___/ .__/\_,_/_/ /_/\_\   version 0.8.0
      /_/                  

Using Scala version 2.9.3 (OpenJDK 64-Bit Server VM, Java 1.7.0_25)
Initializing interpreter...
13/07/27 21:31:47 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:31:47 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:56989
Creating SparkContext...
13/07/27 21:31:56 INFO slf4j.Slf4jEventHandler: Slf4jEventHandler started
13/07/27 21:31:56 INFO spark.SparkEnv: Registering BlockManagerMaster
13/07/27 21:31:56 INFO storage.MemoryStore: MemoryStore started with capacity 1295.4 MB.
13/07/27 21:31:56 INFO storage.DiskStore: Created local directory at /tmp/spark-local-20130727213156-499f
13/07/27 21:31:56 INFO network.ConnectionManager: Bound socket to port 35667 with id = ConnectionManagerId(tachyon-ec2-0,35667)
13/07/27 21:31:57 INFO storage.BlockManagerMaster: Trying to register BlockManager
13/07/27 21:31:57 INFO storage.BlockManagerMasterActor$BlockManagerInfo: Registering block manager tachyon-ec2-0:35667 with 1295.4 MB RAM
13/07/27 21:31:57 INFO storage.BlockManagerMaster: Registered BlockManager
13/07/27 21:31:57 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:31:57 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:49159
13/07/27 21:31:57 INFO broadcast.HttpBroadcast: Broadcast server started at http://10.151.80.188:49159
13/07/27 21:31:57 INFO spark.SparkEnv: Registering MapOutputTracker
13/07/27 21:31:57 INFO spark.HttpFileServer: HTTP File server directory is /tmp/spark-c6a755ee-759e-4cb8-9b93-ad6d6befe218
13/07/27 21:31:57 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:31:57 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:56587
13/07/27 21:31:57 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:31:57 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage/rdd,null}
13/07/27 21:31:57 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:31:57 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:31:57 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:31:57 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:31:57 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:31:57 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:31:57 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:31:57 INFO server.AbstractConnector: Started SelectChannelConnector@0.0.0.0:33000
13/07/27 21:31:57 INFO ui.SparkUI: Started Spark Web UI at http://tachyon-ec2-0:33000
Spark context available as sc.
Type in expressions to have them evaluated.
Type :help for more information.

scala> val s = sc.textFile("tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000")
13/07/27 21:31:58 INFO storage.MemoryStore: ensureFreeSpace(58431) called with curMem=0, maxMem=1358297825
13/07/27 21:31:58 INFO storage.MemoryStore: Block broadcast_0 stored as values to memory (estimated size 57.1 KB, free 1295.3 MB)
s: spark.RDD[String] = MappedRDD[1] at textFile at <console>:12

scala> s.count()
13/07/27 21:31:58 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
13/07/27 21:31:58 WARN snappy.LoadSnappy: Snappy native library not loaded
13/07/27 21:31:58 INFO : initialize(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml). Connecting to Tachyon: tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000
13/07/27 21:31:58 INFO : Trying to connect master @ tachyon-ec2-0/10.151.80.188:19998
13/07/27 21:31:58 INFO : User registered at the master tachyon-ec2-0/10.151.80.188:19998 got UserId 1
13/07/27 21:31:58 INFO : Trying to get local worker host : tachyon-ec2-0
13/07/27 21:31:58 INFO : Connecting local worker @ tachyon-ec2-0/10.151.80.188:29998
13/07/27 21:31:58 INFO : tachyon://tachyon-ec2-0:19998 tachyon://tachyon-ec2-0:19998 file:///mnt/tachyon
13/07/27 21:31:58 INFO : getFileStatus(/hit_data.tsv.500000): HDFS Path: file:/mnt/tachyon/hit_data.tsv.500000 TPath: tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000
13/07/27 21:31:58 INFO : tachyon.client.TachyonFS@58f4d603 file:///mnt/tachyon /hit_data.tsv.500000 tachyon.PrefixList@320e8c95
13/07/27 21:31:59 INFO : Create tachyon file /hit_data.tsv.500000 with file id 2 and checkpoint location file:///mnt/tachyon/hit_data.tsv.500000
13/07/27 21:31:59 INFO mapred.FileInputFormat: Total input paths to process : 1
13/07/27 21:31:59 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:31:59 INFO scheduler.DAGScheduler: Got job 0 (count at <console>:15) with 19 output partitions (allowLocal=false)
13/07/27 21:31:59 INFO scheduler.DAGScheduler: Final stage: Stage 0 (count at <console>:15)
13/07/27 21:31:59 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:31:59 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:31:59 INFO scheduler.DAGScheduler: Submitting Stage 0 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:31:59 INFO scheduler.DAGScheduler: Submitting 19 missing tasks from Stage 0 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:31:59 INFO local.LocalTaskSetManager: Size of task 0 is 1499 bytes
13/07/27 21:31:59 INFO local.LocalScheduler: Running 0
13/07/27 21:31:59 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:32:00 INFO : /mnt/ramdisk/tachyonworker/2147483648 is not on local disk.
13/07/27 21:32:00 INFO : Try to find and read from remote workers.
13/07/27 21:32:00 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:32:00 INFO : Folder /mnt/ramdisk/tachyonworker/users/1 was created!
13/07/27 21:32:00 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483648 was created!
13/07/27 21:32:00 INFO : /mnt/ramdisk/tachyonworker/2147483649 is not on local disk.
13/07/27 21:32:00 INFO : Try to find and read from remote workers.
13/07/27 21:32:00 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:32:00 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483649 was created!
13/07/27 21:32:01 INFO local.LocalScheduler: Finished 0
13/07/27 21:32:01 INFO local.LocalTaskSetManager: Size of task 1 is 1499 bytes
13/07/27 21:32:01 INFO local.LocalScheduler: Running 1
13/07/27 21:32:01 INFO scheduler.DAGScheduler: Completed ResultTask(0, 0)
13/07/27 21:32:01 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:32:01 INFO : /mnt/ramdisk/tachyonworker/2147483650 is not on local disk.
13/07/27 21:32:01 INFO : Try to find and read from remote workers.
13/07/27 21:32:01 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:32:01 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483650 was created!
13/07/27 21:32:01 INFO local.LocalScheduler: Finished 1
13/07/27 21:32:01 INFO scheduler.DAGScheduler: Completed ResultTask(0, 1)
13/07/27 21:32:01 INFO local.LocalTaskSetManager: Size of task 2 is 1499 bytes
13/07/27 21:32:01 INFO local.LocalScheduler: Running 2
13/07/27 21:32:01 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:32:02 INFO : /mnt/ramdisk/tachyonworker/2147483651 is not on local disk.
13/07/27 21:32:02 INFO : Try to find and read from remote workers.
13/07/27 21:32:02 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:32:02 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483651 was created!
13/07/27 21:32:02 INFO local.LocalScheduler: Finished 2
13/07/27 21:32:02 INFO scheduler.DAGScheduler: Completed ResultTask(0, 2)
13/07/27 21:32:02 INFO local.LocalTaskSetManager: Size of task 3 is 1499 bytes
13/07/27 21:32:02 INFO local.LocalScheduler: Running 3
13/07/27 21:32:02 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:32:02 INFO : /mnt/ramdisk/tachyonworker/2147483652 is not on local disk.
13/07/27 21:32:02 INFO : Try to find and read from remote workers.
13/07/27 21:32:02 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:32:02 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483652 was created!
13/07/27 21:32:02 INFO local.LocalScheduler: Finished 3
13/07/27 21:32:03 INFO scheduler.DAGScheduler: Completed ResultTask(0, 3)
13/07/27 21:32:03 INFO local.LocalTaskSetManager: Size of task 4 is 1499 bytes
13/07/27 21:32:03 INFO local.LocalScheduler: Running 4
13/07/27 21:32:03 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:32:03 INFO : /mnt/ramdisk/tachyonworker/2147483653 is not on local disk.
13/07/27 21:32:03 INFO : Try to find and read from remote workers.
13/07/27 21:32:03 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:32:03 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483653 was created!
13/07/27 21:32:03 INFO local.LocalScheduler: Finished 4
13/07/27 21:32:03 INFO scheduler.DAGScheduler: Completed ResultTask(0, 4)
13/07/27 21:32:03 INFO local.LocalTaskSetManager: Size of task 5 is 1499 bytes
13/07/27 21:32:03 INFO local.LocalScheduler: Running 5
13/07/27 21:32:03 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:32:03 INFO : /mnt/ramdisk/tachyonworker/2147483654 is not on local disk.
13/07/27 21:32:03 INFO : Try to find and read from remote workers.
13/07/27 21:32:03 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:32:03 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483654 was created!
13/07/27 21:32:04 INFO local.LocalScheduler: Finished 5
13/07/27 21:32:04 INFO scheduler.DAGScheduler: Completed ResultTask(0, 5)
13/07/27 21:32:04 INFO local.LocalTaskSetManager: Size of task 6 is 1499 bytes
13/07/27 21:32:04 INFO local.LocalScheduler: Running 6
13/07/27 21:32:04 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:32:04 INFO : /mnt/ramdisk/tachyonworker/2147483655 is not on local disk.
13/07/27 21:32:04 INFO : Try to find and read from remote workers.
13/07/27 21:32:04 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:32:04 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483655 was created!
13/07/27 21:32:04 INFO local.LocalScheduler: Finished 6
13/07/27 21:32:04 INFO scheduler.DAGScheduler: Completed ResultTask(0, 6)
13/07/27 21:32:04 INFO local.LocalTaskSetManager: Size of task 7 is 1499 bytes
13/07/27 21:32:04 INFO local.LocalScheduler: Running 7
13/07/27 21:32:04 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:32:05 INFO : /mnt/ramdisk/tachyonworker/2147483656 is not on local disk.
13/07/27 21:32:05 INFO : Try to find and read from remote workers.
13/07/27 21:32:05 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:32:05 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483656 was created!
13/07/27 21:32:05 INFO local.LocalScheduler: Finished 7
13/07/27 21:32:05 INFO scheduler.DAGScheduler: Completed ResultTask(0, 7)
13/07/27 21:32:05 INFO local.LocalTaskSetManager: Size of task 8 is 1499 bytes
13/07/27 21:32:05 INFO local.LocalScheduler: Running 8
13/07/27 21:32:05 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:32:05 INFO : /mnt/ramdisk/tachyonworker/2147483657 is not on local disk.
13/07/27 21:32:05 INFO : Try to find and read from remote workers.
13/07/27 21:32:05 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:32:05 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483657 was created!
13/07/27 21:32:06 INFO local.LocalScheduler: Finished 8
13/07/27 21:32:06 INFO scheduler.DAGScheduler: Completed ResultTask(0, 8)
13/07/27 21:32:06 INFO local.LocalTaskSetManager: Size of task 9 is 1499 bytes
13/07/27 21:32:06 INFO local.LocalScheduler: Running 9
13/07/27 21:32:06 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:32:06 INFO : /mnt/ramdisk/tachyonworker/2147483658 is not on local disk.
13/07/27 21:32:06 INFO : Try to find and read from remote workers.
13/07/27 21:32:06 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:32:06 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483658 was created!
13/07/27 21:32:06 INFO local.LocalScheduler: Finished 9
13/07/27 21:32:06 INFO scheduler.DAGScheduler: Completed ResultTask(0, 9)
13/07/27 21:32:06 INFO local.LocalTaskSetManager: Size of task 10 is 1499 bytes
13/07/27 21:32:06 INFO local.LocalScheduler: Running 10
13/07/27 21:32:06 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:32:06 INFO : /mnt/ramdisk/tachyonworker/2147483659 is not on local disk.
13/07/27 21:32:06 INFO : Try to find and read from remote workers.
13/07/27 21:32:06 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:32:06 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483659 was created!
13/07/27 21:32:07 INFO local.LocalScheduler: Finished 10
13/07/27 21:32:07 INFO scheduler.DAGScheduler: Completed ResultTask(0, 10)
13/07/27 21:32:07 INFO local.LocalTaskSetManager: Size of task 11 is 1499 bytes
13/07/27 21:32:07 INFO local.LocalScheduler: Running 11
13/07/27 21:32:07 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:32:07 INFO : /mnt/ramdisk/tachyonworker/2147483660 is not on local disk.
13/07/27 21:32:07 INFO : Try to find and read from remote workers.
13/07/27 21:32:07 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:32:07 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483660 was created!
13/07/27 21:32:07 INFO local.LocalScheduler: Finished 11
13/07/27 21:32:07 INFO scheduler.DAGScheduler: Completed ResultTask(0, 11)
13/07/27 21:32:07 INFO local.LocalTaskSetManager: Size of task 12 is 1499 bytes
13/07/27 21:32:07 INFO local.LocalScheduler: Running 12
13/07/27 21:32:07 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:32:08 INFO : /mnt/ramdisk/tachyonworker/2147483661 is not on local disk.
13/07/27 21:32:08 INFO : Try to find and read from remote workers.
13/07/27 21:32:08 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:32:08 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483661 was created!
13/07/27 21:32:08 INFO local.LocalScheduler: Finished 12
13/07/27 21:32:08 INFO scheduler.DAGScheduler: Completed ResultTask(0, 12)
13/07/27 21:32:08 INFO local.LocalTaskSetManager: Size of task 13 is 1499 bytes
13/07/27 21:32:08 INFO local.LocalScheduler: Running 13
13/07/27 21:32:08 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:32:09 INFO : /mnt/ramdisk/tachyonworker/2147483662 is not on local disk.
13/07/27 21:32:09 INFO : Try to find and read from remote workers.
13/07/27 21:32:09 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:32:09 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483662 was created!
13/07/27 21:32:09 INFO local.LocalScheduler: Finished 13
13/07/27 21:32:09 INFO scheduler.DAGScheduler: Completed ResultTask(0, 13)
13/07/27 21:32:09 INFO local.LocalTaskSetManager: Size of task 14 is 1499 bytes
13/07/27 21:32:09 INFO local.LocalScheduler: Running 14
13/07/27 21:32:09 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:32:09 INFO : /mnt/ramdisk/tachyonworker/2147483663 is not on local disk.
13/07/27 21:32:09 INFO : Try to find and read from remote workers.
13/07/27 21:32:09 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:32:09 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483663 was created!
13/07/27 21:32:09 INFO local.LocalScheduler: Finished 14
13/07/27 21:32:09 INFO scheduler.DAGScheduler: Completed ResultTask(0, 14)
13/07/27 21:32:09 INFO local.LocalTaskSetManager: Size of task 15 is 1499 bytes
13/07/27 21:32:09 INFO local.LocalScheduler: Running 15
13/07/27 21:32:09 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:32:10 INFO : /mnt/ramdisk/tachyonworker/2147483664 is not on local disk.
13/07/27 21:32:10 INFO : Try to find and read from remote workers.
13/07/27 21:32:10 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:32:10 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483664 was created!
13/07/27 21:32:10 INFO local.LocalScheduler: Finished 15
13/07/27 21:32:10 INFO scheduler.DAGScheduler: Completed ResultTask(0, 15)
13/07/27 21:32:10 INFO local.LocalTaskSetManager: Size of task 16 is 1499 bytes
13/07/27 21:32:10 INFO local.LocalScheduler: Running 16
13/07/27 21:32:10 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:32:10 INFO : /mnt/ramdisk/tachyonworker/2147483665 is not on local disk.
13/07/27 21:32:10 INFO : Try to find and read from remote workers.
13/07/27 21:32:10 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:32:10 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483665 was created!
13/07/27 21:32:11 INFO local.LocalScheduler: Finished 16
13/07/27 21:32:11 INFO scheduler.DAGScheduler: Completed ResultTask(0, 16)
13/07/27 21:32:11 INFO local.LocalTaskSetManager: Size of task 17 is 1499 bytes
13/07/27 21:32:11 INFO local.LocalScheduler: Running 17
13/07/27 21:32:11 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:32:11 INFO : /mnt/ramdisk/tachyonworker/2147483666 is not on local disk.
13/07/27 21:32:11 INFO : Try to find and read from remote workers.
13/07/27 21:32:11 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:32:11 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483666 was created!
13/07/27 21:32:11 INFO local.LocalScheduler: Finished 17
13/07/27 21:32:11 INFO scheduler.DAGScheduler: Completed ResultTask(0, 17)
13/07/27 21:32:11 INFO local.LocalTaskSetManager: Size of task 18 is 1499 bytes
13/07/27 21:32:11 INFO local.LocalScheduler: Running 18
13/07/27 21:32:11 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:32:11 INFO local.LocalScheduler: Finished 18
13/07/27 21:32:11 INFO scheduler.DAGScheduler: Completed ResultTask(0, 18)
13/07/27 21:32:11 INFO local.LocalScheduler: Remove TaskSet 0.0 from pool 
13/07/27 21:32:11 INFO scheduler.DAGScheduler: Stage 0 (count at <console>:15) finished in 11.678 s
13/07/27 21:32:11 INFO spark.SparkContext: Job finished: count at <console>:15, took 11.730850137 s
res0: Long = 500094

scala> 13/07/27 21:32:11 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:32:11 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:32:11 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:32:11 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:32:11 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:32:11 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:32:11 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:32:11 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage/rdd,null}
Killed 1 processes
Killed 1 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting Tachyon @ tachyon-ec2-0
2013-07-27 21:32:13,329 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data
2013-07-27 21:32:13,333 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_log.data
2013-07-27 21:32:13,821 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/data
2013-07-27 21:32:13,833 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/workers

run1 #: 9

restaring tachyon
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Killed 0 processes
Killed 0 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting RamFS: /mnt/ramdisk
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata -Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Starting master @ tachyon-ec2-0
Starting worker @ tachyon-ec2-0

spark-shell count
5878 tachyon.Master
5905 tachyon.Worker

Going to fadvise /mnt/tachyon/hit_data.tsv.1 as mode POSIX_FADV_DONTNEED
offset: 0
length: 525
mode: POSIX_FADV_DONTNEED
WIN
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/ubuntu/work/tachyon/target/tachyon-0.3.0-SNAPSHOT-jar-with-dependencies.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/ubuntu/work/spark/lib_managed/jars/slf4j-log4j12-1.7.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
Welcome to
      ____              __  
     / __/__  ___ _____/ /__
    _\ \/ _ \/ _ `/ __/  '_/
   /___/ .__/\_,_/_/ /_/\_\   version 0.8.0
      /_/                  

Using Scala version 2.9.3 (OpenJDK 64-Bit Server VM, Java 1.7.0_25)
Initializing interpreter...
13/07/27 21:32:20 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:32:20 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:56781
Creating SparkContext...
13/07/27 21:32:29 INFO slf4j.Slf4jEventHandler: Slf4jEventHandler started
13/07/27 21:32:29 INFO spark.SparkEnv: Registering BlockManagerMaster
13/07/27 21:32:29 INFO storage.MemoryStore: MemoryStore started with capacity 1295.4 MB.
13/07/27 21:32:29 INFO storage.DiskStore: Created local directory at /tmp/spark-local-20130727213229-4a6a
13/07/27 21:32:29 INFO network.ConnectionManager: Bound socket to port 47275 with id = ConnectionManagerId(tachyon-ec2-0,47275)
13/07/27 21:32:29 INFO storage.BlockManagerMaster: Trying to register BlockManager
13/07/27 21:32:29 INFO storage.BlockManagerMasterActor$BlockManagerInfo: Registering block manager tachyon-ec2-0:47275 with 1295.4 MB RAM
13/07/27 21:32:29 INFO storage.BlockManagerMaster: Registered BlockManager
13/07/27 21:32:29 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:32:29 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:54748
13/07/27 21:32:29 INFO broadcast.HttpBroadcast: Broadcast server started at http://10.151.80.188:54748
13/07/27 21:32:29 INFO spark.SparkEnv: Registering MapOutputTracker
13/07/27 21:32:29 INFO spark.HttpFileServer: HTTP File server directory is /tmp/spark-ab1c40a1-d729-4e4c-8fd9-c994b37a9783
13/07/27 21:32:29 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:32:29 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:45138
13/07/27 21:32:29 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:32:29 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage/rdd,null}
13/07/27 21:32:29 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:32:29 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:32:29 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:32:29 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:32:29 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:32:29 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:32:29 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:32:29 INFO server.AbstractConnector: Started SelectChannelConnector@0.0.0.0:33000
13/07/27 21:32:29 INFO ui.SparkUI: Started Spark Web UI at http://tachyon-ec2-0:33000
Spark context available as sc.
Type in expressions to have them evaluated.
Type :help for more information.

scala> val s = sc.textFile("tachyon://tachyon-ec2-0:19998/hit_data.tsv.1")
13/07/27 21:32:31 INFO storage.MemoryStore: ensureFreeSpace(58415) called with curMem=0, maxMem=1358297825
13/07/27 21:32:31 INFO storage.MemoryStore: Block broadcast_0 stored as values to memory (estimated size 57.0 KB, free 1295.3 MB)
s: spark.RDD[String] = MappedRDD[1] at textFile at <console>:12

scala> s.count()
13/07/27 21:32:31 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
13/07/27 21:32:31 WARN snappy.LoadSnappy: Snappy native library not loaded
13/07/27 21:32:31 INFO : initialize(tachyon://tachyon-ec2-0:19998/hit_data.tsv.1, Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml). Connecting to Tachyon: tachyon://tachyon-ec2-0:19998/hit_data.tsv.1
13/07/27 21:32:31 INFO : Trying to connect master @ tachyon-ec2-0/10.151.80.188:19998
13/07/27 21:32:31 INFO : User registered at the master tachyon-ec2-0/10.151.80.188:19998 got UserId 1
13/07/27 21:32:31 INFO : Trying to get local worker host : tachyon-ec2-0
13/07/27 21:32:31 INFO : Connecting local worker @ tachyon-ec2-0/10.151.80.188:29998
13/07/27 21:32:31 INFO : tachyon://tachyon-ec2-0:19998 tachyon://tachyon-ec2-0:19998 file:///mnt/tachyon
13/07/27 21:32:31 INFO : getFileStatus(/hit_data.tsv.1): HDFS Path: file:/mnt/tachyon/hit_data.tsv.1 TPath: tachyon://tachyon-ec2-0:19998/hit_data.tsv.1
13/07/27 21:32:31 INFO : tachyon.client.TachyonFS@29cc3776 file:///mnt/tachyon /hit_data.tsv.1 tachyon.PrefixList@1e4d396a
13/07/27 21:32:31 INFO : Create tachyon file /hit_data.tsv.1 with file id 2 and checkpoint location file:///mnt/tachyon/hit_data.tsv.1
13/07/27 21:32:32 INFO mapred.FileInputFormat: Total input paths to process : 1
13/07/27 21:32:32 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:32:32 INFO scheduler.DAGScheduler: Got job 0 (count at <console>:15) with 1 output partitions (allowLocal=false)
13/07/27 21:32:32 INFO scheduler.DAGScheduler: Final stage: Stage 0 (count at <console>:15)
13/07/27 21:32:32 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:32:32 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:32:32 INFO scheduler.DAGScheduler: Submitting Stage 0 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:32:32 INFO scheduler.DAGScheduler: Submitting 1 missing tasks from Stage 0 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:32:32 INFO local.LocalTaskSetManager: Size of task 0 is 1494 bytes
13/07/27 21:32:32 INFO local.LocalScheduler: Running 0
13/07/27 21:32:32 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.1, 65536)
13/07/27 21:32:32 INFO : /mnt/ramdisk/tachyonworker/2147483648 is not on local disk.
13/07/27 21:32:32 INFO : Try to find and read from remote workers.
13/07/27 21:32:32 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:32:32 INFO : Folder /mnt/ramdisk/tachyonworker/users/1 was created!
13/07/27 21:32:32 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483648 was created!
13/07/27 21:32:32 INFO local.LocalScheduler: Finished 0
13/07/27 21:32:32 INFO local.LocalScheduler: Remove TaskSet 0.0 from pool 
13/07/27 21:32:32 INFO scheduler.DAGScheduler: Completed ResultTask(0, 0)
13/07/27 21:32:32 INFO scheduler.DAGScheduler: Stage 0 (count at <console>:15) finished in 0.368 s
13/07/27 21:32:32 INFO spark.SparkContext: Job finished: count at <console>:15, took 0.414620154 s
res0: Long = 1

scala> 13/07/27 21:32:32 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:32:32 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:32:32 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:32:32 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:32:32 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:32:32 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:32:32 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:32:32 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage/rdd,null}
Killed 1 processes
Killed 1 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting Tachyon @ tachyon-ec2-0
2013-07-27 21:32:34,191 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data
2013-07-27 21:32:34,195 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_log.data
2013-07-27 21:32:34,683 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/data
2013-07-27 21:32:34,695 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/workers

restaring tachyon
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Killed 0 processes
Killed 0 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting RamFS: /mnt/ramdisk
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata -Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Starting master @ tachyon-ec2-0
Starting worker @ tachyon-ec2-0

spark-shell count
6434 tachyon.Master
6461 tachyon.Worker

Going to fadvise /mnt/tachyon/hit_data.tsv.100 as mode POSIX_FADV_DONTNEED
offset: 0
length: 55735
mode: POSIX_FADV_DONTNEED
WIN
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/ubuntu/work/tachyon/target/tachyon-0.3.0-SNAPSHOT-jar-with-dependencies.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/ubuntu/work/spark/lib_managed/jars/slf4j-log4j12-1.7.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
Welcome to
      ____              __  
     / __/__  ___ _____/ /__
    _\ \/ _ \/ _ `/ __/  '_/
   /___/ .__/\_,_/_/ /_/\_\   version 0.8.0
      /_/                  

Using Scala version 2.9.3 (OpenJDK 64-Bit Server VM, Java 1.7.0_25)
Initializing interpreter...
13/07/27 21:32:40 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:32:40 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:34387
Creating SparkContext...
13/07/27 21:32:50 INFO slf4j.Slf4jEventHandler: Slf4jEventHandler started
13/07/27 21:32:50 INFO spark.SparkEnv: Registering BlockManagerMaster
13/07/27 21:32:50 INFO storage.MemoryStore: MemoryStore started with capacity 1295.4 MB.
13/07/27 21:32:50 INFO storage.DiskStore: Created local directory at /tmp/spark-local-20130727213250-117e
13/07/27 21:32:50 INFO network.ConnectionManager: Bound socket to port 58911 with id = ConnectionManagerId(tachyon-ec2-0,58911)
13/07/27 21:32:50 INFO storage.BlockManagerMaster: Trying to register BlockManager
13/07/27 21:32:50 INFO storage.BlockManagerMasterActor$BlockManagerInfo: Registering block manager tachyon-ec2-0:58911 with 1295.4 MB RAM
13/07/27 21:32:50 INFO storage.BlockManagerMaster: Registered BlockManager
13/07/27 21:32:50 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:32:50 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:57298
13/07/27 21:32:50 INFO broadcast.HttpBroadcast: Broadcast server started at http://10.151.80.188:57298
13/07/27 21:32:50 INFO spark.SparkEnv: Registering MapOutputTracker
13/07/27 21:32:50 INFO spark.HttpFileServer: HTTP File server directory is /tmp/spark-a5f6a68c-6aaa-4efb-a45f-9ffa9b3260e5
13/07/27 21:32:50 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:32:50 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:54880
13/07/27 21:32:50 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:32:50 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage/rdd,null}
13/07/27 21:32:50 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:32:50 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:32:50 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:32:50 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:32:50 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:32:50 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:32:50 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:32:50 INFO server.AbstractConnector: Started SelectChannelConnector@0.0.0.0:33000
13/07/27 21:32:50 INFO ui.SparkUI: Started Spark Web UI at http://tachyon-ec2-0:33000
Spark context available as sc.
Type in expressions to have them evaluated.
Type :help for more information.

scala> val s = sc.textFile("tachyon://tachyon-ec2-0:19998/hit_data.tsv.100")
13/07/27 21:32:51 INFO storage.MemoryStore: ensureFreeSpace(58423) called with curMem=0, maxMem=1358297825
13/07/27 21:32:51 INFO storage.MemoryStore: Block broadcast_0 stored as values to memory (estimated size 57.1 KB, free 1295.3 MB)
s: spark.RDD[String] = MappedRDD[1] at textFile at <console>:12

scala> s.count()
13/07/27 21:32:52 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
13/07/27 21:32:52 WARN snappy.LoadSnappy: Snappy native library not loaded
13/07/27 21:32:52 INFO : initialize(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100, Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml). Connecting to Tachyon: tachyon://tachyon-ec2-0:19998/hit_data.tsv.100
13/07/27 21:32:52 INFO : Trying to connect master @ tachyon-ec2-0/10.151.80.188:19998
13/07/27 21:32:52 INFO : User registered at the master tachyon-ec2-0/10.151.80.188:19998 got UserId 1
13/07/27 21:32:52 INFO : Trying to get local worker host : tachyon-ec2-0
13/07/27 21:32:52 INFO : Connecting local worker @ tachyon-ec2-0/10.151.80.188:29998
13/07/27 21:32:52 INFO : tachyon://tachyon-ec2-0:19998 tachyon://tachyon-ec2-0:19998 file:///mnt/tachyon
13/07/27 21:32:52 INFO : getFileStatus(/hit_data.tsv.100): HDFS Path: file:/mnt/tachyon/hit_data.tsv.100 TPath: tachyon://tachyon-ec2-0:19998/hit_data.tsv.100
13/07/27 21:32:52 INFO : tachyon.client.TachyonFS@5390cdba file:///mnt/tachyon /hit_data.tsv.100 tachyon.PrefixList@47b29932
13/07/27 21:32:52 INFO : Create tachyon file /hit_data.tsv.100 with file id 2 and checkpoint location file:///mnt/tachyon/hit_data.tsv.100
13/07/27 21:32:52 INFO mapred.FileInputFormat: Total input paths to process : 1
13/07/27 21:32:52 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:32:52 INFO scheduler.DAGScheduler: Got job 0 (count at <console>:15) with 1 output partitions (allowLocal=false)
13/07/27 21:32:52 INFO scheduler.DAGScheduler: Final stage: Stage 0 (count at <console>:15)
13/07/27 21:32:52 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:32:52 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:32:52 INFO scheduler.DAGScheduler: Submitting Stage 0 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:32:52 INFO scheduler.DAGScheduler: Submitting 1 missing tasks from Stage 0 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:32:52 INFO local.LocalTaskSetManager: Size of task 0 is 1496 bytes
13/07/27 21:32:52 INFO local.LocalScheduler: Running 0
13/07/27 21:32:53 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100, 65536)
13/07/27 21:32:53 INFO : /mnt/ramdisk/tachyonworker/2147483648 is not on local disk.
13/07/27 21:32:53 INFO : Try to find and read from remote workers.
13/07/27 21:32:53 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:32:53 INFO : Folder /mnt/ramdisk/tachyonworker/users/1 was created!
13/07/27 21:32:53 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483648 was created!
13/07/27 21:32:53 INFO local.LocalScheduler: Finished 0
13/07/27 21:32:53 INFO local.LocalScheduler: Remove TaskSet 0.0 from pool 
13/07/27 21:32:53 INFO scheduler.DAGScheduler: Completed ResultTask(0, 0)
13/07/27 21:32:53 INFO scheduler.DAGScheduler: Stage 0 (count at <console>:15) finished in 0.387 s
13/07/27 21:32:53 INFO spark.SparkContext: Job finished: count at <console>:15, took 0.430234626 s
res0: Long = 100

scala> 13/07/27 21:32:53 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:32:53 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:32:53 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:32:53 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:32:53 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:32:53 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:32:53 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:32:53 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage/rdd,null}
Killed 1 processes
Killed 1 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting Tachyon @ tachyon-ec2-0
2013-07-27 21:32:55,003 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data
2013-07-27 21:32:55,007 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_log.data
2013-07-27 21:32:55,499 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/data
2013-07-27 21:32:55,510 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/workers

restaring tachyon
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Killed 0 processes
Killed 0 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting RamFS: /mnt/ramdisk
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata -Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Starting master @ tachyon-ec2-0
Starting worker @ tachyon-ec2-0

spark-shell count
6990 tachyon.Master
7017 tachyon.Worker

Going to fadvise /mnt/tachyon/hit_data.tsv.1000 as mode POSIX_FADV_DONTNEED
offset: 0
length: 776400
mode: POSIX_FADV_DONTNEED
WIN
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/ubuntu/work/tachyon/target/tachyon-0.3.0-SNAPSHOT-jar-with-dependencies.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/ubuntu/work/spark/lib_managed/jars/slf4j-log4j12-1.7.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
Welcome to
      ____              __  
     / __/__  ___ _____/ /__
    _\ \/ _ \/ _ `/ __/  '_/
   /___/ .__/\_,_/_/ /_/\_\   version 0.8.0
      /_/                  

Using Scala version 2.9.3 (OpenJDK 64-Bit Server VM, Java 1.7.0_25)
Initializing interpreter...
13/07/27 21:33:01 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:33:01 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:55340
Creating SparkContext...
13/07/27 21:33:10 INFO slf4j.Slf4jEventHandler: Slf4jEventHandler started
13/07/27 21:33:11 INFO spark.SparkEnv: Registering BlockManagerMaster
13/07/27 21:33:11 INFO storage.MemoryStore: MemoryStore started with capacity 1295.4 MB.
13/07/27 21:33:11 INFO storage.DiskStore: Created local directory at /tmp/spark-local-20130727213311-1470
13/07/27 21:33:11 INFO network.ConnectionManager: Bound socket to port 37277 with id = ConnectionManagerId(tachyon-ec2-0,37277)
13/07/27 21:33:11 INFO storage.BlockManagerMaster: Trying to register BlockManager
13/07/27 21:33:11 INFO storage.BlockManagerMasterActor$BlockManagerInfo: Registering block manager tachyon-ec2-0:37277 with 1295.4 MB RAM
13/07/27 21:33:11 INFO storage.BlockManagerMaster: Registered BlockManager
13/07/27 21:33:11 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:33:11 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:60553
13/07/27 21:33:11 INFO broadcast.HttpBroadcast: Broadcast server started at http://10.151.80.188:60553
13/07/27 21:33:11 INFO spark.SparkEnv: Registering MapOutputTracker
13/07/27 21:33:11 INFO spark.HttpFileServer: HTTP File server directory is /tmp/spark-09de4e4e-b503-4acd-8b62-9d758ff24fa5
13/07/27 21:33:11 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:33:11 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:45121
13/07/27 21:33:11 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:33:11 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage/rdd,null}
13/07/27 21:33:11 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:33:11 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:33:11 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:33:11 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:33:11 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:33:11 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:33:11 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:33:11 INFO server.AbstractConnector: Started SelectChannelConnector@0.0.0.0:33000
13/07/27 21:33:11 INFO ui.SparkUI: Started Spark Web UI at http://tachyon-ec2-0:33000
Spark context available as sc.
Type in expressions to have them evaluated.
Type :help for more information.

scala> val s = sc.textFile("tachyon://tachyon-ec2-0:19998/hit_data.tsv.1000")
13/07/27 21:33:12 INFO storage.MemoryStore: ensureFreeSpace(58423) called with curMem=0, maxMem=1358297825
13/07/27 21:33:12 INFO storage.MemoryStore: Block broadcast_0 stored as values to memory (estimated size 57.1 KB, free 1295.3 MB)
s: spark.RDD[String] = MappedRDD[1] at textFile at <console>:12

scala> s.count()
13/07/27 21:33:12 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
13/07/27 21:33:12 WARN snappy.LoadSnappy: Snappy native library not loaded
13/07/27 21:33:12 INFO : initialize(tachyon://tachyon-ec2-0:19998/hit_data.tsv.1000, Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml). Connecting to Tachyon: tachyon://tachyon-ec2-0:19998/hit_data.tsv.1000
13/07/27 21:33:12 INFO : Trying to connect master @ tachyon-ec2-0/10.151.80.188:19998
13/07/27 21:33:13 INFO : User registered at the master tachyon-ec2-0/10.151.80.188:19998 got UserId 1
13/07/27 21:33:13 INFO : Trying to get local worker host : tachyon-ec2-0
13/07/27 21:33:13 INFO : Connecting local worker @ tachyon-ec2-0/10.151.80.188:29998
13/07/27 21:33:13 INFO : tachyon://tachyon-ec2-0:19998 tachyon://tachyon-ec2-0:19998 file:///mnt/tachyon
13/07/27 21:33:13 INFO : getFileStatus(/hit_data.tsv.1000): HDFS Path: file:/mnt/tachyon/hit_data.tsv.1000 TPath: tachyon://tachyon-ec2-0:19998/hit_data.tsv.1000
13/07/27 21:33:13 INFO : tachyon.client.TachyonFS@91c5876 file:///mnt/tachyon /hit_data.tsv.1000 tachyon.PrefixList@23f3afa6
13/07/27 21:33:13 INFO : Create tachyon file /hit_data.tsv.1000 with file id 2 and checkpoint location file:///mnt/tachyon/hit_data.tsv.1000
13/07/27 21:33:13 INFO mapred.FileInputFormat: Total input paths to process : 1
13/07/27 21:33:13 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:33:13 INFO scheduler.DAGScheduler: Got job 0 (count at <console>:15) with 1 output partitions (allowLocal=false)
13/07/27 21:33:13 INFO scheduler.DAGScheduler: Final stage: Stage 0 (count at <console>:15)
13/07/27 21:33:13 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:33:13 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:33:13 INFO scheduler.DAGScheduler: Submitting Stage 0 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:33:13 INFO scheduler.DAGScheduler: Submitting 1 missing tasks from Stage 0 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:33:13 INFO local.LocalTaskSetManager: Size of task 0 is 1497 bytes
13/07/27 21:33:13 INFO local.LocalScheduler: Running 0
13/07/27 21:33:13 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.1000, 65536)
13/07/27 21:33:13 INFO : /mnt/ramdisk/tachyonworker/2147483648 is not on local disk.
13/07/27 21:33:13 INFO : Try to find and read from remote workers.
13/07/27 21:33:13 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:33:13 INFO : Folder /mnt/ramdisk/tachyonworker/users/1 was created!
13/07/27 21:33:13 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483648 was created!
13/07/27 21:33:14 INFO local.LocalScheduler: Finished 0
13/07/27 21:33:14 INFO local.LocalScheduler: Remove TaskSet 0.0 from pool 
13/07/27 21:33:14 INFO scheduler.DAGScheduler: Completed ResultTask(0, 0)
13/07/27 21:33:14 INFO scheduler.DAGScheduler: Stage 0 (count at <console>:15) finished in 0.425 s
13/07/27 21:33:14 INFO spark.SparkContext: Job finished: count at <console>:15, took 0.469637454 s
res0: Long = 1000

scala> 13/07/27 21:33:14 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:33:14 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:33:14 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:33:14 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:33:14 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:33:14 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:33:14 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:33:14 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage/rdd,null}
Killed 1 processes
Killed 1 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting Tachyon @ tachyon-ec2-0
2013-07-27 21:33:15,784 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data
2013-07-27 21:33:15,787 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_log.data
2013-07-27 21:33:16,276 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/data
2013-07-27 21:33:16,287 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/workers

restaring tachyon
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Killed 0 processes
Killed 0 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting RamFS: /mnt/ramdisk
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata -Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Starting master @ tachyon-ec2-0
Starting worker @ tachyon-ec2-0

spark-shell count
7547 tachyon.Master
7574 tachyon.Worker

Going to fadvise /mnt/tachyon/hit_data.tsv.10000 as mode POSIX_FADV_DONTNEED
offset: 0
length: 12330369
mode: POSIX_FADV_DONTNEED
WIN
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/ubuntu/work/tachyon/target/tachyon-0.3.0-SNAPSHOT-jar-with-dependencies.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/ubuntu/work/spark/lib_managed/jars/slf4j-log4j12-1.7.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
Welcome to
      ____              __  
     / __/__  ___ _____/ /__
    _\ \/ _ \/ _ `/ __/  '_/
   /___/ .__/\_,_/_/ /_/\_\   version 0.8.0
      /_/                  

Using Scala version 2.9.3 (OpenJDK 64-Bit Server VM, Java 1.7.0_25)
Initializing interpreter...
13/07/27 21:33:22 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:33:22 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:55598
Creating SparkContext...
13/07/27 21:33:31 INFO slf4j.Slf4jEventHandler: Slf4jEventHandler started
13/07/27 21:33:31 INFO spark.SparkEnv: Registering BlockManagerMaster
13/07/27 21:33:32 INFO storage.MemoryStore: MemoryStore started with capacity 1295.4 MB.
13/07/27 21:33:32 INFO storage.DiskStore: Created local directory at /tmp/spark-local-20130727213332-f044
13/07/27 21:33:32 INFO network.ConnectionManager: Bound socket to port 50110 with id = ConnectionManagerId(tachyon-ec2-0,50110)
13/07/27 21:33:32 INFO storage.BlockManagerMaster: Trying to register BlockManager
13/07/27 21:33:32 INFO storage.BlockManagerMasterActor$BlockManagerInfo: Registering block manager tachyon-ec2-0:50110 with 1295.4 MB RAM
13/07/27 21:33:32 INFO storage.BlockManagerMaster: Registered BlockManager
13/07/27 21:33:32 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:33:32 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:44501
13/07/27 21:33:32 INFO broadcast.HttpBroadcast: Broadcast server started at http://10.151.80.188:44501
13/07/27 21:33:32 INFO spark.SparkEnv: Registering MapOutputTracker
13/07/27 21:33:32 INFO spark.HttpFileServer: HTTP File server directory is /tmp/spark-17e90af7-f6be-415e-bd95-b2fe813e5ea9
13/07/27 21:33:32 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:33:32 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:51838
13/07/27 21:33:32 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:33:32 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage/rdd,null}
13/07/27 21:33:32 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:33:32 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:33:32 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:33:32 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:33:32 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:33:32 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:33:32 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:33:32 INFO server.AbstractConnector: Started SelectChannelConnector@0.0.0.0:33000
13/07/27 21:33:32 INFO ui.SparkUI: Started Spark Web UI at http://tachyon-ec2-0:33000
Spark context available as sc.
Type in expressions to have them evaluated.
Type :help for more information.

scala> val s = sc.textFile("tachyon://tachyon-ec2-0:19998/hit_data.tsv.10000")
13/07/27 21:33:33 INFO storage.MemoryStore: ensureFreeSpace(58423) called with curMem=0, maxMem=1358297825
13/07/27 21:33:33 INFO storage.MemoryStore: Block broadcast_0 stored as values to memory (estimated size 57.1 KB, free 1295.3 MB)
s: spark.RDD[String] = MappedRDD[1] at textFile at <console>:12

scala> s.count()
13/07/27 21:33:33 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
13/07/27 21:33:33 WARN snappy.LoadSnappy: Snappy native library not loaded
13/07/27 21:33:33 INFO : initialize(tachyon://tachyon-ec2-0:19998/hit_data.tsv.10000, Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml). Connecting to Tachyon: tachyon://tachyon-ec2-0:19998/hit_data.tsv.10000
13/07/27 21:33:33 INFO : Trying to connect master @ tachyon-ec2-0/10.151.80.188:19998
13/07/27 21:33:33 INFO : User registered at the master tachyon-ec2-0/10.151.80.188:19998 got UserId 1
13/07/27 21:33:33 INFO : Trying to get local worker host : tachyon-ec2-0
13/07/27 21:33:33 INFO : Connecting local worker @ tachyon-ec2-0/10.151.80.188:29998
13/07/27 21:33:33 INFO : tachyon://tachyon-ec2-0:19998 tachyon://tachyon-ec2-0:19998 file:///mnt/tachyon
13/07/27 21:33:33 INFO : getFileStatus(/hit_data.tsv.10000): HDFS Path: file:/mnt/tachyon/hit_data.tsv.10000 TPath: tachyon://tachyon-ec2-0:19998/hit_data.tsv.10000
13/07/27 21:33:33 INFO : tachyon.client.TachyonFS@91c5876 file:///mnt/tachyon /hit_data.tsv.10000 tachyon.PrefixList@23f3afa6
13/07/27 21:33:34 INFO : Create tachyon file /hit_data.tsv.10000 with file id 2 and checkpoint location file:///mnt/tachyon/hit_data.tsv.10000
13/07/27 21:33:34 INFO mapred.FileInputFormat: Total input paths to process : 1
13/07/27 21:33:34 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:33:34 INFO scheduler.DAGScheduler: Got job 0 (count at <console>:15) with 1 output partitions (allowLocal=false)
13/07/27 21:33:34 INFO scheduler.DAGScheduler: Final stage: Stage 0 (count at <console>:15)
13/07/27 21:33:34 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:33:34 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:33:34 INFO scheduler.DAGScheduler: Submitting Stage 0 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:33:34 INFO scheduler.DAGScheduler: Submitting 1 missing tasks from Stage 0 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:33:34 INFO local.LocalTaskSetManager: Size of task 0 is 1498 bytes
13/07/27 21:33:34 INFO local.LocalScheduler: Running 0
13/07/27 21:33:34 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.10000, 65536)
13/07/27 21:33:34 INFO : /mnt/ramdisk/tachyonworker/2147483648 is not on local disk.
13/07/27 21:33:34 INFO : Try to find and read from remote workers.
13/07/27 21:33:34 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:33:34 INFO : Folder /mnt/ramdisk/tachyonworker/users/1 was created!
13/07/27 21:33:34 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483648 was created!
13/07/27 21:33:35 INFO local.LocalScheduler: Finished 0
13/07/27 21:33:35 INFO local.LocalScheduler: Remove TaskSet 0.0 from pool 
13/07/27 21:33:35 INFO scheduler.DAGScheduler: Completed ResultTask(0, 0)
13/07/27 21:33:35 INFO scheduler.DAGScheduler: Stage 0 (count at <console>:15) finished in 0.633 s
13/07/27 21:33:35 INFO spark.SparkContext: Job finished: count at <console>:15, took 0.677827744 s
res0: Long = 10000

scala> 13/07/27 21:33:35 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:33:35 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:33:35 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:33:35 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:33:35 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:33:35 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:33:35 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:33:35 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage/rdd,null}
Killed 1 processes
Killed 1 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting Tachyon @ tachyon-ec2-0
2013-07-27 21:33:36,883 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data
2013-07-27 21:33:36,886 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_log.data
2013-07-27 21:33:37,374 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/data
2013-07-27 21:33:37,386 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/workers

restaring tachyon
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Killed 0 processes
Killed 0 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting RamFS: /mnt/ramdisk
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata -Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Starting master @ tachyon-ec2-0
Starting worker @ tachyon-ec2-0

spark-shell count
8105 tachyon.Master
8132 tachyon.Worker

Going to fadvise /mnt/tachyon/hit_data.tsv.100000 as mode POSIX_FADV_DONTNEED
offset: 0
length: 125141299
mode: POSIX_FADV_DONTNEED
WIN
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/ubuntu/work/tachyon/target/tachyon-0.3.0-SNAPSHOT-jar-with-dependencies.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/ubuntu/work/spark/lib_managed/jars/slf4j-log4j12-1.7.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
Welcome to
      ____              __  
     / __/__  ___ _____/ /__
    _\ \/ _ \/ _ `/ __/  '_/
   /___/ .__/\_,_/_/ /_/\_\   version 0.8.0
      /_/                  

Using Scala version 2.9.3 (OpenJDK 64-Bit Server VM, Java 1.7.0_25)
Initializing interpreter...
13/07/27 21:33:43 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:33:43 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:50547
Creating SparkContext...
13/07/27 21:33:52 INFO slf4j.Slf4jEventHandler: Slf4jEventHandler started
13/07/27 21:33:53 INFO spark.SparkEnv: Registering BlockManagerMaster
13/07/27 21:33:53 INFO storage.MemoryStore: MemoryStore started with capacity 1295.4 MB.
13/07/27 21:33:53 INFO storage.DiskStore: Created local directory at /tmp/spark-local-20130727213353-4a93
13/07/27 21:33:53 INFO network.ConnectionManager: Bound socket to port 44910 with id = ConnectionManagerId(tachyon-ec2-0,44910)
13/07/27 21:33:53 INFO storage.BlockManagerMaster: Trying to register BlockManager
13/07/27 21:33:53 INFO storage.BlockManagerMasterActor$BlockManagerInfo: Registering block manager tachyon-ec2-0:44910 with 1295.4 MB RAM
13/07/27 21:33:53 INFO storage.BlockManagerMaster: Registered BlockManager
13/07/27 21:33:53 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:33:53 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:48116
13/07/27 21:33:53 INFO broadcast.HttpBroadcast: Broadcast server started at http://10.151.80.188:48116
13/07/27 21:33:53 INFO spark.SparkEnv: Registering MapOutputTracker
13/07/27 21:33:53 INFO spark.HttpFileServer: HTTP File server directory is /tmp/spark-8d307d8f-f3c5-439b-a476-ba7fa74f8902
13/07/27 21:33:53 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:33:53 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:57326
13/07/27 21:33:53 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:33:53 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage/rdd,null}
13/07/27 21:33:53 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:33:53 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:33:53 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:33:53 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:33:53 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:33:53 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:33:53 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:33:53 INFO server.AbstractConnector: Started SelectChannelConnector@0.0.0.0:33000
13/07/27 21:33:53 INFO ui.SparkUI: Started Spark Web UI at http://tachyon-ec2-0:33000
Spark context available as sc.
Type in expressions to have them evaluated.
Type :help for more information.

scala> val s = sc.textFile("tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000")
13/07/27 21:33:54 INFO storage.MemoryStore: ensureFreeSpace(58431) called with curMem=0, maxMem=1358297825
13/07/27 21:33:54 INFO storage.MemoryStore: Block broadcast_0 stored as values to memory (estimated size 57.1 KB, free 1295.3 MB)
s: spark.RDD[String] = MappedRDD[1] at textFile at <console>:12

scala> s.count()
13/07/27 21:33:54 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
13/07/27 21:33:54 WARN snappy.LoadSnappy: Snappy native library not loaded
13/07/27 21:33:54 INFO : initialize(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000, Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml). Connecting to Tachyon: tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000
13/07/27 21:33:55 INFO : Trying to connect master @ tachyon-ec2-0/10.151.80.188:19998
13/07/27 21:33:55 INFO : User registered at the master tachyon-ec2-0/10.151.80.188:19998 got UserId 1
13/07/27 21:33:55 INFO : Trying to get local worker host : tachyon-ec2-0
13/07/27 21:33:55 INFO : Connecting local worker @ tachyon-ec2-0/10.151.80.188:29998
13/07/27 21:33:55 INFO : tachyon://tachyon-ec2-0:19998 tachyon://tachyon-ec2-0:19998 file:///mnt/tachyon
13/07/27 21:33:55 INFO : getFileStatus(/hit_data.tsv.100000): HDFS Path: file:/mnt/tachyon/hit_data.tsv.100000 TPath: tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000
13/07/27 21:33:55 INFO : tachyon.client.TachyonFS@1cabf050 file:///mnt/tachyon /hit_data.tsv.100000 tachyon.PrefixList@5c2e22e4
13/07/27 21:33:55 INFO : Create tachyon file /hit_data.tsv.100000 with file id 2 and checkpoint location file:///mnt/tachyon/hit_data.tsv.100000
13/07/27 21:33:55 INFO mapred.FileInputFormat: Total input paths to process : 1
13/07/27 21:33:55 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:33:55 INFO scheduler.DAGScheduler: Got job 0 (count at <console>:15) with 4 output partitions (allowLocal=false)
13/07/27 21:33:55 INFO scheduler.DAGScheduler: Final stage: Stage 0 (count at <console>:15)
13/07/27 21:33:55 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:33:55 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:33:55 INFO scheduler.DAGScheduler: Submitting Stage 0 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:33:55 INFO scheduler.DAGScheduler: Submitting 4 missing tasks from Stage 0 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:33:55 INFO local.LocalTaskSetManager: Size of task 0 is 1499 bytes
13/07/27 21:33:55 INFO local.LocalScheduler: Running 0
13/07/27 21:33:55 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000, 65536)
13/07/27 21:33:55 INFO : /mnt/ramdisk/tachyonworker/2147483648 is not on local disk.
13/07/27 21:33:55 INFO : Try to find and read from remote workers.
13/07/27 21:33:55 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:33:56 INFO : Folder /mnt/ramdisk/tachyonworker/users/1 was created!
13/07/27 21:33:56 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483648 was created!
13/07/27 21:33:56 INFO : /mnt/ramdisk/tachyonworker/2147483649 is not on local disk.
13/07/27 21:33:56 INFO : Try to find and read from remote workers.
13/07/27 21:33:56 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:33:56 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483649 was created!
13/07/27 21:33:57 INFO local.LocalScheduler: Finished 0
13/07/27 21:33:57 INFO local.LocalTaskSetManager: Size of task 1 is 1499 bytes
13/07/27 21:33:57 INFO local.LocalScheduler: Running 1
13/07/27 21:33:57 INFO scheduler.DAGScheduler: Completed ResultTask(0, 0)
13/07/27 21:33:57 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000, 65536)
13/07/27 21:33:57 INFO : /mnt/ramdisk/tachyonworker/2147483650 is not on local disk.
13/07/27 21:33:57 INFO : Try to find and read from remote workers.
13/07/27 21:33:57 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:33:57 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483650 was created!
13/07/27 21:33:57 INFO local.LocalScheduler: Finished 1
13/07/27 21:33:57 INFO scheduler.DAGScheduler: Completed ResultTask(0, 1)
13/07/27 21:33:57 INFO local.LocalTaskSetManager: Size of task 2 is 1499 bytes
13/07/27 21:33:57 INFO local.LocalScheduler: Running 2
13/07/27 21:33:57 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000, 65536)
13/07/27 21:33:58 INFO : /mnt/ramdisk/tachyonworker/2147483651 is not on local disk.
13/07/27 21:33:58 INFO : Try to find and read from remote workers.
13/07/27 21:33:58 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:33:58 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483651 was created!
13/07/27 21:33:58 INFO local.LocalScheduler: Finished 2
13/07/27 21:33:58 INFO scheduler.DAGScheduler: Completed ResultTask(0, 2)
13/07/27 21:33:58 INFO local.LocalTaskSetManager: Size of task 3 is 1499 bytes
13/07/27 21:33:58 INFO local.LocalScheduler: Running 3
13/07/27 21:33:58 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000, 65536)
13/07/27 21:33:58 INFO local.LocalScheduler: Finished 3
13/07/27 21:33:58 INFO scheduler.DAGScheduler: Completed ResultTask(0, 3)
13/07/27 21:33:58 INFO scheduler.DAGScheduler: Stage 0 (count at <console>:15) finished in 2.867 s
13/07/27 21:33:58 INFO local.LocalScheduler: Remove TaskSet 0.0 from pool 
13/07/27 21:33:58 INFO spark.SparkContext: Job finished: count at <console>:15, took 2.913004348 s
res0: Long = 100002

scala> 13/07/27 21:33:58 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:33:58 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:33:58 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:33:58 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:33:58 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:33:58 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:33:58 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:33:58 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage/rdd,null}
Killed 1 processes
Killed 1 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting Tachyon @ tachyon-ec2-0
2013-07-27 21:34:00,374 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data
2013-07-27 21:34:00,378 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_log.data
2013-07-27 21:34:00,870 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/data
2013-07-27 21:34:00,882 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/workers

restaring tachyon
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Killed 0 processes
Killed 0 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting RamFS: /mnt/ramdisk
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata -Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Starting master @ tachyon-ec2-0
Starting worker @ tachyon-ec2-0

spark-shell count
8739 tachyon.Master
8766 tachyon.Worker

Going to fadvise /mnt/tachyon/hit_data.tsv.500000 as mode POSIX_FADV_DONTNEED
offset: 0
length: 618418417
mode: POSIX_FADV_DONTNEED
WIN
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/ubuntu/work/tachyon/target/tachyon-0.3.0-SNAPSHOT-jar-with-dependencies.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/ubuntu/work/spark/lib_managed/jars/slf4j-log4j12-1.7.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
Welcome to
      ____              __  
     / __/__  ___ _____/ /__
    _\ \/ _ \/ _ `/ __/  '_/
   /___/ .__/\_,_/_/ /_/\_\   version 0.8.0
      /_/                  

Using Scala version 2.9.3 (OpenJDK 64-Bit Server VM, Java 1.7.0_25)
Initializing interpreter...
13/07/27 21:34:07 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:34:07 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:48273
Creating SparkContext...
13/07/27 21:34:16 INFO slf4j.Slf4jEventHandler: Slf4jEventHandler started
13/07/27 21:34:16 INFO spark.SparkEnv: Registering BlockManagerMaster
13/07/27 21:34:16 INFO storage.MemoryStore: MemoryStore started with capacity 1295.4 MB.
13/07/27 21:34:16 INFO storage.DiskStore: Created local directory at /tmp/spark-local-20130727213416-6007
13/07/27 21:34:16 INFO network.ConnectionManager: Bound socket to port 55093 with id = ConnectionManagerId(tachyon-ec2-0,55093)
13/07/27 21:34:16 INFO storage.BlockManagerMaster: Trying to register BlockManager
13/07/27 21:34:16 INFO storage.BlockManagerMasterActor$BlockManagerInfo: Registering block manager tachyon-ec2-0:55093 with 1295.4 MB RAM
13/07/27 21:34:16 INFO storage.BlockManagerMaster: Registered BlockManager
13/07/27 21:34:16 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:34:16 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:33938
13/07/27 21:34:16 INFO broadcast.HttpBroadcast: Broadcast server started at http://10.151.80.188:33938
13/07/27 21:34:16 INFO spark.SparkEnv: Registering MapOutputTracker
13/07/27 21:34:16 INFO spark.HttpFileServer: HTTP File server directory is /tmp/spark-e1faf4c7-3fa8-43f8-9386-132d6a2f9708
13/07/27 21:34:16 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:34:16 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:44393
13/07/27 21:34:16 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:34:16 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage/rdd,null}
13/07/27 21:34:16 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:34:16 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:34:16 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:34:16 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:34:16 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:34:16 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:34:16 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:34:16 INFO server.AbstractConnector: Started SelectChannelConnector@0.0.0.0:33000
13/07/27 21:34:16 INFO ui.SparkUI: Started Spark Web UI at http://tachyon-ec2-0:33000
Spark context available as sc.
Type in expressions to have them evaluated.
Type :help for more information.

scala> val s = sc.textFile("tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000")
13/07/27 21:34:18 INFO storage.MemoryStore: ensureFreeSpace(58431) called with curMem=0, maxMem=1358297825
13/07/27 21:34:18 INFO storage.MemoryStore: Block broadcast_0 stored as values to memory (estimated size 57.1 KB, free 1295.3 MB)
s: spark.RDD[String] = MappedRDD[1] at textFile at <console>:12

scala> s.count()
13/07/27 21:34:18 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
13/07/27 21:34:18 WARN snappy.LoadSnappy: Snappy native library not loaded
13/07/27 21:34:18 INFO : initialize(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml). Connecting to Tachyon: tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000
13/07/27 21:34:18 INFO : Trying to connect master @ tachyon-ec2-0/10.151.80.188:19998
13/07/27 21:34:18 INFO : User registered at the master tachyon-ec2-0/10.151.80.188:19998 got UserId 1
13/07/27 21:34:18 INFO : Trying to get local worker host : tachyon-ec2-0
13/07/27 21:34:18 INFO : Connecting local worker @ tachyon-ec2-0/10.151.80.188:29998
13/07/27 21:34:18 INFO : tachyon://tachyon-ec2-0:19998 tachyon://tachyon-ec2-0:19998 file:///mnt/tachyon
13/07/27 21:34:18 INFO : getFileStatus(/hit_data.tsv.500000): HDFS Path: file:/mnt/tachyon/hit_data.tsv.500000 TPath: tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000
13/07/27 21:34:18 INFO : tachyon.client.TachyonFS@2348717a file:///mnt/tachyon /hit_data.tsv.500000 tachyon.PrefixList@691212ae
13/07/27 21:34:19 INFO : Create tachyon file /hit_data.tsv.500000 with file id 2 and checkpoint location file:///mnt/tachyon/hit_data.tsv.500000
13/07/27 21:34:19 INFO mapred.FileInputFormat: Total input paths to process : 1
13/07/27 21:34:19 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:34:19 INFO scheduler.DAGScheduler: Got job 0 (count at <console>:15) with 19 output partitions (allowLocal=false)
13/07/27 21:34:19 INFO scheduler.DAGScheduler: Final stage: Stage 0 (count at <console>:15)
13/07/27 21:34:19 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:34:19 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:34:19 INFO scheduler.DAGScheduler: Submitting Stage 0 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:34:19 INFO scheduler.DAGScheduler: Submitting 19 missing tasks from Stage 0 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:34:19 INFO local.LocalTaskSetManager: Size of task 0 is 1499 bytes
13/07/27 21:34:19 INFO local.LocalScheduler: Running 0
13/07/27 21:34:19 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:34:19 INFO : /mnt/ramdisk/tachyonworker/2147483648 is not on local disk.
13/07/27 21:34:19 INFO : Try to find and read from remote workers.
13/07/27 21:34:19 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:34:19 INFO : Folder /mnt/ramdisk/tachyonworker/users/1 was created!
13/07/27 21:34:19 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483648 was created!
13/07/27 21:34:20 INFO : /mnt/ramdisk/tachyonworker/2147483649 is not on local disk.
13/07/27 21:34:20 INFO : Try to find and read from remote workers.
13/07/27 21:34:20 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:34:20 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483649 was created!
13/07/27 21:34:20 INFO local.LocalScheduler: Finished 0
13/07/27 21:34:20 INFO local.LocalTaskSetManager: Size of task 1 is 1499 bytes
13/07/27 21:34:20 INFO local.LocalScheduler: Running 1
13/07/27 21:34:20 INFO scheduler.DAGScheduler: Completed ResultTask(0, 0)
13/07/27 21:34:20 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:34:21 INFO : /mnt/ramdisk/tachyonworker/2147483650 is not on local disk.
13/07/27 21:34:21 INFO : Try to find and read from remote workers.
13/07/27 21:34:21 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:34:21 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483650 was created!
13/07/27 21:34:21 INFO local.LocalScheduler: Finished 1
13/07/27 21:34:21 INFO scheduler.DAGScheduler: Completed ResultTask(0, 1)
13/07/27 21:34:21 INFO local.LocalTaskSetManager: Size of task 2 is 1499 bytes
13/07/27 21:34:21 INFO local.LocalScheduler: Running 2
13/07/27 21:34:22 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:34:22 INFO : /mnt/ramdisk/tachyonworker/2147483651 is not on local disk.
13/07/27 21:34:22 INFO : Try to find and read from remote workers.
13/07/27 21:34:22 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:34:22 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483651 was created!
13/07/27 21:34:23 INFO local.LocalScheduler: Finished 2
13/07/27 21:34:23 INFO scheduler.DAGScheduler: Completed ResultTask(0, 2)
13/07/27 21:34:23 INFO local.LocalTaskSetManager: Size of task 3 is 1499 bytes
13/07/27 21:34:23 INFO local.LocalScheduler: Running 3
13/07/27 21:34:23 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:34:23 INFO : /mnt/ramdisk/tachyonworker/2147483652 is not on local disk.
13/07/27 21:34:23 INFO : Try to find and read from remote workers.
13/07/27 21:34:23 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:34:23 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483652 was created!
13/07/27 21:34:23 INFO local.LocalScheduler: Finished 3
13/07/27 21:34:23 INFO scheduler.DAGScheduler: Completed ResultTask(0, 3)
13/07/27 21:34:23 INFO local.LocalTaskSetManager: Size of task 4 is 1499 bytes
13/07/27 21:34:23 INFO local.LocalScheduler: Running 4
13/07/27 21:34:23 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:34:24 INFO : /mnt/ramdisk/tachyonworker/2147483653 is not on local disk.
13/07/27 21:34:24 INFO : Try to find and read from remote workers.
13/07/27 21:34:24 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:34:24 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483653 was created!
13/07/27 21:34:24 INFO local.LocalScheduler: Finished 4
13/07/27 21:34:24 INFO scheduler.DAGScheduler: Completed ResultTask(0, 4)
13/07/27 21:34:24 INFO local.LocalTaskSetManager: Size of task 5 is 1499 bytes
13/07/27 21:34:24 INFO local.LocalScheduler: Running 5
13/07/27 21:34:24 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:34:24 INFO : /mnt/ramdisk/tachyonworker/2147483654 is not on local disk.
13/07/27 21:34:24 INFO : Try to find and read from remote workers.
13/07/27 21:34:24 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:34:24 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483654 was created!
13/07/27 21:34:25 INFO local.LocalScheduler: Finished 5
13/07/27 21:34:25 INFO scheduler.DAGScheduler: Completed ResultTask(0, 5)
13/07/27 21:34:25 INFO local.LocalTaskSetManager: Size of task 6 is 1499 bytes
13/07/27 21:34:25 INFO local.LocalScheduler: Running 6
13/07/27 21:34:25 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:34:25 INFO : /mnt/ramdisk/tachyonworker/2147483655 is not on local disk.
13/07/27 21:34:25 INFO : Try to find and read from remote workers.
13/07/27 21:34:25 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:34:25 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483655 was created!
13/07/27 21:34:25 INFO local.LocalScheduler: Finished 6
13/07/27 21:34:25 INFO scheduler.DAGScheduler: Completed ResultTask(0, 6)
13/07/27 21:34:25 INFO local.LocalTaskSetManager: Size of task 7 is 1499 bytes
13/07/27 21:34:25 INFO local.LocalScheduler: Running 7
13/07/27 21:34:25 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:34:25 INFO : /mnt/ramdisk/tachyonworker/2147483656 is not on local disk.
13/07/27 21:34:25 INFO : Try to find and read from remote workers.
13/07/27 21:34:25 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:34:25 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483656 was created!
13/07/27 21:34:26 INFO local.LocalScheduler: Finished 7
13/07/27 21:34:26 INFO scheduler.DAGScheduler: Completed ResultTask(0, 7)
13/07/27 21:34:26 INFO local.LocalTaskSetManager: Size of task 8 is 1499 bytes
13/07/27 21:34:26 INFO local.LocalScheduler: Running 8
13/07/27 21:34:26 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:34:26 INFO : /mnt/ramdisk/tachyonworker/2147483657 is not on local disk.
13/07/27 21:34:26 INFO : Try to find and read from remote workers.
13/07/27 21:34:26 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:34:26 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483657 was created!
13/07/27 21:34:26 INFO local.LocalScheduler: Finished 8
13/07/27 21:34:26 INFO scheduler.DAGScheduler: Completed ResultTask(0, 8)
13/07/27 21:34:26 INFO local.LocalTaskSetManager: Size of task 9 is 1499 bytes
13/07/27 21:34:26 INFO local.LocalScheduler: Running 9
13/07/27 21:34:26 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:34:27 INFO : /mnt/ramdisk/tachyonworker/2147483658 is not on local disk.
13/07/27 21:34:27 INFO : Try to find and read from remote workers.
13/07/27 21:34:27 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:34:27 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483658 was created!
13/07/27 21:34:27 INFO local.LocalScheduler: Finished 9
13/07/27 21:34:27 INFO scheduler.DAGScheduler: Completed ResultTask(0, 9)
13/07/27 21:34:27 INFO local.LocalTaskSetManager: Size of task 10 is 1499 bytes
13/07/27 21:34:27 INFO local.LocalScheduler: Running 10
13/07/27 21:34:27 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:34:27 INFO : /mnt/ramdisk/tachyonworker/2147483659 is not on local disk.
13/07/27 21:34:27 INFO : Try to find and read from remote workers.
13/07/27 21:34:27 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:34:27 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483659 was created!
13/07/27 21:34:27 INFO local.LocalScheduler: Finished 10
13/07/27 21:34:27 INFO scheduler.DAGScheduler: Completed ResultTask(0, 10)
13/07/27 21:34:27 INFO local.LocalTaskSetManager: Size of task 11 is 1499 bytes
13/07/27 21:34:27 INFO local.LocalScheduler: Running 11
13/07/27 21:34:27 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:34:28 INFO : /mnt/ramdisk/tachyonworker/2147483660 is not on local disk.
13/07/27 21:34:28 INFO : Try to find and read from remote workers.
13/07/27 21:34:28 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:34:28 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483660 was created!
13/07/27 21:34:28 INFO local.LocalScheduler: Finished 11
13/07/27 21:34:28 INFO scheduler.DAGScheduler: Completed ResultTask(0, 11)
13/07/27 21:34:28 INFO local.LocalTaskSetManager: Size of task 12 is 1499 bytes
13/07/27 21:34:28 INFO local.LocalScheduler: Running 12
13/07/27 21:34:28 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:34:28 INFO : /mnt/ramdisk/tachyonworker/2147483661 is not on local disk.
13/07/27 21:34:28 INFO : Try to find and read from remote workers.
13/07/27 21:34:28 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:34:28 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483661 was created!
13/07/27 21:34:29 INFO local.LocalScheduler: Finished 12
13/07/27 21:34:29 INFO scheduler.DAGScheduler: Completed ResultTask(0, 12)
13/07/27 21:34:29 INFO local.LocalTaskSetManager: Size of task 13 is 1499 bytes
13/07/27 21:34:29 INFO local.LocalScheduler: Running 13
13/07/27 21:34:29 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:34:29 INFO : /mnt/ramdisk/tachyonworker/2147483662 is not on local disk.
13/07/27 21:34:29 INFO : Try to find and read from remote workers.
13/07/27 21:34:29 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:34:29 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483662 was created!
13/07/27 21:34:29 INFO local.LocalScheduler: Finished 13
13/07/27 21:34:29 INFO scheduler.DAGScheduler: Completed ResultTask(0, 13)
13/07/27 21:34:29 INFO local.LocalTaskSetManager: Size of task 14 is 1499 bytes
13/07/27 21:34:29 INFO local.LocalScheduler: Running 14
13/07/27 21:34:29 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:34:29 INFO : /mnt/ramdisk/tachyonworker/2147483663 is not on local disk.
13/07/27 21:34:29 INFO : Try to find and read from remote workers.
13/07/27 21:34:29 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:34:29 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483663 was created!
13/07/27 21:34:30 INFO local.LocalScheduler: Finished 14
13/07/27 21:34:30 INFO scheduler.DAGScheduler: Completed ResultTask(0, 14)
13/07/27 21:34:30 INFO local.LocalTaskSetManager: Size of task 15 is 1499 bytes
13/07/27 21:34:30 INFO local.LocalScheduler: Running 15
13/07/27 21:34:30 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:34:30 INFO : /mnt/ramdisk/tachyonworker/2147483664 is not on local disk.
13/07/27 21:34:30 INFO : Try to find and read from remote workers.
13/07/27 21:34:30 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:34:30 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483664 was created!
13/07/27 21:34:30 INFO local.LocalScheduler: Finished 15
13/07/27 21:34:30 INFO scheduler.DAGScheduler: Completed ResultTask(0, 15)
13/07/27 21:34:30 INFO local.LocalTaskSetManager: Size of task 16 is 1499 bytes
13/07/27 21:34:30 INFO local.LocalScheduler: Running 16
13/07/27 21:34:30 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:34:31 INFO : /mnt/ramdisk/tachyonworker/2147483665 is not on local disk.
13/07/27 21:34:31 INFO : Try to find and read from remote workers.
13/07/27 21:34:31 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:34:31 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483665 was created!
13/07/27 21:34:31 INFO local.LocalScheduler: Finished 16
13/07/27 21:34:31 INFO scheduler.DAGScheduler: Completed ResultTask(0, 16)
13/07/27 21:34:31 INFO local.LocalTaskSetManager: Size of task 17 is 1499 bytes
13/07/27 21:34:31 INFO local.LocalScheduler: Running 17
13/07/27 21:34:31 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:34:31 INFO : /mnt/ramdisk/tachyonworker/2147483666 is not on local disk.
13/07/27 21:34:31 INFO : Try to find and read from remote workers.
13/07/27 21:34:31 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:34:31 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483666 was created!
13/07/27 21:34:31 INFO local.LocalScheduler: Finished 17
13/07/27 21:34:31 INFO scheduler.DAGScheduler: Completed ResultTask(0, 17)
13/07/27 21:34:31 INFO local.LocalTaskSetManager: Size of task 18 is 1499 bytes
13/07/27 21:34:31 INFO local.LocalScheduler: Running 18
13/07/27 21:34:31 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:34:31 INFO local.LocalScheduler: Finished 18
13/07/27 21:34:31 INFO scheduler.DAGScheduler: Completed ResultTask(0, 18)
13/07/27 21:34:31 INFO local.LocalScheduler: Remove TaskSet 0.0 from pool 
13/07/27 21:34:31 INFO scheduler.DAGScheduler: Stage 0 (count at <console>:15) finished in 12.238 s
13/07/27 21:34:31 INFO spark.SparkContext: Job finished: count at <console>:15, took 12.290102206 s
res0: Long = 500094

scala> 13/07/27 21:34:32 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:34:32 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:34:32 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:34:32 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:34:32 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:34:32 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:34:32 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:34:32 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage/rdd,null}
Killed 1 processes
Killed 1 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting Tachyon @ tachyon-ec2-0
2013-07-27 21:34:33,765 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data
2013-07-27 21:34:33,769 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_log.data
2013-07-27 21:34:34,258 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/data
2013-07-27 21:34:34,270 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/workers

run11:

restaring tachyon
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Killed 0 processes
Killed 0 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting RamFS: /mnt/ramdisk
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata -Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Starting master @ tachyon-ec2-0
Starting worker @ tachyon-ec2-0

spark-shell count
9510 tachyon.Master
9537 tachyon.Worker

Going to fadvise /mnt/tachyon/hit_data.tsv.1 as mode POSIX_FADV_DONTNEED
offset: 0
length: 525
mode: POSIX_FADV_DONTNEED
WIN
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/ubuntu/work/tachyon/target/tachyon-0.3.0-SNAPSHOT-jar-with-dependencies.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/ubuntu/work/spark/lib_managed/jars/slf4j-log4j12-1.7.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
Welcome to
      ____              __  
     / __/__  ___ _____/ /__
    _\ \/ _ \/ _ `/ __/  '_/
   /___/ .__/\_,_/_/ /_/\_\   version 0.8.0
      /_/                  

Using Scala version 2.9.3 (OpenJDK 64-Bit Server VM, Java 1.7.0_25)
Initializing interpreter...
13/07/27 21:34:40 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:34:40 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:44939
Creating SparkContext...
13/07/27 21:34:49 INFO slf4j.Slf4jEventHandler: Slf4jEventHandler started
13/07/27 21:34:49 INFO spark.SparkEnv: Registering BlockManagerMaster
13/07/27 21:34:50 INFO storage.MemoryStore: MemoryStore started with capacity 1295.4 MB.
13/07/27 21:34:50 INFO storage.DiskStore: Created local directory at /tmp/spark-local-20130727213450-990b
13/07/27 21:34:50 INFO network.ConnectionManager: Bound socket to port 44278 with id = ConnectionManagerId(tachyon-ec2-0,44278)
13/07/27 21:34:50 INFO storage.BlockManagerMaster: Trying to register BlockManager
13/07/27 21:34:50 INFO storage.BlockManagerMasterActor$BlockManagerInfo: Registering block manager tachyon-ec2-0:44278 with 1295.4 MB RAM
13/07/27 21:34:50 INFO storage.BlockManagerMaster: Registered BlockManager
13/07/27 21:34:50 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:34:50 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:37077
13/07/27 21:34:50 INFO broadcast.HttpBroadcast: Broadcast server started at http://10.151.80.188:37077
13/07/27 21:34:50 INFO spark.SparkEnv: Registering MapOutputTracker
13/07/27 21:34:50 INFO spark.HttpFileServer: HTTP File server directory is /tmp/spark-a9a786de-e680-4e84-8bb0-d92214bec1af
13/07/27 21:34:50 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:34:50 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:52786
13/07/27 21:34:50 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:34:50 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage/rdd,null}
13/07/27 21:34:50 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:34:50 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:34:50 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:34:50 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:34:50 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:34:50 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:34:50 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:34:50 INFO server.AbstractConnector: Started SelectChannelConnector@0.0.0.0:33000
13/07/27 21:34:50 INFO ui.SparkUI: Started Spark Web UI at http://tachyon-ec2-0:33000
Spark context available as sc.
Type in expressions to have them evaluated.
Type :help for more information.

scala> val s = sc.textFile("tachyon://tachyon-ec2-0:19998/hit_data.tsv.1")
13/07/27 21:34:51 INFO storage.MemoryStore: ensureFreeSpace(58415) called with curMem=0, maxMem=1358297825
13/07/27 21:34:51 INFO storage.MemoryStore: Block broadcast_0 stored as values to memory (estimated size 57.0 KB, free 1295.3 MB)
s: spark.RDD[String] = MappedRDD[1] at textFile at <console>:12

scala> s.count()
13/07/27 21:34:51 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
13/07/27 21:34:51 WARN snappy.LoadSnappy: Snappy native library not loaded
13/07/27 21:34:51 INFO : initialize(tachyon://tachyon-ec2-0:19998/hit_data.tsv.1, Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml). Connecting to Tachyon: tachyon://tachyon-ec2-0:19998/hit_data.tsv.1
13/07/27 21:34:51 INFO : Trying to connect master @ tachyon-ec2-0/10.151.80.188:19998
13/07/27 21:34:51 INFO : User registered at the master tachyon-ec2-0/10.151.80.188:19998 got UserId 1
13/07/27 21:34:51 INFO : Trying to get local worker host : tachyon-ec2-0
13/07/27 21:34:51 INFO : Connecting local worker @ tachyon-ec2-0/10.151.80.188:29998
13/07/27 21:34:51 INFO : tachyon://tachyon-ec2-0:19998 tachyon://tachyon-ec2-0:19998 file:///mnt/tachyon
13/07/27 21:34:51 INFO : getFileStatus(/hit_data.tsv.1): HDFS Path: file:/mnt/tachyon/hit_data.tsv.1 TPath: tachyon://tachyon-ec2-0:19998/hit_data.tsv.1
13/07/27 21:34:51 INFO : tachyon.client.TachyonFS@75087c8b file:///mnt/tachyon /hit_data.tsv.1 tachyon.PrefixList@28c5b4
13/07/27 21:34:52 INFO : Create tachyon file /hit_data.tsv.1 with file id 2 and checkpoint location file:///mnt/tachyon/hit_data.tsv.1
13/07/27 21:34:52 INFO mapred.FileInputFormat: Total input paths to process : 1
13/07/27 21:34:52 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:34:52 INFO scheduler.DAGScheduler: Got job 0 (count at <console>:15) with 1 output partitions (allowLocal=false)
13/07/27 21:34:52 INFO scheduler.DAGScheduler: Final stage: Stage 0 (count at <console>:15)
13/07/27 21:34:52 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:34:52 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:34:52 INFO scheduler.DAGScheduler: Submitting Stage 0 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:34:52 INFO scheduler.DAGScheduler: Submitting 1 missing tasks from Stage 0 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:34:52 INFO local.LocalTaskSetManager: Size of task 0 is 1494 bytes
13/07/27 21:34:52 INFO local.LocalScheduler: Running 0
13/07/27 21:34:52 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.1, 65536)
13/07/27 21:34:52 INFO : /mnt/ramdisk/tachyonworker/2147483648 is not on local disk.
13/07/27 21:34:52 INFO : Try to find and read from remote workers.
13/07/27 21:34:52 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:34:52 INFO : Folder /mnt/ramdisk/tachyonworker/users/1 was created!
13/07/27 21:34:52 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483648 was created!
13/07/27 21:34:52 INFO local.LocalScheduler: Finished 0
13/07/27 21:34:52 INFO local.LocalScheduler: Remove TaskSet 0.0 from pool 
13/07/27 21:34:52 INFO scheduler.DAGScheduler: Completed ResultTask(0, 0)
13/07/27 21:34:52 INFO scheduler.DAGScheduler: Stage 0 (count at <console>:15) finished in 0.363 s
13/07/27 21:34:52 INFO spark.SparkContext: Job finished: count at <console>:15, took 0.407813279 s
res0: Long = 1

scala> s.count()
13/07/27 21:34:53 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:34:53 INFO scheduler.DAGScheduler: Got job 1 (count at <console>:15) with 1 output partitions (allowLocal=false)
13/07/27 21:34:53 INFO scheduler.DAGScheduler: Final stage: Stage 1 (count at <console>:15)
13/07/27 21:34:53 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:34:53 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:34:53 INFO scheduler.DAGScheduler: Submitting Stage 1 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:34:53 INFO scheduler.DAGScheduler: Submitting 1 missing tasks from Stage 1 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:34:53 INFO local.LocalTaskSetManager: Size of task 1 is 1495 bytes
13/07/27 21:34:53 INFO local.LocalScheduler: Running 1
13/07/27 21:34:53 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.1, 65536)
13/07/27 21:34:53 INFO local.LocalScheduler: Finished 1
13/07/27 21:34:53 INFO scheduler.DAGScheduler: Completed ResultTask(1, 0)
13/07/27 21:34:53 INFO local.LocalScheduler: Remove TaskSet 1.0 from pool 
13/07/27 21:34:53 INFO scheduler.DAGScheduler: Stage 1 (count at <console>:15) finished in 0.042 s
13/07/27 21:34:53 INFO spark.SparkContext: Job finished: count at <console>:15, took 0.045343802 s
res1: Long = 1

scala> s.count()
13/07/27 21:34:53 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:34:53 INFO scheduler.DAGScheduler: Got job 2 (count at <console>:15) with 1 output partitions (allowLocal=false)
13/07/27 21:34:53 INFO scheduler.DAGScheduler: Final stage: Stage 2 (count at <console>:15)
13/07/27 21:34:53 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:34:53 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:34:53 INFO scheduler.DAGScheduler: Submitting Stage 2 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:34:53 INFO scheduler.DAGScheduler: Submitting 1 missing tasks from Stage 2 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:34:53 INFO local.LocalTaskSetManager: Size of task 2 is 1495 bytes
13/07/27 21:34:53 INFO local.LocalScheduler: Running 2
13/07/27 21:34:53 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.1, 65536)
13/07/27 21:34:53 INFO local.LocalScheduler: Finished 2
13/07/27 21:34:53 INFO scheduler.DAGScheduler: Completed ResultTask(2, 0)
13/07/27 21:34:53 INFO local.LocalScheduler: Remove TaskSet 2.0 from pool 
13/07/27 21:34:53 INFO scheduler.DAGScheduler: Stage 2 (count at <console>:15) finished in 0.040 s
13/07/27 21:34:53 INFO spark.SparkContext: Job finished: count at <console>:15, took 0.043617257 s
res2: Long = 1

scala> s.count()
13/07/27 21:34:53 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:34:53 INFO scheduler.DAGScheduler: Got job 3 (count at <console>:15) with 1 output partitions (allowLocal=false)
13/07/27 21:34:53 INFO scheduler.DAGScheduler: Final stage: Stage 3 (count at <console>:15)
13/07/27 21:34:53 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:34:53 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:34:53 INFO scheduler.DAGScheduler: Submitting Stage 3 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:34:53 INFO scheduler.DAGScheduler: Submitting 1 missing tasks from Stage 3 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:34:53 INFO local.LocalTaskSetManager: Size of task 3 is 1495 bytes
13/07/27 21:34:53 INFO local.LocalScheduler: Running 3
13/07/27 21:34:53 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.1, 65536)
13/07/27 21:34:53 INFO local.LocalScheduler: Finished 3
13/07/27 21:34:53 INFO scheduler.DAGScheduler: Completed ResultTask(3, 0)
13/07/27 21:34:53 INFO local.LocalScheduler: Remove TaskSet 3.0 from pool 
13/07/27 21:34:53 INFO scheduler.DAGScheduler: Stage 3 (count at <console>:15) finished in 0.041 s
13/07/27 21:34:53 INFO spark.SparkContext: Job finished: count at <console>:15, took 0.043963979 s
res3: Long = 1

scala> s.count()
13/07/27 21:34:54 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:34:54 INFO scheduler.DAGScheduler: Got job 4 (count at <console>:15) with 1 output partitions (allowLocal=false)
13/07/27 21:34:54 INFO scheduler.DAGScheduler: Final stage: Stage 4 (count at <console>:15)
13/07/27 21:34:54 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:34:54 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:34:54 INFO scheduler.DAGScheduler: Submitting Stage 4 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:34:54 INFO scheduler.DAGScheduler: Submitting 1 missing tasks from Stage 4 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:34:54 INFO local.LocalTaskSetManager: Size of task 4 is 1495 bytes
13/07/27 21:34:54 INFO local.LocalScheduler: Running 4
13/07/27 21:34:54 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.1, 65536)
13/07/27 21:34:54 INFO local.LocalScheduler: Finished 4
13/07/27 21:34:54 INFO scheduler.DAGScheduler: Completed ResultTask(4, 0)
13/07/27 21:34:54 INFO local.LocalScheduler: Remove TaskSet 4.0 from pool 
13/07/27 21:34:54 INFO scheduler.DAGScheduler: Stage 4 (count at <console>:15) finished in 0.040 s
13/07/27 21:34:54 INFO spark.SparkContext: Job finished: count at <console>:15, took 0.042859897 s
res4: Long = 1

scala> s.count()
13/07/27 21:34:54 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:34:54 INFO scheduler.DAGScheduler: Got job 5 (count at <console>:15) with 1 output partitions (allowLocal=false)
13/07/27 21:34:54 INFO scheduler.DAGScheduler: Final stage: Stage 5 (count at <console>:15)
13/07/27 21:34:54 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:34:54 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:34:54 INFO scheduler.DAGScheduler: Submitting Stage 5 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:34:54 INFO scheduler.DAGScheduler: Submitting 1 missing tasks from Stage 5 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:34:54 INFO local.LocalTaskSetManager: Size of task 5 is 1495 bytes
13/07/27 21:34:54 INFO local.LocalScheduler: Running 5
13/07/27 21:34:54 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.1, 65536)
13/07/27 21:34:54 INFO local.LocalScheduler: Finished 5
13/07/27 21:34:54 INFO scheduler.DAGScheduler: Completed ResultTask(5, 0)
13/07/27 21:34:54 INFO local.LocalScheduler: Remove TaskSet 5.0 from pool 
13/07/27 21:34:54 INFO scheduler.DAGScheduler: Stage 5 (count at <console>:15) finished in 0.039 s
13/07/27 21:34:54 INFO spark.SparkContext: Job finished: count at <console>:15, took 0.043013664 s
res5: Long = 1

scala> s.count()
13/07/27 21:34:54 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:34:54 INFO scheduler.DAGScheduler: Got job 6 (count at <console>:15) with 1 output partitions (allowLocal=false)
13/07/27 21:34:54 INFO scheduler.DAGScheduler: Final stage: Stage 6 (count at <console>:15)
13/07/27 21:34:54 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:34:54 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:34:54 INFO scheduler.DAGScheduler: Submitting Stage 6 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:34:54 INFO scheduler.DAGScheduler: Submitting 1 missing tasks from Stage 6 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:34:54 INFO local.LocalTaskSetManager: Size of task 6 is 1495 bytes
13/07/27 21:34:54 INFO local.LocalScheduler: Running 6
13/07/27 21:34:54 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.1, 65536)
13/07/27 21:34:54 INFO local.LocalScheduler: Finished 6
13/07/27 21:34:54 INFO scheduler.DAGScheduler: Completed ResultTask(6, 0)
13/07/27 21:34:54 INFO local.LocalScheduler: Remove TaskSet 6.0 from pool 
13/07/27 21:34:54 INFO scheduler.DAGScheduler: Stage 6 (count at <console>:15) finished in 0.040 s
13/07/27 21:34:54 INFO spark.SparkContext: Job finished: count at <console>:15, took 0.042484928 s
res6: Long = 1

scala> s.count()
13/07/27 21:34:54 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:34:54 INFO scheduler.DAGScheduler: Got job 7 (count at <console>:15) with 1 output partitions (allowLocal=false)
13/07/27 21:34:54 INFO scheduler.DAGScheduler: Final stage: Stage 7 (count at <console>:15)
13/07/27 21:34:54 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:34:54 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:34:54 INFO scheduler.DAGScheduler: Submitting Stage 7 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:34:54 INFO scheduler.DAGScheduler: Submitting 1 missing tasks from Stage 7 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:34:54 INFO local.LocalTaskSetManager: Size of task 7 is 1495 bytes
13/07/27 21:34:54 INFO local.LocalScheduler: Running 7
13/07/27 21:34:54 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.1, 65536)
13/07/27 21:34:54 INFO local.LocalScheduler: Finished 7
13/07/27 21:34:54 INFO scheduler.DAGScheduler: Completed ResultTask(7, 0)
13/07/27 21:34:54 INFO local.LocalScheduler: Remove TaskSet 7.0 from pool 
13/07/27 21:34:54 INFO scheduler.DAGScheduler: Stage 7 (count at <console>:15) finished in 0.042 s
13/07/27 21:34:54 INFO spark.SparkContext: Job finished: count at <console>:15, took 0.045060103 s
res7: Long = 1

scala> s.count()
13/07/27 21:34:55 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:34:55 INFO scheduler.DAGScheduler: Got job 8 (count at <console>:15) with 1 output partitions (allowLocal=false)
13/07/27 21:34:55 INFO scheduler.DAGScheduler: Final stage: Stage 8 (count at <console>:15)
13/07/27 21:34:55 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:34:55 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:34:55 INFO scheduler.DAGScheduler: Submitting Stage 8 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:34:55 INFO scheduler.DAGScheduler: Submitting 1 missing tasks from Stage 8 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:34:55 INFO local.LocalTaskSetManager: Size of task 8 is 1495 bytes
13/07/27 21:34:55 INFO local.LocalScheduler: Running 8
13/07/27 21:34:55 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.1, 65536)
13/07/27 21:34:55 INFO local.LocalScheduler: Finished 8
13/07/27 21:34:55 INFO scheduler.DAGScheduler: Completed ResultTask(8, 0)
13/07/27 21:34:55 INFO local.LocalScheduler: Remove TaskSet 8.0 from pool 
13/07/27 21:34:55 INFO scheduler.DAGScheduler: Stage 8 (count at <console>:15) finished in 0.040 s
13/07/27 21:34:55 INFO spark.SparkContext: Job finished: count at <console>:15, took 0.043406622 s
res8: Long = 1

scala> s.count()
13/07/27 21:34:55 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:34:55 INFO scheduler.DAGScheduler: Got job 9 (count at <console>:15) with 1 output partitions (allowLocal=false)
13/07/27 21:34:55 INFO scheduler.DAGScheduler: Final stage: Stage 9 (count at <console>:15)
13/07/27 21:34:55 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:34:55 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:34:55 INFO scheduler.DAGScheduler: Submitting Stage 9 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:34:55 INFO scheduler.DAGScheduler: Submitting 1 missing tasks from Stage 9 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:34:55 INFO local.LocalTaskSetManager: Size of task 9 is 1495 bytes
13/07/27 21:34:55 INFO local.LocalScheduler: Running 9
13/07/27 21:34:55 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.1, 65536)
13/07/27 21:34:55 INFO local.LocalScheduler: Finished 9
13/07/27 21:34:55 INFO scheduler.DAGScheduler: Completed ResultTask(9, 0)
13/07/27 21:34:55 INFO local.LocalScheduler: Remove TaskSet 9.0 from pool 
13/07/27 21:34:55 INFO scheduler.DAGScheduler: Stage 9 (count at <console>:15) finished in 0.031 s
13/07/27 21:34:55 INFO spark.SparkContext: Job finished: count at <console>:15, took 0.033410486 s
res9: Long = 1

scala> s.count()
13/07/27 21:34:55 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:34:55 INFO scheduler.DAGScheduler: Got job 10 (count at <console>:15) with 1 output partitions (allowLocal=false)
13/07/27 21:34:55 INFO scheduler.DAGScheduler: Final stage: Stage 10 (count at <console>:15)
13/07/27 21:34:55 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:34:55 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:34:55 INFO scheduler.DAGScheduler: Submitting Stage 10 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:34:55 INFO scheduler.DAGScheduler: Submitting 1 missing tasks from Stage 10 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:34:55 INFO local.LocalTaskSetManager: Size of task 10 is 1495 bytes
13/07/27 21:34:55 INFO local.LocalScheduler: Running 10
13/07/27 21:34:55 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.1, 65536)
13/07/27 21:34:55 INFO local.LocalScheduler: Finished 10
13/07/27 21:34:55 INFO scheduler.DAGScheduler: Completed ResultTask(10, 0)
13/07/27 21:34:55 INFO local.LocalScheduler: Remove TaskSet 10.0 from pool 
13/07/27 21:34:55 INFO scheduler.DAGScheduler: Stage 10 (count at <console>:15) finished in 0.031 s
13/07/27 21:34:55 INFO spark.SparkContext: Job finished: count at <console>:15, took 0.033708665 s
res10: Long = 1

scala> 13/07/27 21:34:55 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:34:55 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:34:55 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:34:55 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:34:55 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:34:55 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:34:55 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:34:55 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage/rdd,null}
Killed 1 processes
Killed 1 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting Tachyon @ tachyon-ec2-0
2013-07-27 21:34:57,374 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data
2013-07-27 21:34:57,378 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_log.data
2013-07-27 21:34:57,866 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/data
2013-07-27 21:34:57,878 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/workers

restaring tachyon
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Killed 0 processes
Killed 0 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting RamFS: /mnt/ramdisk
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata -Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Starting master @ tachyon-ec2-0
Starting worker @ tachyon-ec2-0

spark-shell count
10166 tachyon.Master
10193 tachyon.Worker

Going to fadvise /mnt/tachyon/hit_data.tsv.100 as mode POSIX_FADV_DONTNEED
offset: 0
length: 55735
mode: POSIX_FADV_DONTNEED
WIN
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/ubuntu/work/tachyon/target/tachyon-0.3.0-SNAPSHOT-jar-with-dependencies.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/ubuntu/work/spark/lib_managed/jars/slf4j-log4j12-1.7.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
Welcome to
      ____              __  
     / __/__  ___ _____/ /__
    _\ \/ _ \/ _ `/ __/  '_/
   /___/ .__/\_,_/_/ /_/\_\   version 0.8.0
      /_/                  

Using Scala version 2.9.3 (OpenJDK 64-Bit Server VM, Java 1.7.0_25)
Initializing interpreter...
13/07/27 21:35:04 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:35:04 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:39487
Creating SparkContext...
13/07/27 21:35:13 INFO slf4j.Slf4jEventHandler: Slf4jEventHandler started
13/07/27 21:35:13 INFO spark.SparkEnv: Registering BlockManagerMaster
13/07/27 21:35:13 INFO storage.MemoryStore: MemoryStore started with capacity 1295.4 MB.
13/07/27 21:35:13 INFO storage.DiskStore: Created local directory at /tmp/spark-local-20130727213513-ae95
13/07/27 21:35:13 INFO network.ConnectionManager: Bound socket to port 52502 with id = ConnectionManagerId(tachyon-ec2-0,52502)
13/07/27 21:35:13 INFO storage.BlockManagerMaster: Trying to register BlockManager
13/07/27 21:35:13 INFO storage.BlockManagerMasterActor$BlockManagerInfo: Registering block manager tachyon-ec2-0:52502 with 1295.4 MB RAM
13/07/27 21:35:13 INFO storage.BlockManagerMaster: Registered BlockManager
13/07/27 21:35:13 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:35:13 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:53032
13/07/27 21:35:13 INFO broadcast.HttpBroadcast: Broadcast server started at http://10.151.80.188:53032
13/07/27 21:35:13 INFO spark.SparkEnv: Registering MapOutputTracker
13/07/27 21:35:13 INFO spark.HttpFileServer: HTTP File server directory is /tmp/spark-1161bbd6-0c5e-4e06-8281-e3cdb6dc3b4f
13/07/27 21:35:13 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:35:13 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:38289
13/07/27 21:35:13 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:35:13 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage/rdd,null}
13/07/27 21:35:13 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:35:13 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:35:13 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:35:13 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:35:13 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:35:13 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:35:13 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:35:13 INFO server.AbstractConnector: Started SelectChannelConnector@0.0.0.0:33000
13/07/27 21:35:13 INFO ui.SparkUI: Started Spark Web UI at http://tachyon-ec2-0:33000
Spark context available as sc.
Type in expressions to have them evaluated.
Type :help for more information.

scala> val s = sc.textFile("tachyon://tachyon-ec2-0:19998/hit_data.tsv.100")
13/07/27 21:35:15 INFO storage.MemoryStore: ensureFreeSpace(58423) called with curMem=0, maxMem=1358297825
13/07/27 21:35:15 INFO storage.MemoryStore: Block broadcast_0 stored as values to memory (estimated size 57.1 KB, free 1295.3 MB)
s: spark.RDD[String] = MappedRDD[1] at textFile at <console>:12

scala> s.count()
13/07/27 21:35:15 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
13/07/27 21:35:15 WARN snappy.LoadSnappy: Snappy native library not loaded
13/07/27 21:35:15 INFO : initialize(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100, Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml). Connecting to Tachyon: tachyon://tachyon-ec2-0:19998/hit_data.tsv.100
13/07/27 21:35:15 INFO : Trying to connect master @ tachyon-ec2-0/10.151.80.188:19998
13/07/27 21:35:15 INFO : User registered at the master tachyon-ec2-0/10.151.80.188:19998 got UserId 1
13/07/27 21:35:15 INFO : Trying to get local worker host : tachyon-ec2-0
13/07/27 21:35:15 INFO : Connecting local worker @ tachyon-ec2-0/10.151.80.188:29998
13/07/27 21:35:15 INFO : tachyon://tachyon-ec2-0:19998 tachyon://tachyon-ec2-0:19998 file:///mnt/tachyon
13/07/27 21:35:15 INFO : getFileStatus(/hit_data.tsv.100): HDFS Path: file:/mnt/tachyon/hit_data.tsv.100 TPath: tachyon://tachyon-ec2-0:19998/hit_data.tsv.100
13/07/27 21:35:15 INFO : tachyon.client.TachyonFS@1b66a60f file:///mnt/tachyon /hit_data.tsv.100 tachyon.PrefixList@702030d6
13/07/27 21:35:16 INFO : Create tachyon file /hit_data.tsv.100 with file id 2 and checkpoint location file:///mnt/tachyon/hit_data.tsv.100
13/07/27 21:35:16 INFO mapred.FileInputFormat: Total input paths to process : 1
13/07/27 21:35:16 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:35:16 INFO scheduler.DAGScheduler: Got job 0 (count at <console>:15) with 1 output partitions (allowLocal=false)
13/07/27 21:35:16 INFO scheduler.DAGScheduler: Final stage: Stage 0 (count at <console>:15)
13/07/27 21:35:16 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:35:16 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:35:16 INFO scheduler.DAGScheduler: Submitting Stage 0 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:35:16 INFO scheduler.DAGScheduler: Submitting 1 missing tasks from Stage 0 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:35:16 INFO local.LocalTaskSetManager: Size of task 0 is 1496 bytes
13/07/27 21:35:16 INFO local.LocalScheduler: Running 0
13/07/27 21:35:16 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100, 65536)
13/07/27 21:35:16 INFO : /mnt/ramdisk/tachyonworker/2147483648 is not on local disk.
13/07/27 21:35:16 INFO : Try to find and read from remote workers.
13/07/27 21:35:16 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:35:16 INFO : Folder /mnt/ramdisk/tachyonworker/users/1 was created!
13/07/27 21:35:16 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483648 was created!
13/07/27 21:35:16 INFO local.LocalScheduler: Finished 0
13/07/27 21:35:16 INFO local.LocalScheduler: Remove TaskSet 0.0 from pool 
13/07/27 21:35:16 INFO scheduler.DAGScheduler: Completed ResultTask(0, 0)
13/07/27 21:35:16 INFO scheduler.DAGScheduler: Stage 0 (count at <console>:15) finished in 0.377 s
13/07/27 21:35:16 INFO spark.SparkContext: Job finished: count at <console>:15, took 0.421519233 s
res0: Long = 100

scala> s.count()
13/07/27 21:35:16 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:35:16 INFO scheduler.DAGScheduler: Got job 1 (count at <console>:15) with 1 output partitions (allowLocal=false)
13/07/27 21:35:16 INFO scheduler.DAGScheduler: Final stage: Stage 1 (count at <console>:15)
13/07/27 21:35:16 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:35:16 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:35:16 INFO scheduler.DAGScheduler: Submitting Stage 1 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:35:16 INFO scheduler.DAGScheduler: Submitting 1 missing tasks from Stage 1 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:35:16 INFO local.LocalTaskSetManager: Size of task 1 is 1497 bytes
13/07/27 21:35:16 INFO local.LocalScheduler: Running 1
13/07/27 21:35:16 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100, 65536)
13/07/27 21:35:16 INFO local.LocalScheduler: Finished 1
13/07/27 21:35:16 INFO scheduler.DAGScheduler: Completed ResultTask(1, 0)
13/07/27 21:35:16 INFO local.LocalScheduler: Remove TaskSet 1.0 from pool 
13/07/27 21:35:16 INFO scheduler.DAGScheduler: Stage 1 (count at <console>:15) finished in 0.044 s
13/07/27 21:35:16 INFO spark.SparkContext: Job finished: count at <console>:15, took 0.047179933 s
res1: Long = 100

scala> s.count()
13/07/27 21:35:17 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:35:17 INFO scheduler.DAGScheduler: Got job 2 (count at <console>:15) with 1 output partitions (allowLocal=false)
13/07/27 21:35:17 INFO scheduler.DAGScheduler: Final stage: Stage 2 (count at <console>:15)
13/07/27 21:35:17 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:35:17 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:35:17 INFO scheduler.DAGScheduler: Submitting Stage 2 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:35:17 INFO scheduler.DAGScheduler: Submitting 1 missing tasks from Stage 2 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:35:17 INFO local.LocalTaskSetManager: Size of task 2 is 1497 bytes
13/07/27 21:35:17 INFO local.LocalScheduler: Running 2
13/07/27 21:35:17 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100, 65536)
13/07/27 21:35:17 INFO local.LocalScheduler: Finished 2
13/07/27 21:35:17 INFO scheduler.DAGScheduler: Completed ResultTask(2, 0)
13/07/27 21:35:17 INFO local.LocalScheduler: Remove TaskSet 2.0 from pool 
13/07/27 21:35:17 INFO scheduler.DAGScheduler: Stage 2 (count at <console>:15) finished in 0.041 s
13/07/27 21:35:17 INFO spark.SparkContext: Job finished: count at <console>:15, took 0.044711933 s
res2: Long = 100

scala> s.count()
13/07/27 21:35:17 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:35:17 INFO scheduler.DAGScheduler: Got job 3 (count at <console>:15) with 1 output partitions (allowLocal=false)
13/07/27 21:35:17 INFO scheduler.DAGScheduler: Final stage: Stage 3 (count at <console>:15)
13/07/27 21:35:17 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:35:17 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:35:17 INFO scheduler.DAGScheduler: Submitting Stage 3 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:35:17 INFO scheduler.DAGScheduler: Submitting 1 missing tasks from Stage 3 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:35:17 INFO local.LocalTaskSetManager: Size of task 3 is 1497 bytes
13/07/27 21:35:17 INFO local.LocalScheduler: Running 3
13/07/27 21:35:17 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100, 65536)
13/07/27 21:35:17 INFO local.LocalScheduler: Finished 3
13/07/27 21:35:17 INFO scheduler.DAGScheduler: Completed ResultTask(3, 0)
13/07/27 21:35:17 INFO local.LocalScheduler: Remove TaskSet 3.0 from pool 
13/07/27 21:35:17 INFO scheduler.DAGScheduler: Stage 3 (count at <console>:15) finished in 0.041 s
13/07/27 21:35:17 INFO spark.SparkContext: Job finished: count at <console>:15, took 0.044756028 s
res3: Long = 100

scala> s.count()
13/07/27 21:35:17 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:35:17 INFO scheduler.DAGScheduler: Got job 4 (count at <console>:15) with 1 output partitions (allowLocal=false)
13/07/27 21:35:17 INFO scheduler.DAGScheduler: Final stage: Stage 4 (count at <console>:15)
13/07/27 21:35:17 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:35:17 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:35:17 INFO scheduler.DAGScheduler: Submitting Stage 4 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:35:17 INFO scheduler.DAGScheduler: Submitting 1 missing tasks from Stage 4 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:35:17 INFO local.LocalTaskSetManager: Size of task 4 is 1497 bytes
13/07/27 21:35:17 INFO local.LocalScheduler: Running 4
13/07/27 21:35:17 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100, 65536)
13/07/27 21:35:17 INFO local.LocalScheduler: Finished 4
13/07/27 21:35:17 INFO scheduler.DAGScheduler: Completed ResultTask(4, 0)
13/07/27 21:35:17 INFO local.LocalScheduler: Remove TaskSet 4.0 from pool 
13/07/27 21:35:17 INFO scheduler.DAGScheduler: Stage 4 (count at <console>:15) finished in 0.042 s
13/07/27 21:35:17 INFO spark.SparkContext: Job finished: count at <console>:15, took 0.044501501 s
res4: Long = 100

scala> s.count()
13/07/27 21:35:18 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:35:18 INFO scheduler.DAGScheduler: Got job 5 (count at <console>:15) with 1 output partitions (allowLocal=false)
13/07/27 21:35:18 INFO scheduler.DAGScheduler: Final stage: Stage 5 (count at <console>:15)
13/07/27 21:35:18 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:35:18 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:35:18 INFO scheduler.DAGScheduler: Submitting Stage 5 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:35:18 INFO scheduler.DAGScheduler: Submitting 1 missing tasks from Stage 5 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:35:18 INFO local.LocalTaskSetManager: Size of task 5 is 1497 bytes
13/07/27 21:35:18 INFO local.LocalScheduler: Running 5
13/07/27 21:35:18 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100, 65536)
13/07/27 21:35:18 INFO local.LocalScheduler: Finished 5
13/07/27 21:35:18 INFO scheduler.DAGScheduler: Completed ResultTask(5, 0)
13/07/27 21:35:18 INFO local.LocalScheduler: Remove TaskSet 5.0 from pool 
13/07/27 21:35:18 INFO scheduler.DAGScheduler: Stage 5 (count at <console>:15) finished in 0.042 s
13/07/27 21:35:18 INFO spark.SparkContext: Job finished: count at <console>:15, took 0.045665315 s
res5: Long = 100

scala> s.count()
13/07/27 21:35:18 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:35:18 INFO scheduler.DAGScheduler: Got job 6 (count at <console>:15) with 1 output partitions (allowLocal=false)
13/07/27 21:35:18 INFO scheduler.DAGScheduler: Final stage: Stage 6 (count at <console>:15)
13/07/27 21:35:18 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:35:18 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:35:18 INFO scheduler.DAGScheduler: Submitting Stage 6 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:35:18 INFO scheduler.DAGScheduler: Submitting 1 missing tasks from Stage 6 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:35:18 INFO local.LocalTaskSetManager: Size of task 6 is 1497 bytes
13/07/27 21:35:18 INFO local.LocalScheduler: Running 6
13/07/27 21:35:18 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100, 65536)
13/07/27 21:35:18 INFO local.LocalScheduler: Finished 6
13/07/27 21:35:18 INFO scheduler.DAGScheduler: Completed ResultTask(6, 0)
13/07/27 21:35:18 INFO local.LocalScheduler: Remove TaskSet 6.0 from pool 
13/07/27 21:35:18 INFO scheduler.DAGScheduler: Stage 6 (count at <console>:15) finished in 0.041 s
13/07/27 21:35:18 INFO spark.SparkContext: Job finished: count at <console>:15, took 0.044008797 s
res6: Long = 100

scala> s.count()
13/07/27 21:35:18 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:35:18 INFO scheduler.DAGScheduler: Got job 7 (count at <console>:15) with 1 output partitions (allowLocal=false)
13/07/27 21:35:18 INFO scheduler.DAGScheduler: Final stage: Stage 7 (count at <console>:15)
13/07/27 21:35:18 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:35:18 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:35:18 INFO scheduler.DAGScheduler: Submitting Stage 7 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:35:18 INFO scheduler.DAGScheduler: Submitting 1 missing tasks from Stage 7 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:35:18 INFO local.LocalTaskSetManager: Size of task 7 is 1497 bytes
13/07/27 21:35:18 INFO local.LocalScheduler: Running 7
13/07/27 21:35:18 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100, 65536)
13/07/27 21:35:18 INFO local.LocalScheduler: Finished 7
13/07/27 21:35:18 INFO scheduler.DAGScheduler: Completed ResultTask(7, 0)
13/07/27 21:35:18 INFO local.LocalScheduler: Remove TaskSet 7.0 from pool 
13/07/27 21:35:18 INFO scheduler.DAGScheduler: Stage 7 (count at <console>:15) finished in 0.044 s
13/07/27 21:35:18 INFO spark.SparkContext: Job finished: count at <console>:15, took 0.046314398 s
res7: Long = 100

scala> s.count()
13/07/27 21:35:18 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:35:18 INFO scheduler.DAGScheduler: Got job 8 (count at <console>:15) with 1 output partitions (allowLocal=false)
13/07/27 21:35:18 INFO scheduler.DAGScheduler: Final stage: Stage 8 (count at <console>:15)
13/07/27 21:35:18 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:35:18 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:35:18 INFO scheduler.DAGScheduler: Submitting Stage 8 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:35:18 INFO scheduler.DAGScheduler: Submitting 1 missing tasks from Stage 8 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:35:18 INFO local.LocalTaskSetManager: Size of task 8 is 1497 bytes
13/07/27 21:35:18 INFO local.LocalScheduler: Running 8
13/07/27 21:35:18 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100, 65536)
13/07/27 21:35:18 INFO local.LocalScheduler: Finished 8
13/07/27 21:35:18 INFO scheduler.DAGScheduler: Completed ResultTask(8, 0)
13/07/27 21:35:18 INFO local.LocalScheduler: Remove TaskSet 8.0 from pool 
13/07/27 21:35:18 INFO scheduler.DAGScheduler: Stage 8 (count at <console>:15) finished in 0.041 s
13/07/27 21:35:18 INFO spark.SparkContext: Job finished: count at <console>:15, took 0.044212641 s
res8: Long = 100

scala> s.count()
13/07/27 21:35:19 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:35:19 INFO scheduler.DAGScheduler: Got job 9 (count at <console>:15) with 1 output partitions (allowLocal=false)
13/07/27 21:35:19 INFO scheduler.DAGScheduler: Final stage: Stage 9 (count at <console>:15)
13/07/27 21:35:19 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:35:19 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:35:19 INFO scheduler.DAGScheduler: Submitting Stage 9 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:35:19 INFO scheduler.DAGScheduler: Submitting 1 missing tasks from Stage 9 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:35:19 INFO local.LocalTaskSetManager: Size of task 9 is 1497 bytes
13/07/27 21:35:19 INFO local.LocalScheduler: Running 9
13/07/27 21:35:19 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100, 65536)
13/07/27 21:35:19 INFO local.LocalScheduler: Finished 9
13/07/27 21:35:19 INFO scheduler.DAGScheduler: Completed ResultTask(9, 0)
13/07/27 21:35:19 INFO local.LocalScheduler: Remove TaskSet 9.0 from pool 
13/07/27 21:35:19 INFO scheduler.DAGScheduler: Stage 9 (count at <console>:15) finished in 0.032 s
13/07/27 21:35:19 INFO spark.SparkContext: Job finished: count at <console>:15, took 0.034365618 s
res9: Long = 100

scala> s.count()
13/07/27 21:35:19 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:35:19 INFO scheduler.DAGScheduler: Got job 10 (count at <console>:15) with 1 output partitions (allowLocal=false)
13/07/27 21:35:19 INFO scheduler.DAGScheduler: Final stage: Stage 10 (count at <console>:15)
13/07/27 21:35:19 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:35:19 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:35:19 INFO scheduler.DAGScheduler: Submitting Stage 10 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:35:19 INFO scheduler.DAGScheduler: Submitting 1 missing tasks from Stage 10 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:35:19 INFO local.LocalTaskSetManager: Size of task 10 is 1497 bytes
13/07/27 21:35:19 INFO local.LocalScheduler: Running 10
13/07/27 21:35:19 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100, 65536)
13/07/27 21:35:19 INFO local.LocalScheduler: Finished 10
13/07/27 21:35:19 INFO scheduler.DAGScheduler: Completed ResultTask(10, 0)
13/07/27 21:35:19 INFO local.LocalScheduler: Remove TaskSet 10.0 from pool 
13/07/27 21:35:19 INFO scheduler.DAGScheduler: Stage 10 (count at <console>:15) finished in 0.036 s
13/07/27 21:35:19 INFO spark.SparkContext: Job finished: count at <console>:15, took 0.03822237 s
res10: Long = 100

scala> 13/07/27 21:35:19 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:35:19 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:35:19 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:35:19 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:35:19 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:35:19 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:35:19 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:35:19 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage/rdd,null}
Killed 1 processes
Killed 1 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting Tachyon @ tachyon-ec2-0
2013-07-27 21:35:21,057 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data
2013-07-27 21:35:21,061 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_log.data
2013-07-27 21:35:21,550 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/data
2013-07-27 21:35:21,562 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/workers

restaring tachyon
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Killed 0 processes
Killed 0 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting RamFS: /mnt/ramdisk
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata -Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Starting master @ tachyon-ec2-0
Starting worker @ tachyon-ec2-0

spark-shell count
10822 tachyon.Master
10849 tachyon.Worker

Going to fadvise /mnt/tachyon/hit_data.tsv.1000 as mode POSIX_FADV_DONTNEED
offset: 0
length: 776400
mode: POSIX_FADV_DONTNEED
WIN
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/ubuntu/work/tachyon/target/tachyon-0.3.0-SNAPSHOT-jar-with-dependencies.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/ubuntu/work/spark/lib_managed/jars/slf4j-log4j12-1.7.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
Welcome to
      ____              __  
     / __/__  ___ _____/ /__
    _\ \/ _ \/ _ `/ __/  '_/
   /___/ .__/\_,_/_/ /_/\_\   version 0.8.0
      /_/                  

Using Scala version 2.9.3 (OpenJDK 64-Bit Server VM, Java 1.7.0_25)
Initializing interpreter...
13/07/27 21:35:27 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:35:27 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:58889
Creating SparkContext...
13/07/27 21:35:36 INFO slf4j.Slf4jEventHandler: Slf4jEventHandler started
13/07/27 21:35:37 INFO spark.SparkEnv: Registering BlockManagerMaster
13/07/27 21:35:37 INFO storage.MemoryStore: MemoryStore started with capacity 1295.4 MB.
13/07/27 21:35:37 INFO storage.DiskStore: Created local directory at /tmp/spark-local-20130727213537-2bbb
13/07/27 21:35:37 INFO network.ConnectionManager: Bound socket to port 36646 with id = ConnectionManagerId(tachyon-ec2-0,36646)
13/07/27 21:35:37 INFO storage.BlockManagerMaster: Trying to register BlockManager
13/07/27 21:35:37 INFO storage.BlockManagerMasterActor$BlockManagerInfo: Registering block manager tachyon-ec2-0:36646 with 1295.4 MB RAM
13/07/27 21:35:37 INFO storage.BlockManagerMaster: Registered BlockManager
13/07/27 21:35:37 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:35:37 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:44298
13/07/27 21:35:37 INFO broadcast.HttpBroadcast: Broadcast server started at http://10.151.80.188:44298
13/07/27 21:35:37 INFO spark.SparkEnv: Registering MapOutputTracker
13/07/27 21:35:37 INFO spark.HttpFileServer: HTTP File server directory is /tmp/spark-b72e7f30-0c26-40eb-bc99-0decf8581878
13/07/27 21:35:37 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:35:37 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:39807
13/07/27 21:35:37 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:35:37 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage/rdd,null}
13/07/27 21:35:37 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:35:37 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:35:37 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:35:37 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:35:37 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:35:37 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:35:37 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:35:37 INFO server.AbstractConnector: Started SelectChannelConnector@0.0.0.0:33000
13/07/27 21:35:37 INFO ui.SparkUI: Started Spark Web UI at http://tachyon-ec2-0:33000
Spark context available as sc.
Type in expressions to have them evaluated.
Type :help for more information.

scala> val s = sc.textFile("tachyon://tachyon-ec2-0:19998/hit_data.tsv.1000")
13/07/27 21:35:38 INFO storage.MemoryStore: ensureFreeSpace(58423) called with curMem=0, maxMem=1358297825
13/07/27 21:35:38 INFO storage.MemoryStore: Block broadcast_0 stored as values to memory (estimated size 57.1 KB, free 1295.3 MB)
s: spark.RDD[String] = MappedRDD[1] at textFile at <console>:12

scala> s.count()
13/07/27 21:35:39 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
13/07/27 21:35:39 WARN snappy.LoadSnappy: Snappy native library not loaded
13/07/27 21:35:39 INFO : initialize(tachyon://tachyon-ec2-0:19998/hit_data.tsv.1000, Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml). Connecting to Tachyon: tachyon://tachyon-ec2-0:19998/hit_data.tsv.1000
13/07/27 21:35:39 INFO : Trying to connect master @ tachyon-ec2-0/10.151.80.188:19998
13/07/27 21:35:39 INFO : User registered at the master tachyon-ec2-0/10.151.80.188:19998 got UserId 1
13/07/27 21:35:39 INFO : Trying to get local worker host : tachyon-ec2-0
13/07/27 21:35:39 INFO : Connecting local worker @ tachyon-ec2-0/10.151.80.188:29998
13/07/27 21:35:39 INFO : tachyon://tachyon-ec2-0:19998 tachyon://tachyon-ec2-0:19998 file:///mnt/tachyon
13/07/27 21:35:39 INFO : getFileStatus(/hit_data.tsv.1000): HDFS Path: file:/mnt/tachyon/hit_data.tsv.1000 TPath: tachyon://tachyon-ec2-0:19998/hit_data.tsv.1000
13/07/27 21:35:39 INFO : tachyon.client.TachyonFS@2348717a file:///mnt/tachyon /hit_data.tsv.1000 tachyon.PrefixList@691212ae
13/07/27 21:35:39 INFO : Create tachyon file /hit_data.tsv.1000 with file id 2 and checkpoint location file:///mnt/tachyon/hit_data.tsv.1000
13/07/27 21:35:39 INFO mapred.FileInputFormat: Total input paths to process : 1
13/07/27 21:35:39 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:35:39 INFO scheduler.DAGScheduler: Got job 0 (count at <console>:15) with 1 output partitions (allowLocal=false)
13/07/27 21:35:39 INFO scheduler.DAGScheduler: Final stage: Stage 0 (count at <console>:15)
13/07/27 21:35:39 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:35:39 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:35:39 INFO scheduler.DAGScheduler: Submitting Stage 0 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:35:39 INFO scheduler.DAGScheduler: Submitting 1 missing tasks from Stage 0 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:35:39 INFO local.LocalTaskSetManager: Size of task 0 is 1497 bytes
13/07/27 21:35:39 INFO local.LocalScheduler: Running 0
13/07/27 21:35:39 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.1000, 65536)
13/07/27 21:35:40 INFO : /mnt/ramdisk/tachyonworker/2147483648 is not on local disk.
13/07/27 21:35:40 INFO : Try to find and read from remote workers.
13/07/27 21:35:40 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:35:40 INFO : Folder /mnt/ramdisk/tachyonworker/users/1 was created!
13/07/27 21:35:40 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483648 was created!
13/07/27 21:35:40 INFO local.LocalScheduler: Finished 0
13/07/27 21:35:40 INFO local.LocalScheduler: Remove TaskSet 0.0 from pool 
13/07/27 21:35:40 INFO scheduler.DAGScheduler: Completed ResultTask(0, 0)
13/07/27 21:35:40 INFO scheduler.DAGScheduler: Stage 0 (count at <console>:15) finished in 0.398 s
13/07/27 21:35:40 INFO spark.SparkContext: Job finished: count at <console>:15, took 0.441588589 s
res0: Long = 1000

scala> s.count()
13/07/27 21:35:40 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:35:40 INFO scheduler.DAGScheduler: Got job 1 (count at <console>:15) with 1 output partitions (allowLocal=false)
13/07/27 21:35:40 INFO scheduler.DAGScheduler: Final stage: Stage 1 (count at <console>:15)
13/07/27 21:35:40 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:35:40 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:35:40 INFO scheduler.DAGScheduler: Submitting Stage 1 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:35:40 INFO scheduler.DAGScheduler: Submitting 1 missing tasks from Stage 1 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:35:40 INFO local.LocalTaskSetManager: Size of task 1 is 1498 bytes
13/07/27 21:35:40 INFO local.LocalScheduler: Running 1
13/07/27 21:35:40 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.1000, 65536)
13/07/27 21:35:40 INFO local.LocalScheduler: Finished 1
13/07/27 21:35:40 INFO scheduler.DAGScheduler: Completed ResultTask(1, 0)
13/07/27 21:35:40 INFO local.LocalScheduler: Remove TaskSet 1.0 from pool 
13/07/27 21:35:40 INFO scheduler.DAGScheduler: Stage 1 (count at <console>:15) finished in 0.061 s
13/07/27 21:35:40 INFO spark.SparkContext: Job finished: count at <console>:15, took 0.064731891 s
res1: Long = 1000

scala> s.count()
13/07/27 21:35:40 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:35:40 INFO scheduler.DAGScheduler: Got job 2 (count at <console>:15) with 1 output partitions (allowLocal=false)
13/07/27 21:35:40 INFO scheduler.DAGScheduler: Final stage: Stage 2 (count at <console>:15)
13/07/27 21:35:40 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:35:40 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:35:40 INFO scheduler.DAGScheduler: Submitting Stage 2 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:35:40 INFO scheduler.DAGScheduler: Submitting 1 missing tasks from Stage 2 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:35:40 INFO local.LocalTaskSetManager: Size of task 2 is 1498 bytes
13/07/27 21:35:40 INFO local.LocalScheduler: Running 2
13/07/27 21:35:40 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.1000, 65536)
13/07/27 21:35:40 INFO local.LocalScheduler: Finished 2
13/07/27 21:35:40 INFO scheduler.DAGScheduler: Completed ResultTask(2, 0)
13/07/27 21:35:40 INFO local.LocalScheduler: Remove TaskSet 2.0 from pool 
13/07/27 21:35:40 INFO scheduler.DAGScheduler: Stage 2 (count at <console>:15) finished in 0.058 s
13/07/27 21:35:40 INFO spark.SparkContext: Job finished: count at <console>:15, took 0.061212913 s
res2: Long = 1000

scala> s.count()
13/07/27 21:35:41 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:35:41 INFO scheduler.DAGScheduler: Got job 3 (count at <console>:15) with 1 output partitions (allowLocal=false)
13/07/27 21:35:41 INFO scheduler.DAGScheduler: Final stage: Stage 3 (count at <console>:15)
13/07/27 21:35:41 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:35:41 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:35:41 INFO scheduler.DAGScheduler: Submitting Stage 3 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:35:41 INFO scheduler.DAGScheduler: Submitting 1 missing tasks from Stage 3 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:35:41 INFO local.LocalTaskSetManager: Size of task 3 is 1498 bytes
13/07/27 21:35:41 INFO local.LocalScheduler: Running 3
13/07/27 21:35:41 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.1000, 65536)
13/07/27 21:35:41 INFO local.LocalScheduler: Finished 3
13/07/27 21:35:41 INFO scheduler.DAGScheduler: Completed ResultTask(3, 0)
13/07/27 21:35:41 INFO local.LocalScheduler: Remove TaskSet 3.0 from pool 
13/07/27 21:35:41 INFO scheduler.DAGScheduler: Stage 3 (count at <console>:15) finished in 0.057 s
13/07/27 21:35:41 INFO spark.SparkContext: Job finished: count at <console>:15, took 0.060056018 s
res3: Long = 1000

scala> s.count()
13/07/27 21:35:41 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:35:41 INFO scheduler.DAGScheduler: Got job 4 (count at <console>:15) with 1 output partitions (allowLocal=false)
13/07/27 21:35:41 INFO scheduler.DAGScheduler: Final stage: Stage 4 (count at <console>:15)
13/07/27 21:35:41 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:35:41 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:35:41 INFO scheduler.DAGScheduler: Submitting Stage 4 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:35:41 INFO scheduler.DAGScheduler: Submitting 1 missing tasks from Stage 4 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:35:41 INFO local.LocalTaskSetManager: Size of task 4 is 1498 bytes
13/07/27 21:35:41 INFO local.LocalScheduler: Running 4
13/07/27 21:35:41 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.1000, 65536)
13/07/27 21:35:41 INFO local.LocalScheduler: Finished 4
13/07/27 21:35:41 INFO scheduler.DAGScheduler: Completed ResultTask(4, 0)
13/07/27 21:35:41 INFO local.LocalScheduler: Remove TaskSet 4.0 from pool 
13/07/27 21:35:41 INFO scheduler.DAGScheduler: Stage 4 (count at <console>:15) finished in 0.052 s
13/07/27 21:35:41 INFO spark.SparkContext: Job finished: count at <console>:15, took 0.055168139 s
res4: Long = 1000

scala> s.count()
13/07/27 21:35:41 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:35:41 INFO scheduler.DAGScheduler: Got job 5 (count at <console>:15) with 1 output partitions (allowLocal=false)
13/07/27 21:35:41 INFO scheduler.DAGScheduler: Final stage: Stage 5 (count at <console>:15)
13/07/27 21:35:41 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:35:41 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:35:41 INFO scheduler.DAGScheduler: Submitting Stage 5 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:35:41 INFO scheduler.DAGScheduler: Submitting 1 missing tasks from Stage 5 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:35:41 INFO local.LocalTaskSetManager: Size of task 5 is 1498 bytes
13/07/27 21:35:41 INFO local.LocalScheduler: Running 5
13/07/27 21:35:41 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.1000, 65536)
13/07/27 21:35:41 INFO local.LocalScheduler: Finished 5
13/07/27 21:35:41 INFO scheduler.DAGScheduler: Completed ResultTask(5, 0)
13/07/27 21:35:41 INFO local.LocalScheduler: Remove TaskSet 5.0 from pool 
13/07/27 21:35:41 INFO scheduler.DAGScheduler: Stage 5 (count at <console>:15) finished in 0.049 s
13/07/27 21:35:41 INFO spark.SparkContext: Job finished: count at <console>:15, took 0.052904567 s
res5: Long = 1000

scala> s.count()
13/07/27 21:35:41 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:35:41 INFO scheduler.DAGScheduler: Got job 6 (count at <console>:15) with 1 output partitions (allowLocal=false)
13/07/27 21:35:41 INFO scheduler.DAGScheduler: Final stage: Stage 6 (count at <console>:15)
13/07/27 21:35:41 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:35:41 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:35:41 INFO scheduler.DAGScheduler: Submitting Stage 6 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:35:41 INFO scheduler.DAGScheduler: Submitting 1 missing tasks from Stage 6 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:35:41 INFO local.LocalTaskSetManager: Size of task 6 is 1498 bytes
13/07/27 21:35:41 INFO local.LocalScheduler: Running 6
13/07/27 21:35:42 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.1000, 65536)
13/07/27 21:35:42 INFO local.LocalScheduler: Finished 6
13/07/27 21:35:42 INFO scheduler.DAGScheduler: Completed ResultTask(6, 0)
13/07/27 21:35:42 INFO local.LocalScheduler: Remove TaskSet 6.0 from pool 
13/07/27 21:35:42 INFO scheduler.DAGScheduler: Stage 6 (count at <console>:15) finished in 0.049 s
13/07/27 21:35:42 INFO spark.SparkContext: Job finished: count at <console>:15, took 0.051905039 s
res6: Long = 1000

scala> s.count()
13/07/27 21:35:42 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:35:42 INFO scheduler.DAGScheduler: Got job 7 (count at <console>:15) with 1 output partitions (allowLocal=false)
13/07/27 21:35:42 INFO scheduler.DAGScheduler: Final stage: Stage 7 (count at <console>:15)
13/07/27 21:35:42 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:35:42 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:35:42 INFO scheduler.DAGScheduler: Submitting Stage 7 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:35:42 INFO scheduler.DAGScheduler: Submitting 1 missing tasks from Stage 7 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:35:42 INFO local.LocalTaskSetManager: Size of task 7 is 1498 bytes
13/07/27 21:35:42 INFO local.LocalScheduler: Running 7
13/07/27 21:35:42 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.1000, 65536)
13/07/27 21:35:42 INFO local.LocalScheduler: Finished 7
13/07/27 21:35:42 INFO scheduler.DAGScheduler: Completed ResultTask(7, 0)
13/07/27 21:35:42 INFO local.LocalScheduler: Remove TaskSet 7.0 from pool 
13/07/27 21:35:42 INFO scheduler.DAGScheduler: Stage 7 (count at <console>:15) finished in 0.052 s
13/07/27 21:35:42 INFO spark.SparkContext: Job finished: count at <console>:15, took 0.054828998 s
res7: Long = 1000

scala> s.count()
13/07/27 21:35:42 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:35:42 INFO scheduler.DAGScheduler: Got job 8 (count at <console>:15) with 1 output partitions (allowLocal=false)
13/07/27 21:35:42 INFO scheduler.DAGScheduler: Final stage: Stage 8 (count at <console>:15)
13/07/27 21:35:42 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:35:42 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:35:42 INFO scheduler.DAGScheduler: Submitting Stage 8 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:35:42 INFO scheduler.DAGScheduler: Submitting 1 missing tasks from Stage 8 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:35:42 INFO local.LocalTaskSetManager: Size of task 8 is 1498 bytes
13/07/27 21:35:42 INFO local.LocalScheduler: Running 8
13/07/27 21:35:42 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.1000, 65536)
13/07/27 21:35:42 INFO local.LocalScheduler: Finished 8
13/07/27 21:35:42 INFO scheduler.DAGScheduler: Completed ResultTask(8, 0)
13/07/27 21:35:42 INFO local.LocalScheduler: Remove TaskSet 8.0 from pool 
13/07/27 21:35:42 INFO scheduler.DAGScheduler: Stage 8 (count at <console>:15) finished in 0.049 s
13/07/27 21:35:42 INFO spark.SparkContext: Job finished: count at <console>:15, took 0.052287491 s
res8: Long = 1000

scala> s.count()
13/07/27 21:35:42 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:35:42 INFO scheduler.DAGScheduler: Got job 9 (count at <console>:15) with 1 output partitions (allowLocal=false)
13/07/27 21:35:42 INFO scheduler.DAGScheduler: Final stage: Stage 9 (count at <console>:15)
13/07/27 21:35:42 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:35:42 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:35:42 INFO scheduler.DAGScheduler: Submitting Stage 9 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:35:42 INFO scheduler.DAGScheduler: Submitting 1 missing tasks from Stage 9 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:35:42 INFO local.LocalTaskSetManager: Size of task 9 is 1498 bytes
13/07/27 21:35:42 INFO local.LocalScheduler: Running 9
13/07/27 21:35:42 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.1000, 65536)
13/07/27 21:35:42 INFO local.LocalScheduler: Finished 9
13/07/27 21:35:42 INFO scheduler.DAGScheduler: Completed ResultTask(9, 0)
13/07/27 21:35:42 INFO local.LocalScheduler: Remove TaskSet 9.0 from pool 
13/07/27 21:35:42 INFO scheduler.DAGScheduler: Stage 9 (count at <console>:15) finished in 0.040 s
13/07/27 21:35:42 INFO spark.SparkContext: Job finished: count at <console>:15, took 0.042557788 s
res9: Long = 1000

scala> s.count()
13/07/27 21:35:43 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:35:43 INFO scheduler.DAGScheduler: Got job 10 (count at <console>:15) with 1 output partitions (allowLocal=false)
13/07/27 21:35:43 INFO scheduler.DAGScheduler: Final stage: Stage 10 (count at <console>:15)
13/07/27 21:35:43 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:35:43 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:35:43 INFO scheduler.DAGScheduler: Submitting Stage 10 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:35:43 INFO scheduler.DAGScheduler: Submitting 1 missing tasks from Stage 10 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:35:43 INFO local.LocalTaskSetManager: Size of task 10 is 1498 bytes
13/07/27 21:35:43 INFO local.LocalScheduler: Running 10
13/07/27 21:35:43 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.1000, 65536)
13/07/27 21:35:43 INFO local.LocalScheduler: Finished 10
13/07/27 21:35:43 INFO scheduler.DAGScheduler: Completed ResultTask(10, 0)
13/07/27 21:35:43 INFO local.LocalScheduler: Remove TaskSet 10.0 from pool 
13/07/27 21:35:43 INFO scheduler.DAGScheduler: Stage 10 (count at <console>:15) finished in 0.044 s
13/07/27 21:35:43 INFO spark.SparkContext: Job finished: count at <console>:15, took 0.046953583 s
res10: Long = 1000

scala> 13/07/27 21:35:43 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:35:43 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:35:43 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:35:43 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:35:43 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:35:43 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:35:43 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:35:43 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage/rdd,null}
Killed 1 processes
Killed 1 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting Tachyon @ tachyon-ec2-0
2013-07-27 21:35:44,759 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data
2013-07-27 21:35:44,763 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_log.data
2013-07-27 21:35:45,250 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/data
2013-07-27 21:35:45,262 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/workers

restaring tachyon
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Killed 0 processes
Killed 0 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting RamFS: /mnt/ramdisk
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata -Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Starting master @ tachyon-ec2-0
Starting worker @ tachyon-ec2-0

spark-shell count
11479 tachyon.Master
11506 tachyon.Worker

Going to fadvise /mnt/tachyon/hit_data.tsv.10000 as mode POSIX_FADV_DONTNEED
offset: 0
length: 12330369
mode: POSIX_FADV_DONTNEED
WIN
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/ubuntu/work/tachyon/target/tachyon-0.3.0-SNAPSHOT-jar-with-dependencies.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/ubuntu/work/spark/lib_managed/jars/slf4j-log4j12-1.7.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
Welcome to
      ____              __  
     / __/__  ___ _____/ /__
    _\ \/ _ \/ _ `/ __/  '_/
   /___/ .__/\_,_/_/ /_/\_\   version 0.8.0
      /_/                  

Using Scala version 2.9.3 (OpenJDK 64-Bit Server VM, Java 1.7.0_25)
Initializing interpreter...
13/07/27 21:35:51 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:35:51 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:40478
Creating SparkContext...
13/07/27 21:36:00 INFO slf4j.Slf4jEventHandler: Slf4jEventHandler started
13/07/27 21:36:00 INFO spark.SparkEnv: Registering BlockManagerMaster
13/07/27 21:36:01 INFO storage.MemoryStore: MemoryStore started with capacity 1295.4 MB.
13/07/27 21:36:01 INFO storage.DiskStore: Created local directory at /tmp/spark-local-20130727213601-966a
13/07/27 21:36:01 INFO network.ConnectionManager: Bound socket to port 39554 with id = ConnectionManagerId(tachyon-ec2-0,39554)
13/07/27 21:36:01 INFO storage.BlockManagerMaster: Trying to register BlockManager
13/07/27 21:36:01 INFO storage.BlockManagerMasterActor$BlockManagerInfo: Registering block manager tachyon-ec2-0:39554 with 1295.4 MB RAM
13/07/27 21:36:01 INFO storage.BlockManagerMaster: Registered BlockManager
13/07/27 21:36:01 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:36:01 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:58527
13/07/27 21:36:01 INFO broadcast.HttpBroadcast: Broadcast server started at http://10.151.80.188:58527
13/07/27 21:36:01 INFO spark.SparkEnv: Registering MapOutputTracker
13/07/27 21:36:01 INFO spark.HttpFileServer: HTTP File server directory is /tmp/spark-5fcd5f6d-1599-4d50-9a93-05b2ce95924c
13/07/27 21:36:01 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:36:01 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:45079
13/07/27 21:36:01 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:36:01 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage/rdd,null}
13/07/27 21:36:01 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:36:01 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:36:01 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:36:01 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:36:01 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:36:01 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:36:01 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:36:01 INFO server.AbstractConnector: Started SelectChannelConnector@0.0.0.0:33000
13/07/27 21:36:01 INFO ui.SparkUI: Started Spark Web UI at http://tachyon-ec2-0:33000
Spark context available as sc.
Type in expressions to have them evaluated.
Type :help for more information.

scala> val s = sc.textFile("tachyon://tachyon-ec2-0:19998/hit_data.tsv.10000")
13/07/27 21:36:02 INFO storage.MemoryStore: ensureFreeSpace(58423) called with curMem=0, maxMem=1358297825
13/07/27 21:36:02 INFO storage.MemoryStore: Block broadcast_0 stored as values to memory (estimated size 57.1 KB, free 1295.3 MB)
s: spark.RDD[String] = MappedRDD[1] at textFile at <console>:12

scala> s.count()
13/07/27 21:36:02 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
13/07/27 21:36:02 WARN snappy.LoadSnappy: Snappy native library not loaded
13/07/27 21:36:02 INFO : initialize(tachyon://tachyon-ec2-0:19998/hit_data.tsv.10000, Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml). Connecting to Tachyon: tachyon://tachyon-ec2-0:19998/hit_data.tsv.10000
13/07/27 21:36:02 INFO : Trying to connect master @ tachyon-ec2-0/10.151.80.188:19998
13/07/27 21:36:02 INFO : User registered at the master tachyon-ec2-0/10.151.80.188:19998 got UserId 1
13/07/27 21:36:02 INFO : Trying to get local worker host : tachyon-ec2-0
13/07/27 21:36:02 INFO : Connecting local worker @ tachyon-ec2-0/10.151.80.188:29998
13/07/27 21:36:02 INFO : tachyon://tachyon-ec2-0:19998 tachyon://tachyon-ec2-0:19998 file:///mnt/tachyon
13/07/27 21:36:02 INFO : getFileStatus(/hit_data.tsv.10000): HDFS Path: file:/mnt/tachyon/hit_data.tsv.10000 TPath: tachyon://tachyon-ec2-0:19998/hit_data.tsv.10000
13/07/27 21:36:02 INFO : tachyon.client.TachyonFS@4bf3f11c file:///mnt/tachyon /hit_data.tsv.10000 tachyon.PrefixList@7c5a8c38
13/07/27 21:36:03 INFO : Create tachyon file /hit_data.tsv.10000 with file id 2 and checkpoint location file:///mnt/tachyon/hit_data.tsv.10000
13/07/27 21:36:03 INFO mapred.FileInputFormat: Total input paths to process : 1
13/07/27 21:36:03 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:36:03 INFO scheduler.DAGScheduler: Got job 0 (count at <console>:15) with 1 output partitions (allowLocal=false)
13/07/27 21:36:03 INFO scheduler.DAGScheduler: Final stage: Stage 0 (count at <console>:15)
13/07/27 21:36:03 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:36:03 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:36:03 INFO scheduler.DAGScheduler: Submitting Stage 0 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:36:03 INFO scheduler.DAGScheduler: Submitting 1 missing tasks from Stage 0 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:36:03 INFO local.LocalTaskSetManager: Size of task 0 is 1498 bytes
13/07/27 21:36:03 INFO local.LocalScheduler: Running 0
13/07/27 21:36:03 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.10000, 65536)
13/07/27 21:36:03 INFO : /mnt/ramdisk/tachyonworker/2147483648 is not on local disk.
13/07/27 21:36:03 INFO : Try to find and read from remote workers.
13/07/27 21:36:03 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:36:03 INFO : Folder /mnt/ramdisk/tachyonworker/users/1 was created!
13/07/27 21:36:03 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483648 was created!
13/07/27 21:36:04 INFO local.LocalScheduler: Finished 0
13/07/27 21:36:04 INFO local.LocalScheduler: Remove TaskSet 0.0 from pool 
13/07/27 21:36:04 INFO scheduler.DAGScheduler: Completed ResultTask(0, 0)
13/07/27 21:36:04 INFO scheduler.DAGScheduler: Stage 0 (count at <console>:15) finished in 0.634 s
13/07/27 21:36:04 INFO spark.SparkContext: Job finished: count at <console>:15, took 0.678248112 s
res0: Long = 10000

scala> s.count()
13/07/27 21:36:04 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:36:04 INFO scheduler.DAGScheduler: Got job 1 (count at <console>:15) with 1 output partitions (allowLocal=false)
13/07/27 21:36:04 INFO scheduler.DAGScheduler: Final stage: Stage 1 (count at <console>:15)
13/07/27 21:36:04 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:36:04 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:36:04 INFO scheduler.DAGScheduler: Submitting Stage 1 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:36:04 INFO scheduler.DAGScheduler: Submitting 1 missing tasks from Stage 1 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:36:04 INFO local.LocalTaskSetManager: Size of task 1 is 1499 bytes
13/07/27 21:36:04 INFO local.LocalScheduler: Running 1
13/07/27 21:36:04 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.10000, 65536)
13/07/27 21:36:04 INFO local.LocalScheduler: Finished 1
13/07/27 21:36:04 INFO scheduler.DAGScheduler: Completed ResultTask(1, 0)
13/07/27 21:36:04 INFO local.LocalScheduler: Remove TaskSet 1.0 from pool 
13/07/27 21:36:04 INFO scheduler.DAGScheduler: Stage 1 (count at <console>:15) finished in 0.114 s
13/07/27 21:36:04 INFO spark.SparkContext: Job finished: count at <console>:15, took 0.117145233 s
res1: Long = 10000

scala> s.count()
13/07/27 21:36:04 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:36:04 INFO scheduler.DAGScheduler: Got job 2 (count at <console>:15) with 1 output partitions (allowLocal=false)
13/07/27 21:36:04 INFO scheduler.DAGScheduler: Final stage: Stage 2 (count at <console>:15)
13/07/27 21:36:04 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:36:04 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:36:04 INFO scheduler.DAGScheduler: Submitting Stage 2 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:36:04 INFO scheduler.DAGScheduler: Submitting 1 missing tasks from Stage 2 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:36:04 INFO local.LocalTaskSetManager: Size of task 2 is 1499 bytes
13/07/27 21:36:04 INFO local.LocalScheduler: Running 2
13/07/27 21:36:04 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.10000, 65536)
13/07/27 21:36:04 INFO local.LocalScheduler: Finished 2
13/07/27 21:36:04 INFO scheduler.DAGScheduler: Completed ResultTask(2, 0)
13/07/27 21:36:04 INFO local.LocalScheduler: Remove TaskSet 2.0 from pool 
13/07/27 21:36:04 INFO scheduler.DAGScheduler: Stage 2 (count at <console>:15) finished in 0.125 s
13/07/27 21:36:04 INFO spark.SparkContext: Job finished: count at <console>:15, took 0.128094153 s
res2: Long = 10000

scala> s.count()
13/07/27 21:36:05 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:36:05 INFO scheduler.DAGScheduler: Got job 3 (count at <console>:15) with 1 output partitions (allowLocal=false)
13/07/27 21:36:05 INFO scheduler.DAGScheduler: Final stage: Stage 3 (count at <console>:15)
13/07/27 21:36:05 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:36:05 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:36:05 INFO scheduler.DAGScheduler: Submitting Stage 3 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:36:05 INFO scheduler.DAGScheduler: Submitting 1 missing tasks from Stage 3 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:36:05 INFO local.LocalTaskSetManager: Size of task 3 is 1499 bytes
13/07/27 21:36:05 INFO local.LocalScheduler: Running 3
13/07/27 21:36:05 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.10000, 65536)
13/07/27 21:36:05 INFO local.LocalScheduler: Finished 3
13/07/27 21:36:05 INFO scheduler.DAGScheduler: Completed ResultTask(3, 0)
13/07/27 21:36:05 INFO local.LocalScheduler: Remove TaskSet 3.0 from pool 
13/07/27 21:36:05 INFO scheduler.DAGScheduler: Stage 3 (count at <console>:15) finished in 0.111 s
13/07/27 21:36:05 INFO spark.SparkContext: Job finished: count at <console>:15, took 0.113939925 s
res3: Long = 10000

scala> s.count()
13/07/27 21:36:05 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:36:05 INFO scheduler.DAGScheduler: Got job 4 (count at <console>:15) with 1 output partitions (allowLocal=false)
13/07/27 21:36:05 INFO scheduler.DAGScheduler: Final stage: Stage 4 (count at <console>:15)
13/07/27 21:36:05 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:36:05 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:36:05 INFO scheduler.DAGScheduler: Submitting Stage 4 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:36:05 INFO scheduler.DAGScheduler: Submitting 1 missing tasks from Stage 4 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:36:05 INFO local.LocalTaskSetManager: Size of task 4 is 1499 bytes
13/07/27 21:36:05 INFO local.LocalScheduler: Running 4
13/07/27 21:36:05 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.10000, 65536)
13/07/27 21:36:05 INFO local.LocalScheduler: Finished 4
13/07/27 21:36:05 INFO scheduler.DAGScheduler: Completed ResultTask(4, 0)
13/07/27 21:36:05 INFO local.LocalScheduler: Remove TaskSet 4.0 from pool 
13/07/27 21:36:05 INFO scheduler.DAGScheduler: Stage 4 (count at <console>:15) finished in 0.240 s
13/07/27 21:36:05 INFO spark.SparkContext: Job finished: count at <console>:15, took 0.242796474 s
res4: Long = 10000

scala> s.count()
13/07/27 21:36:06 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:36:06 INFO scheduler.DAGScheduler: Got job 5 (count at <console>:15) with 1 output partitions (allowLocal=false)
13/07/27 21:36:06 INFO scheduler.DAGScheduler: Final stage: Stage 5 (count at <console>:15)
13/07/27 21:36:06 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:36:06 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:36:06 INFO scheduler.DAGScheduler: Submitting Stage 5 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:36:06 INFO scheduler.DAGScheduler: Submitting 1 missing tasks from Stage 5 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:36:06 INFO local.LocalTaskSetManager: Size of task 5 is 1499 bytes
13/07/27 21:36:06 INFO local.LocalScheduler: Running 5
13/07/27 21:36:06 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.10000, 65536)
13/07/27 21:36:06 INFO local.LocalScheduler: Finished 5
13/07/27 21:36:06 INFO scheduler.DAGScheduler: Completed ResultTask(5, 0)
13/07/27 21:36:06 INFO local.LocalScheduler: Remove TaskSet 5.0 from pool 
13/07/27 21:36:06 INFO scheduler.DAGScheduler: Stage 5 (count at <console>:15) finished in 0.112 s
13/07/27 21:36:06 INFO spark.SparkContext: Job finished: count at <console>:15, took 0.115973191 s
res5: Long = 10000

scala> s.count()
13/07/27 21:36:06 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:36:06 INFO scheduler.DAGScheduler: Got job 6 (count at <console>:15) with 1 output partitions (allowLocal=false)
13/07/27 21:36:06 INFO scheduler.DAGScheduler: Final stage: Stage 6 (count at <console>:15)
13/07/27 21:36:06 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:36:06 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:36:06 INFO scheduler.DAGScheduler: Submitting Stage 6 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:36:06 INFO scheduler.DAGScheduler: Submitting 1 missing tasks from Stage 6 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:36:06 INFO local.LocalTaskSetManager: Size of task 6 is 1499 bytes
13/07/27 21:36:06 INFO local.LocalScheduler: Running 6
13/07/27 21:36:06 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.10000, 65536)
13/07/27 21:36:06 INFO local.LocalScheduler: Finished 6
13/07/27 21:36:06 INFO scheduler.DAGScheduler: Completed ResultTask(6, 0)
13/07/27 21:36:06 INFO local.LocalScheduler: Remove TaskSet 6.0 from pool 
13/07/27 21:36:06 INFO scheduler.DAGScheduler: Stage 6 (count at <console>:15) finished in 0.115 s
13/07/27 21:36:06 INFO spark.SparkContext: Job finished: count at <console>:15, took 0.117468556 s
res6: Long = 10000

scala> s.count()
13/07/27 21:36:06 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:36:06 INFO scheduler.DAGScheduler: Got job 7 (count at <console>:15) with 1 output partitions (allowLocal=false)
13/07/27 21:36:06 INFO scheduler.DAGScheduler: Final stage: Stage 7 (count at <console>:15)
13/07/27 21:36:06 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:36:06 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:36:06 INFO scheduler.DAGScheduler: Submitting Stage 7 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:36:06 INFO scheduler.DAGScheduler: Submitting 1 missing tasks from Stage 7 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:36:06 INFO local.LocalTaskSetManager: Size of task 7 is 1499 bytes
13/07/27 21:36:06 INFO local.LocalScheduler: Running 7
13/07/27 21:36:06 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.10000, 65536)
13/07/27 21:36:06 INFO local.LocalScheduler: Finished 7
13/07/27 21:36:06 INFO scheduler.DAGScheduler: Completed ResultTask(7, 0)
13/07/27 21:36:06 INFO local.LocalScheduler: Remove TaskSet 7.0 from pool 
13/07/27 21:36:06 INFO scheduler.DAGScheduler: Stage 7 (count at <console>:15) finished in 0.113 s
13/07/27 21:36:06 INFO spark.SparkContext: Job finished: count at <console>:15, took 0.115742104 s
res7: Long = 10000

scala> s.count()
13/07/27 21:36:07 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:36:07 INFO scheduler.DAGScheduler: Got job 8 (count at <console>:15) with 1 output partitions (allowLocal=false)
13/07/27 21:36:07 INFO scheduler.DAGScheduler: Final stage: Stage 8 (count at <console>:15)
13/07/27 21:36:07 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:36:07 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:36:07 INFO scheduler.DAGScheduler: Submitting Stage 8 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:36:07 INFO scheduler.DAGScheduler: Submitting 1 missing tasks from Stage 8 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:36:07 INFO local.LocalTaskSetManager: Size of task 8 is 1499 bytes
13/07/27 21:36:07 INFO local.LocalScheduler: Running 8
13/07/27 21:36:07 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.10000, 65536)
13/07/27 21:36:07 INFO local.LocalScheduler: Finished 8
13/07/27 21:36:07 INFO scheduler.DAGScheduler: Completed ResultTask(8, 0)
13/07/27 21:36:07 INFO local.LocalScheduler: Remove TaskSet 8.0 from pool 
13/07/27 21:36:07 INFO scheduler.DAGScheduler: Stage 8 (count at <console>:15) finished in 0.109 s
13/07/27 21:36:07 INFO spark.SparkContext: Job finished: count at <console>:15, took 0.112722515 s
res8: Long = 10000

scala> s.count()
13/07/27 21:36:07 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:36:07 INFO scheduler.DAGScheduler: Got job 9 (count at <console>:15) with 1 output partitions (allowLocal=false)
13/07/27 21:36:07 INFO scheduler.DAGScheduler: Final stage: Stage 9 (count at <console>:15)
13/07/27 21:36:07 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:36:07 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:36:07 INFO scheduler.DAGScheduler: Submitting Stage 9 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:36:07 INFO scheduler.DAGScheduler: Submitting 1 missing tasks from Stage 9 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:36:07 INFO local.LocalTaskSetManager: Size of task 9 is 1499 bytes
13/07/27 21:36:07 INFO local.LocalScheduler: Running 9
13/07/27 21:36:07 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.10000, 65536)
13/07/27 21:36:07 INFO local.LocalScheduler: Finished 9
13/07/27 21:36:07 INFO scheduler.DAGScheduler: Completed ResultTask(9, 0)
13/07/27 21:36:07 INFO local.LocalScheduler: Remove TaskSet 9.0 from pool 
13/07/27 21:36:07 INFO scheduler.DAGScheduler: Stage 9 (count at <console>:15) finished in 0.100 s
13/07/27 21:36:07 INFO spark.SparkContext: Job finished: count at <console>:15, took 0.102804076 s
res9: Long = 10000

scala> s.count()
13/07/27 21:36:07 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:36:07 INFO scheduler.DAGScheduler: Got job 10 (count at <console>:15) with 1 output partitions (allowLocal=false)
13/07/27 21:36:07 INFO scheduler.DAGScheduler: Final stage: Stage 10 (count at <console>:15)
13/07/27 21:36:07 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:36:07 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:36:07 INFO scheduler.DAGScheduler: Submitting Stage 10 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:36:07 INFO scheduler.DAGScheduler: Submitting 1 missing tasks from Stage 10 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:36:07 INFO local.LocalTaskSetManager: Size of task 10 is 1499 bytes
13/07/27 21:36:07 INFO local.LocalScheduler: Running 10
13/07/27 21:36:07 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.10000, 65536)
13/07/27 21:36:07 INFO local.LocalScheduler: Finished 10
13/07/27 21:36:07 INFO scheduler.DAGScheduler: Completed ResultTask(10, 0)
13/07/27 21:36:07 INFO local.LocalScheduler: Remove TaskSet 10.0 from pool 
13/07/27 21:36:07 INFO scheduler.DAGScheduler: Stage 10 (count at <console>:15) finished in 0.100 s
13/07/27 21:36:07 INFO spark.SparkContext: Job finished: count at <console>:15, took 0.103049151 s
res10: Long = 10000

scala> 13/07/27 21:36:07 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:36:07 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:36:07 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:36:07 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:36:07 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:36:07 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:36:07 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:36:07 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage/rdd,null}
Killed 1 processes
Killed 1 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting Tachyon @ tachyon-ec2-0
2013-07-27 21:36:09,529 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data
2013-07-27 21:36:09,533 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_log.data
2013-07-27 21:36:10,017 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/data
2013-07-27 21:36:10,029 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/workers

restaring tachyon
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Killed 0 processes
Killed 0 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting RamFS: /mnt/ramdisk
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata -Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Starting master @ tachyon-ec2-0
Starting worker @ tachyon-ec2-0

spark-shell count
12140 tachyon.Master
12167 tachyon.Worker

Going to fadvise /mnt/tachyon/hit_data.tsv.100000 as mode POSIX_FADV_DONTNEED
offset: 0
length: 125141299
mode: POSIX_FADV_DONTNEED
WIN
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/ubuntu/work/tachyon/target/tachyon-0.3.0-SNAPSHOT-jar-with-dependencies.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/ubuntu/work/spark/lib_managed/jars/slf4j-log4j12-1.7.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
Welcome to
      ____              __  
     / __/__  ___ _____/ /__
    _\ \/ _ \/ _ `/ __/  '_/
   /___/ .__/\_,_/_/ /_/\_\   version 0.8.0
      /_/                  

Using Scala version 2.9.3 (OpenJDK 64-Bit Server VM, Java 1.7.0_25)
Initializing interpreter...
13/07/27 21:36:16 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:36:16 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:41737
Creating SparkContext...
13/07/27 21:36:25 INFO slf4j.Slf4jEventHandler: Slf4jEventHandler started
13/07/27 21:36:25 INFO spark.SparkEnv: Registering BlockManagerMaster
13/07/27 21:36:25 INFO storage.MemoryStore: MemoryStore started with capacity 1295.4 MB.
13/07/27 21:36:25 INFO storage.DiskStore: Created local directory at /tmp/spark-local-20130727213625-5069
13/07/27 21:36:25 INFO network.ConnectionManager: Bound socket to port 50160 with id = ConnectionManagerId(tachyon-ec2-0,50160)
13/07/27 21:36:25 INFO storage.BlockManagerMaster: Trying to register BlockManager
13/07/27 21:36:25 INFO storage.BlockManagerMasterActor$BlockManagerInfo: Registering block manager tachyon-ec2-0:50160 with 1295.4 MB RAM
13/07/27 21:36:25 INFO storage.BlockManagerMaster: Registered BlockManager
13/07/27 21:36:25 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:36:25 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:35026
13/07/27 21:36:25 INFO broadcast.HttpBroadcast: Broadcast server started at http://10.151.80.188:35026
13/07/27 21:36:25 INFO spark.SparkEnv: Registering MapOutputTracker
13/07/27 21:36:25 INFO spark.HttpFileServer: HTTP File server directory is /tmp/spark-9d7f7442-b1f9-43be-bc29-aa253ffe041e
13/07/27 21:36:25 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:36:25 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:35674
13/07/27 21:36:25 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:36:25 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage/rdd,null}
13/07/27 21:36:25 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:36:25 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:36:25 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:36:25 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:36:25 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:36:25 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:36:25 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:36:25 INFO server.AbstractConnector: Started SelectChannelConnector@0.0.0.0:33000
13/07/27 21:36:26 INFO ui.SparkUI: Started Spark Web UI at http://tachyon-ec2-0:33000
Spark context available as sc.
Type in expressions to have them evaluated.
Type :help for more information.

scala> val s = sc.textFile("tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000")
13/07/27 21:36:27 INFO storage.MemoryStore: ensureFreeSpace(58431) called with curMem=0, maxMem=1358297825
13/07/27 21:36:27 INFO storage.MemoryStore: Block broadcast_0 stored as values to memory (estimated size 57.1 KB, free 1295.3 MB)
s: spark.RDD[String] = MappedRDD[1] at textFile at <console>:12

scala> s.count()
13/07/27 21:36:27 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
13/07/27 21:36:27 WARN snappy.LoadSnappy: Snappy native library not loaded
13/07/27 21:36:27 INFO : initialize(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000, Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml). Connecting to Tachyon: tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000
13/07/27 21:36:27 INFO : Trying to connect master @ tachyon-ec2-0/10.151.80.188:19998
13/07/27 21:36:27 INFO : User registered at the master tachyon-ec2-0/10.151.80.188:19998 got UserId 1
13/07/27 21:36:27 INFO : Trying to get local worker host : tachyon-ec2-0
13/07/27 21:36:27 INFO : Connecting local worker @ tachyon-ec2-0/10.151.80.188:29998
13/07/27 21:36:27 INFO : tachyon://tachyon-ec2-0:19998 tachyon://tachyon-ec2-0:19998 file:///mnt/tachyon
13/07/27 21:36:27 INFO : getFileStatus(/hit_data.tsv.100000): HDFS Path: file:/mnt/tachyon/hit_data.tsv.100000 TPath: tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000
13/07/27 21:36:27 INFO : tachyon.client.TachyonFS@5390cdba file:///mnt/tachyon /hit_data.tsv.100000 tachyon.PrefixList@47b29932
13/07/27 21:36:28 INFO : Create tachyon file /hit_data.tsv.100000 with file id 2 and checkpoint location file:///mnt/tachyon/hit_data.tsv.100000
13/07/27 21:36:28 INFO mapred.FileInputFormat: Total input paths to process : 1
13/07/27 21:36:28 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:36:28 INFO scheduler.DAGScheduler: Got job 0 (count at <console>:15) with 4 output partitions (allowLocal=false)
13/07/27 21:36:28 INFO scheduler.DAGScheduler: Final stage: Stage 0 (count at <console>:15)
13/07/27 21:36:28 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:36:28 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:36:28 INFO scheduler.DAGScheduler: Submitting Stage 0 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:36:28 INFO scheduler.DAGScheduler: Submitting 4 missing tasks from Stage 0 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:36:28 INFO local.LocalTaskSetManager: Size of task 0 is 1499 bytes
13/07/27 21:36:28 INFO local.LocalScheduler: Running 0
13/07/27 21:36:28 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000, 65536)
13/07/27 21:36:28 INFO : /mnt/ramdisk/tachyonworker/2147483648 is not on local disk.
13/07/27 21:36:28 INFO : Try to find and read from remote workers.
13/07/27 21:36:28 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:36:28 INFO : Folder /mnt/ramdisk/tachyonworker/users/1 was created!
13/07/27 21:36:28 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483648 was created!
13/07/27 21:36:29 INFO : /mnt/ramdisk/tachyonworker/2147483649 is not on local disk.
13/07/27 21:36:29 INFO : Try to find and read from remote workers.
13/07/27 21:36:29 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:36:29 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483649 was created!
13/07/27 21:36:29 INFO local.LocalScheduler: Finished 0
13/07/27 21:36:29 INFO local.LocalTaskSetManager: Size of task 1 is 1499 bytes
13/07/27 21:36:29 INFO local.LocalScheduler: Running 1
13/07/27 21:36:29 INFO scheduler.DAGScheduler: Completed ResultTask(0, 0)
13/07/27 21:36:29 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000, 65536)
13/07/27 21:36:30 INFO : /mnt/ramdisk/tachyonworker/2147483650 is not on local disk.
13/07/27 21:36:30 INFO : Try to find and read from remote workers.
13/07/27 21:36:30 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:36:30 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483650 was created!
13/07/27 21:36:30 INFO local.LocalScheduler: Finished 1
13/07/27 21:36:30 INFO scheduler.DAGScheduler: Completed ResultTask(0, 1)
13/07/27 21:36:30 INFO local.LocalTaskSetManager: Size of task 2 is 1499 bytes
13/07/27 21:36:30 INFO local.LocalScheduler: Running 2
13/07/27 21:36:30 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000, 65536)
13/07/27 21:36:30 INFO : /mnt/ramdisk/tachyonworker/2147483651 is not on local disk.
13/07/27 21:36:30 INFO : Try to find and read from remote workers.
13/07/27 21:36:30 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:36:30 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483651 was created!
13/07/27 21:36:31 INFO local.LocalScheduler: Finished 2
13/07/27 21:36:31 INFO scheduler.DAGScheduler: Completed ResultTask(0, 2)
13/07/27 21:36:31 INFO local.LocalTaskSetManager: Size of task 3 is 1499 bytes
13/07/27 21:36:31 INFO local.LocalScheduler: Running 3
13/07/27 21:36:31 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000, 65536)
13/07/27 21:36:31 INFO local.LocalScheduler: Finished 3
13/07/27 21:36:31 INFO scheduler.DAGScheduler: Completed ResultTask(0, 3)
13/07/27 21:36:31 INFO local.LocalScheduler: Remove TaskSet 0.0 from pool 
13/07/27 21:36:31 INFO scheduler.DAGScheduler: Stage 0 (count at <console>:15) finished in 2.800 s
13/07/27 21:36:31 INFO spark.SparkContext: Job finished: count at <console>:15, took 2.846039954 s
res0: Long = 100002

scala> s.count()
13/07/27 21:36:31 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:36:31 INFO scheduler.DAGScheduler: Got job 1 (count at <console>:15) with 4 output partitions (allowLocal=false)
13/07/27 21:36:31 INFO scheduler.DAGScheduler: Final stage: Stage 1 (count at <console>:15)
13/07/27 21:36:31 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:36:31 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:36:31 INFO scheduler.DAGScheduler: Submitting Stage 1 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:36:31 INFO scheduler.DAGScheduler: Submitting 4 missing tasks from Stage 1 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:36:31 INFO local.LocalTaskSetManager: Size of task 4 is 1500 bytes
13/07/27 21:36:31 INFO local.LocalScheduler: Running 4
13/07/27 21:36:31 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000, 65536)
13/07/27 21:36:31 INFO local.LocalScheduler: Finished 4
13/07/27 21:36:31 INFO scheduler.DAGScheduler: Completed ResultTask(1, 0)
13/07/27 21:36:31 INFO local.LocalTaskSetManager: Size of task 5 is 1500 bytes
13/07/27 21:36:31 INFO local.LocalScheduler: Running 5
13/07/27 21:36:31 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000, 65536)
13/07/27 21:36:32 INFO local.LocalScheduler: Finished 5
13/07/27 21:36:32 INFO scheduler.DAGScheduler: Completed ResultTask(1, 1)
13/07/27 21:36:32 INFO local.LocalTaskSetManager: Size of task 6 is 1500 bytes
13/07/27 21:36:32 INFO local.LocalScheduler: Running 6
13/07/27 21:36:32 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000, 65536)
13/07/27 21:36:32 INFO local.LocalScheduler: Finished 6
13/07/27 21:36:32 INFO scheduler.DAGScheduler: Completed ResultTask(1, 2)
13/07/27 21:36:32 INFO local.LocalTaskSetManager: Size of task 7 is 1500 bytes
13/07/27 21:36:32 INFO local.LocalScheduler: Running 7
13/07/27 21:36:32 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000, 65536)
13/07/27 21:36:32 INFO local.LocalScheduler: Finished 7
13/07/27 21:36:32 INFO scheduler.DAGScheduler: Completed ResultTask(1, 3)
13/07/27 21:36:32 INFO local.LocalScheduler: Remove TaskSet 1.0 from pool 
13/07/27 21:36:32 INFO scheduler.DAGScheduler: Stage 1 (count at <console>:15) finished in 0.955 s
13/07/27 21:36:32 INFO spark.SparkContext: Job finished: count at <console>:15, took 0.959368989 s
res1: Long = 100002

scala> s.count()
13/07/27 21:36:32 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:36:32 INFO scheduler.DAGScheduler: Got job 2 (count at <console>:15) with 4 output partitions (allowLocal=false)
13/07/27 21:36:32 INFO scheduler.DAGScheduler: Final stage: Stage 2 (count at <console>:15)
13/07/27 21:36:32 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:36:32 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:36:32 INFO scheduler.DAGScheduler: Submitting Stage 2 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:36:32 INFO scheduler.DAGScheduler: Submitting 4 missing tasks from Stage 2 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:36:32 INFO local.LocalTaskSetManager: Size of task 8 is 1500 bytes
13/07/27 21:36:32 INFO local.LocalScheduler: Running 8
13/07/27 21:36:32 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000, 65536)
13/07/27 21:36:33 INFO local.LocalScheduler: Finished 8
13/07/27 21:36:33 INFO scheduler.DAGScheduler: Completed ResultTask(2, 0)
13/07/27 21:36:33 INFO local.LocalTaskSetManager: Size of task 9 is 1500 bytes
13/07/27 21:36:33 INFO local.LocalScheduler: Running 9
13/07/27 21:36:33 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000, 65536)
13/07/27 21:36:33 INFO local.LocalScheduler: Finished 9
13/07/27 21:36:33 INFO scheduler.DAGScheduler: Completed ResultTask(2, 1)
13/07/27 21:36:33 INFO local.LocalTaskSetManager: Size of task 10 is 1500 bytes
13/07/27 21:36:33 INFO local.LocalScheduler: Running 10
13/07/27 21:36:33 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000, 65536)
13/07/27 21:36:33 INFO local.LocalScheduler: Finished 10
13/07/27 21:36:33 INFO scheduler.DAGScheduler: Completed ResultTask(2, 2)
13/07/27 21:36:33 INFO local.LocalTaskSetManager: Size of task 11 is 1500 bytes
13/07/27 21:36:33 INFO local.LocalScheduler: Running 11
13/07/27 21:36:33 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000, 65536)
13/07/27 21:36:33 INFO local.LocalScheduler: Finished 11
13/07/27 21:36:33 INFO scheduler.DAGScheduler: Completed ResultTask(2, 3)
13/07/27 21:36:33 INFO local.LocalScheduler: Remove TaskSet 2.0 from pool 
13/07/27 21:36:33 INFO scheduler.DAGScheduler: Stage 2 (count at <console>:15) finished in 0.931 s
13/07/27 21:36:33 INFO spark.SparkContext: Job finished: count at <console>:15, took 0.935241754 s
res2: Long = 100002

scala> s.count()
13/07/27 21:36:33 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:36:33 INFO scheduler.DAGScheduler: Got job 3 (count at <console>:15) with 4 output partitions (allowLocal=false)
13/07/27 21:36:33 INFO scheduler.DAGScheduler: Final stage: Stage 3 (count at <console>:15)
13/07/27 21:36:33 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:36:33 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:36:33 INFO scheduler.DAGScheduler: Submitting Stage 3 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:36:33 INFO scheduler.DAGScheduler: Submitting 4 missing tasks from Stage 3 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:36:33 INFO local.LocalTaskSetManager: Size of task 12 is 1500 bytes
13/07/27 21:36:33 INFO local.LocalScheduler: Running 12
13/07/27 21:36:34 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000, 65536)
13/07/27 21:36:34 INFO local.LocalScheduler: Finished 12
13/07/27 21:36:34 INFO scheduler.DAGScheduler: Completed ResultTask(3, 0)
13/07/27 21:36:34 INFO local.LocalTaskSetManager: Size of task 13 is 1500 bytes
13/07/27 21:36:34 INFO local.LocalScheduler: Running 13
13/07/27 21:36:34 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000, 65536)
13/07/27 21:36:34 INFO local.LocalScheduler: Finished 13
13/07/27 21:36:34 INFO scheduler.DAGScheduler: Completed ResultTask(3, 1)
13/07/27 21:36:34 INFO local.LocalTaskSetManager: Size of task 14 is 1500 bytes
13/07/27 21:36:34 INFO local.LocalScheduler: Running 14
13/07/27 21:36:34 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000, 65536)
13/07/27 21:36:34 INFO local.LocalScheduler: Finished 14
13/07/27 21:36:34 INFO scheduler.DAGScheduler: Completed ResultTask(3, 2)
13/07/27 21:36:34 INFO local.LocalTaskSetManager: Size of task 15 is 1500 bytes
13/07/27 21:36:34 INFO local.LocalScheduler: Running 15
13/07/27 21:36:34 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000, 65536)
13/07/27 21:36:34 INFO local.LocalScheduler: Finished 15
13/07/27 21:36:34 INFO scheduler.DAGScheduler: Completed ResultTask(3, 3)
13/07/27 21:36:34 INFO local.LocalScheduler: Remove TaskSet 3.0 from pool 
13/07/27 21:36:34 INFO scheduler.DAGScheduler: Stage 3 (count at <console>:15) finished in 0.911 s
13/07/27 21:36:34 INFO spark.SparkContext: Job finished: count at <console>:15, took 0.914807577 s
res3: Long = 100002

scala> s.count()
13/07/27 21:36:35 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:36:35 INFO scheduler.DAGScheduler: Got job 4 (count at <console>:15) with 4 output partitions (allowLocal=false)
13/07/27 21:36:35 INFO scheduler.DAGScheduler: Final stage: Stage 4 (count at <console>:15)
13/07/27 21:36:35 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:36:35 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:36:35 INFO scheduler.DAGScheduler: Submitting Stage 4 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:36:35 INFO scheduler.DAGScheduler: Submitting 4 missing tasks from Stage 4 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:36:35 INFO local.LocalTaskSetManager: Size of task 16 is 1500 bytes
13/07/27 21:36:35 INFO local.LocalScheduler: Running 16
13/07/27 21:36:35 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000, 65536)
13/07/27 21:36:35 INFO local.LocalScheduler: Finished 16
13/07/27 21:36:35 INFO scheduler.DAGScheduler: Completed ResultTask(4, 0)
13/07/27 21:36:35 INFO local.LocalTaskSetManager: Size of task 17 is 1500 bytes
13/07/27 21:36:35 INFO local.LocalScheduler: Running 17
13/07/27 21:36:35 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000, 65536)
13/07/27 21:36:35 INFO local.LocalScheduler: Finished 17
13/07/27 21:36:35 INFO scheduler.DAGScheduler: Completed ResultTask(4, 1)
13/07/27 21:36:35 INFO local.LocalTaskSetManager: Size of task 18 is 1500 bytes
13/07/27 21:36:35 INFO local.LocalScheduler: Running 18
13/07/27 21:36:35 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000, 65536)
13/07/27 21:36:35 INFO local.LocalScheduler: Finished 18
13/07/27 21:36:35 INFO scheduler.DAGScheduler: Completed ResultTask(4, 2)
13/07/27 21:36:35 INFO local.LocalTaskSetManager: Size of task 19 is 1500 bytes
13/07/27 21:36:35 INFO local.LocalScheduler: Running 19
13/07/27 21:36:35 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000, 65536)
13/07/27 21:36:36 INFO local.LocalScheduler: Finished 19
13/07/27 21:36:36 INFO scheduler.DAGScheduler: Completed ResultTask(4, 3)
13/07/27 21:36:36 INFO local.LocalScheduler: Remove TaskSet 4.0 from pool 
13/07/27 21:36:36 INFO scheduler.DAGScheduler: Stage 4 (count at <console>:15) finished in 0.896 s
13/07/27 21:36:36 INFO spark.SparkContext: Job finished: count at <console>:15, took 0.900317473 s
res4: Long = 100002

scala> s.count()
13/07/27 21:36:36 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:36:36 INFO scheduler.DAGScheduler: Got job 5 (count at <console>:15) with 4 output partitions (allowLocal=false)
13/07/27 21:36:36 INFO scheduler.DAGScheduler: Final stage: Stage 5 (count at <console>:15)
13/07/27 21:36:36 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:36:36 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:36:36 INFO scheduler.DAGScheduler: Submitting Stage 5 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:36:36 INFO scheduler.DAGScheduler: Submitting 4 missing tasks from Stage 5 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:36:36 INFO local.LocalTaskSetManager: Size of task 20 is 1500 bytes
13/07/27 21:36:36 INFO local.LocalScheduler: Running 20
13/07/27 21:36:36 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000, 65536)
13/07/27 21:36:36 INFO local.LocalScheduler: Finished 20
13/07/27 21:36:36 INFO scheduler.DAGScheduler: Completed ResultTask(5, 0)
13/07/27 21:36:36 INFO local.LocalTaskSetManager: Size of task 21 is 1500 bytes
13/07/27 21:36:36 INFO local.LocalScheduler: Running 21
13/07/27 21:36:36 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000, 65536)
13/07/27 21:36:36 INFO local.LocalScheduler: Finished 21
13/07/27 21:36:36 INFO scheduler.DAGScheduler: Completed ResultTask(5, 1)
13/07/27 21:36:36 INFO local.LocalTaskSetManager: Size of task 22 is 1500 bytes
13/07/27 21:36:36 INFO local.LocalScheduler: Running 22
13/07/27 21:36:36 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000, 65536)
13/07/27 21:36:37 INFO local.LocalScheduler: Finished 22
13/07/27 21:36:37 INFO scheduler.DAGScheduler: Completed ResultTask(5, 2)
13/07/27 21:36:37 INFO local.LocalTaskSetManager: Size of task 23 is 1500 bytes
13/07/27 21:36:37 INFO local.LocalScheduler: Running 23
13/07/27 21:36:37 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000, 65536)
13/07/27 21:36:37 INFO local.LocalScheduler: Finished 23
13/07/27 21:36:37 INFO scheduler.DAGScheduler: Completed ResultTask(5, 3)
13/07/27 21:36:37 INFO local.LocalScheduler: Remove TaskSet 5.0 from pool 
13/07/27 21:36:37 INFO scheduler.DAGScheduler: Stage 5 (count at <console>:15) finished in 0.915 s
13/07/27 21:36:37 INFO spark.SparkContext: Job finished: count at <console>:15, took 0.919648753 s
res5: Long = 100002

scala> s.count()
13/07/27 21:36:37 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:36:37 INFO scheduler.DAGScheduler: Got job 6 (count at <console>:15) with 4 output partitions (allowLocal=false)
13/07/27 21:36:37 INFO scheduler.DAGScheduler: Final stage: Stage 6 (count at <console>:15)
13/07/27 21:36:37 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:36:37 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:36:37 INFO scheduler.DAGScheduler: Submitting Stage 6 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:36:37 INFO scheduler.DAGScheduler: Submitting 4 missing tasks from Stage 6 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:36:37 INFO local.LocalTaskSetManager: Size of task 24 is 1500 bytes
13/07/27 21:36:37 INFO local.LocalScheduler: Running 24
13/07/27 21:36:37 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000, 65536)
13/07/27 21:36:37 INFO local.LocalScheduler: Finished 24
13/07/27 21:36:37 INFO scheduler.DAGScheduler: Completed ResultTask(6, 0)
13/07/27 21:36:37 INFO local.LocalTaskSetManager: Size of task 25 is 1500 bytes
13/07/27 21:36:37 INFO local.LocalScheduler: Running 25
13/07/27 21:36:37 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000, 65536)
13/07/27 21:36:37 INFO local.LocalScheduler: Finished 25
13/07/27 21:36:37 INFO scheduler.DAGScheduler: Completed ResultTask(6, 1)
13/07/27 21:36:37 INFO local.LocalTaskSetManager: Size of task 26 is 1500 bytes
13/07/27 21:36:37 INFO local.LocalScheduler: Running 26
13/07/27 21:36:37 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000, 65536)
13/07/27 21:36:38 INFO local.LocalScheduler: Finished 26
13/07/27 21:36:38 INFO scheduler.DAGScheduler: Completed ResultTask(6, 2)
13/07/27 21:36:38 INFO local.LocalTaskSetManager: Size of task 27 is 1500 bytes
13/07/27 21:36:38 INFO local.LocalScheduler: Running 27
13/07/27 21:36:38 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000, 65536)
13/07/27 21:36:38 INFO local.LocalScheduler: Finished 27
13/07/27 21:36:38 INFO scheduler.DAGScheduler: Completed ResultTask(6, 3)
13/07/27 21:36:38 INFO local.LocalScheduler: Remove TaskSet 6.0 from pool 
13/07/27 21:36:38 INFO scheduler.DAGScheduler: Stage 6 (count at <console>:15) finished in 0.840 s
13/07/27 21:36:38 INFO spark.SparkContext: Job finished: count at <console>:15, took 0.843721212 s
res6: Long = 100002

scala> s.count()
13/07/27 21:36:38 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:36:38 INFO scheduler.DAGScheduler: Got job 7 (count at <console>:15) with 4 output partitions (allowLocal=false)
13/07/27 21:36:38 INFO scheduler.DAGScheduler: Final stage: Stage 7 (count at <console>:15)
13/07/27 21:36:38 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:36:38 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:36:38 INFO scheduler.DAGScheduler: Submitting Stage 7 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:36:38 INFO scheduler.DAGScheduler: Submitting 4 missing tasks from Stage 7 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:36:38 INFO local.LocalTaskSetManager: Size of task 28 is 1500 bytes
13/07/27 21:36:38 INFO local.LocalScheduler: Running 28
13/07/27 21:36:38 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000, 65536)
13/07/27 21:36:38 INFO local.LocalScheduler: Finished 28
13/07/27 21:36:38 INFO scheduler.DAGScheduler: Completed ResultTask(7, 0)
13/07/27 21:36:38 INFO local.LocalTaskSetManager: Size of task 29 is 1500 bytes
13/07/27 21:36:38 INFO local.LocalScheduler: Running 29
13/07/27 21:36:38 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000, 65536)
13/07/27 21:36:38 INFO local.LocalScheduler: Finished 29
13/07/27 21:36:38 INFO scheduler.DAGScheduler: Completed ResultTask(7, 1)
13/07/27 21:36:38 INFO local.LocalTaskSetManager: Size of task 30 is 1500 bytes
13/07/27 21:36:38 INFO local.LocalScheduler: Running 30
13/07/27 21:36:38 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000, 65536)
13/07/27 21:36:39 INFO local.LocalScheduler: Finished 30
13/07/27 21:36:39 INFO scheduler.DAGScheduler: Completed ResultTask(7, 2)
13/07/27 21:36:39 INFO local.LocalTaskSetManager: Size of task 31 is 1500 bytes
13/07/27 21:36:39 INFO local.LocalScheduler: Running 31
13/07/27 21:36:39 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000, 65536)
13/07/27 21:36:39 INFO local.LocalScheduler: Finished 31
13/07/27 21:36:39 INFO scheduler.DAGScheduler: Completed ResultTask(7, 3)
13/07/27 21:36:39 INFO local.LocalScheduler: Remove TaskSet 7.0 from pool 
13/07/27 21:36:39 INFO scheduler.DAGScheduler: Stage 7 (count at <console>:15) finished in 0.832 s
13/07/27 21:36:39 INFO spark.SparkContext: Job finished: count at <console>:15, took 0.835951744 s
res7: Long = 100002

scala> s.count()
13/07/27 21:36:39 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:36:39 INFO scheduler.DAGScheduler: Got job 8 (count at <console>:15) with 4 output partitions (allowLocal=false)
13/07/27 21:36:39 INFO scheduler.DAGScheduler: Final stage: Stage 8 (count at <console>:15)
13/07/27 21:36:39 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:36:39 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:36:39 INFO scheduler.DAGScheduler: Submitting Stage 8 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:36:39 INFO scheduler.DAGScheduler: Submitting 4 missing tasks from Stage 8 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:36:39 INFO local.LocalTaskSetManager: Size of task 32 is 1500 bytes
13/07/27 21:36:39 INFO local.LocalScheduler: Running 32
13/07/27 21:36:39 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000, 65536)
13/07/27 21:36:39 INFO local.LocalScheduler: Finished 32
13/07/27 21:36:39 INFO scheduler.DAGScheduler: Completed ResultTask(8, 0)
13/07/27 21:36:39 INFO local.LocalTaskSetManager: Size of task 33 is 1500 bytes
13/07/27 21:36:39 INFO local.LocalScheduler: Running 33
13/07/27 21:36:39 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000, 65536)
13/07/27 21:36:40 INFO local.LocalScheduler: Finished 33
13/07/27 21:36:40 INFO scheduler.DAGScheduler: Completed ResultTask(8, 1)
13/07/27 21:36:40 INFO local.LocalTaskSetManager: Size of task 34 is 1500 bytes
13/07/27 21:36:40 INFO local.LocalScheduler: Running 34
13/07/27 21:36:40 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000, 65536)
13/07/27 21:36:40 INFO local.LocalScheduler: Finished 34
13/07/27 21:36:40 INFO scheduler.DAGScheduler: Completed ResultTask(8, 2)
13/07/27 21:36:40 INFO local.LocalTaskSetManager: Size of task 35 is 1500 bytes
13/07/27 21:36:40 INFO local.LocalScheduler: Running 35
13/07/27 21:36:40 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000, 65536)
13/07/27 21:36:40 INFO local.LocalScheduler: Finished 35
13/07/27 21:36:40 INFO scheduler.DAGScheduler: Completed ResultTask(8, 3)
13/07/27 21:36:40 INFO local.LocalScheduler: Remove TaskSet 8.0 from pool 
13/07/27 21:36:40 INFO scheduler.DAGScheduler: Stage 8 (count at <console>:15) finished in 0.820 s
13/07/27 21:36:40 INFO spark.SparkContext: Job finished: count at <console>:15, took 0.824981665 s
res8: Long = 100002

scala> s.count()
13/07/27 21:36:40 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:36:40 INFO scheduler.DAGScheduler: Got job 9 (count at <console>:15) with 4 output partitions (allowLocal=false)
13/07/27 21:36:40 INFO scheduler.DAGScheduler: Final stage: Stage 9 (count at <console>:15)
13/07/27 21:36:40 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:36:40 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:36:40 INFO scheduler.DAGScheduler: Submitting Stage 9 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:36:40 INFO scheduler.DAGScheduler: Submitting 4 missing tasks from Stage 9 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:36:40 INFO local.LocalTaskSetManager: Size of task 36 is 1500 bytes
13/07/27 21:36:40 INFO local.LocalScheduler: Running 36
13/07/27 21:36:40 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000, 65536)
13/07/27 21:36:40 INFO local.LocalScheduler: Finished 36
13/07/27 21:36:40 INFO scheduler.DAGScheduler: Completed ResultTask(9, 0)
13/07/27 21:36:40 INFO local.LocalTaskSetManager: Size of task 37 is 1500 bytes
13/07/27 21:36:40 INFO local.LocalScheduler: Running 37
13/07/27 21:36:40 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000, 65536)
13/07/27 21:36:41 INFO local.LocalScheduler: Finished 37
13/07/27 21:36:41 INFO scheduler.DAGScheduler: Completed ResultTask(9, 1)
13/07/27 21:36:41 INFO local.LocalTaskSetManager: Size of task 38 is 1500 bytes
13/07/27 21:36:41 INFO local.LocalScheduler: Running 38
13/07/27 21:36:41 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000, 65536)
13/07/27 21:36:41 INFO local.LocalScheduler: Finished 38
13/07/27 21:36:41 INFO scheduler.DAGScheduler: Completed ResultTask(9, 2)
13/07/27 21:36:41 INFO local.LocalTaskSetManager: Size of task 39 is 1500 bytes
13/07/27 21:36:41 INFO local.LocalScheduler: Running 39
13/07/27 21:36:41 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000, 65536)
13/07/27 21:36:41 INFO local.LocalScheduler: Finished 39
13/07/27 21:36:41 INFO scheduler.DAGScheduler: Completed ResultTask(9, 3)
13/07/27 21:36:41 INFO local.LocalScheduler: Remove TaskSet 9.0 from pool 
13/07/27 21:36:41 INFO scheduler.DAGScheduler: Stage 9 (count at <console>:15) finished in 0.815 s
13/07/27 21:36:41 INFO spark.SparkContext: Job finished: count at <console>:15, took 0.819616139 s
res9: Long = 100002

scala> s.count()
13/07/27 21:36:41 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:36:41 INFO scheduler.DAGScheduler: Got job 10 (count at <console>:15) with 4 output partitions (allowLocal=false)
13/07/27 21:36:41 INFO scheduler.DAGScheduler: Final stage: Stage 10 (count at <console>:15)
13/07/27 21:36:41 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:36:41 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:36:41 INFO scheduler.DAGScheduler: Submitting Stage 10 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:36:41 INFO scheduler.DAGScheduler: Submitting 4 missing tasks from Stage 10 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:36:41 INFO local.LocalTaskSetManager: Size of task 40 is 1500 bytes
13/07/27 21:36:41 INFO local.LocalScheduler: Running 40
13/07/27 21:36:41 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000, 65536)
13/07/27 21:36:41 INFO local.LocalScheduler: Finished 40
13/07/27 21:36:41 INFO scheduler.DAGScheduler: Completed ResultTask(10, 0)
13/07/27 21:36:41 INFO local.LocalTaskSetManager: Size of task 41 is 1500 bytes
13/07/27 21:36:41 INFO local.LocalScheduler: Running 41
13/07/27 21:36:41 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000, 65536)
13/07/27 21:36:42 INFO local.LocalScheduler: Finished 41
13/07/27 21:36:42 INFO scheduler.DAGScheduler: Completed ResultTask(10, 1)
13/07/27 21:36:42 INFO local.LocalTaskSetManager: Size of task 42 is 1500 bytes
13/07/27 21:36:42 INFO local.LocalScheduler: Running 42
13/07/27 21:36:42 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000, 65536)
13/07/27 21:36:42 INFO local.LocalScheduler: Finished 42
13/07/27 21:36:42 INFO scheduler.DAGScheduler: Completed ResultTask(10, 2)
13/07/27 21:36:42 INFO local.LocalTaskSetManager: Size of task 43 is 1500 bytes
13/07/27 21:36:42 INFO local.LocalScheduler: Running 43
13/07/27 21:36:42 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.100000, 65536)
13/07/27 21:36:42 INFO local.LocalScheduler: Finished 43
13/07/27 21:36:42 INFO scheduler.DAGScheduler: Completed ResultTask(10, 3)
13/07/27 21:36:42 INFO local.LocalScheduler: Remove TaskSet 10.0 from pool 
13/07/27 21:36:42 INFO scheduler.DAGScheduler: Stage 10 (count at <console>:15) finished in 0.837 s
13/07/27 21:36:42 INFO spark.SparkContext: Job finished: count at <console>:15, took 0.841221544 s
res10: Long = 100002

scala> 13/07/27 21:36:42 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:36:42 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:36:42 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:36:42 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:36:42 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:36:42 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:36:42 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:36:42 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage/rdd,null}
Killed 1 processes
Killed 1 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting Tachyon @ tachyon-ec2-0
2013-07-27 21:36:44,194 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data
2013-07-27 21:36:44,198 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_log.data
2013-07-27 21:36:44,687 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/data
2013-07-27 21:36:44,699 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/workers

restaring tachyon
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Killed 0 processes
Killed 0 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting RamFS: /mnt/ramdisk
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata -Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Starting master @ tachyon-ec2-0
Starting worker @ tachyon-ec2-0

spark-shell count
12937 tachyon.Master
12964 tachyon.Worker

Going to fadvise /mnt/tachyon/hit_data.tsv.500000 as mode POSIX_FADV_DONTNEED
offset: 0
length: 618418417
mode: POSIX_FADV_DONTNEED
WIN
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/ubuntu/work/tachyon/target/tachyon-0.3.0-SNAPSHOT-jar-with-dependencies.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/ubuntu/work/spark/lib_managed/jars/slf4j-log4j12-1.7.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
Welcome to
      ____              __  
     / __/__  ___ _____/ /__
    _\ \/ _ \/ _ `/ __/  '_/
   /___/ .__/\_,_/_/ /_/\_\   version 0.8.0
      /_/                  

Using Scala version 2.9.3 (OpenJDK 64-Bit Server VM, Java 1.7.0_25)
Initializing interpreter...
13/07/27 21:36:51 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:36:51 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:45664
Creating SparkContext...
13/07/27 21:37:00 INFO slf4j.Slf4jEventHandler: Slf4jEventHandler started
13/07/27 21:37:00 INFO spark.SparkEnv: Registering BlockManagerMaster
13/07/27 21:37:00 INFO storage.MemoryStore: MemoryStore started with capacity 1295.4 MB.
13/07/27 21:37:00 INFO storage.DiskStore: Created local directory at /tmp/spark-local-20130727213700-037a
13/07/27 21:37:00 INFO network.ConnectionManager: Bound socket to port 56911 with id = ConnectionManagerId(tachyon-ec2-0,56911)
13/07/27 21:37:00 INFO storage.BlockManagerMaster: Trying to register BlockManager
13/07/27 21:37:00 INFO storage.BlockManagerMasterActor$BlockManagerInfo: Registering block manager tachyon-ec2-0:56911 with 1295.4 MB RAM
13/07/27 21:37:00 INFO storage.BlockManagerMaster: Registered BlockManager
13/07/27 21:37:00 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:37:00 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:41454
13/07/27 21:37:00 INFO broadcast.HttpBroadcast: Broadcast server started at http://10.151.80.188:41454
13/07/27 21:37:00 INFO spark.SparkEnv: Registering MapOutputTracker
13/07/27 21:37:00 INFO spark.HttpFileServer: HTTP File server directory is /tmp/spark-1b17fbe2-d151-421e-963d-9290c94ce370
13/07/27 21:37:00 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:37:00 INFO server.AbstractConnector: Started SocketConnector@0.0.0.0:43838
13/07/27 21:37:00 INFO server.Server: jetty-7.x.y-SNAPSHOT
13/07/27 21:37:00 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage/rdd,null}
13/07/27 21:37:00 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:37:00 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:37:00 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:37:00 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:37:00 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:37:00 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:37:00 INFO handler.ContextHandler: started o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:37:00 INFO server.AbstractConnector: Started SelectChannelConnector@0.0.0.0:33000
13/07/27 21:37:00 INFO ui.SparkUI: Started Spark Web UI at http://tachyon-ec2-0:33000
Spark context available as sc.
Type in expressions to have them evaluated.
Type :help for more information.

scala> val s = sc.textFile("tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000")
13/07/27 21:37:02 INFO storage.MemoryStore: ensureFreeSpace(58431) called with curMem=0, maxMem=1358297825
13/07/27 21:37:02 INFO storage.MemoryStore: Block broadcast_0 stored as values to memory (estimated size 57.1 KB, free 1295.3 MB)
s: spark.RDD[String] = MappedRDD[1] at textFile at <console>:12

scala> s.count()
13/07/27 21:37:02 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
13/07/27 21:37:02 WARN snappy.LoadSnappy: Snappy native library not loaded
13/07/27 21:37:02 INFO : initialize(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml). Connecting to Tachyon: tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000
13/07/27 21:37:02 INFO : Trying to connect master @ tachyon-ec2-0/10.151.80.188:19998
13/07/27 21:37:02 INFO : User registered at the master tachyon-ec2-0/10.151.80.188:19998 got UserId 1
13/07/27 21:37:02 INFO : Trying to get local worker host : tachyon-ec2-0
13/07/27 21:37:02 INFO : Connecting local worker @ tachyon-ec2-0/10.151.80.188:29998
13/07/27 21:37:02 INFO : tachyon://tachyon-ec2-0:19998 tachyon://tachyon-ec2-0:19998 file:///mnt/tachyon
13/07/27 21:37:02 INFO : getFileStatus(/hit_data.tsv.500000): HDFS Path: file:/mnt/tachyon/hit_data.tsv.500000 TPath: tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000
13/07/27 21:37:02 INFO : tachyon.client.TachyonFS@1cabf050 file:///mnt/tachyon /hit_data.tsv.500000 tachyon.PrefixList@5c2e22e4
13/07/27 21:37:02 INFO : Create tachyon file /hit_data.tsv.500000 with file id 2 and checkpoint location file:///mnt/tachyon/hit_data.tsv.500000
13/07/27 21:37:02 INFO mapred.FileInputFormat: Total input paths to process : 1
13/07/27 21:37:03 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:37:03 INFO scheduler.DAGScheduler: Got job 0 (count at <console>:15) with 19 output partitions (allowLocal=false)
13/07/27 21:37:03 INFO scheduler.DAGScheduler: Final stage: Stage 0 (count at <console>:15)
13/07/27 21:37:03 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:37:03 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:37:03 INFO scheduler.DAGScheduler: Submitting Stage 0 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:37:03 INFO scheduler.DAGScheduler: Submitting 19 missing tasks from Stage 0 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:37:03 INFO local.LocalTaskSetManager: Size of task 0 is 1499 bytes
13/07/27 21:37:03 INFO local.LocalScheduler: Running 0
13/07/27 21:37:03 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:03 INFO : /mnt/ramdisk/tachyonworker/2147483648 is not on local disk.
13/07/27 21:37:03 INFO : Try to find and read from remote workers.
13/07/27 21:37:03 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:37:03 INFO : Folder /mnt/ramdisk/tachyonworker/users/1 was created!
13/07/27 21:37:03 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483648 was created!
13/07/27 21:37:04 INFO : /mnt/ramdisk/tachyonworker/2147483649 is not on local disk.
13/07/27 21:37:04 INFO : Try to find and read from remote workers.
13/07/27 21:37:04 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:37:04 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483649 was created!
13/07/27 21:37:04 INFO local.LocalScheduler: Finished 0
13/07/27 21:37:04 INFO local.LocalTaskSetManager: Size of task 1 is 1499 bytes
13/07/27 21:37:04 INFO local.LocalScheduler: Running 1
13/07/27 21:37:04 INFO scheduler.DAGScheduler: Completed ResultTask(0, 0)
13/07/27 21:37:04 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:05 INFO : /mnt/ramdisk/tachyonworker/2147483650 is not on local disk.
13/07/27 21:37:05 INFO : Try to find and read from remote workers.
13/07/27 21:37:05 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:37:05 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483650 was created!
13/07/27 21:37:05 INFO local.LocalScheduler: Finished 1
13/07/27 21:37:05 INFO scheduler.DAGScheduler: Completed ResultTask(0, 1)
13/07/27 21:37:05 INFO local.LocalTaskSetManager: Size of task 2 is 1499 bytes
13/07/27 21:37:05 INFO local.LocalScheduler: Running 2
13/07/27 21:37:05 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:05 INFO : /mnt/ramdisk/tachyonworker/2147483651 is not on local disk.
13/07/27 21:37:05 INFO : Try to find and read from remote workers.
13/07/27 21:37:05 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:37:05 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483651 was created!
13/07/27 21:37:05 INFO local.LocalScheduler: Finished 2
13/07/27 21:37:05 INFO scheduler.DAGScheduler: Completed ResultTask(0, 2)
13/07/27 21:37:05 INFO local.LocalTaskSetManager: Size of task 3 is 1499 bytes
13/07/27 21:37:05 INFO local.LocalScheduler: Running 3
13/07/27 21:37:06 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:06 INFO : /mnt/ramdisk/tachyonworker/2147483652 is not on local disk.
13/07/27 21:37:06 INFO : Try to find and read from remote workers.
13/07/27 21:37:06 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:37:06 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483652 was created!
13/07/27 21:37:06 INFO local.LocalScheduler: Finished 3
13/07/27 21:37:06 INFO scheduler.DAGScheduler: Completed ResultTask(0, 3)
13/07/27 21:37:06 INFO local.LocalTaskSetManager: Size of task 4 is 1499 bytes
13/07/27 21:37:06 INFO local.LocalScheduler: Running 4
13/07/27 21:37:06 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:06 INFO : /mnt/ramdisk/tachyonworker/2147483653 is not on local disk.
13/07/27 21:37:06 INFO : Try to find and read from remote workers.
13/07/27 21:37:06 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:37:06 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483653 was created!
13/07/27 21:37:07 INFO local.LocalScheduler: Finished 4
13/07/27 21:37:07 INFO scheduler.DAGScheduler: Completed ResultTask(0, 4)
13/07/27 21:37:07 INFO local.LocalTaskSetManager: Size of task 5 is 1499 bytes
13/07/27 21:37:07 INFO local.LocalScheduler: Running 5
13/07/27 21:37:07 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:07 INFO : /mnt/ramdisk/tachyonworker/2147483654 is not on local disk.
13/07/27 21:37:07 INFO : Try to find and read from remote workers.
13/07/27 21:37:07 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:37:07 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483654 was created!
13/07/27 21:37:07 INFO local.LocalScheduler: Finished 5
13/07/27 21:37:07 INFO scheduler.DAGScheduler: Completed ResultTask(0, 5)
13/07/27 21:37:07 INFO local.LocalTaskSetManager: Size of task 6 is 1499 bytes
13/07/27 21:37:07 INFO local.LocalScheduler: Running 6
13/07/27 21:37:07 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:08 INFO : /mnt/ramdisk/tachyonworker/2147483655 is not on local disk.
13/07/27 21:37:08 INFO : Try to find and read from remote workers.
13/07/27 21:37:08 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:37:08 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483655 was created!
13/07/27 21:37:08 INFO local.LocalScheduler: Finished 6
13/07/27 21:37:08 INFO scheduler.DAGScheduler: Completed ResultTask(0, 6)
13/07/27 21:37:08 INFO local.LocalTaskSetManager: Size of task 7 is 1499 bytes
13/07/27 21:37:08 INFO local.LocalScheduler: Running 7
13/07/27 21:37:08 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:08 INFO : /mnt/ramdisk/tachyonworker/2147483656 is not on local disk.
13/07/27 21:37:08 INFO : Try to find and read from remote workers.
13/07/27 21:37:08 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:37:08 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483656 was created!
13/07/27 21:37:09 INFO local.LocalScheduler: Finished 7
13/07/27 21:37:09 INFO scheduler.DAGScheduler: Completed ResultTask(0, 7)
13/07/27 21:37:09 INFO local.LocalTaskSetManager: Size of task 8 is 1499 bytes
13/07/27 21:37:09 INFO local.LocalScheduler: Running 8
13/07/27 21:37:09 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:09 INFO : /mnt/ramdisk/tachyonworker/2147483657 is not on local disk.
13/07/27 21:37:09 INFO : Try to find and read from remote workers.
13/07/27 21:37:09 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:37:09 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483657 was created!
13/07/27 21:37:09 INFO local.LocalScheduler: Finished 8
13/07/27 21:37:09 INFO scheduler.DAGScheduler: Completed ResultTask(0, 8)
13/07/27 21:37:09 INFO local.LocalTaskSetManager: Size of task 9 is 1499 bytes
13/07/27 21:37:09 INFO local.LocalScheduler: Running 9
13/07/27 21:37:09 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:09 INFO : /mnt/ramdisk/tachyonworker/2147483658 is not on local disk.
13/07/27 21:37:09 INFO : Try to find and read from remote workers.
13/07/27 21:37:09 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:37:09 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483658 was created!
13/07/27 21:37:10 INFO local.LocalScheduler: Finished 9
13/07/27 21:37:10 INFO scheduler.DAGScheduler: Completed ResultTask(0, 9)
13/07/27 21:37:10 INFO local.LocalTaskSetManager: Size of task 10 is 1499 bytes
13/07/27 21:37:10 INFO local.LocalScheduler: Running 10
13/07/27 21:37:10 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:10 INFO : /mnt/ramdisk/tachyonworker/2147483659 is not on local disk.
13/07/27 21:37:10 INFO : Try to find and read from remote workers.
13/07/27 21:37:10 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:37:10 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483659 was created!
13/07/27 21:37:10 INFO local.LocalScheduler: Finished 10
13/07/27 21:37:10 INFO scheduler.DAGScheduler: Completed ResultTask(0, 10)
13/07/27 21:37:10 INFO local.LocalTaskSetManager: Size of task 11 is 1499 bytes
13/07/27 21:37:10 INFO local.LocalScheduler: Running 11
13/07/27 21:37:10 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:11 INFO : /mnt/ramdisk/tachyonworker/2147483660 is not on local disk.
13/07/27 21:37:11 INFO : Try to find and read from remote workers.
13/07/27 21:37:11 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:37:11 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483660 was created!
13/07/27 21:37:11 INFO local.LocalScheduler: Finished 11
13/07/27 21:37:11 INFO scheduler.DAGScheduler: Completed ResultTask(0, 11)
13/07/27 21:37:11 INFO local.LocalTaskSetManager: Size of task 12 is 1499 bytes
13/07/27 21:37:11 INFO local.LocalScheduler: Running 12
13/07/27 21:37:11 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:11 INFO : /mnt/ramdisk/tachyonworker/2147483661 is not on local disk.
13/07/27 21:37:11 INFO : Try to find and read from remote workers.
13/07/27 21:37:11 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:37:11 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483661 was created!
13/07/27 21:37:11 INFO local.LocalScheduler: Finished 12
13/07/27 21:37:11 INFO scheduler.DAGScheduler: Completed ResultTask(0, 12)
13/07/27 21:37:11 INFO local.LocalTaskSetManager: Size of task 13 is 1499 bytes
13/07/27 21:37:11 INFO local.LocalScheduler: Running 13
13/07/27 21:37:12 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:12 INFO : /mnt/ramdisk/tachyonworker/2147483662 is not on local disk.
13/07/27 21:37:12 INFO : Try to find and read from remote workers.
13/07/27 21:37:12 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:37:12 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483662 was created!
13/07/27 21:37:12 INFO local.LocalScheduler: Finished 13
13/07/27 21:37:12 INFO scheduler.DAGScheduler: Completed ResultTask(0, 13)
13/07/27 21:37:12 INFO local.LocalTaskSetManager: Size of task 14 is 1499 bytes
13/07/27 21:37:12 INFO local.LocalScheduler: Running 14
13/07/27 21:37:12 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:12 INFO : /mnt/ramdisk/tachyonworker/2147483663 is not on local disk.
13/07/27 21:37:12 INFO : Try to find and read from remote workers.
13/07/27 21:37:12 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:37:12 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483663 was created!
13/07/27 21:37:13 INFO local.LocalScheduler: Finished 14
13/07/27 21:37:13 INFO scheduler.DAGScheduler: Completed ResultTask(0, 14)
13/07/27 21:37:13 INFO local.LocalTaskSetManager: Size of task 15 is 1499 bytes
13/07/27 21:37:13 INFO local.LocalScheduler: Running 15
13/07/27 21:37:13 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:13 INFO : /mnt/ramdisk/tachyonworker/2147483664 is not on local disk.
13/07/27 21:37:13 INFO : Try to find and read from remote workers.
13/07/27 21:37:13 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:37:13 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483664 was created!
13/07/27 21:37:13 INFO local.LocalScheduler: Finished 15
13/07/27 21:37:13 INFO scheduler.DAGScheduler: Completed ResultTask(0, 15)
13/07/27 21:37:13 INFO local.LocalTaskSetManager: Size of task 16 is 1499 bytes
13/07/27 21:37:13 INFO local.LocalScheduler: Running 16
13/07/27 21:37:13 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:13 INFO : /mnt/ramdisk/tachyonworker/2147483665 is not on local disk.
13/07/27 21:37:13 INFO : Try to find and read from remote workers.
13/07/27 21:37:13 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:37:13 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483665 was created!
13/07/27 21:37:14 INFO local.LocalScheduler: Finished 16
13/07/27 21:37:14 INFO scheduler.DAGScheduler: Completed ResultTask(0, 16)
13/07/27 21:37:14 INFO local.LocalTaskSetManager: Size of task 17 is 1499 bytes
13/07/27 21:37:14 INFO local.LocalScheduler: Running 17
13/07/27 21:37:14 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:14 INFO : /mnt/ramdisk/tachyonworker/2147483666 is not on local disk.
13/07/27 21:37:14 INFO : Try to find and read from remote workers.
13/07/27 21:37:14 INFO : readByteBufferFromRemote() [NetAddress(mHost:localhost, mPort:-1)]
13/07/27 21:37:14 INFO : /mnt/ramdisk/tachyonworker/users/1/2147483666 was created!
13/07/27 21:37:14 INFO local.LocalScheduler: Finished 17
13/07/27 21:37:14 INFO scheduler.DAGScheduler: Completed ResultTask(0, 17)
13/07/27 21:37:14 INFO local.LocalTaskSetManager: Size of task 18 is 1499 bytes
13/07/27 21:37:14 INFO local.LocalScheduler: Running 18
13/07/27 21:37:14 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:14 INFO local.LocalScheduler: Finished 18
13/07/27 21:37:14 INFO scheduler.DAGScheduler: Completed ResultTask(0, 18)
13/07/27 21:37:14 INFO local.LocalScheduler: Remove TaskSet 0.0 from pool 
13/07/27 21:37:14 INFO scheduler.DAGScheduler: Stage 0 (count at <console>:15) finished in 11.286 s
13/07/27 21:37:14 INFO spark.SparkContext: Job finished: count at <console>:15, took 11.338197655 s
res0: Long = 500094

scala> s.count()
13/07/27 21:37:14 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:37:14 INFO scheduler.DAGScheduler: Got job 1 (count at <console>:15) with 19 output partitions (allowLocal=false)
13/07/27 21:37:14 INFO scheduler.DAGScheduler: Final stage: Stage 1 (count at <console>:15)
13/07/27 21:37:14 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:37:15 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:37:15 INFO scheduler.DAGScheduler: Submitting Stage 1 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:37:15 INFO scheduler.DAGScheduler: Submitting 19 missing tasks from Stage 1 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:37:15 INFO local.LocalTaskSetManager: Size of task 19 is 1500 bytes
13/07/27 21:37:15 INFO local.LocalScheduler: Running 19
13/07/27 21:37:15 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:15 INFO local.LocalScheduler: Finished 19
13/07/27 21:37:15 INFO scheduler.DAGScheduler: Completed ResultTask(1, 0)
13/07/27 21:37:15 INFO local.LocalTaskSetManager: Size of task 20 is 1500 bytes
13/07/27 21:37:15 INFO local.LocalScheduler: Running 20
13/07/27 21:37:15 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:15 INFO local.LocalScheduler: Finished 20
13/07/27 21:37:15 INFO scheduler.DAGScheduler: Completed ResultTask(1, 1)
13/07/27 21:37:15 INFO local.LocalTaskSetManager: Size of task 21 is 1500 bytes
13/07/27 21:37:15 INFO local.LocalScheduler: Running 21
13/07/27 21:37:15 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:15 INFO local.LocalScheduler: Finished 21
13/07/27 21:37:15 INFO scheduler.DAGScheduler: Completed ResultTask(1, 2)
13/07/27 21:37:15 INFO local.LocalTaskSetManager: Size of task 22 is 1500 bytes
13/07/27 21:37:15 INFO local.LocalScheduler: Running 22
13/07/27 21:37:15 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:15 INFO local.LocalScheduler: Finished 22
13/07/27 21:37:15 INFO scheduler.DAGScheduler: Completed ResultTask(1, 3)
13/07/27 21:37:15 INFO local.LocalTaskSetManager: Size of task 23 is 1500 bytes
13/07/27 21:37:15 INFO local.LocalScheduler: Running 23
13/07/27 21:37:16 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:16 INFO local.LocalScheduler: Finished 23
13/07/27 21:37:16 INFO scheduler.DAGScheduler: Completed ResultTask(1, 4)
13/07/27 21:37:16 INFO local.LocalTaskSetManager: Size of task 24 is 1500 bytes
13/07/27 21:37:16 INFO local.LocalScheduler: Running 24
13/07/27 21:37:16 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:16 INFO local.LocalScheduler: Finished 24
13/07/27 21:37:16 INFO scheduler.DAGScheduler: Completed ResultTask(1, 5)
13/07/27 21:37:16 INFO local.LocalTaskSetManager: Size of task 25 is 1500 bytes
13/07/27 21:37:16 INFO local.LocalScheduler: Running 25
13/07/27 21:37:16 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:16 INFO local.LocalScheduler: Finished 25
13/07/27 21:37:16 INFO scheduler.DAGScheduler: Completed ResultTask(1, 6)
13/07/27 21:37:16 INFO local.LocalTaskSetManager: Size of task 26 is 1500 bytes
13/07/27 21:37:16 INFO local.LocalScheduler: Running 26
13/07/27 21:37:16 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:16 INFO local.LocalScheduler: Finished 26
13/07/27 21:37:16 INFO scheduler.DAGScheduler: Completed ResultTask(1, 7)
13/07/27 21:37:16 INFO local.LocalTaskSetManager: Size of task 27 is 1500 bytes
13/07/27 21:37:16 INFO local.LocalScheduler: Running 27
13/07/27 21:37:16 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:17 INFO local.LocalScheduler: Finished 27
13/07/27 21:37:17 INFO scheduler.DAGScheduler: Completed ResultTask(1, 8)
13/07/27 21:37:17 INFO local.LocalTaskSetManager: Size of task 28 is 1500 bytes
13/07/27 21:37:17 INFO local.LocalScheduler: Running 28
13/07/27 21:37:17 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:17 INFO local.LocalScheduler: Finished 28
13/07/27 21:37:17 INFO scheduler.DAGScheduler: Completed ResultTask(1, 9)
13/07/27 21:37:17 INFO local.LocalTaskSetManager: Size of task 29 is 1500 bytes
13/07/27 21:37:17 INFO local.LocalScheduler: Running 29
13/07/27 21:37:17 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:17 INFO local.LocalScheduler: Finished 29
13/07/27 21:37:17 INFO scheduler.DAGScheduler: Completed ResultTask(1, 10)
13/07/27 21:37:17 INFO local.LocalTaskSetManager: Size of task 30 is 1500 bytes
13/07/27 21:37:17 INFO local.LocalScheduler: Running 30
13/07/27 21:37:17 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:17 INFO local.LocalScheduler: Finished 30
13/07/27 21:37:17 INFO scheduler.DAGScheduler: Completed ResultTask(1, 11)
13/07/27 21:37:17 INFO local.LocalTaskSetManager: Size of task 31 is 1500 bytes
13/07/27 21:37:17 INFO local.LocalScheduler: Running 31
13/07/27 21:37:17 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:18 INFO local.LocalScheduler: Finished 31
13/07/27 21:37:18 INFO scheduler.DAGScheduler: Completed ResultTask(1, 12)
13/07/27 21:37:18 INFO local.LocalTaskSetManager: Size of task 32 is 1500 bytes
13/07/27 21:37:18 INFO local.LocalScheduler: Running 32
13/07/27 21:37:18 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:18 INFO local.LocalScheduler: Finished 32
13/07/27 21:37:18 INFO scheduler.DAGScheduler: Completed ResultTask(1, 13)
13/07/27 21:37:18 INFO local.LocalTaskSetManager: Size of task 33 is 1500 bytes
13/07/27 21:37:18 INFO local.LocalScheduler: Running 33
13/07/27 21:37:18 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:18 INFO local.LocalScheduler: Finished 33
13/07/27 21:37:18 INFO scheduler.DAGScheduler: Completed ResultTask(1, 14)
13/07/27 21:37:18 INFO local.LocalTaskSetManager: Size of task 34 is 1500 bytes
13/07/27 21:37:18 INFO local.LocalScheduler: Running 34
13/07/27 21:37:18 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:18 INFO local.LocalScheduler: Finished 34
13/07/27 21:37:18 INFO scheduler.DAGScheduler: Completed ResultTask(1, 15)
13/07/27 21:37:18 INFO local.LocalTaskSetManager: Size of task 35 is 1500 bytes
13/07/27 21:37:18 INFO local.LocalScheduler: Running 35
13/07/27 21:37:18 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:18 INFO local.LocalScheduler: Finished 35
13/07/27 21:37:18 INFO scheduler.DAGScheduler: Completed ResultTask(1, 16)
13/07/27 21:37:18 INFO local.LocalTaskSetManager: Size of task 36 is 1500 bytes
13/07/27 21:37:18 INFO local.LocalScheduler: Running 36
13/07/27 21:37:18 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:19 INFO local.LocalScheduler: Finished 36
13/07/27 21:37:19 INFO scheduler.DAGScheduler: Completed ResultTask(1, 17)
13/07/27 21:37:19 INFO local.LocalTaskSetManager: Size of task 37 is 1500 bytes
13/07/27 21:37:19 INFO local.LocalScheduler: Running 37
13/07/27 21:37:19 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:19 INFO local.LocalScheduler: Finished 37
13/07/27 21:37:19 INFO scheduler.DAGScheduler: Completed ResultTask(1, 18)
13/07/27 21:37:19 INFO local.LocalScheduler: Remove TaskSet 1.0 from pool 
13/07/27 21:37:19 INFO scheduler.DAGScheduler: Stage 1 (count at <console>:15) finished in 4.213 s
13/07/27 21:37:19 INFO spark.SparkContext: Job finished: count at <console>:15, took 4.222967471 s
res1: Long = 500094

scala> s.count()
13/07/27 21:37:19 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:37:19 INFO scheduler.DAGScheduler: Got job 2 (count at <console>:15) with 19 output partitions (allowLocal=false)
13/07/27 21:37:19 INFO scheduler.DAGScheduler: Final stage: Stage 2 (count at <console>:15)
13/07/27 21:37:19 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:37:19 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:37:19 INFO scheduler.DAGScheduler: Submitting Stage 2 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:37:19 INFO scheduler.DAGScheduler: Submitting 19 missing tasks from Stage 2 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:37:19 INFO local.LocalTaskSetManager: Size of task 38 is 1500 bytes
13/07/27 21:37:19 INFO local.LocalScheduler: Running 38
13/07/27 21:37:19 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:19 INFO local.LocalScheduler: Finished 38
13/07/27 21:37:19 INFO scheduler.DAGScheduler: Completed ResultTask(2, 0)
13/07/27 21:37:19 INFO local.LocalTaskSetManager: Size of task 39 is 1500 bytes
13/07/27 21:37:19 INFO local.LocalScheduler: Running 39
13/07/27 21:37:19 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:19 INFO local.LocalScheduler: Finished 39
13/07/27 21:37:19 INFO scheduler.DAGScheduler: Completed ResultTask(2, 1)
13/07/27 21:37:19 INFO local.LocalTaskSetManager: Size of task 40 is 1500 bytes
13/07/27 21:37:19 INFO local.LocalScheduler: Running 40
13/07/27 21:37:19 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:20 INFO local.LocalScheduler: Finished 40
13/07/27 21:37:20 INFO scheduler.DAGScheduler: Completed ResultTask(2, 2)
13/07/27 21:37:20 INFO local.LocalTaskSetManager: Size of task 41 is 1500 bytes
13/07/27 21:37:20 INFO local.LocalScheduler: Running 41
13/07/27 21:37:20 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:20 INFO local.LocalScheduler: Finished 41
13/07/27 21:37:20 INFO scheduler.DAGScheduler: Completed ResultTask(2, 3)
13/07/27 21:37:20 INFO local.LocalTaskSetManager: Size of task 42 is 1500 bytes
13/07/27 21:37:20 INFO local.LocalScheduler: Running 42
13/07/27 21:37:20 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:20 INFO local.LocalScheduler: Finished 42
13/07/27 21:37:20 INFO scheduler.DAGScheduler: Completed ResultTask(2, 4)
13/07/27 21:37:20 INFO local.LocalTaskSetManager: Size of task 43 is 1500 bytes
13/07/27 21:37:20 INFO local.LocalScheduler: Running 43
13/07/27 21:37:20 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:20 INFO local.LocalScheduler: Finished 43
13/07/27 21:37:20 INFO scheduler.DAGScheduler: Completed ResultTask(2, 5)
13/07/27 21:37:20 INFO local.LocalTaskSetManager: Size of task 44 is 1500 bytes
13/07/27 21:37:20 INFO local.LocalScheduler: Running 44
13/07/27 21:37:20 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:21 INFO local.LocalScheduler: Finished 44
13/07/27 21:37:21 INFO scheduler.DAGScheduler: Completed ResultTask(2, 6)
13/07/27 21:37:21 INFO local.LocalTaskSetManager: Size of task 45 is 1500 bytes
13/07/27 21:37:21 INFO local.LocalScheduler: Running 45
13/07/27 21:37:21 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:21 INFO local.LocalScheduler: Finished 45
13/07/27 21:37:21 INFO scheduler.DAGScheduler: Completed ResultTask(2, 7)
13/07/27 21:37:21 INFO local.LocalTaskSetManager: Size of task 46 is 1500 bytes
13/07/27 21:37:21 INFO local.LocalScheduler: Running 46
13/07/27 21:37:21 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:21 INFO local.LocalScheduler: Finished 46
13/07/27 21:37:21 INFO scheduler.DAGScheduler: Completed ResultTask(2, 8)
13/07/27 21:37:21 INFO local.LocalTaskSetManager: Size of task 47 is 1500 bytes
13/07/27 21:37:21 INFO local.LocalScheduler: Running 47
13/07/27 21:37:21 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:21 INFO local.LocalScheduler: Finished 47
13/07/27 21:37:21 INFO scheduler.DAGScheduler: Completed ResultTask(2, 9)
13/07/27 21:37:21 INFO local.LocalTaskSetManager: Size of task 48 is 1500 bytes
13/07/27 21:37:21 INFO local.LocalScheduler: Running 48
13/07/27 21:37:21 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:21 INFO local.LocalScheduler: Finished 48
13/07/27 21:37:21 INFO scheduler.DAGScheduler: Completed ResultTask(2, 10)
13/07/27 21:37:21 INFO local.LocalTaskSetManager: Size of task 49 is 1500 bytes
13/07/27 21:37:21 INFO local.LocalScheduler: Running 49
13/07/27 21:37:21 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:22 INFO local.LocalScheduler: Finished 49
13/07/27 21:37:22 INFO scheduler.DAGScheduler: Completed ResultTask(2, 11)
13/07/27 21:37:22 INFO local.LocalTaskSetManager: Size of task 50 is 1500 bytes
13/07/27 21:37:22 INFO local.LocalScheduler: Running 50
13/07/27 21:37:22 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:22 INFO local.LocalScheduler: Finished 50
13/07/27 21:37:22 INFO scheduler.DAGScheduler: Completed ResultTask(2, 12)
13/07/27 21:37:22 INFO local.LocalTaskSetManager: Size of task 51 is 1500 bytes
13/07/27 21:37:22 INFO local.LocalScheduler: Running 51
13/07/27 21:37:22 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:22 INFO local.LocalScheduler: Finished 51
13/07/27 21:37:22 INFO scheduler.DAGScheduler: Completed ResultTask(2, 13)
13/07/27 21:37:22 INFO local.LocalTaskSetManager: Size of task 52 is 1500 bytes
13/07/27 21:37:22 INFO local.LocalScheduler: Running 52
13/07/27 21:37:22 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:22 INFO local.LocalScheduler: Finished 52
13/07/27 21:37:22 INFO scheduler.DAGScheduler: Completed ResultTask(2, 14)
13/07/27 21:37:22 INFO local.LocalTaskSetManager: Size of task 53 is 1500 bytes
13/07/27 21:37:22 INFO local.LocalScheduler: Running 53
13/07/27 21:37:22 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:22 INFO local.LocalScheduler: Finished 53
13/07/27 21:37:22 INFO scheduler.DAGScheduler: Completed ResultTask(2, 15)
13/07/27 21:37:22 INFO local.LocalTaskSetManager: Size of task 54 is 1500 bytes
13/07/27 21:37:22 INFO local.LocalScheduler: Running 54
13/07/27 21:37:22 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:23 INFO local.LocalScheduler: Finished 54
13/07/27 21:37:23 INFO scheduler.DAGScheduler: Completed ResultTask(2, 16)
13/07/27 21:37:23 INFO local.LocalTaskSetManager: Size of task 55 is 1500 bytes
13/07/27 21:37:23 INFO local.LocalScheduler: Running 55
13/07/27 21:37:23 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:23 INFO local.LocalScheduler: Finished 55
13/07/27 21:37:23 INFO scheduler.DAGScheduler: Completed ResultTask(2, 17)
13/07/27 21:37:23 INFO local.LocalTaskSetManager: Size of task 56 is 1500 bytes
13/07/27 21:37:23 INFO local.LocalScheduler: Running 56
13/07/27 21:37:23 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:23 INFO local.LocalScheduler: Finished 56
13/07/27 21:37:23 INFO scheduler.DAGScheduler: Completed ResultTask(2, 18)
13/07/27 21:37:23 INFO local.LocalScheduler: Remove TaskSet 2.0 from pool 
13/07/27 21:37:23 INFO scheduler.DAGScheduler: Stage 2 (count at <console>:15) finished in 4.003 s
13/07/27 21:37:23 INFO spark.SparkContext: Job finished: count at <console>:15, took 4.013009632 s
res2: Long = 500094

scala> s.count()
13/07/27 21:37:23 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:37:23 INFO scheduler.DAGScheduler: Got job 3 (count at <console>:15) with 19 output partitions (allowLocal=false)
13/07/27 21:37:23 INFO scheduler.DAGScheduler: Final stage: Stage 3 (count at <console>:15)
13/07/27 21:37:23 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:37:23 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:37:23 INFO scheduler.DAGScheduler: Submitting Stage 3 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:37:23 INFO scheduler.DAGScheduler: Submitting 19 missing tasks from Stage 3 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:37:23 INFO local.LocalTaskSetManager: Size of task 57 is 1500 bytes
13/07/27 21:37:23 INFO local.LocalScheduler: Running 57
13/07/27 21:37:23 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:23 INFO local.LocalScheduler: Finished 57
13/07/27 21:37:23 INFO scheduler.DAGScheduler: Completed ResultTask(3, 0)
13/07/27 21:37:23 INFO local.LocalTaskSetManager: Size of task 58 is 1500 bytes
13/07/27 21:37:23 INFO local.LocalScheduler: Running 58
13/07/27 21:37:23 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:24 INFO local.LocalScheduler: Finished 58
13/07/27 21:37:24 INFO scheduler.DAGScheduler: Completed ResultTask(3, 1)
13/07/27 21:37:24 INFO local.LocalTaskSetManager: Size of task 59 is 1500 bytes
13/07/27 21:37:24 INFO local.LocalScheduler: Running 59
13/07/27 21:37:24 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:24 INFO local.LocalScheduler: Finished 59
13/07/27 21:37:24 INFO scheduler.DAGScheduler: Completed ResultTask(3, 2)
13/07/27 21:37:24 INFO local.LocalTaskSetManager: Size of task 60 is 1500 bytes
13/07/27 21:37:24 INFO local.LocalScheduler: Running 60
13/07/27 21:37:24 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:24 INFO local.LocalScheduler: Finished 60
13/07/27 21:37:24 INFO scheduler.DAGScheduler: Completed ResultTask(3, 3)
13/07/27 21:37:24 INFO local.LocalTaskSetManager: Size of task 61 is 1500 bytes
13/07/27 21:37:24 INFO local.LocalScheduler: Running 61
13/07/27 21:37:24 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:24 INFO local.LocalScheduler: Finished 61
13/07/27 21:37:24 INFO scheduler.DAGScheduler: Completed ResultTask(3, 4)
13/07/27 21:37:24 INFO local.LocalTaskSetManager: Size of task 62 is 1500 bytes
13/07/27 21:37:24 INFO local.LocalScheduler: Running 62
13/07/27 21:37:24 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:25 INFO local.LocalScheduler: Finished 62
13/07/27 21:37:25 INFO scheduler.DAGScheduler: Completed ResultTask(3, 5)
13/07/27 21:37:25 INFO local.LocalTaskSetManager: Size of task 63 is 1500 bytes
13/07/27 21:37:25 INFO local.LocalScheduler: Running 63
13/07/27 21:37:25 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:25 INFO local.LocalScheduler: Finished 63
13/07/27 21:37:25 INFO scheduler.DAGScheduler: Completed ResultTask(3, 6)
13/07/27 21:37:25 INFO local.LocalTaskSetManager: Size of task 64 is 1500 bytes
13/07/27 21:37:25 INFO local.LocalScheduler: Running 64
13/07/27 21:37:25 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:25 INFO local.LocalScheduler: Finished 64
13/07/27 21:37:25 INFO scheduler.DAGScheduler: Completed ResultTask(3, 7)
13/07/27 21:37:25 INFO local.LocalTaskSetManager: Size of task 65 is 1500 bytes
13/07/27 21:37:25 INFO local.LocalScheduler: Running 65
13/07/27 21:37:25 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:25 INFO local.LocalScheduler: Finished 65
13/07/27 21:37:25 INFO scheduler.DAGScheduler: Completed ResultTask(3, 8)
13/07/27 21:37:25 INFO local.LocalTaskSetManager: Size of task 66 is 1500 bytes
13/07/27 21:37:25 INFO local.LocalScheduler: Running 66
13/07/27 21:37:25 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:25 INFO local.LocalScheduler: Finished 66
13/07/27 21:37:25 INFO scheduler.DAGScheduler: Completed ResultTask(3, 9)
13/07/27 21:37:25 INFO local.LocalTaskSetManager: Size of task 67 is 1500 bytes
13/07/27 21:37:25 INFO local.LocalScheduler: Running 67
13/07/27 21:37:25 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:26 INFO local.LocalScheduler: Finished 67
13/07/27 21:37:26 INFO scheduler.DAGScheduler: Completed ResultTask(3, 10)
13/07/27 21:37:26 INFO local.LocalTaskSetManager: Size of task 68 is 1500 bytes
13/07/27 21:37:26 INFO local.LocalScheduler: Running 68
13/07/27 21:37:26 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:26 INFO local.LocalScheduler: Finished 68
13/07/27 21:37:26 INFO scheduler.DAGScheduler: Completed ResultTask(3, 11)
13/07/27 21:37:26 INFO local.LocalTaskSetManager: Size of task 69 is 1500 bytes
13/07/27 21:37:26 INFO local.LocalScheduler: Running 69
13/07/27 21:37:26 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:26 INFO local.LocalScheduler: Finished 69
13/07/27 21:37:26 INFO scheduler.DAGScheduler: Completed ResultTask(3, 12)
13/07/27 21:37:26 INFO local.LocalTaskSetManager: Size of task 70 is 1500 bytes
13/07/27 21:37:26 INFO local.LocalScheduler: Running 70
13/07/27 21:37:26 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:26 INFO local.LocalScheduler: Finished 70
13/07/27 21:37:26 INFO scheduler.DAGScheduler: Completed ResultTask(3, 13)
13/07/27 21:37:26 INFO local.LocalTaskSetManager: Size of task 71 is 1500 bytes
13/07/27 21:37:26 INFO local.LocalScheduler: Running 71
13/07/27 21:37:26 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:27 INFO local.LocalScheduler: Finished 71
13/07/27 21:37:27 INFO scheduler.DAGScheduler: Completed ResultTask(3, 14)
13/07/27 21:37:27 INFO local.LocalTaskSetManager: Size of task 72 is 1500 bytes
13/07/27 21:37:27 INFO local.LocalScheduler: Running 72
13/07/27 21:37:27 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:27 INFO local.LocalScheduler: Finished 72
13/07/27 21:37:27 INFO scheduler.DAGScheduler: Completed ResultTask(3, 15)
13/07/27 21:37:27 INFO local.LocalTaskSetManager: Size of task 73 is 1500 bytes
13/07/27 21:37:27 INFO local.LocalScheduler: Running 73
13/07/27 21:37:27 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:27 INFO local.LocalScheduler: Finished 73
13/07/27 21:37:27 INFO scheduler.DAGScheduler: Completed ResultTask(3, 16)
13/07/27 21:37:27 INFO local.LocalTaskSetManager: Size of task 74 is 1500 bytes
13/07/27 21:37:27 INFO local.LocalScheduler: Running 74
13/07/27 21:37:27 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:27 INFO local.LocalScheduler: Finished 74
13/07/27 21:37:27 INFO scheduler.DAGScheduler: Completed ResultTask(3, 17)
13/07/27 21:37:27 INFO local.LocalTaskSetManager: Size of task 75 is 1500 bytes
13/07/27 21:37:27 INFO local.LocalScheduler: Running 75
13/07/27 21:37:27 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:27 INFO local.LocalScheduler: Finished 75
13/07/27 21:37:27 INFO scheduler.DAGScheduler: Completed ResultTask(3, 18)
13/07/27 21:37:27 INFO local.LocalScheduler: Remove TaskSet 3.0 from pool 
13/07/27 21:37:27 INFO scheduler.DAGScheduler: Stage 3 (count at <console>:15) finished in 4.006 s
13/07/27 21:37:27 INFO spark.SparkContext: Job finished: count at <console>:15, took 4.014702339 s
res3: Long = 500094

scala> s.count()
13/07/27 21:37:28 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:37:28 INFO scheduler.DAGScheduler: Got job 4 (count at <console>:15) with 19 output partitions (allowLocal=false)
13/07/27 21:37:28 INFO scheduler.DAGScheduler: Final stage: Stage 4 (count at <console>:15)
13/07/27 21:37:28 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:37:28 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:37:28 INFO scheduler.DAGScheduler: Submitting Stage 4 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:37:28 INFO scheduler.DAGScheduler: Submitting 19 missing tasks from Stage 4 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:37:28 INFO local.LocalTaskSetManager: Size of task 76 is 1500 bytes
13/07/27 21:37:28 INFO local.LocalScheduler: Running 76
13/07/27 21:37:28 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:28 INFO local.LocalScheduler: Finished 76
13/07/27 21:37:28 INFO scheduler.DAGScheduler: Completed ResultTask(4, 0)
13/07/27 21:37:28 INFO local.LocalTaskSetManager: Size of task 77 is 1500 bytes
13/07/27 21:37:28 INFO local.LocalScheduler: Running 77
13/07/27 21:37:28 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:28 INFO local.LocalScheduler: Finished 77
13/07/27 21:37:28 INFO scheduler.DAGScheduler: Completed ResultTask(4, 1)
13/07/27 21:37:28 INFO local.LocalTaskSetManager: Size of task 78 is 1500 bytes
13/07/27 21:37:28 INFO local.LocalScheduler: Running 78
13/07/27 21:37:28 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:28 INFO local.LocalScheduler: Finished 78
13/07/27 21:37:28 INFO scheduler.DAGScheduler: Completed ResultTask(4, 2)
13/07/27 21:37:28 INFO local.LocalTaskSetManager: Size of task 79 is 1500 bytes
13/07/27 21:37:28 INFO local.LocalScheduler: Running 79
13/07/27 21:37:28 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:28 INFO local.LocalScheduler: Finished 79
13/07/27 21:37:28 INFO scheduler.DAGScheduler: Completed ResultTask(4, 3)
13/07/27 21:37:28 INFO local.LocalTaskSetManager: Size of task 80 is 1500 bytes
13/07/27 21:37:28 INFO local.LocalScheduler: Running 80
13/07/27 21:37:28 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:29 INFO local.LocalScheduler: Finished 80
13/07/27 21:37:29 INFO scheduler.DAGScheduler: Completed ResultTask(4, 4)
13/07/27 21:37:29 INFO local.LocalTaskSetManager: Size of task 81 is 1500 bytes
13/07/27 21:37:29 INFO local.LocalScheduler: Running 81
13/07/27 21:37:29 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:29 INFO local.LocalScheduler: Finished 81
13/07/27 21:37:29 INFO scheduler.DAGScheduler: Completed ResultTask(4, 5)
13/07/27 21:37:29 INFO local.LocalTaskSetManager: Size of task 82 is 1500 bytes
13/07/27 21:37:29 INFO local.LocalScheduler: Running 82
13/07/27 21:37:29 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:29 INFO local.LocalScheduler: Finished 82
13/07/27 21:37:29 INFO scheduler.DAGScheduler: Completed ResultTask(4, 6)
13/07/27 21:37:29 INFO local.LocalTaskSetManager: Size of task 83 is 1500 bytes
13/07/27 21:37:29 INFO local.LocalScheduler: Running 83
13/07/27 21:37:29 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:29 INFO local.LocalScheduler: Finished 83
13/07/27 21:37:29 INFO scheduler.DAGScheduler: Completed ResultTask(4, 7)
13/07/27 21:37:29 INFO local.LocalTaskSetManager: Size of task 84 is 1500 bytes
13/07/27 21:37:29 INFO local.LocalScheduler: Running 84
13/07/27 21:37:29 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:29 INFO local.LocalScheduler: Finished 84
13/07/27 21:37:29 INFO scheduler.DAGScheduler: Completed ResultTask(4, 8)
13/07/27 21:37:29 INFO local.LocalTaskSetManager: Size of task 85 is 1500 bytes
13/07/27 21:37:29 INFO local.LocalScheduler: Running 85
13/07/27 21:37:29 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:30 INFO local.LocalScheduler: Finished 85
13/07/27 21:37:30 INFO scheduler.DAGScheduler: Completed ResultTask(4, 9)
13/07/27 21:37:30 INFO local.LocalTaskSetManager: Size of task 86 is 1500 bytes
13/07/27 21:37:30 INFO local.LocalScheduler: Running 86
13/07/27 21:37:30 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:30 INFO local.LocalScheduler: Finished 86
13/07/27 21:37:30 INFO scheduler.DAGScheduler: Completed ResultTask(4, 10)
13/07/27 21:37:30 INFO local.LocalTaskSetManager: Size of task 87 is 1500 bytes
13/07/27 21:37:30 INFO local.LocalScheduler: Running 87
13/07/27 21:37:30 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:30 INFO local.LocalScheduler: Finished 87
13/07/27 21:37:30 INFO scheduler.DAGScheduler: Completed ResultTask(4, 11)
13/07/27 21:37:30 INFO local.LocalTaskSetManager: Size of task 88 is 1500 bytes
13/07/27 21:37:30 INFO local.LocalScheduler: Running 88
13/07/27 21:37:30 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:30 INFO local.LocalScheduler: Finished 88
13/07/27 21:37:30 INFO scheduler.DAGScheduler: Completed ResultTask(4, 12)
13/07/27 21:37:30 INFO local.LocalTaskSetManager: Size of task 89 is 1500 bytes
13/07/27 21:37:30 INFO local.LocalScheduler: Running 89
13/07/27 21:37:30 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:31 INFO local.LocalScheduler: Finished 89
13/07/27 21:37:31 INFO scheduler.DAGScheduler: Completed ResultTask(4, 13)
13/07/27 21:37:31 INFO local.LocalTaskSetManager: Size of task 90 is 1500 bytes
13/07/27 21:37:31 INFO local.LocalScheduler: Running 90
13/07/27 21:37:31 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:31 INFO local.LocalScheduler: Finished 90
13/07/27 21:37:31 INFO scheduler.DAGScheduler: Completed ResultTask(4, 14)
13/07/27 21:37:31 INFO local.LocalTaskSetManager: Size of task 91 is 1500 bytes
13/07/27 21:37:31 INFO local.LocalScheduler: Running 91
13/07/27 21:37:31 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:31 INFO local.LocalScheduler: Finished 91
13/07/27 21:37:31 INFO scheduler.DAGScheduler: Completed ResultTask(4, 15)
13/07/27 21:37:31 INFO local.LocalTaskSetManager: Size of task 92 is 1500 bytes
13/07/27 21:37:31 INFO local.LocalScheduler: Running 92
13/07/27 21:37:31 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:31 INFO local.LocalScheduler: Finished 92
13/07/27 21:37:31 INFO scheduler.DAGScheduler: Completed ResultTask(4, 16)
13/07/27 21:37:31 INFO local.LocalTaskSetManager: Size of task 93 is 1500 bytes
13/07/27 21:37:31 INFO local.LocalScheduler: Running 93
13/07/27 21:37:31 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:31 INFO local.LocalScheduler: Finished 93
13/07/27 21:37:31 INFO scheduler.DAGScheduler: Completed ResultTask(4, 17)
13/07/27 21:37:31 INFO local.LocalTaskSetManager: Size of task 94 is 1500 bytes
13/07/27 21:37:31 INFO local.LocalScheduler: Running 94
13/07/27 21:37:31 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:32 INFO local.LocalScheduler: Finished 94
13/07/27 21:37:32 INFO scheduler.DAGScheduler: Completed ResultTask(4, 18)
13/07/27 21:37:32 INFO local.LocalScheduler: Remove TaskSet 4.0 from pool 
13/07/27 21:37:32 INFO scheduler.DAGScheduler: Stage 4 (count at <console>:15) finished in 4.001 s
13/07/27 21:37:32 INFO spark.SparkContext: Job finished: count at <console>:15, took 4.010423921 s
res4: Long = 500094

scala> s.count()
13/07/27 21:37:32 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:37:32 INFO scheduler.DAGScheduler: Got job 5 (count at <console>:15) with 19 output partitions (allowLocal=false)
13/07/27 21:37:32 INFO scheduler.DAGScheduler: Final stage: Stage 5 (count at <console>:15)
13/07/27 21:37:32 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:37:32 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:37:32 INFO scheduler.DAGScheduler: Submitting Stage 5 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:37:32 INFO scheduler.DAGScheduler: Submitting 19 missing tasks from Stage 5 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:37:32 INFO local.LocalTaskSetManager: Size of task 95 is 1500 bytes
13/07/27 21:37:32 INFO local.LocalScheduler: Running 95
13/07/27 21:37:32 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:32 INFO local.LocalScheduler: Finished 95
13/07/27 21:37:32 INFO scheduler.DAGScheduler: Completed ResultTask(5, 0)
13/07/27 21:37:32 INFO local.LocalTaskSetManager: Size of task 96 is 1500 bytes
13/07/27 21:37:32 INFO local.LocalScheduler: Running 96
13/07/27 21:37:32 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:32 INFO local.LocalScheduler: Finished 96
13/07/27 21:37:32 INFO scheduler.DAGScheduler: Completed ResultTask(5, 1)
13/07/27 21:37:32 INFO local.LocalTaskSetManager: Size of task 97 is 1500 bytes
13/07/27 21:37:32 INFO local.LocalScheduler: Running 97
13/07/27 21:37:32 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:32 INFO local.LocalScheduler: Finished 97
13/07/27 21:37:32 INFO scheduler.DAGScheduler: Completed ResultTask(5, 2)
13/07/27 21:37:32 INFO local.LocalTaskSetManager: Size of task 98 is 1500 bytes
13/07/27 21:37:32 INFO local.LocalScheduler: Running 98
13/07/27 21:37:32 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:33 INFO local.LocalScheduler: Finished 98
13/07/27 21:37:33 INFO scheduler.DAGScheduler: Completed ResultTask(5, 3)
13/07/27 21:37:33 INFO local.LocalTaskSetManager: Size of task 99 is 1500 bytes
13/07/27 21:37:33 INFO local.LocalScheduler: Running 99
13/07/27 21:37:33 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:33 INFO local.LocalScheduler: Finished 99
13/07/27 21:37:33 INFO scheduler.DAGScheduler: Completed ResultTask(5, 4)
13/07/27 21:37:33 INFO local.LocalTaskSetManager: Size of task 100 is 1500 bytes
13/07/27 21:37:33 INFO local.LocalScheduler: Running 100
13/07/27 21:37:33 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:33 INFO local.LocalScheduler: Finished 100
13/07/27 21:37:33 INFO scheduler.DAGScheduler: Completed ResultTask(5, 5)
13/07/27 21:37:33 INFO local.LocalTaskSetManager: Size of task 101 is 1500 bytes
13/07/27 21:37:33 INFO local.LocalScheduler: Running 101
13/07/27 21:37:33 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:33 INFO local.LocalScheduler: Finished 101
13/07/27 21:37:33 INFO scheduler.DAGScheduler: Completed ResultTask(5, 6)
13/07/27 21:37:33 INFO local.LocalTaskSetManager: Size of task 102 is 1500 bytes
13/07/27 21:37:33 INFO local.LocalScheduler: Running 102
13/07/27 21:37:33 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:34 INFO local.LocalScheduler: Finished 102
13/07/27 21:37:34 INFO scheduler.DAGScheduler: Completed ResultTask(5, 7)
13/07/27 21:37:34 INFO local.LocalTaskSetManager: Size of task 103 is 1500 bytes
13/07/27 21:37:34 INFO local.LocalScheduler: Running 103
13/07/27 21:37:34 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:34 INFO local.LocalScheduler: Finished 103
13/07/27 21:37:34 INFO scheduler.DAGScheduler: Completed ResultTask(5, 8)
13/07/27 21:37:34 INFO local.LocalTaskSetManager: Size of task 104 is 1500 bytes
13/07/27 21:37:34 INFO local.LocalScheduler: Running 104
13/07/27 21:37:34 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:34 INFO local.LocalScheduler: Finished 104
13/07/27 21:37:34 INFO scheduler.DAGScheduler: Completed ResultTask(5, 9)
13/07/27 21:37:34 INFO local.LocalTaskSetManager: Size of task 105 is 1500 bytes
13/07/27 21:37:34 INFO local.LocalScheduler: Running 105
13/07/27 21:37:34 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:34 INFO local.LocalScheduler: Finished 105
13/07/27 21:37:34 INFO scheduler.DAGScheduler: Completed ResultTask(5, 10)
13/07/27 21:37:34 INFO local.LocalTaskSetManager: Size of task 106 is 1500 bytes
13/07/27 21:37:34 INFO local.LocalScheduler: Running 106
13/07/27 21:37:34 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:34 INFO local.LocalScheduler: Finished 106
13/07/27 21:37:34 INFO scheduler.DAGScheduler: Completed ResultTask(5, 11)
13/07/27 21:37:34 INFO local.LocalTaskSetManager: Size of task 107 is 1500 bytes
13/07/27 21:37:34 INFO local.LocalScheduler: Running 107
13/07/27 21:37:34 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:35 INFO local.LocalScheduler: Finished 107
13/07/27 21:37:35 INFO scheduler.DAGScheduler: Completed ResultTask(5, 12)
13/07/27 21:37:35 INFO local.LocalTaskSetManager: Size of task 108 is 1500 bytes
13/07/27 21:37:35 INFO local.LocalScheduler: Running 108
13/07/27 21:37:35 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:35 INFO local.LocalScheduler: Finished 108
13/07/27 21:37:35 INFO scheduler.DAGScheduler: Completed ResultTask(5, 13)
13/07/27 21:37:35 INFO local.LocalTaskSetManager: Size of task 109 is 1500 bytes
13/07/27 21:37:35 INFO local.LocalScheduler: Running 109
13/07/27 21:37:35 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:35 INFO local.LocalScheduler: Finished 109
13/07/27 21:37:35 INFO scheduler.DAGScheduler: Completed ResultTask(5, 14)
13/07/27 21:37:35 INFO local.LocalTaskSetManager: Size of task 110 is 1500 bytes
13/07/27 21:37:35 INFO local.LocalScheduler: Running 110
13/07/27 21:37:35 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:35 INFO local.LocalScheduler: Finished 110
13/07/27 21:37:35 INFO scheduler.DAGScheduler: Completed ResultTask(5, 15)
13/07/27 21:37:35 INFO local.LocalTaskSetManager: Size of task 111 is 1500 bytes
13/07/27 21:37:35 INFO local.LocalScheduler: Running 111
13/07/27 21:37:35 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:35 INFO local.LocalScheduler: Finished 111
13/07/27 21:37:35 INFO scheduler.DAGScheduler: Completed ResultTask(5, 16)
13/07/27 21:37:35 INFO local.LocalTaskSetManager: Size of task 112 is 1500 bytes
13/07/27 21:37:35 INFO local.LocalScheduler: Running 112
13/07/27 21:37:35 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:36 INFO local.LocalScheduler: Finished 112
13/07/27 21:37:36 INFO scheduler.DAGScheduler: Completed ResultTask(5, 17)
13/07/27 21:37:36 INFO local.LocalTaskSetManager: Size of task 113 is 1500 bytes
13/07/27 21:37:36 INFO local.LocalScheduler: Running 113
13/07/27 21:37:36 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:36 INFO local.LocalScheduler: Finished 113
13/07/27 21:37:36 INFO scheduler.DAGScheduler: Completed ResultTask(5, 18)
13/07/27 21:37:36 INFO local.LocalScheduler: Remove TaskSet 5.0 from pool 
13/07/27 21:37:36 INFO scheduler.DAGScheduler: Stage 5 (count at <console>:15) finished in 3.967 s
13/07/27 21:37:36 INFO spark.SparkContext: Job finished: count at <console>:15, took 3.975746187 s
res5: Long = 500094

scala> s.count()
13/07/27 21:37:36 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:37:36 INFO scheduler.DAGScheduler: Got job 6 (count at <console>:15) with 19 output partitions (allowLocal=false)
13/07/27 21:37:36 INFO scheduler.DAGScheduler: Final stage: Stage 6 (count at <console>:15)
13/07/27 21:37:36 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:37:36 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:37:36 INFO scheduler.DAGScheduler: Submitting Stage 6 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:37:36 INFO scheduler.DAGScheduler: Submitting 19 missing tasks from Stage 6 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:37:36 INFO local.LocalTaskSetManager: Size of task 114 is 1500 bytes
13/07/27 21:37:36 INFO local.LocalScheduler: Running 114
13/07/27 21:37:36 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:36 INFO local.LocalScheduler: Finished 114
13/07/27 21:37:36 INFO scheduler.DAGScheduler: Completed ResultTask(6, 0)
13/07/27 21:37:36 INFO local.LocalTaskSetManager: Size of task 115 is 1500 bytes
13/07/27 21:37:36 INFO local.LocalScheduler: Running 115
13/07/27 21:37:36 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:36 INFO local.LocalScheduler: Finished 115
13/07/27 21:37:36 INFO scheduler.DAGScheduler: Completed ResultTask(6, 1)
13/07/27 21:37:36 INFO local.LocalTaskSetManager: Size of task 116 is 1500 bytes
13/07/27 21:37:36 INFO local.LocalScheduler: Running 116
13/07/27 21:37:36 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:37 INFO local.LocalScheduler: Finished 116
13/07/27 21:37:37 INFO scheduler.DAGScheduler: Completed ResultTask(6, 2)
13/07/27 21:37:37 INFO local.LocalTaskSetManager: Size of task 117 is 1500 bytes
13/07/27 21:37:37 INFO local.LocalScheduler: Running 117
13/07/27 21:37:37 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:37 INFO local.LocalScheduler: Finished 117
13/07/27 21:37:37 INFO scheduler.DAGScheduler: Completed ResultTask(6, 3)
13/07/27 21:37:37 INFO local.LocalTaskSetManager: Size of task 118 is 1500 bytes
13/07/27 21:37:37 INFO local.LocalScheduler: Running 118
13/07/27 21:37:37 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:37 INFO local.LocalScheduler: Finished 118
13/07/27 21:37:37 INFO scheduler.DAGScheduler: Completed ResultTask(6, 4)
13/07/27 21:37:37 INFO local.LocalTaskSetManager: Size of task 119 is 1500 bytes
13/07/27 21:37:37 INFO local.LocalScheduler: Running 119
13/07/27 21:37:37 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:37 INFO local.LocalScheduler: Finished 119
13/07/27 21:37:37 INFO scheduler.DAGScheduler: Completed ResultTask(6, 5)
13/07/27 21:37:37 INFO local.LocalTaskSetManager: Size of task 120 is 1500 bytes
13/07/27 21:37:37 INFO local.LocalScheduler: Running 120
13/07/27 21:37:37 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:37 INFO local.LocalScheduler: Finished 120
13/07/27 21:37:37 INFO scheduler.DAGScheduler: Completed ResultTask(6, 6)
13/07/27 21:37:37 INFO local.LocalTaskSetManager: Size of task 121 is 1500 bytes
13/07/27 21:37:37 INFO local.LocalScheduler: Running 121
13/07/27 21:37:38 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:38 INFO local.LocalScheduler: Finished 121
13/07/27 21:37:38 INFO scheduler.DAGScheduler: Completed ResultTask(6, 7)
13/07/27 21:37:38 INFO local.LocalTaskSetManager: Size of task 122 is 1500 bytes
13/07/27 21:37:38 INFO local.LocalScheduler: Running 122
13/07/27 21:37:38 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:38 INFO local.LocalScheduler: Finished 122
13/07/27 21:37:38 INFO scheduler.DAGScheduler: Completed ResultTask(6, 8)
13/07/27 21:37:38 INFO local.LocalTaskSetManager: Size of task 123 is 1500 bytes
13/07/27 21:37:38 INFO local.LocalScheduler: Running 123
13/07/27 21:37:38 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:38 INFO local.LocalScheduler: Finished 123
13/07/27 21:37:38 INFO scheduler.DAGScheduler: Completed ResultTask(6, 9)
13/07/27 21:37:38 INFO local.LocalTaskSetManager: Size of task 124 is 1500 bytes
13/07/27 21:37:38 INFO local.LocalScheduler: Running 124
13/07/27 21:37:38 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:38 INFO local.LocalScheduler: Finished 124
13/07/27 21:37:38 INFO scheduler.DAGScheduler: Completed ResultTask(6, 10)
13/07/27 21:37:38 INFO local.LocalTaskSetManager: Size of task 125 is 1500 bytes
13/07/27 21:37:38 INFO local.LocalScheduler: Running 125
13/07/27 21:37:38 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:39 INFO local.LocalScheduler: Finished 125
13/07/27 21:37:39 INFO scheduler.DAGScheduler: Completed ResultTask(6, 11)
13/07/27 21:37:39 INFO local.LocalTaskSetManager: Size of task 126 is 1500 bytes
13/07/27 21:37:39 INFO local.LocalScheduler: Running 126
13/07/27 21:37:39 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:39 INFO local.LocalScheduler: Finished 126
13/07/27 21:37:39 INFO scheduler.DAGScheduler: Completed ResultTask(6, 12)
13/07/27 21:37:39 INFO local.LocalTaskSetManager: Size of task 127 is 1500 bytes
13/07/27 21:37:39 INFO local.LocalScheduler: Running 127
13/07/27 21:37:39 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:39 INFO local.LocalScheduler: Finished 127
13/07/27 21:37:39 INFO scheduler.DAGScheduler: Completed ResultTask(6, 13)
13/07/27 21:37:39 INFO local.LocalTaskSetManager: Size of task 128 is 1500 bytes
13/07/27 21:37:39 INFO local.LocalScheduler: Running 128
13/07/27 21:37:39 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:39 INFO local.LocalScheduler: Finished 128
13/07/27 21:37:39 INFO scheduler.DAGScheduler: Completed ResultTask(6, 14)
13/07/27 21:37:39 INFO local.LocalTaskSetManager: Size of task 129 is 1500 bytes
13/07/27 21:37:39 INFO local.LocalScheduler: Running 129
13/07/27 21:37:39 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:39 INFO local.LocalScheduler: Finished 129
13/07/27 21:37:39 INFO scheduler.DAGScheduler: Completed ResultTask(6, 15)
13/07/27 21:37:39 INFO local.LocalTaskSetManager: Size of task 130 is 1500 bytes
13/07/27 21:37:39 INFO local.LocalScheduler: Running 130
13/07/27 21:37:39 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:40 INFO local.LocalScheduler: Finished 130
13/07/27 21:37:40 INFO scheduler.DAGScheduler: Completed ResultTask(6, 16)
13/07/27 21:37:40 INFO local.LocalTaskSetManager: Size of task 131 is 1500 bytes
13/07/27 21:37:40 INFO local.LocalScheduler: Running 131
13/07/27 21:37:40 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:40 INFO local.LocalScheduler: Finished 131
13/07/27 21:37:40 INFO scheduler.DAGScheduler: Completed ResultTask(6, 17)
13/07/27 21:37:40 INFO local.LocalTaskSetManager: Size of task 132 is 1500 bytes
13/07/27 21:37:40 INFO local.LocalScheduler: Running 132
13/07/27 21:37:40 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:40 INFO local.LocalScheduler: Finished 132
13/07/27 21:37:40 INFO scheduler.DAGScheduler: Completed ResultTask(6, 18)
13/07/27 21:37:40 INFO local.LocalScheduler: Remove TaskSet 6.0 from pool 
13/07/27 21:37:40 INFO scheduler.DAGScheduler: Stage 6 (count at <console>:15) finished in 3.975 s
13/07/27 21:37:40 INFO spark.SparkContext: Job finished: count at <console>:15, took 3.983709346 s
res6: Long = 500094

scala> s.count()
13/07/27 21:37:40 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:37:40 INFO scheduler.DAGScheduler: Got job 7 (count at <console>:15) with 19 output partitions (allowLocal=false)
13/07/27 21:37:40 INFO scheduler.DAGScheduler: Final stage: Stage 7 (count at <console>:15)
13/07/27 21:37:40 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:37:40 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:37:40 INFO scheduler.DAGScheduler: Submitting Stage 7 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:37:40 INFO scheduler.DAGScheduler: Submitting 19 missing tasks from Stage 7 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:37:40 INFO local.LocalTaskSetManager: Size of task 133 is 1500 bytes
13/07/27 21:37:40 INFO local.LocalScheduler: Running 133
13/07/27 21:37:40 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:40 INFO local.LocalScheduler: Finished 133
13/07/27 21:37:40 INFO scheduler.DAGScheduler: Completed ResultTask(7, 0)
13/07/27 21:37:40 INFO local.LocalTaskSetManager: Size of task 134 is 1500 bytes
13/07/27 21:37:40 INFO local.LocalScheduler: Running 134
13/07/27 21:37:40 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:41 INFO local.LocalScheduler: Finished 134
13/07/27 21:37:41 INFO scheduler.DAGScheduler: Completed ResultTask(7, 1)
13/07/27 21:37:41 INFO local.LocalTaskSetManager: Size of task 135 is 1500 bytes
13/07/27 21:37:41 INFO local.LocalScheduler: Running 135
13/07/27 21:37:41 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:41 INFO local.LocalScheduler: Finished 135
13/07/27 21:37:41 INFO scheduler.DAGScheduler: Completed ResultTask(7, 2)
13/07/27 21:37:41 INFO local.LocalTaskSetManager: Size of task 136 is 1500 bytes
13/07/27 21:37:41 INFO local.LocalScheduler: Running 136
13/07/27 21:37:41 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:41 INFO local.LocalScheduler: Finished 136
13/07/27 21:37:41 INFO scheduler.DAGScheduler: Completed ResultTask(7, 3)
13/07/27 21:37:41 INFO local.LocalTaskSetManager: Size of task 137 is 1500 bytes
13/07/27 21:37:41 INFO local.LocalScheduler: Running 137
13/07/27 21:37:41 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:41 INFO local.LocalScheduler: Finished 137
13/07/27 21:37:41 INFO scheduler.DAGScheduler: Completed ResultTask(7, 4)
13/07/27 21:37:41 INFO local.LocalTaskSetManager: Size of task 138 is 1500 bytes
13/07/27 21:37:41 INFO local.LocalScheduler: Running 138
13/07/27 21:37:41 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:42 INFO local.LocalScheduler: Finished 138
13/07/27 21:37:42 INFO scheduler.DAGScheduler: Completed ResultTask(7, 5)
13/07/27 21:37:42 INFO local.LocalTaskSetManager: Size of task 139 is 1500 bytes
13/07/27 21:37:42 INFO local.LocalScheduler: Running 139
13/07/27 21:37:42 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:42 INFO local.LocalScheduler: Finished 139
13/07/27 21:37:42 INFO scheduler.DAGScheduler: Completed ResultTask(7, 6)
13/07/27 21:37:42 INFO local.LocalTaskSetManager: Size of task 140 is 1500 bytes
13/07/27 21:37:42 INFO local.LocalScheduler: Running 140
13/07/27 21:37:42 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:42 INFO local.LocalScheduler: Finished 140
13/07/27 21:37:42 INFO scheduler.DAGScheduler: Completed ResultTask(7, 7)
13/07/27 21:37:42 INFO local.LocalTaskSetManager: Size of task 141 is 1500 bytes
13/07/27 21:37:42 INFO local.LocalScheduler: Running 141
13/07/27 21:37:42 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:42 INFO local.LocalScheduler: Finished 141
13/07/27 21:37:42 INFO scheduler.DAGScheduler: Completed ResultTask(7, 8)
13/07/27 21:37:42 INFO local.LocalTaskSetManager: Size of task 142 is 1500 bytes
13/07/27 21:37:42 INFO local.LocalScheduler: Running 142
13/07/27 21:37:42 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:42 INFO local.LocalScheduler: Finished 142
13/07/27 21:37:42 INFO scheduler.DAGScheduler: Completed ResultTask(7, 9)
13/07/27 21:37:42 INFO local.LocalTaskSetManager: Size of task 143 is 1500 bytes
13/07/27 21:37:42 INFO local.LocalScheduler: Running 143
13/07/27 21:37:42 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:43 INFO local.LocalScheduler: Finished 143
13/07/27 21:37:43 INFO scheduler.DAGScheduler: Completed ResultTask(7, 10)
13/07/27 21:37:43 INFO local.LocalTaskSetManager: Size of task 144 is 1500 bytes
13/07/27 21:37:43 INFO local.LocalScheduler: Running 144
13/07/27 21:37:43 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:43 INFO local.LocalScheduler: Finished 144
13/07/27 21:37:43 INFO scheduler.DAGScheduler: Completed ResultTask(7, 11)
13/07/27 21:37:43 INFO local.LocalTaskSetManager: Size of task 145 is 1500 bytes
13/07/27 21:37:43 INFO local.LocalScheduler: Running 145
13/07/27 21:37:43 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:43 INFO local.LocalScheduler: Finished 145
13/07/27 21:37:43 INFO scheduler.DAGScheduler: Completed ResultTask(7, 12)
13/07/27 21:37:43 INFO local.LocalTaskSetManager: Size of task 146 is 1500 bytes
13/07/27 21:37:43 INFO local.LocalScheduler: Running 146
13/07/27 21:37:43 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:43 INFO local.LocalScheduler: Finished 146
13/07/27 21:37:43 INFO scheduler.DAGScheduler: Completed ResultTask(7, 13)
13/07/27 21:37:43 INFO local.LocalTaskSetManager: Size of task 147 is 1500 bytes
13/07/27 21:37:43 INFO local.LocalScheduler: Running 147
13/07/27 21:37:43 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:43 INFO local.LocalScheduler: Finished 147
13/07/27 21:37:43 INFO scheduler.DAGScheduler: Completed ResultTask(7, 14)
13/07/27 21:37:43 INFO local.LocalTaskSetManager: Size of task 148 is 1500 bytes
13/07/27 21:37:43 INFO local.LocalScheduler: Running 148
13/07/27 21:37:43 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:44 INFO local.LocalScheduler: Finished 148
13/07/27 21:37:44 INFO scheduler.DAGScheduler: Completed ResultTask(7, 15)
13/07/27 21:37:44 INFO local.LocalTaskSetManager: Size of task 149 is 1500 bytes
13/07/27 21:37:44 INFO local.LocalScheduler: Running 149
13/07/27 21:37:44 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:44 INFO local.LocalScheduler: Finished 149
13/07/27 21:37:44 INFO scheduler.DAGScheduler: Completed ResultTask(7, 16)
13/07/27 21:37:44 INFO local.LocalTaskSetManager: Size of task 150 is 1500 bytes
13/07/27 21:37:44 INFO local.LocalScheduler: Running 150
13/07/27 21:37:44 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:44 INFO local.LocalScheduler: Finished 150
13/07/27 21:37:44 INFO scheduler.DAGScheduler: Completed ResultTask(7, 17)
13/07/27 21:37:44 INFO local.LocalTaskSetManager: Size of task 151 is 1500 bytes
13/07/27 21:37:44 INFO local.LocalScheduler: Running 151
13/07/27 21:37:44 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:44 INFO local.LocalScheduler: Finished 151
13/07/27 21:37:44 INFO scheduler.DAGScheduler: Completed ResultTask(7, 18)
13/07/27 21:37:44 INFO local.LocalScheduler: Remove TaskSet 7.0 from pool 
13/07/27 21:37:44 INFO scheduler.DAGScheduler: Stage 7 (count at <console>:15) finished in 3.998 s
13/07/27 21:37:44 INFO spark.SparkContext: Job finished: count at <console>:15, took 4.01304565 s
res7: Long = 500094

scala> s.count()
13/07/27 21:37:44 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:37:44 INFO scheduler.DAGScheduler: Got job 8 (count at <console>:15) with 19 output partitions (allowLocal=false)
13/07/27 21:37:44 INFO scheduler.DAGScheduler: Final stage: Stage 8 (count at <console>:15)
13/07/27 21:37:44 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:37:44 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:37:44 INFO scheduler.DAGScheduler: Submitting Stage 8 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:37:44 INFO scheduler.DAGScheduler: Submitting 19 missing tasks from Stage 8 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:37:44 INFO local.LocalTaskSetManager: Size of task 152 is 1500 bytes
13/07/27 21:37:44 INFO local.LocalScheduler: Running 152
13/07/27 21:37:44 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:45 INFO local.LocalScheduler: Finished 152
13/07/27 21:37:45 INFO scheduler.DAGScheduler: Completed ResultTask(8, 0)
13/07/27 21:37:45 INFO local.LocalTaskSetManager: Size of task 153 is 1500 bytes
13/07/27 21:37:45 INFO local.LocalScheduler: Running 153
13/07/27 21:37:45 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:45 INFO local.LocalScheduler: Finished 153
13/07/27 21:37:45 INFO scheduler.DAGScheduler: Completed ResultTask(8, 1)
13/07/27 21:37:45 INFO local.LocalTaskSetManager: Size of task 154 is 1500 bytes
13/07/27 21:37:45 INFO local.LocalScheduler: Running 154
13/07/27 21:37:45 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:45 INFO local.LocalScheduler: Finished 154
13/07/27 21:37:45 INFO scheduler.DAGScheduler: Completed ResultTask(8, 2)
13/07/27 21:37:45 INFO local.LocalTaskSetManager: Size of task 155 is 1500 bytes
13/07/27 21:37:45 INFO local.LocalScheduler: Running 155
13/07/27 21:37:45 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:45 INFO local.LocalScheduler: Finished 155
13/07/27 21:37:45 INFO scheduler.DAGScheduler: Completed ResultTask(8, 3)
13/07/27 21:37:45 INFO local.LocalTaskSetManager: Size of task 156 is 1500 bytes
13/07/27 21:37:45 INFO local.LocalScheduler: Running 156
13/07/27 21:37:45 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:46 INFO local.LocalScheduler: Finished 156
13/07/27 21:37:46 INFO scheduler.DAGScheduler: Completed ResultTask(8, 4)
13/07/27 21:37:46 INFO local.LocalTaskSetManager: Size of task 157 is 1500 bytes
13/07/27 21:37:46 INFO local.LocalScheduler: Running 157
13/07/27 21:37:46 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:46 INFO local.LocalScheduler: Finished 157
13/07/27 21:37:46 INFO scheduler.DAGScheduler: Completed ResultTask(8, 5)
13/07/27 21:37:46 INFO local.LocalTaskSetManager: Size of task 158 is 1500 bytes
13/07/27 21:37:46 INFO local.LocalScheduler: Running 158
13/07/27 21:37:46 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:46 INFO local.LocalScheduler: Finished 158
13/07/27 21:37:46 INFO scheduler.DAGScheduler: Completed ResultTask(8, 6)
13/07/27 21:37:46 INFO local.LocalTaskSetManager: Size of task 159 is 1500 bytes
13/07/27 21:37:46 INFO local.LocalScheduler: Running 159
13/07/27 21:37:46 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:46 INFO local.LocalScheduler: Finished 159
13/07/27 21:37:46 INFO scheduler.DAGScheduler: Completed ResultTask(8, 7)
13/07/27 21:37:46 INFO local.LocalTaskSetManager: Size of task 160 is 1500 bytes
13/07/27 21:37:46 INFO local.LocalScheduler: Running 160
13/07/27 21:37:46 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:46 INFO local.LocalScheduler: Finished 160
13/07/27 21:37:46 INFO scheduler.DAGScheduler: Completed ResultTask(8, 8)
13/07/27 21:37:46 INFO local.LocalTaskSetManager: Size of task 161 is 1500 bytes
13/07/27 21:37:46 INFO local.LocalScheduler: Running 161
13/07/27 21:37:46 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:47 INFO local.LocalScheduler: Finished 161
13/07/27 21:37:47 INFO scheduler.DAGScheduler: Completed ResultTask(8, 9)
13/07/27 21:37:47 INFO local.LocalTaskSetManager: Size of task 162 is 1500 bytes
13/07/27 21:37:47 INFO local.LocalScheduler: Running 162
13/07/27 21:37:47 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:47 INFO local.LocalScheduler: Finished 162
13/07/27 21:37:47 INFO scheduler.DAGScheduler: Completed ResultTask(8, 10)
13/07/27 21:37:47 INFO local.LocalTaskSetManager: Size of task 163 is 1500 bytes
13/07/27 21:37:47 INFO local.LocalScheduler: Running 163
13/07/27 21:37:47 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:47 INFO local.LocalScheduler: Finished 163
13/07/27 21:37:47 INFO scheduler.DAGScheduler: Completed ResultTask(8, 11)
13/07/27 21:37:47 INFO local.LocalTaskSetManager: Size of task 164 is 1500 bytes
13/07/27 21:37:47 INFO local.LocalScheduler: Running 164
13/07/27 21:37:47 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:47 INFO local.LocalScheduler: Finished 164
13/07/27 21:37:47 INFO scheduler.DAGScheduler: Completed ResultTask(8, 12)
13/07/27 21:37:47 INFO local.LocalTaskSetManager: Size of task 165 is 1500 bytes
13/07/27 21:37:47 INFO local.LocalScheduler: Running 165
13/07/27 21:37:47 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:47 INFO local.LocalScheduler: Finished 165
13/07/27 21:37:47 INFO scheduler.DAGScheduler: Completed ResultTask(8, 13)
13/07/27 21:37:47 INFO local.LocalTaskSetManager: Size of task 166 is 1500 bytes
13/07/27 21:37:47 INFO local.LocalScheduler: Running 166
13/07/27 21:37:47 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:48 INFO local.LocalScheduler: Finished 166
13/07/27 21:37:48 INFO scheduler.DAGScheduler: Completed ResultTask(8, 14)
13/07/27 21:37:48 INFO local.LocalTaskSetManager: Size of task 167 is 1500 bytes
13/07/27 21:37:48 INFO local.LocalScheduler: Running 167
13/07/27 21:37:48 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:48 INFO local.LocalScheduler: Finished 167
13/07/27 21:37:48 INFO scheduler.DAGScheduler: Completed ResultTask(8, 15)
13/07/27 21:37:48 INFO local.LocalTaskSetManager: Size of task 168 is 1500 bytes
13/07/27 21:37:48 INFO local.LocalScheduler: Running 168
13/07/27 21:37:48 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:48 INFO local.LocalScheduler: Finished 168
13/07/27 21:37:48 INFO scheduler.DAGScheduler: Completed ResultTask(8, 16)
13/07/27 21:37:48 INFO local.LocalTaskSetManager: Size of task 169 is 1500 bytes
13/07/27 21:37:48 INFO local.LocalScheduler: Running 169
13/07/27 21:37:48 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:48 INFO local.LocalScheduler: Finished 169
13/07/27 21:37:48 INFO scheduler.DAGScheduler: Completed ResultTask(8, 17)
13/07/27 21:37:48 INFO local.LocalTaskSetManager: Size of task 170 is 1500 bytes
13/07/27 21:37:48 INFO local.LocalScheduler: Running 170
13/07/27 21:37:48 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:48 INFO local.LocalScheduler: Finished 170
13/07/27 21:37:48 INFO scheduler.DAGScheduler: Completed ResultTask(8, 18)
13/07/27 21:37:48 INFO local.LocalScheduler: Remove TaskSet 8.0 from pool 
13/07/27 21:37:48 INFO scheduler.DAGScheduler: Stage 8 (count at <console>:15) finished in 3.959 s
13/07/27 21:37:48 INFO spark.SparkContext: Job finished: count at <console>:15, took 3.967623559 s
res8: Long = 500094

scala> s.count()
13/07/27 21:37:49 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:37:49 INFO scheduler.DAGScheduler: Got job 9 (count at <console>:15) with 19 output partitions (allowLocal=false)
13/07/27 21:37:49 INFO scheduler.DAGScheduler: Final stage: Stage 9 (count at <console>:15)
13/07/27 21:37:49 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:37:49 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:37:49 INFO scheduler.DAGScheduler: Submitting Stage 9 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:37:49 INFO scheduler.DAGScheduler: Submitting 19 missing tasks from Stage 9 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:37:49 INFO local.LocalTaskSetManager: Size of task 171 is 1500 bytes
13/07/27 21:37:49 INFO local.LocalScheduler: Running 171
13/07/27 21:37:49 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:49 INFO local.LocalScheduler: Finished 171
13/07/27 21:37:49 INFO scheduler.DAGScheduler: Completed ResultTask(9, 0)
13/07/27 21:37:49 INFO local.LocalTaskSetManager: Size of task 172 is 1500 bytes
13/07/27 21:37:49 INFO local.LocalScheduler: Running 172
13/07/27 21:37:49 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:49 INFO local.LocalScheduler: Finished 172
13/07/27 21:37:49 INFO scheduler.DAGScheduler: Completed ResultTask(9, 1)
13/07/27 21:37:49 INFO local.LocalTaskSetManager: Size of task 173 is 1500 bytes
13/07/27 21:37:49 INFO local.LocalScheduler: Running 173
13/07/27 21:37:49 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:49 INFO local.LocalScheduler: Finished 173
13/07/27 21:37:49 INFO scheduler.DAGScheduler: Completed ResultTask(9, 2)
13/07/27 21:37:49 INFO local.LocalTaskSetManager: Size of task 174 is 1500 bytes
13/07/27 21:37:49 INFO local.LocalScheduler: Running 174
13/07/27 21:37:49 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:49 INFO local.LocalScheduler: Finished 174
13/07/27 21:37:49 INFO scheduler.DAGScheduler: Completed ResultTask(9, 3)
13/07/27 21:37:49 INFO local.LocalTaskSetManager: Size of task 175 is 1500 bytes
13/07/27 21:37:49 INFO local.LocalScheduler: Running 175
13/07/27 21:37:50 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:50 INFO local.LocalScheduler: Finished 175
13/07/27 21:37:50 INFO scheduler.DAGScheduler: Completed ResultTask(9, 4)
13/07/27 21:37:50 INFO local.LocalTaskSetManager: Size of task 176 is 1500 bytes
13/07/27 21:37:50 INFO local.LocalScheduler: Running 176
13/07/27 21:37:50 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:50 INFO local.LocalScheduler: Finished 176
13/07/27 21:37:50 INFO scheduler.DAGScheduler: Completed ResultTask(9, 5)
13/07/27 21:37:50 INFO local.LocalTaskSetManager: Size of task 177 is 1500 bytes
13/07/27 21:37:50 INFO local.LocalScheduler: Running 177
13/07/27 21:37:50 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:50 INFO local.LocalScheduler: Finished 177
13/07/27 21:37:50 INFO scheduler.DAGScheduler: Completed ResultTask(9, 6)
13/07/27 21:37:50 INFO local.LocalTaskSetManager: Size of task 178 is 1500 bytes
13/07/27 21:37:50 INFO local.LocalScheduler: Running 178
13/07/27 21:37:50 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:50 INFO local.LocalScheduler: Finished 178
13/07/27 21:37:50 INFO scheduler.DAGScheduler: Completed ResultTask(9, 7)
13/07/27 21:37:50 INFO local.LocalTaskSetManager: Size of task 179 is 1500 bytes
13/07/27 21:37:50 INFO local.LocalScheduler: Running 179
13/07/27 21:37:50 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:51 INFO local.LocalScheduler: Finished 179
13/07/27 21:37:51 INFO scheduler.DAGScheduler: Completed ResultTask(9, 8)
13/07/27 21:37:51 INFO local.LocalTaskSetManager: Size of task 180 is 1500 bytes
13/07/27 21:37:51 INFO local.LocalScheduler: Running 180
13/07/27 21:37:51 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:51 INFO local.LocalScheduler: Finished 180
13/07/27 21:37:51 INFO scheduler.DAGScheduler: Completed ResultTask(9, 9)
13/07/27 21:37:51 INFO local.LocalTaskSetManager: Size of task 181 is 1500 bytes
13/07/27 21:37:51 INFO local.LocalScheduler: Running 181
13/07/27 21:37:51 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:51 INFO local.LocalScheduler: Finished 181
13/07/27 21:37:51 INFO scheduler.DAGScheduler: Completed ResultTask(9, 10)
13/07/27 21:37:51 INFO local.LocalTaskSetManager: Size of task 182 is 1500 bytes
13/07/27 21:37:51 INFO local.LocalScheduler: Running 182
13/07/27 21:37:51 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:51 INFO local.LocalScheduler: Finished 182
13/07/27 21:37:51 INFO scheduler.DAGScheduler: Completed ResultTask(9, 11)
13/07/27 21:37:51 INFO local.LocalTaskSetManager: Size of task 183 is 1500 bytes
13/07/27 21:37:51 INFO local.LocalScheduler: Running 183
13/07/27 21:37:51 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:51 INFO local.LocalScheduler: Finished 183
13/07/27 21:37:51 INFO scheduler.DAGScheduler: Completed ResultTask(9, 12)
13/07/27 21:37:51 INFO local.LocalTaskSetManager: Size of task 184 is 1500 bytes
13/07/27 21:37:51 INFO local.LocalScheduler: Running 184
13/07/27 21:37:51 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:52 INFO local.LocalScheduler: Finished 184
13/07/27 21:37:52 INFO scheduler.DAGScheduler: Completed ResultTask(9, 13)
13/07/27 21:37:52 INFO local.LocalTaskSetManager: Size of task 185 is 1500 bytes
13/07/27 21:37:52 INFO local.LocalScheduler: Running 185
13/07/27 21:37:52 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:52 INFO local.LocalScheduler: Finished 185
13/07/27 21:37:52 INFO scheduler.DAGScheduler: Completed ResultTask(9, 14)
13/07/27 21:37:52 INFO local.LocalTaskSetManager: Size of task 186 is 1500 bytes
13/07/27 21:37:52 INFO local.LocalScheduler: Running 186
13/07/27 21:37:52 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:52 INFO local.LocalScheduler: Finished 186
13/07/27 21:37:52 INFO scheduler.DAGScheduler: Completed ResultTask(9, 15)
13/07/27 21:37:52 INFO local.LocalTaskSetManager: Size of task 187 is 1500 bytes
13/07/27 21:37:52 INFO local.LocalScheduler: Running 187
13/07/27 21:37:52 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:52 INFO local.LocalScheduler: Finished 187
13/07/27 21:37:52 INFO scheduler.DAGScheduler: Completed ResultTask(9, 16)
13/07/27 21:37:52 INFO local.LocalTaskSetManager: Size of task 188 is 1500 bytes
13/07/27 21:37:52 INFO local.LocalScheduler: Running 188
13/07/27 21:37:52 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:52 INFO local.LocalScheduler: Finished 188
13/07/27 21:37:52 INFO scheduler.DAGScheduler: Completed ResultTask(9, 17)
13/07/27 21:37:52 INFO local.LocalTaskSetManager: Size of task 189 is 1500 bytes
13/07/27 21:37:52 INFO local.LocalScheduler: Running 189
13/07/27 21:37:52 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:53 INFO local.LocalScheduler: Finished 189
13/07/27 21:37:53 INFO scheduler.DAGScheduler: Completed ResultTask(9, 18)
13/07/27 21:37:53 INFO local.LocalScheduler: Remove TaskSet 9.0 from pool 
13/07/27 21:37:53 INFO scheduler.DAGScheduler: Stage 9 (count at <console>:15) finished in 3.938 s
13/07/27 21:37:53 INFO spark.SparkContext: Job finished: count at <console>:15, took 3.945925139 s
res9: Long = 500094

scala> s.count()
13/07/27 21:37:53 INFO spark.SparkContext: Starting job: count at <console>:15
13/07/27 21:37:53 INFO scheduler.DAGScheduler: Got job 10 (count at <console>:15) with 19 output partitions (allowLocal=false)
13/07/27 21:37:53 INFO scheduler.DAGScheduler: Final stage: Stage 10 (count at <console>:15)
13/07/27 21:37:53 INFO scheduler.DAGScheduler: Parents of final stage: List()
13/07/27 21:37:53 INFO scheduler.DAGScheduler: Missing parents: List()
13/07/27 21:37:53 INFO scheduler.DAGScheduler: Submitting Stage 10 (MappedRDD[1] at textFile at <console>:12), which has no missing parents
13/07/27 21:37:53 INFO scheduler.DAGScheduler: Submitting 19 missing tasks from Stage 10 (MappedRDD[1] at textFile at <console>:12)
13/07/27 21:37:53 INFO local.LocalTaskSetManager: Size of task 190 is 1500 bytes
13/07/27 21:37:53 INFO local.LocalScheduler: Running 190
13/07/27 21:37:53 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:53 INFO local.LocalScheduler: Finished 190
13/07/27 21:37:53 INFO scheduler.DAGScheduler: Completed ResultTask(10, 0)
13/07/27 21:37:53 INFO local.LocalTaskSetManager: Size of task 191 is 1500 bytes
13/07/27 21:37:53 INFO local.LocalScheduler: Running 191
13/07/27 21:37:53 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:53 INFO local.LocalScheduler: Finished 191
13/07/27 21:37:53 INFO scheduler.DAGScheduler: Completed ResultTask(10, 1)
13/07/27 21:37:53 INFO local.LocalTaskSetManager: Size of task 192 is 1500 bytes
13/07/27 21:37:53 INFO local.LocalScheduler: Running 192
13/07/27 21:37:53 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:53 INFO local.LocalScheduler: Finished 192
13/07/27 21:37:53 INFO scheduler.DAGScheduler: Completed ResultTask(10, 2)
13/07/27 21:37:53 INFO local.LocalTaskSetManager: Size of task 193 is 1500 bytes
13/07/27 21:37:53 INFO local.LocalScheduler: Running 193
13/07/27 21:37:53 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:54 INFO local.LocalScheduler: Finished 193
13/07/27 21:37:54 INFO scheduler.DAGScheduler: Completed ResultTask(10, 3)
13/07/27 21:37:54 INFO local.LocalTaskSetManager: Size of task 194 is 1500 bytes
13/07/27 21:37:54 INFO local.LocalScheduler: Running 194
13/07/27 21:37:54 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:54 INFO local.LocalScheduler: Finished 194
13/07/27 21:37:54 INFO scheduler.DAGScheduler: Completed ResultTask(10, 4)
13/07/27 21:37:54 INFO local.LocalTaskSetManager: Size of task 195 is 1500 bytes
13/07/27 21:37:54 INFO local.LocalScheduler: Running 195
13/07/27 21:37:54 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:54 INFO local.LocalScheduler: Finished 195
13/07/27 21:37:54 INFO scheduler.DAGScheduler: Completed ResultTask(10, 5)
13/07/27 21:37:54 INFO local.LocalTaskSetManager: Size of task 196 is 1500 bytes
13/07/27 21:37:54 INFO local.LocalScheduler: Running 196
13/07/27 21:37:54 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:54 INFO local.LocalScheduler: Finished 196
13/07/27 21:37:54 INFO scheduler.DAGScheduler: Completed ResultTask(10, 6)
13/07/27 21:37:54 INFO local.LocalTaskSetManager: Size of task 197 is 1500 bytes
13/07/27 21:37:54 INFO local.LocalScheduler: Running 197
13/07/27 21:37:54 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:54 INFO local.LocalScheduler: Finished 197
13/07/27 21:37:54 INFO scheduler.DAGScheduler: Completed ResultTask(10, 7)
13/07/27 21:37:54 INFO local.LocalTaskSetManager: Size of task 198 is 1500 bytes
13/07/27 21:37:54 INFO local.LocalScheduler: Running 198
13/07/27 21:37:54 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:55 INFO local.LocalScheduler: Finished 198
13/07/27 21:37:55 INFO scheduler.DAGScheduler: Completed ResultTask(10, 8)
13/07/27 21:37:55 INFO local.LocalTaskSetManager: Size of task 199 is 1500 bytes
13/07/27 21:37:55 INFO local.LocalScheduler: Running 199
13/07/27 21:37:55 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:55 INFO local.LocalScheduler: Finished 199
13/07/27 21:37:55 INFO scheduler.DAGScheduler: Completed ResultTask(10, 9)
13/07/27 21:37:55 INFO local.LocalTaskSetManager: Size of task 200 is 1500 bytes
13/07/27 21:37:55 INFO local.LocalScheduler: Running 200
13/07/27 21:37:55 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:55 INFO local.LocalScheduler: Finished 200
13/07/27 21:37:55 INFO scheduler.DAGScheduler: Completed ResultTask(10, 10)
13/07/27 21:37:55 INFO local.LocalTaskSetManager: Size of task 201 is 1500 bytes
13/07/27 21:37:55 INFO local.LocalScheduler: Running 201
13/07/27 21:37:55 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:55 INFO local.LocalScheduler: Finished 201
13/07/27 21:37:55 INFO scheduler.DAGScheduler: Completed ResultTask(10, 11)
13/07/27 21:37:55 INFO local.LocalTaskSetManager: Size of task 202 is 1500 bytes
13/07/27 21:37:55 INFO local.LocalScheduler: Running 202
13/07/27 21:37:55 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:56 INFO local.LocalScheduler: Finished 202
13/07/27 21:37:56 INFO scheduler.DAGScheduler: Completed ResultTask(10, 12)
13/07/27 21:37:56 INFO local.LocalTaskSetManager: Size of task 203 is 1500 bytes
13/07/27 21:37:56 INFO local.LocalScheduler: Running 203
13/07/27 21:37:56 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:56 INFO local.LocalScheduler: Finished 203
13/07/27 21:37:56 INFO scheduler.DAGScheduler: Completed ResultTask(10, 13)
13/07/27 21:37:56 INFO local.LocalTaskSetManager: Size of task 204 is 1500 bytes
13/07/27 21:37:56 INFO local.LocalScheduler: Running 204
13/07/27 21:37:56 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:56 INFO local.LocalScheduler: Finished 204
13/07/27 21:37:56 INFO scheduler.DAGScheduler: Completed ResultTask(10, 14)
13/07/27 21:37:56 INFO local.LocalTaskSetManager: Size of task 205 is 1500 bytes
13/07/27 21:37:56 INFO local.LocalScheduler: Running 205
13/07/27 21:37:56 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:56 INFO local.LocalScheduler: Finished 205
13/07/27 21:37:56 INFO scheduler.DAGScheduler: Completed ResultTask(10, 15)
13/07/27 21:37:56 INFO local.LocalTaskSetManager: Size of task 206 is 1500 bytes
13/07/27 21:37:56 INFO local.LocalScheduler: Running 206
13/07/27 21:37:56 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:56 INFO local.LocalScheduler: Finished 206
13/07/27 21:37:56 INFO scheduler.DAGScheduler: Completed ResultTask(10, 16)
13/07/27 21:37:56 INFO local.LocalTaskSetManager: Size of task 207 is 1500 bytes
13/07/27 21:37:56 INFO local.LocalScheduler: Running 207
13/07/27 21:37:56 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:57 INFO local.LocalScheduler: Finished 207
13/07/27 21:37:57 INFO scheduler.DAGScheduler: Completed ResultTask(10, 17)
13/07/27 21:37:57 INFO local.LocalTaskSetManager: Size of task 208 is 1500 bytes
13/07/27 21:37:57 INFO local.LocalScheduler: Running 208
13/07/27 21:37:57 INFO : open(tachyon://tachyon-ec2-0:19998/hit_data.tsv.500000, 65536)
13/07/27 21:37:57 INFO local.LocalScheduler: Finished 208
13/07/27 21:37:57 INFO scheduler.DAGScheduler: Completed ResultTask(10, 18)
13/07/27 21:37:57 INFO local.LocalScheduler: Remove TaskSet 10.0 from pool 
13/07/27 21:37:57 INFO scheduler.DAGScheduler: Stage 10 (count at <console>:15) finished in 3.963 s
13/07/27 21:37:57 INFO spark.SparkContext: Job finished: count at <console>:15, took 3.971509177 s
res10: Long = 500094

scala> 13/07/27 21:37:57 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/,null}
13/07/27 21:37:57 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/static,null}
13/07/27 21:37:57 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/executors,null}
13/07/27 21:37:57 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/environment,null}
13/07/27 21:37:57 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages,null}
13/07/27 21:37:57 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/stages/stage,null}
13/07/27 21:37:57 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage,null}
13/07/27 21:37:57 INFO handler.ContextHandler: stopped o.e.j.s.h.ContextHandler{/storage/rdd,null}
Killed 1 processes
Killed 1 processes
tachyon-ec2-0: Killed 0 processes
-Xmx2048m -Dlog4j.configuration=file:/home/ubuntu/work/tachyon/conf/log4j.properties -Dtachyon.debug=false -Dtachyon.underfs.address=file:///mnt/tachyon -Dtachyon.worker.memory.size=2GB -Dtachyon.worker.data.folder=/mnt/ramdisk/tachyonworker/ -Dtachyon.master.worker.timeout.ms=60000 -Dtachyon.master.hostname=tachyon-ec2-0 -Dtachyon.master.log.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_log.data -Dtachyon.master.checkpoint.file=/home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data -Dtachyon.master.pinlist=/pinfiles;/pindata
Formatting Tachyon @ tachyon-ec2-0
2013-07-27 21:37:59,096 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_checkpoint.data
2013-07-27 21:37:59,100 INFO   (Format.java:main) - Deleting /home/ubuntu/work/tachyon/bin/../data/tachyon_log.data
2013-07-27 21:37:59,590 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/data
2013-07-27 21:37:59,602 INFO   (Format.java:main) - Formatting file:///mnt/tachyon/tachyon/workers

